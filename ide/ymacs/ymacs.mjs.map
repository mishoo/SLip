{"mappings":"AGIA,IACI,EADA,EAAW,SAAS,aAAa,CAAC,YAG3B,EAAM,CACb,SAAS,CAAI,EACT,EAAS,SAAS,CAAG,EAAK,IAAI,GAC9B,IAAI,EAAO,EAAS,OAAO,CAC3B,OAAO,EAAK,QAAQ,CAAC,MAAM,CAAG,EAAI,EAAO,EAAK,QAAQ,CAAC,EAAE,AAC7D,EACA,SAAS,CAAE,CAAE,CAAG,EACZ,EAAG,SAAS,CAAC,GAAG,CAAC,EACrB,EACA,SAAS,CAAE,CAAE,CAAG,EACR,aAAe,OACf,EAAG,SAAS,CAAG,EAAG,SAAS,CAAC,OAAO,CAAC,EAAK,IAEzC,EAAG,SAAS,CAAC,MAAM,CAAC,EAE5B,EACA,SAAA,CAAS,EAAI,IACF,EAAG,SAAS,CAAC,QAAQ,CAAC,GAEjC,UAAU,CAAE,CAAE,CAAI,CAAE,CAAO,CAAE,CAAQ,EACjC,EAAG,SAAS,CAAC,MAAM,CAAC,EAAS,CAAC,CAAC,GAC3B,GACA,EAAG,SAAS,CAAC,MAAM,CAAC,EAAU,CAAC,EAEvC,EACA,YAAY,CAAE,CAAE,GAAG,CAAI,EACnB,EAAG,SAAS,CAAC,MAAM,IAAI,EAC3B,EACA,MAAM,CAAE,EACJ,GAAM,EAAG,MAAM,EACnB,EACA,GAAG,CAAO,CAAE,CAAK,CAAE,CAAO,CAAE,CAAO,EAC3B,AAAgB,UAAhB,OAAO,EACP,EAAQ,gBAAgB,CAAC,EAAO,EAAS,GAAW,CAAC,GAErD,OAAO,IAAI,CAAC,GAAO,OAAO,CAAC,AAAA,GAAM,EAAI,EAAE,CAAC,EAAS,EAAI,CAAK,CAAC,EAAG,CAAE,GAAW,CAAC,GAEpF,EACA,IAAI,CAAO,CAAE,CAAK,CAAE,CAAO,CAAE,CAAO,EAC5B,AAAgB,UAAhB,OAAO,EACP,EAAQ,mBAAmB,CAAC,EAAO,EAAS,GAAW,CAAC,GAExD,OAAO,IAAI,CAAC,GAAO,OAAO,CAAC,AAAA,GAAM,EAAI,GAAG,CAAC,EAAS,EAAI,CAAK,CAAC,EAAG,CAAE,GAAW,CAAC,GAErF,EACA,UAAA,AAAU,IACN,SAAS,IAAI,CAAC,WAAW,CAAC,GACtB,GACA,CAAA,EAAQ,SAAS,CAAG,CADxB,EAGO,GAEX,aACI,EAAQ,MAAM,EAClB,EACA,SAAS,CAAE,CAAE,CAAE,EACX,IAAI,EAAM,EAAG,qBAAqB,GAClC,MAAO,CACH,EAAG,EAAG,OAAO,CAAG,EAAI,IAAI,CACxB,EAAG,EAAG,OAAO,CAAG,EAAI,GAAG,AAC3B,CACJ,EACA,WAAY,SAAS,CAAG,EACpB,MAAO,AAAC,CAAA,EAAI,EAAA,EAAI,OAAO,CAAC,KAAM,SACzB,OAAO,CAAC,QAAS,UACjB,OAAO,CAAC,QAAS,UACjB,OAAO,CAAC,KAAM,QACd,OAAO,CAAC,KAAM,QACd,OAAO,CAAC,UAAW,SAC5B,CACJ,EAEA,EAAU,EAAI,QAAQ,CAAC,4FAEhB,OAAM,EACT,YAAY,CAAO,CAAE,CACjB,IAAI,CAAC,YAAY,CAAG,OAAO,MAAM,CAAC,MAClC,IAAI,CAAC,CAAC,CAAG,OAAO,MAAM,CAAC,OAAO,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAI,MAAO,EAC5E,CACA,iBAAiB,CAAK,CAAE,CAAO,CAAE,CAC7B,GAAI,AAAgB,UAAhB,OAAO,EAAmB,CAC1B,IAAI,EAAI,IAAI,CAAC,YAAY,CAAC,GAC1B,EAAO,EAAG,GACV,EAAE,IAAI,CAAC,EACX,MACI,OAAO,IAAI,CAAC,GAAO,OAAO,CAAC,AAAA,GAAM,IAAI,CAAC,gBAAgB,CAAC,EAAI,CAAK,CAAC,EAAG,EAE5E,CACA,oBAAoB,CAAK,CAAE,CAAO,CAAE,CAC5B,AAAgB,UAAhB,OAAO,EACP,EAAO,IAAI,CAAC,YAAY,CAAC,GAAQ,GAEjC,OAAO,IAAI,CAAC,GAAO,OAAO,CAAC,AAAA,GAAM,IAAI,CAAC,mBAAmB,CAAC,EAAI,CAAK,CAAC,EAAG,EAE/E,CACA,WAAW,CAAK,CAAE,CAAO,CAAE,CACvB,IAAI,CAAC,gBAAgB,CAAC,EAAO,SAAS,EAAG,GAAG,CAAI,EAE5C,OADA,IAAI,CAAC,mBAAmB,CAAC,EAAO,GACzB,EAAQ,KAAK,CAAC,IAAI,CAAE,EAC/B,EACJ,CACA,UAAU,CAAE,CAAE,GAAG,CAAI,CAAE,CACnB,IAAI,CAAC,YAAY,CAAC,GAAI,OAAO,CAAC,AAAA,GAAK,EAAE,KAAK,CAAC,IAAI,CAAE,GACrD,CACA,SAAU,CACN,IAAI,CAAC,SAAS,CAAC,YACnB,CACA,aAAa,CAAE,CAAE,CACb,OAAO,IAAI,CAAC,YAAY,CAAC,EAAG,EAAK,CAAA,IAAI,CAAC,YAAY,CAAC,EAAG,CAAG,EAAE,AAAF,CAC7D,CACJ,CAEO,MAAM,UAAe,EACxB,YAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GACT,IAAI,CAAC,aAAa,EACtB,CACA,eAAgB,CACZ,IAAI,EAAK,SAAS,aAAa,CAAC,OAIhC,OAHA,EAAG,SAAS,CAAG,IAAI,CAAC,aAAa,GACjC,EAAG,aAAa,CAAG,IAAI,CACvB,IAAI,CAAC,EAAE,CAAG,EACH,CACX,CACA,eAAgB,CACZ,OAAO,IAAI,CAAC,WAAW,CAAC,IAAI,AAChC,CACA,mBAAoB,CAChB,OAAO,IAAI,CAAC,EAAE,AAClB,CACA,YAAa,CACT,OAAO,IAAI,CAAC,EAAE,AAClB,CACA,IAAI,CAAK,CAAE,CACH,aAAiB,GACjB,CAAA,EAAQ,EAAM,UAAU,EAD5B,EAGA,IAAI,CAAC,iBAAiB,GAAG,WAAW,CAAC,EACzC,CACA,SAAS,CAAG,CAAE,CACV,EAAI,QAAQ,CAAC,IAAI,CAAC,UAAU,GAAI,EACpC,CACA,SAAS,CAAG,CAAE,CACV,EAAI,QAAQ,CAAC,IAAI,CAAC,UAAU,GAAI,EACpC,CACA,SAAS,CAAG,CAAE,CACV,OAAO,EAAI,QAAQ,CAAC,IAAI,CAAC,UAAU,GAAI,EAC3C,CACA,UAAU,CAAI,CAAE,CAAO,CAAE,CAAQ,CAAE,CAC/B,EAAI,SAAS,CAAC,IAAI,CAAC,UAAU,GAAI,EAAM,EAAS,EACpD,CACA,YAAY,GAAG,CAAI,CAAE,CACjB,EAAI,WAAW,CAAC,IAAI,CAAC,UAAU,MAAO,EAC1C,CACA,WAAW,CAAI,CAAE,CACb,IAAI,CAAC,iBAAiB,GAAG,SAAS,CAAG,CACzC,CACA,SAAS,CAAI,CAAE,CAAG,CAAE,CAChB,IAAI,EAAQ,IAAI,CAAC,UAAU,GAAG,KAAK,AAC/B,AAAe,CAAA,UAAf,OAAO,EACP,CAAK,CAAC,EAAK,CAAG,EAEd,OAAO,MAAM,CAAC,EAAO,EAE7B,CACA,QAAS,CACL,OAAO,IAAI,CAAC,UAAU,GAAG,qBAAqB,EAClD,CACA,SAAU,CACN,EAAI,KAAK,CAAC,IAAI,CAAC,UAAU,IACzB,KAAK,CAAC,WAAW,UACrB,CACJ,CAEO,SAAS,EAAO,CAAK,CAAE,CAAO,EACjC,IAAI,EAAM,EACV,KAAQ,AAAA,CAAA,EAAM,EAAM,OAAO,CAAC,EAAS,EAAA,GAAS,GAC1C,EAAM,MAAM,CAAC,EAAK,EAE1B,CAEO,SAAS,EAAQ,CAAE,CAAE,EAAU,CAAC,CAAE,CAAG,CAAE,GAAG,CAAI,EAC7C,UAAU,MAAM,CAAG,GACnB,CAAA,EAAK,EAAG,IAAI,CAAC,KAAQ,EADzB,EAGA,IAAI,EAAQ,KACZ,OAAO,WACH,aAAa,GACb,EAAQ,WAAW,EAAI,EAC3B,CACJ,CAGO,SAAS,EAAY,CAAM,CAAE,CAAK,EACrC,IAAiB,EAAM,EAAnB,EAAK,QAeT,CAdI,EAHE,KAIF,EAAO,IACA,EALO,SAMd,GANE,KAOF,EAAO,KACA,EARyB,YAShC,GATc,QAUd,EAAO,KACA,EAX2C,gBAYlD,GAZgC,WAahC,EAAO,KAGX,EAAI,KAAK,KAAK,CAAC,GACX,GAAS,GAAM,GACR,EAAG,OAAO,CAAC,GAAS,EAEpB,EAAI,CACnB,CAYO,SAAS,EAAc,CAAO,EACjC,OAAQ,EAAQ,MAAM,EACpB,KAAK,EACH,MAAO,EACT,MAAK,EACH,OAAO,CAAO,CAAC,EAAE,AACnB,MAAK,EACH,IAAI,EAAI,CAAO,CAAC,EAAE,CACd,EAAI,CAAO,CAAC,EAAE,CACd,EAAI,KAAK,GAAG,CAAC,EAAE,MAAM,CAAE,EAAE,MAAM,EAC/B,EAAI,EACR,KAAO,EAAI,GAAK,EAAE,MAAM,CAAC,KAAO,EAAE,MAAM,CAAC,IAAI,EAAE,EAC/C,OAAO,EAAE,SAAS,CAAC,EAAG,EACxB,SACE,OAAO,EAAc,CAAE,CAAO,CAAC,EAAE,CAAE,EAAc,EAAQ,KAAK,CAAC,IAAK,CACxE,CACJ,CE/OO,MAAM,EAET,YAAY,CAAA,IACR,EAAM,IAAA,CAAA,OACN,EAAS,IAAA,CAAA,OACT,EAAS,CAAA,CAAA,CAAA,KACT,EAAO,IAAA,CACV,CAAG,CAAC,CAAC,CAAE,CACJ,IAAI,CAAC,QAAQ,CAAG,EAChB,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,IAAI,CAAG,EAEZ,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,EAC7B,IAAI,CAAC,MAAM,CAAG,KACd,IAAI,CAAC,QAAQ,CAAG,EAAE,AACtB,CAEA,SAAU,CACN,AAAA,EAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAE,IAAI,EAChC,IAAI,CAAC,MAAM,CAAG,IAClB,CAEA,aAAa,CAAG,CAAE,CAAI,CAAE,CAAG,CAAE,CACzB,IAAI,EAAI,IAAI,CAAC,QAAQ,AACjB,CAAA,IAAI,CAAC,MAAM,EACX,EAAE,EACM,GAAR,GAAa,GAAO,IACpB,IAAI,CAAC,MAAM,CAAG,KACd,IAAI,CAAC,QAAQ,EAAI,EACb,IAAI,CAAC,QAAQ,CAAG,GAChB,CAAA,IAAI,CAAC,QAAQ,CAAG,CADpB,EAEA,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAE,IAAI,CAAC,QAAQ,EAEnD,CAEA,UAAU,CAAC,CAAE,CAAG,CAAE,CACd,IAAK,IAAI,EAAI,EAAE,MAAM,CAAE,EAAE,GAAK,GAC1B,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAE,EAC/B,CAEA,aAAc,CACV,OAAO,IAAI,CAAC,QAAQ,AACxB,CAEA,SAAU,CACN,OAAO,IAAI,CAAC,QAAQ,AACxB,CAEA,YAAY,CAAG,CAAE,CAAO,CAAE,CAAK,CAAE,CACzB,CAAA,GAAS,IAAI,CAAC,QAAQ,EAAI,CAAA,IAC1B,IAAI,CAAC,MAAM,CAAG,KACd,IAAI,CAAC,QAAQ,CAAG,EACX,GACD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAE,IAAI,CAAC,QAAQ,EAEvD,CAEA,WAAY,CACR,OAAO,IAAI,CAAC,MAAM,EAAK,CAAA,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAA,CACpF,CAEA,KAAK,CAAK,CAAE,CAAO,CAAE,CAAK,CAAE,CACxB,IAAI,EAAM,IAAI,CAAC,WAAW,GAC1B,IAAI,CAAC,WAAW,CAAC,EAAM,WAAW,GAAI,EAAS,GAC/C,EAAM,WAAW,CAAC,EAAK,EAAS,EACpC,CAEJ,CCzEA,IAAI,EAAU,OAAO,MAAM,CAAC,KAErB,OAAM,EAET,YAAY,CAAI,CAAE,CACd,IAAI,CAAC,WAAW,CAAG,OAAO,MAAM,CAAC,MACjC,IAAI,CAAC,UAAU,CAAC,EACpB,CAEA,OAAO,OAAO,CAAI,CAAE,CAAI,CAAE,CACtB,IAAI,EAAM,GAAQ,CAAO,CAAC,EAAK,CAO/B,MANI,CAAC,IACD,EAAM,aAAgB,IAAI,CAAG,EAAO,IAAI,IAAI,CAAC,GACzC,GACA,CAAA,CAAO,CAAC,EAAK,CAAG,CADpB,GAIG,CACX,CAEA,OAAO,IAAI,CAAI,CAAE,CACb,OAAO,CAAO,CAAC,EAAK,AACxB,CAEA,OAAO,SAAS,CAAG,CAAE,CACjB,IAAI,EAAM,CAAC,EACP,EAAI,EAAI,KAAK,CAAC,KAClB,EAAE,OAAO,GACT,EAAE,OAAO,CAAC,CAAC,EAAG,KACV,GAAI,AAAK,GAAL,EACA,EAAI,GAAG,CAAG,AAAK,SAAL,EAAe,IAAM,AAAY,GAAZ,EAAE,MAAM,CAAQ,EAAE,WAAW,GAAK,OAC9D,OAAO,GACV,IAAK,IAAK,EAAI,OAAO,CAAG,CAAA,EAAM,KAC9B,KAAK,IAAK,EAAI,OAAO,CAAG,CAAA,EAAM,KAC9B,KAAK,IAAK,EAAI,QAAQ,CAAG,CAAA,CAC7B,CACJ,GACA,EAAE,OAAO,GACT,IAAI,EAAI,EAAE,GAAG,GAKb,OAJA,EAAI,GAAG,CAAG,EAAE,IAAI,GAAG,IAAI,CAAC,KACpB,EAAI,GAAG,EACP,CAAA,EAAI,GAAG,EAAI,GADf,EAEA,EAAI,GAAG,EAAI,EACJ,CACX,CAEA,OAAO,WAAW,CAAE,CAAE,CAClB,IAAI,EAAK,EAAI,EAAE,CAgBf,MAfI,eAAgB,EAChB,EAAM,EAAG,UAAU,CAAG,EAAI,UAAY,aAG3B,KADX,CAAA,EAAM,EAAG,GAAG,AAAH,GACO,CAAA,EAAM,OAAtB,EACkB,GAAd,EAAI,MAAM,EAAO,CAAA,EAAM,EAAI,WAAW,EAA1C,GAEA,EAAG,OAAO,EACV,EAAE,IAAI,CAAC,KACP,CAAA,EAAG,MAAM,EAAI,EAAG,SAAS,AAAT,GAChB,EAAE,IAAI,CAAC,KACP,EAAG,QAAQ,EAAK,CAAA,EAAI,MAAM,CAAG,GAAK,EAAI,WAAW,IAAM,EAAI,WAAW,EAAA,GACtE,EAAE,IAAI,CAAC,KACX,EAAE,IAAI,GACN,EAAE,IAAI,CAAC,GACA,EAAE,IAAI,CAAC,IAClB,CAEA,UAAU,CAAG,CAAE,CAAI,CAAE,CAAI,CAAE,CAMvB,GALI,aAAgB,QAChB,EAAO,EAAK,KAAK,CAAC,GAClB,EAAO,CAAI,CAAC,EAAE,EAGd,AADJ,CAAA,EAAM,EAAI,IAAI,GAAG,KAAK,CAAC,WAAvB,EACQ,MAAM,CAAG,EACb,EAAI,OAAO,CAAC,AAAA,GAAO,IAAI,CAAC,SAAS,CAAC,EAAK,EAAM,QAC1C,CACH,EAAM,CAAG,CAAC,EAAE,CAAC,IAAI,GACjB,IAAI,EAAM,IAAI,CAAC,WAAW,CAC1B,GAAI,EAAI,OAAO,CAAC,MAAQ,EAAG,CACvB,IAAI,EAAI,EAAI,KAAK,CAAC,OAClB,EAAM,EAAE,GAAG,GACX,EAAE,OAAO,CAAC,AAAA,IAED,CAAG,CADR,EAAM,IAAI,CAAC,QAAQ,CAAC,GAAK,GAAG,CACf,EACT,CAAA,CAAG,CAAC,EAAI,CAAG,CAAC,CAAA,EAChB,EAAM,CAAG,CAAC,EAAI,AAClB,EACJ,CAEA,CAAG,CAAC,AADJ,CAAA,EAAM,IAAI,CAAC,QAAQ,CAAC,EAApB,EACQ,GAAG,CAAC,CAAG,CAAE,EAAM,EAAM,AACjC,CACJ,CAEA,WAAW,CAAG,CAAE,CACZ,OAAO,IAAI,CAAC,GAAK,OAAO,CAAC,AAAA,GAAO,IAAI,CAAC,SAAS,CAAC,EAAK,CAAG,CAAC,EAAI,EAChE,CAEA,WAAW,CAAI,CAAE,CACb,IAAI,EAAU,KAAM,EAAM,IAAI,CAAC,WAAW,CAC1C,IAAK,IAAI,KAAO,EAAM,CAClB,IAAI,EAAM,EAAU,CAAO,CAAC,EAAI,CAAG,CAAG,CAAC,EAAI,CAC3C,GAAI,EAEA,CAAA,GAAI,MAAM,OAAO,CADjB,EAAU,GAEN,KADJ,KAGG,CACH,EAAU,KACV,KACJ,CACJ,CACA,OAAO,CACX,CAEA,UAAU,CAAC,CACX,UAAU,CAAC,CAEf,CGpHO,SAAS,EAAgB,CAAG,EAC/B,IAAI,CAAC,OAAO,CAAG,CACnB,CDiBO,SAAS,EAAkB,CAAI,CAAE,CAAI,EACxC,GAAI,AAAoB,GAApB,UAAU,MAAM,CAChB,EAAO,EACP,EAAO,SACJ,CACH,IAAI,EACE,aAAgB,WAClB,EAAgB,EAChB,EAAO,SAAS,CAAC,EAAE,CACnB,EAAK,QAAQ,CAAG,EAExB,CAEA,GADA,EAAK,gBAAgB,CAAG,CAAA,EACpB,AAAQ,MAAR,EAAc,CACd,GAAI,CAAC,MAAM,OAAO,CAAC,GAAO,CACtB,IAAI,EAAI,aAAa,IAAI,CAAC,GACtB,IACA,EAAI,CAAC,CAAC,EAAE,CACR,EAAO,EAAK,MAAM,CAAC,EAAE,MAAM,EACvB,EAAE,OAAO,CAAC,MAAQ,GAClB,CAAA,EAAK,eAAe,CAAG,CAAA,CAD3B,EAGI,EAAE,OAAO,CAAC,MAAQ,GAClB,CAAA,EAAK,iBAAiB,CAAG,CAAA,CAD7B,EAGI,EAAE,OAAO,CAAC,MAAQ,GAClB,CAAA,EAAK,gBAAgB,CAAG,CAAA,CAD5B,GAIA,GACA,CAAA,EAAO,EAAK,KAAK,CAAC,MADtB,CAEJ,CACA,GAAI,EAAM,KACF,EACJ,IAAI,EAAU,SAAS,GAAG,CAAI,EAE1B,OADA,EAAU,EAAQ,MAAM,CAAC,GAClB,IAAI,CAAC,iBAAiB,CAAC,EAAM,EAAS,CAAA,EACjD,EACA,KAAO,EAAK,MAAM,CAAG,GAAG,CACpB,IAAI,EAAO,EACX,EAAU,AAwL1B,SAAgC,CAAG,CAAE,CAAI,EACrC,IAAI,EAAS,CAAW,CAAC,EAAI,MAAM,CAAC,GAAG,CAEvC,OADA,EAAM,EAAI,MAAM,CAAC,GACV,WACH,OAAO,EAAO,IAAI,CAAC,IAAI,CAAE,EAAK,EAClC,CACJ,EA9LiD,EAAK,GAAG,GAAI,SAAS,GAAG,CAAI,EAEzD,OADA,EAAU,EAAQ,MAAM,CAAC,GAClB,EAAK,IAAI,CAAC,IAAI,CACzB,EACJ,CACA,EAAK,sBAAsB,CAAG,WAE1B,OADA,EAAU,EAAE,CACL,EAAQ,IAAI,CAAC,IAAI,CAC5B,CACJ,CACJ,CACA,OAAO,CACX,CAEO,SAAS,EAAoB,CAAI,EACpC,OAAO,EAAkB,IAAK,SAAS,CAAC,EAEpC,IADS,MAAL,GAAW,CAAA,EAAI,CAAA,EACZ,KAAM,GAAG,EAAK,IAAI,CAAC,IAAI,CAClC,EACJ,CFwCA,EAAa,SAAS,CAAC,QAAQ,CAAG,EAAa,QAAQ,CEtCvD,IAAI,EAAS,WAAW,EAMxB,SAAS,EAAO,CAAG,EACf,IAAI,EAAK,IAAI,CAAC,YAAY,CAAC,CAAA,GAI3B,OAHI,GACA,CAAA,EAAM,EAAK,IAAM,CADrB,EAGO,IAAI,CAAC,GAAG,CAAC,oBAAqB,EACzC,CAsDA,SAAS,EAAoB,CAAG,CAAE,CAAI,EAElC,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,yBAA0B,KAAM,EACpD,CAEA,SAAS,EAAY,CAAG,CAAE,CAAI,EAE1B,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,yBAA0B,EAC9C,CAzEA,EAAM,QAAQ,CAAG,WAAa,MAAO,EAAG,EACxC,EAAM,KAAK,CAAG,CAAA,EAkId,IAAI,EAAc,CACd,EAvHJ,SAA4B,CAAG,CAAE,CAAI,EAGjC,OAFA,QAAQ,GAAG,CAAC,qBAAsB,GAClC,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,2BAA4B,EAEhD,EAmHI,EAjHJ,SAAmC,CAAG,CAAE,CAAI,EAExC,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,yBAA0B,EAE9C,EA8GI,EA5GJ,SAA0B,CAAG,CAAE,CAAI,EAE/B,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,yBAA0B,EAC9C,EA0GI,EAxGJ,SAAwB,CAAG,CAAE,CAAI,EAEjC,EAuGI,EArGJ,SAA2B,CAAG,CAAE,CAAI,EAEhC,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,0BAA2B,EAE/C,EAkGI,EAhGJ,SAAmB,CAAG,CAAE,CAAI,EACxB,OAAO,EAAK,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,KAAK,GACrC,EA+FI,EA7FJ,SAAyB,CAAG,CAAE,CAAI,EAElC,EA4FI,EA1FJ,SAAoB,CAAG,CAAE,CAAI,EACzB,OAAO,EAAK,IAAI,CAAC,IAAI,CAAE,KAC3B,EAyFI,EAvFJ,SAA2B,CAAG,CAAE,CAAI,EAEpC,EAsFI,EApFJ,SAA4B,CAAG,CAAE,CAAI,EAErC,EAmFI,EAjFJ,SAAkB,CAAG,CAAE,CAAI,EACvB,OAAO,EAAK,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,UAAU,CAAC,WAAW,GACtD,EAgFI,EAAG,EACH,EAAG,EACH,EAtEJ,SAA+B,CAAG,CAAE,CAAI,EACpC,IAAI,EAAI,SAAS,IAAI,CAAC,YAAY,GAAI,WACtC,AAAK,MAAM,GAGA,EAAY,IAAI,CAAC,IAAI,CAAE,EAAK,GAF5B,EAAK,IAAI,CAAC,IAAI,CAAE,EAG/B,EAiEI,EA/DJ,SAA4B,CAAG,CAAE,CAAI,EACjC,IAAI,EAAI,SAAS,IAAI,CAAC,YAAY,GAAI,IAGtC,OAFI,MAAM,IACN,CAAA,EAAI,IADR,EAEO,EAAK,IAAI,CAAC,IAAI,CAAE,EAC3B,EA2DI,EAzDJ,SAAwB,CAAG,CAAE,CAAI,EAI7B,MAFY,KADZ,CAAA,EAAM,IAAI,CAAC,YAAY,EAAvB,GAEI,CAAA,EAAM,CADV,EAEO,EAAK,IAAI,CAAC,IAAI,CAAE,EAC3B,EAqDI,EAnDJ,SAA4B,CAAG,CAAE,CAAI,EACjC,IAAI,EAAI,IAAI,CAAC,SAAS,GACtB,OAAO,EAAK,IAAI,CAAC,IAAI,CAAE,EAAE,KAAK,CAAE,EAAE,GAAG,CACzC,EAiDI,EAAG,EACH,EAhDJ,SAA4B,CAAG,CAAE,CAAI,EAErC,EA+CI,EA7CJ,SAA4B,CAAG,CAAE,CAAI,EAEjC,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,2BAA4B,EAChD,EA4CI,EA1CJ,SAAiC,CAAG,CAAE,CAAI,EAEtC,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,gCAAiC,EACrD,EAwCI,EAtCJ,SAAwB,CAAG,CAAE,CAAI,EAE7B,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,uBAAwB,EAC5C,EAoCI,EAlCJ,SAAqC,CAAG,CAAE,CAAI,EAE1C,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,oCAAqC,EACzD,EAgCI,EA9BJ,SAAsC,CAAG,CAAE,CAAI,EAE3C,OADA,EAAO,IAAI,CAAC,IAAI,CAAE,GACX,IAAI,CAAC,GAAG,CAAC,4BAA6B,EACjD,CA+BA,ED9LA,IAAI,EAAkB,CAElB,qBAA4C,gBAC5C,qBAA4C,eAC5C,KAA4C,mCAC5C,aAA4C,cAC5C,MAA4C,oBAC5C,gBAA4C,sBAC5C,eAA4C,gBAC5C,sBAA4C,eAC5C,qBAA4C,gBAG5C,2BAA4C,qBAC5C,2BAA4C,oBAC5C,2BAA4C,oBAC5C,2BAA4C,qBAC5C,SAA4C,wCAC5C,QAA4C,yBAC5C,iBAA4C,mBAC5C,WAA4C,2BAC5C,UAA4C,qBAG5C,UAA4C,uBAC5C,gBAA4C,cAC5C,kBAA4C,YAC5C,yCAA4C,qBAC5C,MAA4C,YAC5C,kBAA4C,OAC5C,MAA4C,WAC5C,UAA4C,mBAC5C,UAA4C,0BAC5C,MAA4C,cAC5C,MAA4C,kBAC5C,MAA4C,kBAC5C,MAA4C,sBAC5C,MAA4C,kBAC5C,MAA4C,cAC5C,MAA4C,gBAC5C,IAA4C,2BAC5C,6BAA4C,OAC5C,OAA4C,iBAC5C,MAA4C,iBAC5C,MAA4C,gBAC5C,OAA4C,gBAK5C,eAA4C,6BAC5C,QAA4C,4BAE5C,QAA4C,qBAC5C,cAA4C,6BAC5C,WAA4C,oBAE5C,QAA4C,sBAChD,EAEI,EAAa,OAAO,MAAM,CAAC,CAAC,EAAG,EAAiB,CAEhD,qBAA4C,gBAC5C,qBAA4C,eAC5C,qBAA4C,gBAC5C,qBAA4C,eAC5C,KAA4C,mCAC5C,aAA4C,cAC5C,MAA4C,oBAC5C,gBAA4C,sBAC5C,eAA4C,gBAC5C,sBAA4C,eAC5C,qBAA4C,gBAC5C,cAA4C,oBAC5C,YAA4C,qBAC5C,MAA4C,iBAC5C,MAA4C,sBAC5C,OAA4C,iBAC5C,SAA4C,mBAC5C,QAA4C,YAC5C,UAA4C,cAG5C,2BAA4C,qBAC5C,2BAA4C,oBAC5C,2BAA4C,qBAC5C,2BAA4C,oBAC5C,2BAA4C,oBAC5C,2BAA4C,qBAC5C,gBAA4C,yBAC5C,cAA4C,0BAC5C,SAA4C,wCAC5C,QAA4C,yBAC5C,iBAA4C,mBAC5C,WAA4C,2BAC5C,UAA4C,qBAG5C,UAA4C,uBAC5C,gBAA4C,cAC5C,eAA4C,UAC5C,kBAA4C,YAC5C,yCAA4C,qBAC5C,MAA4C,YAC5C,kBAA4C,OAC5C,MAA4C,WAC5C,UAA4C,mBAC5C,UAA4C,0BAC5C,MAA4C,cAC5C,MAA4C,kBAC5C,MAA4C,kBAC5C,UAA4C,kBAC5C,MAA4C,sBAC5C,MAA4C,kBAC5C,MAA4C,cAC5C,MAA4C,gBAC5C,IAA4C,2BAC5C,IAA4C,cAC5C,SAA4C,gBAC5C,MAA4C,iBAC5C,6BAA4C,OAC5C,OAA4C,iBAC5C,MAA4C,cAC5C,MAA4C,iBAC5C,MAA4C,kBAC5C,MAA4C,mBAC5C,QAA4C,4BAC5C,QAA4C,yBAC5C,QAA4C,0BAC5C,MAA4C,gBAC5C,QAA4C,uBAC5C,MAA4C,qBAC5C,MAA4C,YAC5C,QAA4C,oBAC5C,MAA4C,gBAC5C,MAA4C,qBAC5C,MAA4C,eAC5C,QAA4C,uBAC5C,QAA4C,kBAG5C,UAA4C,mBAC5C,UAA4C,kBAC5C,UAA4C,iBAC5C,UAA4C,iBAG5C,8CAAmD,cACnD,8CAAmD,kBACnD,QAAmD,mBACnD,QAAmD,cAGnD,QAA4C,eAC5C,QAA4C,sBAC5C,QAA4C,yBAC5C,QAA4C,2BAC5C,QAA4C,cAC5C,QAA4C,sBAG5C,MAA4C,2BAE5C,eAA4C,6BAC5C,QAA4C,4BAG5C,QAA4C,aAC5C,QAA4C,qBAC5C,cAA4C,6BAC5C,WAA4C,oBAC5C,QAA4C,wBAC5C,UAA4C,uBAC5C,QAA4C,eAC5C,OAA4C,cAC5C,cAA4C,CAAE,WAAY,OAAQ,CAClE,eAA4C,CAAE,WAAY,QAAS,CACnE,YAA4C,CAAE,WAAY,KAAM,CAChE,cAA4C,CAAE,WAAY,OAAQ,CAElE,QAA4C,4BAC5C,QAA4C,qBAC5C,QAA4C,mBAG5C,UAA4C,YAC5C,UAA4C,aAC5C,UAA4C,cAC5C,QAA4C,mBAChD,GAEI,EAAoB,AAAA,EAAa,MAAM,CAAC,WAAY,EACxD,CAAA,EAAkB,cAAc,CAAG,CAAE,sBAAuB,CAE5D,IAAI,EAAe,AAAA,EAAa,MAAM,CAAC,QAAS,EAChD,CAAA,EAAa,cAAc,CAAG,CAAE,sBAAuB,CAEvD,IAAI,EAAuB,AAAA,EAAa,MAAM,CAAC,gBAAiB,CAAC,EACjE,CAAA,EAAqB,cAAc,CAAG,CAAE,AAAA,EAAkB,IAAK,WAC3D,IAAI,EAAK,IAAI,CAAC,gBAAgB,GAC1B,EAAK,EAAG,GAAG,CACX,EAAS,IAAI,CAAC,YAAY,CAAC,CAAA,SAC/B,AAAK,CAAA,UAAU,IAAI,CAAC,IAAQ,CAAA,AAAO,MAAP,GAAc,AAAW,KAAX,CAAW,GAAS,EAAG,MAAM,EAAK,EAAG,OAAO,EAUtF,IAAI,CAAC,SAAS,CAAC,GACR,CAAA,IAVH,GAAU,EACV,IAAI,CAAC,YAAY,CAAC,GACb,IAAI,CAAC,YAAY,EAClB,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,EAAG,GAAG,CAAC,SAAU,IAAK,EAC1B,GAEG,CAAA,EAIf,GAAI,CACJ,EAAqB,QAAQ,CAAG,AAAA,GAAU,EAAO,YAAY,CAAC,GGxQvD,OAAM,UAA8B,EAEvC,YAAY,CAAA,OAAE,CAAM,CAAE,CAAE,CACpB,KAAK,IAAI,WACT,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,KAAK,EACd,CAEA,OAAQ,CACJ,IAAI,CAAC,KAAK,CAAG,EAAE,AACnB,CAEA,WAAW,CAAG,CAAE,CACR,IAAI,CAAC,KAAK,CAAC,MAAM,CAAG,EACpB,IAAI,CAAC,KAAK,CAAC,EAAI,CAAG,KAElB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAK,EAAG,KAElC,CAEA,WAAW,CAAG,CAAE,CACZ,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,EAAK,EAC3B,CAEA,YAAY,CAAG,CAAE,CAAI,CAAE,CACnB,IAAI,EAAI,IAAI,CAAC,KAAK,CAAC,EAAI,CACnB,GAAK,EAAE,MAAM,CAAG,EAAK,MAAM,EAE3B,EAAE,MAAM,CAAC,EAAK,MAAM,CAE5B,CAEA,aAAa,CAAG,CAAE,CAAC,CAAE,CAAC,CAAE,CAAI,CAAE,CAAG,CAAE,CAC/B,IAAoB,EAAhB,EAAI,IAAI,CAAC,KAAK,CAAK,EAAU,CAAA,EACjC,GAAI,EAAI,EAAG,CAEP,IADA,EAAI,CAAC,CAAC,EAAI,EAAK,CAAA,CAAC,CAAC,EAAI,CAAG,EAAC,AAAD,EACjB,EAAI,GAEH,AADJ,CAAA,EAAI,CAAC,CAAC,EAAE,EAAK,CAAA,CAAC,CAAC,EAAE,CAAG,CAAC,CAAA,CAAA,CAChB,CAAC,EAAK,EAAI,GACX,CAAA,EAAU,CAAA,CADd,EAEA,CAAC,CAAC,EAAK,CAAG,EACV,EAAE,EAEF,GACA,IAAI,CAAC,SAAS,CAAC,WAAY,EACnC,CACA,OAAO,CACX,CAEA,gBAAgB,CAAG,CAAE,CAAC,CAAE,CAAC,CAAE,CAAI,CAAE,CAC7B,IAAyB,EAArB,EAAI,IAAI,CAAC,KAAK,CAAC,EAAI,CAAK,EAAU,CAAA,EACtC,GAAI,GAAK,EAAI,EAAG,CACZ,KAAO,EAAI,GACP,CAAA,EAAI,CAAC,CAAC,EAAE,AAAF,GACG,KAAQ,IACb,EAAU,CAAA,EACV,OAAO,CAAC,CAAC,EAAK,EAElB,EAAE,EAEF,GACA,IAAI,CAAC,SAAS,CAAC,WAAY,EACnC,CACA,OAAO,CACX,CAEA,gBAAgB,CAAG,CAAE,CAAC,CAAE,CAAI,CAAE,CAC1B,IAAI,EAAI,IAAI,CAAC,KAAK,CAAC,EAAI,CACnB,IACI,EAAO,EACP,EAAE,MAAM,CAAC,EAAG,KAAM,AAAI,MAAM,IACrB,EAAO,GACd,EAAE,MAAM,CAAC,EAAG,CAAC,GAGzB,CAYA,YAAY,CAAG,CAAE,CAAI,CAAE,CAAK,CAAE,CAC1B,IAAI,EAAI,IAAI,CAAC,KAAK,CAAC,EAAI,CACvB,GAAI,AAAU,OAAV,EAAgB,CAChB,GAAI,AAAQ,IAAR,EACA,MAAO,QACX,GAAI,CAAC,GAAK,AAAY,GAAZ,EAAE,MAAM,CACd,OAAO,AAAA,EAAI,UAAU,CAAC,EAE9B,KAAO,CACH,GAAI,AAAQ,IAAR,EACA,MAAO,0CACX,GAAI,CAAC,GAAK,AAAY,GAAZ,EAAE,MAAM,QACd,AAAI,IAAU,EAAK,MAAM,CACd,AAAA,EAAI,UAAU,CAAC,GAAQ,0CAC3B,AAAA,EAAI,UAAU,CAAC,EAAK,MAAM,CAAC,EAAG,IACjC,6BACA,AAAA,EAAI,UAAU,CAAC,EAAK,MAAM,CAAC,IAC3B,UACA,AAAA,EAAI,UAAU,CAAC,EAAK,MAAM,CAAC,EAAQ,GAE/C,CAEA,IADA,IAAyC,EAAa,EAAlD,EAAI,EAAG,EAAI,EAAK,MAAM,CAAE,EAAO,KAAS,EAAM,GAC3C,EAAI,GAAG,CAmBV,OAjBA,EAAI,AADJ,CAAA,EAAI,CAAC,CAAC,EAAE,AAAF,GACG,EAAE,GAAG,CACV,IAAM,GACN,CAAA,EAAI,EAAI,EAAI,eAAiB,aADjC,EAGI,GAAK,GAAK,GACN,GACA,CAAA,GAAO,SADX,EAEA,GAAO,gBAAkB,EAAI,MAExB,CAAC,GAAK,GACX,CAAA,GAAO,SAFX,EAIA,EAAO,EAIP,EAAK,EAAK,MAAM,CAAC,IAEf,IAAK,IAAM,GAAO,OAAQ,KAC1B,KAAK,IAAM,GAAO,OAAQ,KAC1B,KAAK,IAAM,GAAO,QAAS,KAC3B,SAAW,GAAO,CACpB,CACA,EAAE,CACN,CAOA,OANI,GACA,CAAA,GAAO,SADX,EAEI,IAAM,GAEN,CAAA,GAAO,yCAAP,EAEG,CACX,CAEJ,CN3IA,IAAI,EAAc,CACd,iBAA8B,KAC9B,aAA8B,CAAA,EAC9B,4BAA8B,EAC9B,YAA8B,GAC9B,UAA8B,EAC9B,aAA8B,EAC9B,YAA8B,CAAA,EAG9B,YAA8B,kBAC9B,uBAA8B,kCAC9B,oBAA8B,oBAC9B,iBAA8B,oBAC9B,qBAA8B,sBAClC,EAIA,SAAS,EAAK,CAAG,CAAE,CAAG,EAClB,GAAI,AAAc,UAAd,OAAO,EAOP,OANI,AAAQ,KAAA,IAAR,EACA,OAAO,IAAI,CAAC,EAAI,CAEhB,IAAI,CAAC,EAAI,CAAG,EACZ,aAAe,UACf,CAAA,EAAI,YAAY,CAAG,CADvB,EAEO,EAEP,IAAI,EAAU,OAAO,MAAM,CAAC,MAC5B,IAAK,IAAI,KAAK,EACV,CAAO,CAAC,EAAE,CAAG,IAAI,CAAC,EAAE,CACpB,EAAK,IAAI,CAAC,IAAI,CAAE,EAAG,CAAG,CAAC,EAAE,EAE7B,OAAO,CAEf,CAEA,SAAS,EAAI,CAAC,EACV,OAAO,aAAa,EAAe,EAAE,WAAW,GAAK,CACzD,CAEO,MAAM,UAAqB,EAE9B,OAAO,QAAU,CACb,KAAe,YACf,KAAe,GACf,MAAe,KACf,UAAe,IACnB,CAAE,AAEF,QAAO,SAAW,OAAO,MAAM,CAAC,KAAM,AAEtC,QAAO,YAAY,GAAG,CAAI,CAAE,CACxB,OAAO,EAAK,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAE,EACrC,CAEA,OAAO,gBAAgB,CAAI,CAAE,CACzB,IAAI,CAAC,QAAQ,CAAG,OAAO,MAAM,CAAC,OAAO,MAAM,CAAC,MAAO,IAAI,CAAC,QAAQ,EAChE,IAAI,EAAe,OAAO,MAAM,CAAC,MAQjC,OAPA,OAAO,IAAI,CAAC,GAAM,OAAO,CAAC,AAAA,IACtB,IAAI,EAAS,CAAI,CAAC,EAAO,AACJ,CAAA,UAAjB,OAAO,GACP,CAAA,EAAS,IAAI,CAAC,QAAQ,CAAC,EAAO,AAAP,EAE3B,CAAY,CAAC,EAAO,CAAG,CAC3B,GACO,IAAI,CAAC,WAAW,CAAC,EAC5B,CAEA,OAAO,QAAQ,CAAI,CAAE,CAAQ,CAAE,CAC3B,IAAI,EAAU,IAAM,EAAO,IAAK,EAAU,EAAU,QACpD,EAAa,SAAS,CAAC,EAAS,EAAE,EAClC,IAAI,CAAC,QAAQ,CAAC,EAAK,CAAG,AAAA,EAAkB,IAAK,SAAS,CAAK,EACvD,IAAI,EAAS,IAAI,CAAC,IAAI,CAAC,GACvB,GAAI,EAEc,CAAA,IAAV,IAEA,IAAI,CAAC,IAAI,CAAC,GAAS,OAAO,CAAC,AAAA,GAAQ,EAAK,IAAI,CAAC,IAAI,CAAE,CAAA,IAC/C,aAAkB,UAElB,EAAO,IAAI,CAAC,IAAI,EAEpB,IAAI,CAAC,IAAI,CAAC,EAAS,MACnB,AAAA,EAAO,IAAI,CAAC,KAAK,CAAE,SAKvB,GAAI,AAAU,CAAA,IAAV,EAAiB,CACjB,IAAI,EAAM,EAAS,KAAK,CAAC,IAAI,CAAE,WACzB,aAAe,UACjB,CAAA,EAAM,CAAA,CADV,EAEA,IAAI,CAAC,IAAI,CAAC,EAAS,GACnB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAChB,IAAI,CAAC,IAAI,CAAC,GAAS,OAAO,CAAC,AAAA,GAAQ,EAAK,IAAI,CAAC,IAAI,CAAE,CAAA,GACvD,CAEJ,OAAO,CACX,EACJ,CAEA,OAAO,YAAY,CAAG,CAAE,CACpB,OAAO,CAAW,CAAC,EAAI,AAC3B,CAEA,OAAO,aAAc,CACjB,OAAO,EAAK,KAAK,CAAC,EAAa,UACnC,CAEA,YAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GAET,IAAI,CAAC,YAAY,CAAG,IAAI,YAAY,EACpC,IAAI,CAAC,QAAQ,CAAG,OAAO,MAAM,CAAC,OAAO,MAAM,CAAC,MAAO,IAAI,CAAC,QAAQ,EAChE,IAAI,CAAC,IAAI,CAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CACvB,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,CAAC,CAAC,KAAK,CACzB,IAAI,CAAC,SAAS,CAAG,IAAI,CAAC,CAAC,CAAC,SAAS,CAEjC,IAAI,CAAC,iBAAiB,CAAG,EACzB,IAAI,CAAC,gBAAgB,CAAG,EACxB,IAAI,CAAC,aAAa,CAAG,EACrB,IAAI,CAAC,gBAAgB,CAAG,EACxB,IAAI,CAAC,YAAY,CAAG,EAAE,CACtB,IAAI,CAAC,WAAW,CAAG,EAAE,CACrB,IAAI,CAAC,aAAa,CAAG,EAErB,IAAI,CAAC,OAAO,CAAG,EAAE,CACjB,IAAI,CAAC,WAAW,CAAG,IAAI,CAAC,YAAY,CAAC,EAAG,CAAA,EAAO,SAC/C,IAAI,CAAC,UAAU,CAAG,IAAI,CAAC,YAAY,CAAC,EAAG,CAAA,EAAM,QAC7C,IAAI,CAAC,SAAS,CAAG,EAAE,CACnB,IAAI,CAAC,eAAe,CAAG,KACvB,IAAI,CAAC,cAAc,CAAG,KACtB,IAAI,CAAC,WAAW,CAAG,EAAE,CACrB,IAAI,CAAC,QAAQ,CAAG,OAAO,MAAM,CAAC,MAE9B,IAAI,CAAC,SAAS,CAAG,OAAO,MAAM,CAAC,MAC/B,IAAI,CAAC,eAAe,CAAG,EACvB,IAAI,CAAC,KAAK,CAAG,EAAE,CAEf,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAG,EACvC,IAAI,CAAC,OAAO,CAAG,IAAI,CAAC,WAAW,CAAC,SAAS,GAEpC,IAAI,CAAC,gBAAgB,EACtB,IAAI,CAAC,SAAS,CAAC,gBAAiB,IAAI,CAAC,OAAO,CAAE,IAAI,CAAC,KAAK,GAEhE,GAEA,IAAI,CAAC,gBAAgB,CAAG,CACpB,aAAgB,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAC1D,EAEA,IAAI,CAAC,eAAe,CAAG,IAAI,EAAsB,CAAE,OAAQ,IAAI,AAAC,GAChE,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,WAAY,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,GAEzF,IAAI,CAAC,MAAM,CAAG,EAAE,CAChB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,iBAAiB,IACtC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EACxB,IAAI,CAAC,mBAAmB,CAAG,CAC/B,CAEA,YAAY,CAAI,CAAE,CAAI,CAAE,CACD,UAAf,OAAO,GACP,CAAA,EAAO,IAAI,CAAC,QAAQ,CAAC,EAAK,AAAL,EAEzB,IAAI,CAAC,IAAI,CADK,IAAM,EAAO,UACR,UAAU,CAAC,EAClC,CAEA,eAAe,CAAI,CAAE,CAAI,CAAE,CACJ,UAAf,OAAO,GACP,CAAA,EAAO,IAAI,CAAC,QAAQ,CAAC,EAAK,AAAL,EAEzB,AAAA,EAAO,IAAI,CAAC,IAAI,CADF,IAAM,EAAO,UACA,EAC/B,CAEA,cAAc,CAAI,CAAE,CAAI,CAAE,CACtB,IAAI,EAAQ,IAAI,CAAC,SAAS,AAC1B,CAAA,IAAI,CAAC,SAAS,CAAG,OAAO,MAAM,CAAC,OAAO,MAAM,CAAC,IAAI,CAAC,SAAS,EAAG,GAC9D,GAAI,CACA,GAAI,aAAgB,SAChB,OAAO,EAAK,KAAK,CAAC,IAAI,CAAE,IAAI,UAAU,CAAC,KAAK,CAAC,IAE7C,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAM,IAAI,UAAU,CAAC,KAAK,CAAC,GAExD,QAAU,CACN,IAAI,CAAC,SAAS,CAAG,CACrB,CACJ,CAEA,aAAa,CAAI,CAAE,CAAI,CAAE,CACrB,IAAI,EAAQ,IAAI,CAAC,QAAQ,AACzB,CAAA,IAAI,CAAC,QAAQ,CAAG,OAAO,MAAM,CAAC,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAG,GAC5D,GAAI,CACA,GAAI,aAAgB,SAChB,OAAO,EAAK,KAAK,CAAC,IAAI,CAAE,IAAI,UAAU,CAAC,KAAK,CAAC,IAE7C,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAM,IAAI,UAAU,CAAC,KAAK,CAAC,GAExD,QAAU,CACN,IAAI,CAAC,QAAQ,CAAG,CACpB,CACJ,CAEA,YAAY,CAAI,CAAE,CACd,OAAQ,KAAQ,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,SAAS,CAAC,EAAK,CACpB,CAAW,CAAC,EAAK,AAC3B,CAEA,aAAc,CACV,OAAO,EAAK,KAAK,CAAC,IAAI,CAAC,SAAS,CAAE,UACtC,CAIA,kBAAkB,CAAG,CAAE,CAAE,CAAE,CAAK,CAAE,EAAQ,CAAC,CAAE,KAGrC,EACJ,IAHK,EAAG,MAAM,EAAE,CAAA,EAAK,AAAI,OAAO,EAAG,MAAM,CAAE,EAAG,KAAK,CAAG,IAAtD,EACA,EAAG,SAAS,CAAG,IAEF,CACT,IAAI,EAAM,EAAG,SAAS,CAClB,EAAI,EAAG,IAAI,CAAC,GAChB,GAAI,CAAC,GAAK,EAAG,SAAS,CAAG,EAAO,MAGhC,GADA,AADA,CAAA,EAAQ,CAAA,EACF,KAAK,CAAG,EAAG,SAAS,CACtB,EAAG,SAAS,EAAI,EAAK,CAKrB,IAAI,EAAU,OACd,CAAA,EAAQ,SAAS,CAAG,EAAG,SAAS,CAChC,EAAQ,IAAI,CAAC,GACb,EAAG,SAAS,CAAG,EAAQ,SAAS,AACpC,CACJ,CACA,GAAI,EACA,OAAO,IAAI,CAAC,SAAS,CAAG,CAEhC,CAEA,WAAW,CAAM,CAAE,CACX,aAAkB,MAClB,EAAO,OAAO,CAAC,IAAI,CAAC,UAAU,CAAE,IAAI,GAEpC,IAAI,CAAC,SAAS,CAAC,GACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GACjB,EAAO,QAAQ,CAAC,IAAI,EAE5B,CAEA,UAAU,CAAM,CAAE,CACd,AAAA,EAAO,IAAI,CAAC,MAAM,CAAE,GACpB,EAAO,QAAQ,CAAC,IAAI,CACxB,CAEA,mBAAoB,CAChB,OAAO,IAAI,CAAC,YAAY,CAAG,EAA0B,CACzD,CAEA,YAAY,CAAI,CAAE,CAAM,CAAE,CAAO,CAAE,CAE/B,IAAI,CAAC,KAAK,CAAC,aAAa,GACxB,IAAI,CAAC,SAAS,CAAC,YAAa,CAAE,KAAM,QAAS,KAAA,EAAM,OAAA,EAAQ,QAAA,CAAQ,EACvE,CAEA,WAAW,CAAI,CAAE,CAAM,CAAE,CAAO,CAAE,CAC9B,IAAI,CAAC,SAAS,CAAC,YAAa,CAAE,KAAM,OAAQ,KAAA,EAAM,OAAA,EAAQ,QAAA,CAAQ,EACtE,CAEA,aAAa,CAAI,CAAE,CACf,IAAI,CAAC,SAAS,CAAC,YAAa,EAChC,CAEA,aAAa,CAAG,CAAE,CAAM,CAAE,CAAI,CAAE,CAG5B,OAFW,MAAP,GACA,CAAA,EAAM,IAAI,CAAC,KAAK,EADpB,EAEO,IAAI,EAAa,CAAE,OAAQ,IAAI,CAAE,IAAK,EAAK,KAAM,EAAM,OAAQ,CAAO,EACjF,CAEA,OAAQ,CACJ,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,EACvC,CAEA,MAAM,CAAK,CAAE,CAQT,OAPI,UAAU,MAAM,CAAG,IACnB,IAAI,CAAC,SAAS,CAAG,EACjB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,AAAA,IACN,IAAX,EAAE,IAAI,EAAQ,CAAA,EAAE,KAAK,CAAG,CAAA,CAA5B,CACJ,GACA,IAAI,CAAC,cAAc,IAEhB,IAAI,CAAC,SAAS,AACzB,CAEA,QAAQ,CAAI,CAAE,CAEV,IAAI,CAAC,SAAS,CAAG,CAAA,EACjB,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,MAAM,CAAG,EAAK,MAAM,CACzB,IAAI,CAAC,WAAW,CAAG,EAAE,CACrB,IAAI,CAAC,aAAa,CAAG,EACrB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,AAAA,GAAK,EAAE,WAAW,CAAC,EAAG,CAAA,EAAM,CAAA,IAC7C,IAAI,CAAC,IAAI,CAAG,EAAK,KAAK,CAAC,MACvB,IAAI,CAAC,eAAe,CAAC,KAAK,GACtB,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,KAAK,GAExB,IAAI,CAAC,SAAS,CAAC,cAAe,IAAI,CAAC,IAAI,EACvC,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,EAAG,CAAA,EAAO,CAAA,GACvC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAAG,CAAA,GAC/B,IAAI,CAAC,YAAY,CAAC,AAAA,IACd,EAAM,kBAAkB,GACxB,EAAM,uBAAuB,EACjC,EACJ,CAEA,aAAa,CAAG,CAAE,CACQ,MAAlB,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,mBAAmB,CAAC,IAAI,CAAC,gBAAgB,EAE5D,IAAI,CAAC,SAAS,CAAG,EACb,GACA,EAAI,gBAAgB,CAAC,IAAI,CAAC,gBAAgB,EAC1C,EAAI,KAAK,KAET,IAAI,CAAC,eAAe,CAAC,KAAK,GAC1B,IAAI,CAAC,SAAS,CAAC,cAAe,IAAI,CAAC,IAAI,EAE/C,CAEA,SAAU,CACN,OAAO,IAAI,CAAC,MAAM,EAAK,CAAA,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAA,CACxD,CAEA,aAAc,CACV,GAAI,IAAI,CAAC,MAAM,CACX,OAAO,IAAI,CAAC,MAAM,CAEtB,IADA,IAAI,EAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAE,EAAO,EAAI,EAAI,GAAK,EACvC,EAAE,GAAK,GACV,GAAQ,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,MAAM,CAAG,EAClC,OAAO,IAAI,CAAC,MAAM,CAAG,CACzB,CAEA,QAAQ,CAAG,CAAE,CAGT,OAFW,MAAP,GACA,CAAA,EAAM,IAAI,CAAC,OAAO,CAAC,GAAG,AAAH,EAChB,IAAI,CAAC,IAAI,CAAC,EAAI,AACzB,CAEA,aAAa,CAAG,CAAE,CAAG,CAAE,CACnB,IAAI,EAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CACxB,GAAI,GAAO,IAAK,OAAO,KACvB,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,EAAI,QACzB,AAAI,GAAO,EAAK,MAAM,CACX,GAAO,EAAI,KAAO,KACtB,EAAK,MAAM,CAAC,EACvB,CAEA,OAAO,CAAK,CAAE,CACN,AAAS,MAAT,EACA,EAAQ,IAAI,CAAC,KAAK,GAElB,CAAA,EAAQ,EAAI,EAAZ,EACY,GACR,CAAA,GAAS,IAAI,CAAC,KAAK,EADvB,EAGJ,IAAI,EAAK,IAAI,CAAC,iBAAiB,CAAC,GAChC,OAAO,IAAI,CAAC,YAAY,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,CAC3C,CAEA,kBAAkB,CAAI,CAAE,CAAI,CAAE,CAAS,CAAE,KAEjC,EAOJ,GARK,GAAM,CAAA,EAAO,EAAE,AAAF,EAEZ,aAAgB,SAIlB,EAAM,EAAK,YAAY,EAAI,MAH3B,EAAM,EACN,EAAO,IAAI,CAAC,QAAQ,CAAC,EAAK,EAI1B,EAAK,sBAAsB,EAAI,CAAC,EAMhC,OAAO,EAAK,sBAAsB,CAAC,KAAK,CAAC,IAAI,CAAE,EAEnD,CAAA,IAAI,CAAC,cAAc,CAAG,EAClB,IAAI,CAAC,eAAe,EAAI,GACxB,IAAI,CAAC,gBAAgB,CAAC,GACX,QAAP,GACA,IAAI,CAAC,kBAAkB,IAEpB,CAAA,AAAO,uBAAP,GAAgC,IAAI,CAAC,gBAAgB,GAAK,IAAM,CAAA,GACnE,AAAO,QAAP,GACA,IAAI,CAAC,kBAAkB,GAG/B,IAAI,CAAC,cAAc,GACnB,GAAI,CAKA,OAJA,IAAI,CAAC,SAAS,CAAC,2BAA4B,EAAK,GAC3C,EAAK,eAAe,EAAK,IAAI,CAAC,IAAI,CAAC,gBACpC,IAAI,CAAC,kBAAkB,GAEpB,EAAK,KAAK,CAAC,IAAI,CAAE,EAC5B,CAAE,MAAM,EAAI,CACR,GAAI,aAAc,EACd,IAAI,CAAC,WAAW,CAAC,EAAG,OAAO,OAE3B,MAAM,CAEd,QAAU,CACF,IAAI,CAAC,IAAI,CAAC,gBACV,IAAI,CAAC,mBAAmB,GAEjB,QAAP,GACA,CAAA,IAAI,CAAC,aAAa,CAAG,IAAI,CAAC,WAAW,CAAC,MAAM,AAAN,EAE1C,IAAI,CAAC,aAAa,GAClB,IAAI,CAAC,SAAS,CAAC,0BAA2B,EAAK,GAC/C,IAAI,CAAC,eAAe,CAAG,EACvB,IAAI,CAAC,gBAAgB,CAAC,GAClB,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,KAAK,EAE5B,CACJ,CAEA,mBAAmB,CAAE,CAAE,CACK,GAApB,UAAU,MAAM,EAChB,CAAA,EAAK,IAAI,CAAC,aAAa,AAAb,EACd,IAAI,CAAC,SAAS,CAAC,kBAAmB,IAAI,CAAC,aAAa,CAAG,CAAC,GACxD,IAAI,CAAC,UAAU,CAAC,EAAK,cAAgB,iBACzC,CAEA,eAAgB,CACZ,OAAO,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EAAI,OAAO,EAAM,UAAU,AAAE,EACrE,CAEA,oBAAqB,CACjB,OAAO,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EAAI,OAAO,EAAM,gBAAgB,AAAE,EAC3E,CAEA,cAAc,CAAI,CAAE,CAChB,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,EAAG,OAAO,CAAC,GACX,EAAG,GAAG,CAAC,gBACX,EACJ,CAEA,IAAI,CAAG,CAAE,GAAG,CAAI,CAAE,CACd,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAI,CAAC,KAAK,CAAC,IAAI,CAAE,EAC1C,CAEA,SAAS,CAAG,CAAE,CAAI,CAAE,CAChB,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAI,CAAC,KAAK,CAAC,IAAI,CAAE,EAC1C,CAEA,YAAY,CAAI,CAAE,EAAQ,IAAI,CAAC,UAAU,EAAE,CAAE,EAAM,IAAI,CAAC,KAAK,EAAE,CAAE,CAG7D,GAFA,EAAQ,EAAI,GAER,AADJ,CAAA,EAAM,EAAI,EAAV,EACU,EAAO,CAAE,IAAI,EAAM,EAAO,EAAQ,EAAK,EAAM,CAAK,CAC5D,EAAQ,IAAI,CAAC,iBAAiB,CAAC,GAC/B,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAC7B,IAAK,IAAI,EAAI,EAAM,GAAG,CAAE,GAAK,EAAI,GAAG,CAAE,EAAE,EAAG,CACvC,IAAI,EAAK,GAAK,EAAM,GAAG,CAAG,EAAM,GAAG,CAAG,EAClC,EAAK,GAAK,EAAI,GAAG,CAAG,EAAI,GAAG,CAAG,IAAI,CAAC,OAAO,CAAC,GAAG,MAAM,CACxD,EAAK,EAAG,EAAI,EAChB,CACJ,CAEA,gBAAiB,CACb,OAAO,IAAI,CAAC,SAAS,CAAC,iBAC1B,CAgBA,KAAK,CAAI,CAAE,CAAI,CAAE,GAAG,CAAI,CAAE,CAEtB,GAAI,AAAQ,MADZ,CAAA,EAAO,IAAI,CAAC,EAAK,EAAI,IAAI,CAAC,IAAI,CAAC,EAA/B,SAEI,AAAI,aAAgB,SACT,EAAK,IAAI,CAAC,IAAI,CAAE,GAEhB,CAAI,CAAC,EAAK,CAAC,KAAK,CAAC,EAAM,EAG1C,CAGA,iBAAkB,CACd,IAAI,EAAK,IAAI,CAAC,cAAc,GAC5B,GAAI,EAAG,MAAM,GAAK,IAAI,CAAE,CACpB,IAAI,CAAC,WAAW,CAAG,EACnB,IAAI,EAAI,CAAC,iBAAkB,UAAU,CACrC,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAE,EACjC,CACI,IAAI,CAAC,WAAW,CAAG,IAE3B,CAEA,aAAa,CAAI,CAAE,CACX,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,EAAE,OAAO,CAAC,EACjD,CAEA,WAAY,CACR,IAAI,EAAI,CAAC,WAAY,UAAU,CAC/B,OAAO,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAE,EACjC,CAEA,eAAe,CAAI,CAAE,CAIjB,OAAO,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EAChC,GAAI,EAAM,UAAU,CAChB,OAAO,EAAK,IAAI,CAAC,IAAI,CAAE,EAAM,UAAU,CAC/C,EACJ,CAEA,YAAY,CAAI,CAAE,GAAG,CAAI,CAAE,CACvB,IAAI,EAAI,EAAK,GAAG,CAAC,AAAA,GAAO,IAAI,CAAC,YAAY,CAAC,IAC1C,GAAI,CACA,OAAO,EAAK,KAAK,CAAC,IAAI,CAAE,EAC5B,QAAU,CACN,EAAE,OAAO,CAAC,AAAA,GAAK,EAAE,OAAO,GAC5B,CACJ,CAEA,gBAAiB,CACb,EAAE,IAAI,CAAC,gBAAgB,AAC3B,CAEA,eAAgB,CAC4D,GAAnE,CAAA,IAAI,CAAC,gBAAgB,CAAG,KAAK,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAG,EAAG,EAAA,GAC7D,IAAI,CAAC,gBAAgB,EAE7B,CAEA,UAAU,EAAQ,IAAI,CAAC,WAAW,CAAE,EAAM,IAAI,CAAC,UAAU,CAAE,CAGvD,GAFA,EAAQ,EAAI,GAER,AADJ,CAAA,EAAM,EAAI,EAAV,EACU,EAAO,CAAE,IAAI,EAAM,EAAO,EAAQ,EAAK,EAAM,CAAK,CAC5D,MAAO,CAAE,MAAO,EAAO,IAAK,CAAI,CACpC,CAEA,kBAAmB,CACf,IAAI,CAAC,SAAS,CAAC,gBACf,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,EAAM,KACzB,GACA,IAAI,CAAC,SAAS,CAAC,eAAgB,EAEvC,GACA,IAAI,CAAC,YAAY,CAAG,EAAE,CACtB,IAAI,CAAC,SAAS,CAAC,cACnB,CAEA,WAAW,CAAI,CAAE,CAAK,CAAE,CACpB,IAAI,CAAC,SAAS,CAAC,kBAAmB,EAAM,EAC5C,CAEA,cAAc,CAAI,CAAE,CAChB,IAAI,CAAC,SAAS,CAAC,kBAAmB,EACtC,CAEA,QAAQ,EAAM,IAAI,CAAC,KAAK,EAAE,CAAE,CACxB,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,EAChC,CAEA,qBAAsB,CAClB,IAAuB,EAAnB,EAAK,IAAI,CAAC,OAAO,AAChB,CAAA,IAAI,CAAC,eAAe,GACrB,IAAI,CAAC,eAAe,CAAG,IAAI,CAAC,YAAY,GACxC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,IACtC,EAAK,GAEJ,GACD,CAAA,EAAK,IAAI,CAAC,eAAe,CAAC,SAAS,EADvC,EAEA,IAAI,CAAC,UAAU,CAAC,YAAa,CACzB,MAAQ,EAAG,GAAG,CACd,KAAQ,EAAG,GAAG,CACd,MAAQ,EAAG,GAAG,CACd,KAAQ,EAAG,GAAG,AAClB,EACJ,CAEA,oBAAqB,CACb,IAAI,CAAC,eAAe,GACpB,IAAI,CAAC,eAAe,CAAC,OAAO,GAC5B,IAAI,CAAC,eAAe,CAAG,KACvB,IAAI,CAAC,aAAa,CAAC,aACnB,IAAI,CAAC,IAAI,CAAC,cAAe,CAAA,GAEjC,CAEA,uBAAwB,CACpB,GAAI,IAAI,CAAC,eAAe,CAIpB,OAHA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,eAAe,EACvD,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,kBAAkB,GAChB,CAAA,CAEf,CAEA,OAAO,CAAC,CAAgB,CAAG,CAAE,AAC7B,CAAA,iBAAiB,CAAI,CAAE,QACnB,AAAI,AAAQ,MAAR,EAAqB,EAAa,CAAC,CAAgB,CACnD,AAAQ,GAAR,EAAkB,EAAa,CAAC,CAAgB,CAAG,EAChD,EAAa,CAAC,CAAgB,EAAI,CAC7C,CAEA,OAAO,CAAC,CAAY,CAAG,IAAK,AAC5B,CAAA,iBAAiB,CAAE,CAAE,QACjB,AAAI,AAAoB,GAApB,UAAU,MAAM,CACT,EAAa,CAAC,CAAY,CAC9B,EAAa,CAAC,CAAY,CAAG,CACxC,CAEA,aAAa,CAAS,CAAE,CACpB,IAAI,EAAM,IAAI,CAAC,IAAI,CAAC,oBAMpB,OALK,GAAa,AAAQ,KAAA,IAAR,IACd,IAAI,CAAC,IAAI,CAAC,mBAAoB,KAAA,GACzB,IAAI,CAAC,YAAY,EAClB,IAAI,CAAC,aAAa,CAAC,KAEpB,CACX,CAEA,aAAa,CAAG,CAAE,CACd,OAAO,IAAI,CAAC,IAAI,CAAC,mBAAoB,EACzC,CAEA,eAAe,CAAI,CAAE,CAAG,CAAE,CAClB,AAAO,MAAP,EACA,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAK,CAE1B,IAAI,CAAC,QAAQ,CAAC,EAAK,CAAG,EAC1B,IAAI,CAAC,SAAS,CAAC,mBACnB,CAEA,gBAAiB,CACb,IAAI,CAAC,SAAS,CAAC,mBACnB,CAEA,sBAAsB,CAAE,CAAE,CAAO,CAAE,CAC/B,IAAI,EAAM,AAAA,CAAA,IAAI,CAAC,SAAS,CAAG,KAAO,IAAA,EAC9B,CAAC,mCAAmC,EAAE,AAAA,EAAI,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CACxE,KAAO,EAAU,OAAS,AAAA,EAAY,IAAI,CAAC,WAAW,GAAI,GAAG,WAAW,GAFlE,MAGC,CAAA,EAAG,GAAG,CAAG,CAAA,EAAK,IAAM,EAAG,GAAG,CAAG,KACpC,EAAS,IAAI,CAAC,IAAI,CAAC,2BACnB,GACA,CAAA,EAAS,EAAO,IAAI,CAAC,IAAI,CAAE,IAAI,CAAE,EAAjC,GACY,CAAA,GAAM,IAAM,EAAS,IAAjC,EAEJ,IAAI,EAAK,EAAE,CACX,IAAK,IAAI,KAAK,IAAI,CAAC,QAAQ,CACvB,EAAG,IAAI,CAAC,EAAI,KAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,EAKvC,OAHI,EAAG,MAAM,CAAG,GACZ,CAAA,GAAM,IAAM,EAAG,IAAI,CAAC,MAAQ,GADhC,EAGO,CACX,CAMA,cAAc,CAAI,CAAE,CAAG,CAAE,CAAG,CAAE,CAAI,CAAE,CAChC,GAAI,EAAM,EAAG,CACT,IAAI,EAAI,IAAI,CAAC,WAAW,CACxB,EAAE,IAAI,CAAC,CACH,KAAQ,EACR,IAAQ,EACR,IAAQ,EACR,KAAQ,EACR,MAAQ,IAAI,CAAC,SAAS,AAC1B,GACA,IAAI,CAAC,SAAS,CAAG,CAAA,EACb,EAAE,MAAM,CApqBC,KAqqBT,EAAE,KAAK,EACf,CACJ,CAEA,oBAAqB,CACjB,IAAI,EAAI,IAAI,CAAC,WAAW,CACpB,EAAI,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,AAAA,GAAK,CAAE,EAAG,EAAE,WAAW,GAAI,EAChD,EAAO,EAAE,EAAE,CAAC,GACZ,CAAC,GAAQ,AAAa,GAAb,EAAK,IAAI,CAGlB,EAAK,OAAO,CAAG,EAFf,EAAE,IAAI,CAAC,CAAE,KAAM,EAAG,QAAS,CAAE,EAIrC,CAEA,eAAgB,CACZ,IAAI,EAAI,IAAI,CAAC,WAAW,CACxB,GAAI,AAAY,GAAZ,EAAE,MAAM,CAAO,MAAO,CAAA,CAC1B,GAAE,IAAI,CAAC,gBAAgB,CAEvB,IADA,IAAmB,EAAf,EAAQ,CAAA,EACL,EAAE,IAAI,CAAC,aAAa,EAAI,GAAG,CAE9B,GAAI,AAAe,GAAf,AADJ,CAAA,EAAS,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,AAAD,EAClB,IAAI,CAAO,CAGlB,GADA,EAAO,OAAO,CAAC,OAAO,CAAC,AAAA,GAAK,CAAC,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,EAAE,GAC7C,CAAC,EAAO,SACZ,KACJ,CACA,EAAQ,CAAA,EACR,IAAI,EAAM,EAAO,GAAG,CACpB,OAAQ,EAAO,IAAI,EACjB,KAAK,EACH,IAAI,CAAC,WAAW,CAAC,EAAK,EAAM,EAAO,GAAG,EACtC,KACF,MAAK,EACH,IAAI,CAAC,WAAW,CAAC,EAAO,IAAI,CAAE,EAElC,CACA,IAAI,CAAC,SAAS,CAAG,EAAO,KAAK,AACjC,CAEA,MADA,EAAE,IAAI,CAAC,gBAAgB,CAChB,CACX,CAIA,aAAa,CAAG,CAAE,CAAI,CAAE,CACpB,IAAI,CAAC,IAAI,CAAC,EAAI,CAAG,EACjB,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAK,GACjC,IAAI,CAAC,gBAAgB,CAGtB,IAAI,CAAC,YAAY,CAAC,EAAI,CAAG,CAAA,EAFzB,IAAI,CAAC,SAAS,CAAC,eAAgB,EAIvC,CAEA,YAAY,CAAG,CAAE,CACb,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAK,GACtB,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,GAC5B,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,GACnC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAK,GAC9B,IAAI,CAAC,SAAS,CAAC,eAAgB,EACnC,CAEA,YAAY,CAAG,CAAE,CAAI,CAAE,CACnB,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAK,EAAG,GACzB,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,GAC5B,IAAI,CAAC,SAAS,EACd,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,GACnC,IAAI,EAAS,CAAC,IAAI,CAAC,gBAAgB,CACnC,IAAI,CAAC,SAAS,CAAC,eAAgB,EAAK,GAC/B,IACG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAI,EAC5B,IAAI,CAAC,YAAY,CAAC,EAAI,CAAG,CAAA,EAEzB,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,EAAK,EAAG,CAAA,GAE7C,CAEA,YAAY,CAAI,CAAE,CAAG,CAAE,CACnB,GAAI,AAAe,GAAf,EAAK,MAAM,EAEJ,MAAP,GACA,CAAA,EAAM,IAAI,CAAC,WAAW,CAAC,WAAW,EADtC,EAEA,EAAM,EAAI,GAEL,IAAI,CAAC,aAAa,EACnB,IAAI,CAAC,aAAa,CAAC,EAAG,EAAK,EAAK,MAAM,EAC1C,IAAI,EAAK,GAAO,IAAI,CAAC,KAAK,GAAK,IAAI,CAAC,OAAO,CAAG,IAAI,CAAC,iBAAiB,CAAC,GACjE,EAAI,EAAG,GAAG,CACd,GAAI,QAAQ,IAAI,CAAC,IAAS,AAAU,GAAV,EAAG,GAAG,CAK5B,IAAK,IAAI,EAAI,EAAG,EAAI,EAAK,MAAM,CAAE,EAAE,EAC/B,IAAI,CAAC,WAAW,CAAC,EAAI,EAAG,QAEzB,CACH,IAAI,EAAQ,EAAK,KAAK,CAAC,MAAO,EAAK,IAAI,CAAC,IAAI,CAAC,EAAE,CAAE,EAAO,EAAG,MAAM,CAAC,EAAG,GAAG,CACpE,CAAA,EAAM,MAAM,CAAG,GACf,IAAI,CAAC,YAAY,CAAC,EAAG,EAAG,MAAM,CAAC,EAAG,EAAG,GAAG,EAAI,EAAM,KAAK,IACvD,EAAM,OAAO,CAAC,AAAA,GAAQ,IAAI,CAAC,WAAW,CAAC,EAAE,EAAG,IAC5C,IAAI,CAAC,YAAY,CAAC,EAAG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAG,IAEpC,IAAI,CAAC,YAAY,CAAC,EAAG,EAAG,MAAM,CAAC,EAAG,EAAG,GAAG,EAAI,CAAK,CAAC,EAAE,CAAG,EAAG,MAAM,CAAC,EAAG,GAAG,EAE/E,CACA,IAAI,CAAC,cAAc,CAAC,EAAK,EAAK,MAAM,EACpC,IAAI,CAAC,SAAS,CAAC,eAAgB,EAAK,GACxC,CAEA,YAAY,CAAK,CAAE,CAAG,CAAE,CAGpB,GAFA,EAAQ,IAAI,CAAC,cAAc,CAAC,EAAI,IAChC,EAAM,IAAI,CAAC,cAAc,CAAC,EAAI,IAC1B,GAAS,GAEb,GAAI,EAAM,EAAO,CAAE,IAAI,EAAM,EAAO,EAAQ,EAAK,EAAM,CAAK,CAEvD,IAAI,CAAC,aAAa,EACnB,IAAI,CAAC,aAAa,CAAC,EAAG,EAAO,EAAM,EAAO,IAAI,CAAC,gBAAgB,CAAC,EAAO,IAC3E,IAAI,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAC7B,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAC7B,EAAO,IAAI,CAAC,IAAI,CAAC,EAAI,GAAG,CAAC,CAC7B,GAAI,EAAI,GAAG,EAAI,EAAI,GAAG,CAElB,EAAO,EAAK,MAAM,CAAC,EAAG,EAAI,GAAG,EAAI,EAAK,MAAM,CAAC,EAAI,GAAG,EACpD,IAAI,CAAC,YAAY,CAAC,EAAI,GAAG,CAAE,OACxB,CAEH,EAAO,EAAK,MAAM,CAAC,EAAG,EAAI,GAAG,EAAI,IAAI,CAAC,IAAI,CAAC,EAAI,GAAG,CAAC,CAAC,MAAM,CAAC,EAAI,GAAG,EAClE,IAAI,CAAC,YAAY,CAAC,EAAI,GAAG,CAAE,GAE3B,EAAO,EAAI,GAAG,CAAG,EACjB,IAAK,IAAI,EAAI,EAAI,GAAG,CAAG,EAAI,GAAG,CAAE,KAAM,GAAI,IAAI,CAAC,WAAW,CAAC,EAC/D,CACA,IAAI,CAAC,cAAc,CAAC,EAAO,EAAQ,EAAK,GACxC,IAAI,CAAC,SAAS,CAAC,eAAgB,EAAO,GAC1C,CAEA,aAAa,CAAK,CAAE,CAAG,CAAE,CAAI,CAAE,CAC3B,IAAI,CAAC,WAAW,CAAC,EAAO,GACxB,IAAI,CAAC,WAAW,CAAC,EAAM,EAC3B,CAEA,WAAW,CAAC,CAAE,CAEV,IAAI,EAAK,AADT,CAAA,EAAI,EAAE,GAAG,CAAC,GAAK,IAAI,EAAnB,CACU,CAAC,EAAE,CACT,EAAK,CAAC,CAAC,EAAE,CACT,EAAK,CAAC,CAAC,EAAE,CACT,EAAK,CAAC,CAAC,EAAE,CACT,EAAK,IAAI,CAAC,gBAAgB,CAAC,EAAI,GAC/B,EAAK,IAAI,CAAC,gBAAgB,CAAC,EAAI,GAGnC,OAFA,IAAI,CAAC,YAAY,CAAC,EAAI,EAAI,GAC1B,IAAI,CAAC,YAAY,CAAC,EAAI,EAAI,GACnB,CACX,CAEA,iBAAiB,CAAK,CAAE,CAAG,CAAE,CAOzB,GANmB,EAAf,AAAS,MAAT,EAAuB,IAAI,CAAC,KAAK,GACxB,EAAI,GAKb,CAHa,EAAb,AAAO,MAAP,EAAmB,IAAI,CAAC,WAAW,GAC5B,EAAI,IAEL,EAAO,CAAE,IAAI,EAAM,EAAO,EAAQ,EAAK,EAAM,CAAK,CAS5D,OAAO,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC,EAAO,EAC3C,CAEA,eAAe,CAAE,CAAE,CAAE,CAAE,CAAO,CAAE,CAAQ,CAAE,CACtC,EAAK,EAAI,GACT,EAAK,EAAI,GACT,IAAI,EAAO,IAAI,CAAC,gBAAgB,CAAC,EAAI,GACrC,IAAI,CAAC,eAAe,CAAC,EAAM,GACtB,GACD,IAAI,CAAC,WAAW,CAAC,EAAI,GACzB,IAAI,CAAC,kBAAkB,EAC3B,CAEA,gBAAgB,CAAI,CAAE,CAAO,CAAE,CAK3B,GAJK,IAAI,CAAC,mBAAmB,EACzB,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAC/B,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,EAAM,GAChC,IAAI,CAAC,mBAAmB,GACpB,IAAI,CAAC,gBAAgB,GAAI,GAAI,CAC7B,UAAU,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,GACzD,CAAE,KAAM,CAAC,CACb,CAEA,kBAAkB,CAAG,CAAE,CAEnB,IADA,IAAI,EAAO,EAAG,EAAI,IAAI,CAAC,IAAI,CAAE,EAAI,EAAE,MAAM,CAClC,EAAM,GAAK,EAAO,GAAG,CACxB,IAAI,EAAM,CAAC,CAAC,EAAK,CAAC,MAAM,CACxB,GAAI,GAAO,EACP,MACJ,GAAO,EAAM,EACb,GACJ,CACA,MAAO,CAAE,IAAK,EAAM,IAAK,CAAI,CACjC,CAEA,kBAAkB,CAAG,CAAE,CAAG,CAAE,CACxB,IAAI,EAAM,EAAG,EAAI,IAAI,CAAC,IAAI,CAAE,EAAI,KAAK,GAAG,CAAC,EAAK,EAAE,MAAM,CAAG,GAAI,EAAI,EACjE,GAAI,EAAI,EACJ,OAAO,EACX,KAAO,EAAE,GAAK,GACV,GAAO,CAAC,CAAC,EAAE,CAAC,MAAM,CAAG,EACzB,OAAO,EAAM,KAAK,GAAG,CAAC,EAAK,CAAC,CAAC,EAAE,CAAC,MAAM,CAC1C,CAEA,eAAe,CAAG,CAAE,QAChB,AAAI,EAAM,EACC,EACJ,KAAK,GAAG,CAAC,EAAK,IAAI,CAAC,WAAW,GACzC,CAEA,iBAAiB,CAAG,CAAE,CAClB,IAAI,EAAI,IAAI,CAAC,WAAW,CAAC,WAAW,GAMpC,OALW,MAAP,GACA,CAAA,EAAM,CAAA,EACV,EAAM,EAAI,GACV,EAAM,IAAI,CAAC,cAAc,CAAC,GAC1B,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,GACtB,GAAO,CAClB,CAEA,eAAe,CAAM,CAAE,CAAK,CAAE,EAAM,CAAC,CAAE,CAMnC,GALA,IAAI,CAAC,MAAM,CAAG,KACd,IAAI,CAAC,MAAM,CAAG,KAEd,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,AAAA,GAAK,EAAE,YAAY,CAAC,EAAQ,EAAO,IAEhD,IAAI,CAAC,SAAS,CAAE,CAChB,IAAI,EAAM,IAAI,CAAC,iBAAiB,CAAC,KAAK,GAAG,CAAC,EAAQ,EAAS,IAAQ,GAAG,CACtE,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,EAC5B,CACJ,CAEA,eAAe,CAAI,CAAE,CAAY,CAAE,CAC/B,IAAI,EAAM,IAAI,CAAC,YAAY,CAAC,KAAM,EAClC,GAAE,IAAI,CAAC,iBAAiB,CACxB,GAAI,CACA,OAAO,EAAK,IAAI,CAAC,IAAI,CACzB,QAAU,CACN,EAAE,IAAI,CAAC,iBAAiB,CACxB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAK,CAAA,EAAO,CAAA,GAClC,EAAI,OAAO,EACf,CACJ,CAEA,aAAa,CAAI,CAAE,CACf,EAAE,IAAI,CAAC,aAAa,CACpB,GAAI,CACA,OAAO,EAAK,IAAI,CAAC,IAAI,CACzB,QAAU,CACN,EAAE,IAAI,CAAC,aAAa,AACxB,CACJ,CAEA,gBAAgB,CAAE,CAAE,CAChB,IAAI,EAAU,CAAA,EACd,IAAI,CAAC,gBAAgB,CAAC,GACtB,IAAI,EAAO,IAAI,CAAC,mBAAmB,AAE/B,CAAA,IAAI,CAAC,YAAY,EACjB,CAAA,EAAG,SAAS,CAAG,CAAA,CADnB,EAEA,IAAI,CAAC,YAAY,CAAG,CAAA,EAEpB,IAAI,EAAM,AAAA,EAAa,UAAU,CAAC,GAC9B,EAAK,IAAI,CAAC,WAAW,CACrB,EAAc,CAAA,EAClB,EAAG,IAAI,CAAC,GAER,IAAK,IAAI,EAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAE,EAAE,GAAK,GAAI,CACxC,IAAI,EAAK,IAAI,CAAC,MAAM,CAAC,EAAE,CACnB,EAAI,EAAG,UAAU,CAAC,GAWtB,GAVI,aAAa,OACb,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,EAAE,CAAE,CAAC,CAAC,EAAE,EACjC,EAAU,CAAA,GAEL,EACL,EAAU,EAAc,CAAA,EAEnB,EAAG,cAAc,EAAI,AAAa,GAAb,EAAG,MAAM,EACnC,CAAA,EAAU,IAAI,CAAC,iBAAiB,CAAC,EAAG,cAAc,CAAC,EAAE,CAAE,EAAG,cAAc,CAAC,EAAE,CAAA,EAE3E,EACA,KACR,CAsBA,OApBK,IACG,CAAC,GACG,EAAG,MAAM,CAAG,IACZ,IAAI,CAAC,WAAW,CAAC,EAAG,IAAI,CAAC,KAAK,IAAI,GAAK,gBAAiB,CAAA,GACxD,EAAU,CAAA,GAGlB,EAAG,MAAM,CAAC,EAAG,EAAG,MAAM,GAGtB,IAAI,CAAC,mBAAmB,EAAI,GAAQ,AAAkB,UAAlB,OAAO,GAAwB,IAAI,CAAC,YAAY,EAEpF,CAAA,IAAI,CAAC,mBAAmB,CAAG,CAAA,EAG/B,IAAI,CAAC,SAAS,CAAC,gBAAiB,GAChC,IAAI,CAAC,gBAAgB,CAAC,MAIf,GAAW,IAAI,CAAC,YAAY,AACvC,CAEA,wBAAwB,CAAG,CAAE,CAAE,CAAE,CAAE,CAAE,CAAI,CAAE,CACnC,EACA,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,EAAK,EAAI,EAAI,MAAO,GAEtD,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,EAAK,EAAI,EAAI,MAE1D,CAEA,yBAAyB,CAAG,CAAE,CACrB,IAAI,CAAC,gBAAgB,CAGtB,IAAI,CAAC,YAAY,CAAC,EAAI,CAAG,CAAA,EAFzB,IAAI,CAAC,SAAS,CAAC,eAAgB,EAIvC,CAEA,eAAe,CAAG,CAAE,CAAK,CAAE,CACvB,IAAI,EAAK,IAAI,CAAC,OAAO,CAIrB,OAHI,aAAiB,GACjB,CAAA,EAAK,EAAM,SAAS,EADxB,EAEA,EAAQ,GAAO,EAAG,GAAG,CAAG,EAAG,GAAG,CAAG,KAC1B,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAK,IAAI,CAAC,IAAI,CAAC,EAAI,CAAE,EACjE,CAEA,WAAW,CAAM,CAAE,CACf,IAAI,EAAW,IAAI,CAAC,OAAO,GAC3B,GAAI,aAAkB,OAAQ,CAC1B,IAAI,EAAM,EAAO,SAAS,CAAG,IAAI,CAAC,KAAK,GACnC,EAAM,EAAO,IAAI,CAAC,GACtB,GAAI,GAAO,EAAI,KAAK,EAAI,EAEpB,OADA,EAAI,KAAK,CAAG,EAAO,SAAS,CACrB,IAAI,CAAC,SAAS,CAAG,CAEhC,MAAO,GAAI,AAAiB,UAAjB,OAAO,EAEd,OAAO,EAAS,MAAM,CAAC,IAAI,CAAC,KAAK,GAAI,EAAO,MAAM,GAAK,CAE/D,CAEA,aAAa,CAAM,CAAE,CACjB,IAAI,EAAW,IAAI,CAAC,OAAO,GAC3B,GAAI,aAAkB,OAAQ,CAC1B,IAAI,EAAI,IAAI,CAAC,iBAAiB,CAAC,EAAU,EAAQ,IAAI,CAAC,KAAK,IAC3D,GAAI,GAAK,EAAE,KAAK,EAAI,IAAI,CAAC,KAAK,GAC1B,OAAO,CACf,MAAO,GAAI,AAAiB,UAAjB,OAAO,EAEd,OAAO,EAAS,MAAM,CAAC,IAAI,CAAC,KAAK,GAAK,EAAO,MAAM,CAAE,EAAO,MAAM,GAAK,CAE/E,CAEA,WAAW,CAAG,CAAE,CACZ,OAAO,EAAI,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,0BACV,CAAC,EAAG,EAAG,IAAM,EAAE,WAAW,GAAK,EAAE,WAAW,GACnE,CACJ,CAGA,EAAa,SAAS,CAAC,QAAQ,CAAG,EAAa,QAAQ,CACvD,EAAa,SAAS,CAAC,WAAW,CAAG,EAAa,WAAW,CAC7D,EAAa,SAAS,CAAC,eAAe,CAAG,EAAa,eAAe,CACrE,EAAa,SAAS,CAAC,OAAO,CAAG,EAAa,OAAO,CACrD,EAAa,SAAS,CAAC,WAAW,CAAG,EAAa,WAAW,CAC7D,EAAa,SAAS,CAAC,cAAc,CAAG,EAAa,cAAc,CACnE,EAAa,IAAI,CACb,EAAa,SAAS,CACtB,EAAa,SAAS,CAAC,SAAS,CAAG,EAAa,WAAW,CAC/D,EAAa,SAAS,CAAC,IAAI,CAAG,EAAa,SAAS,CAAC,WAAW,CAChE,EAAa,SAAS,CAAC,IAAI,CAAG,EAAa,SAAS,CAAC,WAAW,CAChE,EAAa,IAAI,CAAG,EAAa,WAAW,AAErC,OAAM,UAAyB,EAClC,YAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GACT,IAAI,CAAC,YAAY,CAAG,IAAI,CAAC,YAAY,CAAC,EAAG,CAAA,EAAM,UAC/C,IAAI,CAAC,IAAI,CAAC,wBAAyB,AAAA,GAAY,CAAA,EACnD,CAYA,OAAO,CAAI,CAAE,CACT,EAAO,EAAK,IAAI,GAAK,IACrB,IAAI,CAAC,YAAY,CAAC,KACd,IAAI,EAAM,IAAI,CAAC,YAAY,CAAC,WAAW,GACvC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,EAAG,CAAA,EAAM,CAAA,GACvC,IAAI,CAAC,YAAY,CAAC,EAAG,EAAK,GAC1B,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,EAAK,MAAM,CAAE,CAAA,EAAM,CAAA,GACjD,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,EAAG,EAAG,EAAK,MAAM,CAAG,GACzD,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,EAAG,EAAG,EAAK,MAAM,CAAG,EAAG,MAAO,oBACpE,EACJ,CAEA,eAAe,CAAG,CAAE,CAChB,OAAO,KAAK,GAAG,CAAC,EAAI,IAAI,CAAC,YAAY,EACrB,KAAK,GAAG,CAAC,EAAK,IAAI,CAAC,WAAW,IAClD,CACJ,COtmCO,MAAM,UAAoB,EAC7B,OAAO,QAAU,CAAC,CAAE,AAEpB,aAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GACT,IAAI,CAAC,KAAK,CAAG,AAAA,EAAI,QAAQ,CAAC,kCAC1B,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC,IAAI,CAAC,KAAK,CAC5C,CAEA,mBAAoB,CAChB,OAAO,IAAI,CAAC,KAAK,AACrB,CAEA,eAAgB,CACZ,MAAO,aACX,CAEJ,CCOA,IAAI,EAAc,EAAG,EAAoB,KACzC,SAAS,IAAsB,EAAc,IAAK,CAElD,IAAI,EAAW,AAAA,EAAI,QAAQ,CAAC,iCAExB,EAAQ,CAEL,OAAM,UAAoB,EAE7B,OAAO,QAAU,CACb,qBAAuB,CAAA,EACvB,OAAuB,KACvB,MAAuB,KACvB,aAAuB,CAAA,CAC3B,CAAE,AAEF,aAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GAET,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,CAAC,CAAC,MAAM,CAC3B,IAAI,CAAC,KAAK,CAAG,IAAI,CAAC,CAAC,CAAC,KAAK,CACzB,IAAI,CAAC,YAAY,CAAG,IAAI,CAAC,CAAC,CAAC,YAAY,CAGvC,IAAI,CAAC,EAAE,CAAG,IAAI,CAAC,UAAU,GACzB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAG,IAAI,CAG5B,IAAI,CAAC,EAAE,CAAG,CAAC,YAAY,EAAE,EAAE,EAAM,CAAC,CAClC,IAAI,CAAC,SAAS,CAAG,CAAC,YAAY,EAAE,EAAM,CAAC,CACvC,IAAI,CAAC,uBAAuB,CAAG,AAAA,EAAQ,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,GAEpE,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAG,EAC7B,IAAI,CAAC,UAAU,GAAG,SAAS,CAAG,oHAK9B,IAAI,CAAC,gBAAgB,CAAC,CAClB,UAAe,IAAI,CAAC,WAAW,AACnC,GAEA,IAAI,CAAC,mBAAmB,CAAG,CACvB,UAAY,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,EAClD,QAAY,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CACpD,EAEA,IAAI,CAAC,aAAa,CAAG,CACjB,aAA2B,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAC9D,aAA2B,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAC9D,aAA2B,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,EAC9D,cAA2B,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,EAC/D,YAA2B,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,EAC7D,gBAA2B,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,EACjE,iBAA2B,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,IAAI,EAClE,yBAA2B,IAAI,CAAC,kCAAkC,CAAC,IAAI,CAAC,IAAI,EAC5E,wBAA2B,IAAI,CAAC,iCAAiC,CAAC,IAAI,CAAC,IAAI,EAC3E,gBAA2B,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,EACjE,gBAA2B,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CACrE,EAEA,IAAI,CAAC,iBAAiB,CAAG,CACrB,UAA0B,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,EAC1D,wBAA0B,AAAA,CAAA,WAClB,IAAI,CAAC,oBAAoB,EACzB,IAAI,CAAC,kBAAkB,EAC/B,CAAA,EAAE,IAAI,CAAC,IAAI,CACf,EAEA,IAAI,EAAS,IAAI,CAAC,MAAM,AACxB,CAAA,IAAI,CAAC,MAAM,CAAG,KACV,GACA,IAAI,CAAC,SAAS,CAAC,GAEnB,AAAA,EAAI,EAAE,CAAC,IAAI,CAAC,oBAAoB,GAAI,SAAU,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,GACvE,AAAA,EAAI,EAAE,CAAC,IAAI,CAAC,UAAU,GAAI,CACtB,UAAc,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,EACpD,MAAc,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EACtC,KAAc,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EACrC,QAAc,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EACxC,MAAc,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EACtC,MAAc,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAC/C,EACJ,CAEA,eAAgB,CACZ,MAAO,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC,YAAY,CAAG,oBAAsB,GAAG,CAAC,AACzE,CAEA,MAAM,CAAW,CAAE,CACf,IAAI,CAAC,UAAU,GAAG,KAAK,EAW3B,CAEA,KAAK,CAAK,CAAE,CAGZ,CAEA,sBAAuB,CACnB,OAAO,IAAI,CAAC,UAAU,GAAG,UAAU,AACvC,CAEA,oBAAqB,CACjB,OAAO,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,EAAE,AAC1C,CAEA,mBAAoB,CAChB,OAAO,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC,UAAU,AAClD,CAEA,iBAAkB,CACd,OAAO,SAAS,cAAc,CAAC,IAAI,CAAC,SAAS,CACjD,CAEA,kBAAkB,CAAG,CAAE,CACnB,OAAO,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,EAAI,EAAI,IACvD,CAEA,oBAAqB,CAEjB,IAAI,EAAM,IAAI,CAAC,oBAAoB,GAC/B,EAAK,EAAI,SAAS,CACtB,IAAI,CAAC,WAAW,GAChB,IAAI,EAAQ,IAAI,CAAC,eAAe,GAOhC,OANI,IACA,EAAM,cAAc,CAAC,CAAE,MAAO,UAAW,OAAQ,SAAU,GACvD,EAAM,UAAU,CAAG,EAAI,WAAW,CAAG,GACrC,CAAA,EAAI,UAAU,CAAG,CAAA,GAGlB,GAAM,EAAI,SAAS,AAC9B,CAEA,aAAc,CACV,OAAO,SAAS,aAAa,GAAK,IAAI,CAAC,UAAU,EACrD,CAEA,UAAU,CAAM,CAAE,CACV,IAAI,CAAC,MAAM,GACP,IAAI,CAAC,WAAW,EAAI,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,GACxC,IAAI,CAAC,WAAW,CAAC,OAAO,GACxB,IAAI,CAAC,WAAW,CAAG,MAEvB,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,aAAa,EAClD,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,iBAAiB,GAE1D,IAAI,CAAC,MAAM,CAAG,EACV,IACA,EAAO,gBAAgB,CAAC,IAAI,CAAC,aAAa,EACtC,IAAI,CAAC,WAAW,IAChB,EAAO,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,EAE9C,IAAI,CAAC,CAAC,CAAC,YAAY,CACnB,IAAI,CAAC,WAAW,CAAG,EAAO,WAAW,CAErC,IAAI,CAAC,WAAW,CAAG,EAAO,YAAY,CAAC,EAAO,WAAW,CAAC,WAAW,GAAI,CAAA,EAAO,cAEpF,IAAI,CAAC,aAAa,GAClB,IAAI,CAAC,WAAW,CAAC,CAAA,GACjB,IAAI,CAAC,aAAa,GAE1B,CAEA,mBAAoB,CAChB,IAAI,EAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAC7B,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAC9B,EAAM,IAAI,CAAC,oBAAoB,GAC/B,EAAK,EAAI,SAAS,CAClB,EAAS,KAAK,KAAK,CAAC,EAAK,SAAS,CAAG,EAAI,YAAY,CAAG,EAAI,EAAK,YAAY,CAAG,GAChF,EAAM,KAAK,KAAK,CAAC,EAAK,SAAS,EAAI,EACnC,EAAS,KAAK,KAAK,CAAC,EAAK,SAAS,CAAG,EAAI,YAAY,CAAG,EAAK,YAAY,EAAI,CAC7E,CAAA,GAAM,EAAK,EAAI,SAAS,CAAG,EACtB,GAAM,EAAQ,EAAI,SAAS,CAAG,EAClC,EAAI,SAAS,CAAG,CACzB,CAEA,eAAgB,CACZ,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAC7C,CAEA,aAAa,CAAG,CAAE,CACd,IAAI,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAAM,EAAM,IAAI,CAAC,oBAAoB,EACvE,CAAA,EAAI,SAAS,CAAG,KAAK,KAAK,CAAC,EAAK,SAAS,CAAG,EAAI,YAAY,CAAG,EAAI,EAAK,YAAY,CAAG,EAE3F,CAEA,mBAAmB,CAAI,CAAE,CACrB,IAAI,CAAC,kBAAkB,GAAG,SAAS,CAAG,CAC1C,CAEA,mBAAoB,CAChB,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,IAAI,CACjC,CAEA,aAAc,CACV,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAC/B,CAEA,OAAO,CAAK,CAAE,CACV,IAAI,EAAQ,IAAI,CAAC,oBAAoB,GACjC,EAAS,EAAM,SAAS,CACxB,EAAK,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAE,OAAQ,IAAI,CAAC,MAAM,AAAC,GAClD,EAAK,IAAI,EAAgB,CAAE,MAAO,CAAM,GAM5C,OALA,IAAI,CAAC,UAAU,GAAG,WAAW,CAAC,EAAG,UAAU,IAC3C,EAAG,QAAQ,CAAC,IAAI,CAAE,GAClB,EAAM,SAAS,CAAG,EAClB,EAAG,oBAAoB,GAAG,SAAS,CAAG,EACtC,IAAI,CAAC,KAAK,GACH,CACX,CAEA,QAAS,CACL,OAAO,IAAI,CAAC,MAAM,CAAC,CAAA,EACvB,CAEA,OAAO,CAAO,CAAE,CACZ,OAAO,IAAI,CAAC,MAAM,CAAC,CAAA,EACvB,CAEA,aAAc,CACV,AAAA,EAAI,QAAQ,CAAC,IAAI,CAAC,eAAe,GAAI,cACzC,CAEA,cAAe,CACX,IAAI,EAAK,AAAoB,MAApB,IAAI,CAAC,WAAW,EAAY,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,WAAW,EACxE,GAAI,AAAA,EAAI,QAAQ,CAAC,EAAI,sBACzB,IAAI,CAAC,WAAW,CAAG,IACvB,CAEA,YAAY,CAAK,CAAE,CACX,IAAI,CAAC,CAAC,CAAC,YAAY,EAAE,CAAA,EAAQ,CAAA,CAAjC,EACA,IAAI,EAAW,IAAI,CAAC,KAAK,CAAC,cAAc,KAAO,IAAI,CACnD,GAAI,AAAC,GAAU,GAGX,GAAY,CAAC,IAAI,CAAC,CAAC,CAAC,YAAY,EAAI,IAAI,CAAC,WAAW,IACpD,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,WAAW,IAEpE,IAAI,EAAK,IAAI,CAAC,MAAM,CAAC,OAAO,AAExB,CAAA,IAAI,CAAC,CAAC,CAAC,oBAAoB,GAC3B,IAAI,CAAC,YAAY,GACjB,AAAA,EAAI,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,EAAG,GAAG,EAAG,sBAC7C,IAAI,CAAC,WAAW,CAAG,EAAG,GAAG,EAK7B,IAAI,IAAI,CAAC,UAAU,GAAG,gBAAgB,CAAC,kBAAoB,IAAI,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,AAAA,IAChF,EAAG,EAAE,CAAG,GACR,EAAG,SAAS,CAAG,EACnB,GAG4B,MAAxB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,eAAe,EAI9C,IAAI,CAAC,eAAe,EAAI,EAAG,GAAG,GAC9B,IAAI,CAAC,eAAe,CAAG,EAAG,GAAG,CAC7B,IAAI,CAAC,oBAAoB,CAAC,EAAG,GAAG,GAGpC,IAAI,CAAC,SAAS,CAAC,gBAAiB,EAAG,GAAG,CAAE,EAAG,GAAG,EAC9C,IAAI,CAAC,uBAAuB,CAAC,GACjC,CAEA,aAAa,CAAG,CAAE,CACd,IAAI,EAAO,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,EAAK,IAAI,CAAC,WAAW,EAGvD,EAAM,EAAK,OAAO,CAAC,iBAMvB,OALI,GAAO,GACP,CAAA,EAAO,EAAK,MAAM,CAAC,EAAG,EAAM,IACtB,QAAU,IAAI,CAAC,SAAS,CAAG,IAC3B,EAAK,MAAM,CAAC,EAAM,GAH5B,EAKO,CACX,CAEA,eAAgB,CACZ,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAM,IACxC,CAAC,kBAAkB,EAAE,IAAI,CAAC,YAAY,CAAC,GAAG,MAAM,CAAC,EACnD,IAAI,CAAC,IACX,CAEA,oBAAoB,CAAC,CAAE,CAAC,CAAE,CA0BtB,IAAI,EAAO,IAAI,CACX,EAAM,AA1BV,SAAS,EAAS,CAAE,CAAE,CAAE,EACpB,GAAI,GAAM,EACN,OAAO,EACX,IAAI,EAAM,KAAK,KAAK,CAAC,AAAC,CAAA,EAAK,CAAA,EAAM,GAC7B,EAAM,EAAK,iBAAiB,CAAC,GAC7B,EAAM,EAAI,SAAS,QAEvB,AAAI,AADM,EAAK,EAAI,YAAY,CACtB,EACE,EAAS,EAAM,EAAG,GACzB,EAAI,EACG,EAAS,EAAI,EAAM,GACvB,CACX,EAcmB,EAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAG,GAC5C,EAAM,AAdV,SAAS,EAAQ,CAAE,CAAE,CAAE,EACnB,GAAI,GAAM,EACN,OAAO,EACX,IAAI,EAAM,KAAK,KAAK,CAAC,AAAC,CAAA,EAAK,CAAA,EAAM,GAC7B,EAAK,EAAK,WAAW,CAAC,EAAK,UAE/B,AAAI,AADK,EAAK,WAAW,CAAC,EAAK,EAAM,GAC9B,CAAC,CAAG,EACA,EAAQ,EAAM,EAAG,GACxB,EAAI,EAAG,CAAC,CACD,EAAQ,EAAI,EAAM,GACtB,CACX,EAGkB,EAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAI,CAAC,MAAM,EACjD,MAAO,CAAE,IAAK,EAAK,IAAK,CAAI,CAChC,CAEA,YAAY,CAAG,CAAE,CAAG,CAAE,CAClB,IAAI,EAAM,IAAI,CAAC,iBAAiB,GAAG,qBAAqB,GACpD,EAAM,IAAI,CAAC,iBAAiB,CAAC,GACjC,MAAO,CACH,EAAG,AArWf,SAAkB,CAAG,CAAE,CAAG,EACtB,IAAI,EAAQ,SAAS,WAAW,GAChC,EAAM,kBAAkB,CAAC,GACzB,IAAI,EAAa,SAAS,gBAAgB,CAAC,EAAK,WAAW,SAAS,EAChE,EAAM,EACV,KAAO,EAAW,QAAQ,IAAI,CAC1B,IAAI,EAAO,EAAW,WAAW,CAC7B,EAAO,EAAK,SAAS,CAAC,MAAM,CAChC,GAAI,EAAM,GAAQ,EAAK,CACnB,EAAM,QAAQ,CAAC,EAAM,EAAM,GAC3B,EAAM,MAAM,CAAC,EAAM,EAAM,GACzB,KACJ,CACA,GAAO,CACX,CACA,OAAO,EAAM,qBAAqB,GAAG,KAAK,AAC9C,EAqVwB,EAAK,GAAO,EAAI,IAAI,CAChC,EAAG,EAAI,SAAS,CAChB,EAAG,EAAI,YAAY,AACvB,CACJ,CAEA,eAAgB,CACZ,OAAO,KAAK,KAAK,CAAC,IAAI,CAAC,oBAAoB,GAAG,YAAY,CAAG,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC,YAAY,CACjH,CAEA,eAAe,CAAE,CAAE,CACV,GAAI,CAAA,EAAK,IAAI,CAAC,WAAW,CAAC,SAAS,EAAxC,EACA,IAAI,EAAU,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAG,EACpC,EAAY,IAAI,CAAC,gBAAgB,GACjC,EAAW,IAAI,CAAC,eAAe,GAMnC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC,EAL5C,AAAa,GAAb,EACR,MACA,GAAY,EACZ,MACA,KAAK,KAAK,CAAC,EAAW,EAAU,KAAO,KAEjD,CAIA,qBAAqB,CAAG,CAAE,CACtB,IAAI,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAC7B,GAGA,CAAA,EAAI,SAAS,CAAG,IAAI,CAAC,YAAY,CAAC,EAAlC,CAER,CAEA,qBAAqB,CAAG,CAAE,CAAM,CAAE,CAC9B,IAAI,EAAM,EAAS,SAAS,CAAC,CAAA,GAC7B,IAAI,CAAC,iBAAiB,GAAG,YAAY,CAAC,EAAK,IAAI,CAAC,iBAAiB,CAAC,IAC9D,GACA,CAAA,EAAI,SAAS,CAAG,IAAI,CAAC,YAAY,CAAC,EADtC,CAGJ,CAEA,qBAAqB,CAAG,CAAE,CACtB,AAAA,EAAI,KAAK,CAAC,IAAI,CAAC,iBAAiB,CAAC,GACrC,CAEA,sBAAsB,CAAE,CAAE,CAAG,CAAE,CAC3B,IAAI,CAAC,WAAW,EACpB,CAEA,qBAAsB,CAClB,IAAI,CAAC,aAAa,EACtB,CAEA,wBAAwB,CAAE,CAAE,CACxB,IAAI,CAAC,SAAS,CAAC,EAAI,uBACvB,CAEA,kBAAkB,CAAI,CAAE,CACpB,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,EAC5B,CAEA,oCAAqC,CACjC,IAAI,CAAC,oBAAoB,CAAG,CAAA,EAC5B,IAAI,CAAC,YAAY,GACjB,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAChC,CAEA,mCAAoC,CAAC,CAErC,0BAA2B,CACvB,IAAI,CAAC,uBAAuB,CAAC,KACjC,CAEA,aAAa,CAAI,CAAE,CACf,OAAO,IAAI,CAAC,EAAE,CAAG,QAAU,CAC/B,CAEA,eAAe,CAAI,CAAE,CAAK,CAAE,CACxB,IAAI,EAAM,GAuCV,OAtCA,EAAM,OAAO,CAAC,AAAA,IACV,GAAI,EAAE,KAAK,EAAI,EAAE,KAAK,EAAI,EAAE,IAAI,EAAI,EAAE,IAAI,EAG1C,EAtaD,CADY,EAuaO,GAtajB,KAAK,CAAG,EAAE,KAAK,EAAK,EAAE,KAAK,EAAI,EAAE,KAAK,EAAI,EAAE,IAAI,CAAG,EAAE,IAAI,CAC9D,CAAE,MAAO,EAAE,KAAK,CAAE,KAAM,EAAE,IAAI,CAAE,MAAO,EAAE,KAAK,CAAE,KAAM,EAAE,IAAI,AAAC,EAAI,EAsa7D,IAxaW,EAwaP,EAAK,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,CAAE,EAAE,IAAI,EACrC,EAAK,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,CAAE,EAAE,IAAI,EACrC,EAAK,AAAU,GAAV,EAAE,IAAI,CAAQ,EAAK,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,CAAE,EAClD,CAAA,EAAE,KAAK,EAAI,EAAE,KAAK,CAClB,GAAO,CAAC,YAAY,EAAE,EAAK;yBAClB,EAAE,EAAG,CAAC,CAAC;0BACN,EAAE,EAAG,CAAC,CAAC;4BACL,EAAE,EAAG,CAAC,CAAC;2BACR,EAAE,EAAG,CAAC,CAAG,EAAG,CAAC,CAAC;wBACjB,CAAC,EAET,GAAO,CAAC,YAAY,EAAE,EAAK;yBAClB,EAAE,EAAG,CAAC,CAAC;0BACN,EAAE,EAAG,CAAC,CAAC;4BACL,EAAE,EAAE,IAAI,CAAG,EAAI,EAAG,CAAC,CAAG,EAAG,CAAC,CAAG,EAAG,CAAC,CAAC;wBACtC,CAAC,CACL,EAAE,IAAI,CAAG,GAAK,EAAE,KAAK,CAAG,EAAE,KAAK,CAAG,GAClC,CAAA,GAAO,CAAC,YAAY,EAAE,EAAK;6BAClB,EAAE,EAAG,CAAC,CAAG,EAAG,CAAC,CAAC;8BACb,EAAE,EAAG,CAAC,CAAC;gCACL,EAAE,EAAG,CAAC,CAAG,EAAG,CAAC,CAAG,EAAG,CAAC,CAAC;4BACzB,CAAC,AAAD,EAER,EAAE,IAAI,CAAG,GACT,CAAA,GAAO,CAAC,YAAY,EAAE,EAAK;6BAClB,EAAE,EAAG,CAAC,CAAC;8BACN,EAAE,EAAG,CAAC,CAAC;gCACL,EAAE,EAAG,CAAC,CAAC;+BACR,EAAE,EAAG,CAAC,CAAG,EAAG,CAAC,CAAC;4BACjB,CAAC,AAAD,GAGpB,GACO,EAAM,CAAC,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,GAAM,sBAAsB,EAAE,EAAK,uBAAuB,EAAE,EAAK,EAAE,EAAE,EAAI,MAAM,CAAC,CAAG,IAClI,CAEA,kBAAmB,CACf,OAAO,IAAI,CAAC,oBAAoB,GAAG,UAAU,CAAC,MAAM,CAAG,CAC3D,CAEA,wBAAwB,CAAI,CAAE,CAAK,CAAE,CACjC,IAAI,EAAO,IAAI,CAAC,cAAc,CAAC,EAAM,MAAM,OAAO,CAAC,GAAS,EAAQ,CAAE,EAAO,EAC7E,GAAI,EAAM,CACN,IAAI,EAAM,AAAA,EAAI,QAAQ,CAAC,GACnB,EAAM,SAAS,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,GACpD,CAAA,EAAM,EAAI,WAAW,CAAC,GAAO,IAAI,CAAC,oBAAoB,GAAG,WAAW,CAAC,GACrE,IAAI,CAAC,kBAAkB,EAC3B,MACI,IAAI,CAAC,uBAAuB,CAAC,EAErC,CAEA,wBAAwB,CAAI,CAAE,CAC1B,AAAA,EAAI,KAAK,CAAC,SAAS,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,KACpD,IAAI,CAAC,kBAAkB,EAC3B,CAEA,oBAAqB,CACjB,IAAI,EAAQ,IACL,IAAI,CAAC,oBAAoB,GAAG,gBAAgB,CAAC,iCACnD,CAAC,GAAG,CAAC,AAAA,GAAM,EAAG,OAAO,CAAC,YAAY,EACnC,IAAI,CAAC,SAAS,CAAC,EAAM,MAAM,CAAG,EAAG,2BACjC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,aAAa,CAAG,EAAM,IAAI,CAAC,IACzD,CAIA,aAAc,CACV,IAAI,CAAC,SAAS,CAAC,KACnB,CAEA,WAAY,CACR,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAE,CAAA,GAC3B,IAAI,CAAC,CAAC,CAAC,YAAY,EACpB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,WAAW,CAAC,WAAW,IAE7D,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,CACvD,CAEA,UAAW,CACF,IAAI,CAAC,CAAC,CAAC,YAAY,EACpB,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,WAAW,IAEpE,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC,iBAAiB,CAC1D,CAEA,wBAAwB,CAAE,CAAE,CACxB,GAAI,EAAG,OAAO,EAAI,EAAG,QAAQ,CACzB,OACJ,EAAG,eAAe,GAElB,aAAa,GACb,IACA,EAAoB,WAAW,EAhgBjB,KAkgBd,IAAI,EAAM,AAAA,EAAI,QAAQ,CAAC,EAAI,IAAI,CAAC,iBAAiB,IAC7C,EAAK,IAAI,CAAC,mBAAmB,CAAC,EAAI,CAAC,CAAE,EAAI,CAAC,EAC1C,EAAM,IAAI,CAAC,MAAM,CAErB,WAAW,KACP,EAAI,kBAAkB,GACtB,EAAI,GAAG,CAAC,YAAa,EAAI,iBAAiB,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,GACzD,EAAI,iBAAiB,CAAC,iBAClB,AAAe,GAAf,GACA,EAAI,mBAAmB,GACvB,AAAA,EAAI,EAAE,CAAC,OAAQ,IAAI,CAAC,mBAAmB,GAElC,AAAe,GAAf,GACL,EAAI,GAAG,CAAC,gBACR,EAAI,GAAG,CAAC,iBACR,EAAI,GAAG,CAAC,sBAEH,AAAe,GAAf,GACL,EAAI,GAAG,CAAC,qBACR,EAAI,GAAG,CAAC,qBAEY,GAAf,IACL,EAAI,GAAG,CAAC,sBACR,EAAI,GAAG,CAAC,sBACR,EAAI,GAAG,CAAC,qBACR,EAAI,GAAG,CAAC,0BAEhB,EACJ,CAEA,wBAAwB,CAAE,CAAE,CACxB,IAAI,EAAM,AAAA,EAAI,QAAQ,CAAC,EAAI,IAAI,CAAC,iBAAiB,IAC7C,EAAK,IAAI,CAAC,mBAAmB,CAAC,EAAI,CAAC,CAAE,EAAI,CAAC,EAC9C,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,GACzE,IAAI,CAAC,MAAM,CAAC,mBAAmB,GAC/B,IAAI,CAAC,kBAAkB,EAC3B,CAEA,sBAAsB,CAAE,CAAE,CACtB,AAAA,EAAI,GAAG,CAAC,OAAQ,IAAI,CAAC,mBAAmB,CAC5C,CAEA,YAAY,CAAE,CAAE,KAgDA,EAAA,EA/CI,EAAG,GAAG,CAAlB,CAgDD,4GAA4G,IAAI,CAAC,IA/C5G,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,KAC3B,EAAG,cAAc,GACjB,EAAG,eAAe,GAG9B,CAEA,UAAU,CAAE,CAAE,CACd,CAEA,YAAa,CACT,IAAI,CAAC,uBAAuB,EAChC,CAEA,eAAe,CAAE,CAAE,CACf,EAAG,cAAc,GACjB,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,EAChC,CAEA,kBAAmB,CACf,IAAI,EAAM,IAAI,CAAC,oBAAoB,GACnC,OAAO,IAAI,CAAC,mBAAmB,CAAC,EAAG,EAAI,SAAS,CAAG,GAAG,GAAG,AAC7D,CAEA,iBAAkB,CACd,IAAI,EAAM,IAAI,CAAC,oBAAoB,GACnC,OAAO,IAAI,CAAC,mBAAmB,CAAC,EAAI,WAAW,CAAG,EAAG,EAAI,SAAS,CAAG,EAAI,YAAY,CAAG,GAAG,GAAG,AAClG,CAEA,SAAS,CAAK,CAAE,CACZ,IAAI,EAAM,IAAI,CAAC,oBAAoB,GAC/B,EAAO,KAAK,GAAG,CAAC,IAAI,CAAC,gBAAgB,GAAK,EAAO,GACrD,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAC9B,EAAI,SAAS,CAAG,EAAK,SAAS,CAC9B,IAAI,CAAC,oBAAoB,CAAG,CAAA,CAChC,CAEA,WAAW,CAAK,CAAE,CACd,IAAI,EAAM,IAAI,CAAC,oBAAoB,GAC/B,EAAO,KAAK,GAAG,CAAC,IAAI,CAAC,gBAAgB,GAAK,EAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAG,GAC/E,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAC9B,EAAI,SAAS,CAAG,EAAK,SAAS,CAC9B,IAAI,CAAC,oBAAoB,CAAG,CAAA,CAChC,CACJ,CAMO,MAAM,UAAwB,EACjC,OAAO,QAAU,CACb,MAAO,CAAA,CACX,CAAE,AACF,EAAC,CAAa,CAAG,IAAK,AACtB,CAAA,eAAgB,CACZ,MAAO,mBAAsB,CAAA,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,QAAU,MAAA,CAC1D,CACA,eAAgB,CACZ,KAAK,CAAC,gBACN,IAAI,CAAC,aAAa,CAAG,CACjB,UAAY,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EACvC,QAAY,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CACzC,EACA,IAAI,CAAC,GAAG,CAAG,AAAA,EAAI,QAAQ,CAAC,wCACxB,AAAA,EAAI,EAAE,CAAC,IAAI,CAAC,GAAG,CAAE,YAAa,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAC7D,CACA,SAAS,CAAC,CAAE,CAAC,CAAE,CACX,IAAI,CAAC,GAAG,CAAC,GACT,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,EACjB,IAAI,CAAC,GAAG,CAAC,EACb,CACA,aAAa,CAAE,CAAE,CAEb,GADA,IAAI,CAAC,CAAC,CAAa,CAAG,SAAS,aAAa,CACxC,EAAG,MAAM,GAAK,IAAI,CAAC,GAAG,CAAE,CACxB,IAAI,EAAQ,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,EAAE,AAChD,CAAA,IAAI,CAAC,MAAM,CAAG,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,EAAG,OAAO,CAAG,EAAG,OAAO,CACpD,IAAI,CAAC,QAAQ,CAAG,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,EAAM,YAAY,CAAG,EAAM,WAAW,CACrE,IAAI,CAAC,QAAQ,CAAC,YACd,EAAG,eAAe,GAClB,AAAA,EAAI,EAAE,CAAC,OAAQ,IAAI,CAAC,aAAa,EACjC,AAAA,EAAI,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,qBAAuB,oBACxD,MAAW,IAAI,CAAC,CAAC,CAAa,EAC1B,IAAI,CAAC,CAAC,CAAa,CAAC,KAAK,EAEjC,CACA,WAAW,CAAE,CAAE,CACX,AAAA,EAAI,GAAG,CAAC,OAAQ,IAAI,CAAC,aAAa,EAClC,IAAI,CAAC,QAAQ,CAAC,YACd,AAAA,EAAI,UAAU,GACV,IAAI,CAAC,CAAC,CAAa,EACnB,IAAI,CAAC,CAAC,CAAa,CAAC,KAAK,GAE7B,IAAI,CAAC,CAAC,CAAa,CAAG,IAC1B,CACA,aAAa,CAAE,CAAE,CACb,IAAI,EAAO,IAAI,CAAC,UAAU,GACtB,EAAM,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,EAAK,YAAY,CAAG,EAAK,WAAW,CACzD,EAAO,AAAC,CAAA,IAAI,CAAC,CAAC,CAAC,KAAK,CAAG,EAAG,OAAO,CAAG,EAAG,OAAM,AAAN,EAAW,IAAI,CAAC,MAAM,CAE7D,EAAO,KAAK,GAAG,CAAC,GAAK,KAAK,GAAG,CAAC,GAAK,AAD1B,KAAK,GAAG,CAAC,EAAK,KAAK,GAAG,CAAC,EAAG,IAAI,CAAC,QAAQ,CAAG,IACP,GAC5C,CAAA,IAAI,CAAC,CAAC,CAAC,KAAK,CACZ,EAAK,KAAK,CAAC,gBAAgB,CAAG,CAAC,EAAE,EAAK,QAAQ,EAAE,EAAE,EAAK,EAAE,CAAC,CAE1D,EAAK,KAAK,CAAC,mBAAmB,CAAG,CAAC,EAAE,EAAK,QAAQ,EAAE,EAAE,EAAK,EAAE,CAAC,AAErE,CACJ,CV5qBA,SAAS,EAAW,CAAK,CAAE,CAAC,CAAE,CAAG,CAAE,CAAM,EACrC,GAAI,AAAgB,GAAhB,EAAM,MAAM,CACZ,OAAO,KAEX,IADA,IAA0E,EAAtE,EAAI,EAAG,EAAQ,CAAK,CAAC,EAAE,CAAE,EAAW,EAAE,IAAI,CAAC,EAAK,GAAQ,EAAW,EAChE,EAAE,EAAI,EAAM,MAAM,EAAO,CAAA,EAAM,EAAE,IAAI,CAAC,EAAK,CAAK,CAAC,EAAE,CAAA,EAAK,IAC3D,EAAW,EACX,EAAW,EACX,EAAQ,CAAK,CAAC,EAAE,EAIpB,OAFI,GACA,EAAM,MAAM,CAAC,EAAU,GACpB,CACX,CAEA,SAAS,EAAoB,CAAG,CAAE,CAAG,EACjC,GAAI,EAAI,MAAM,CAAG,EAAG,CAEhB,IADA,IAAI,EAAI,EAAI,EAAE,CAAC,IAAI,MAAM,GAAG,IAAI,CAAE,EAAI,CAAE,EAAI,GAAG,GAAI,CAC5C,EAAI,MAAM,CAAG,GAAK,EAAI,EAAE,CAAC,IAAI,MAAM,GAAG,IAAI,EAAI,GACjD,EAAE,IAAI,CAAC,EAAI,GAAG,IAClB,OAAO,EAAW,EAAG,SAAS,CAAC,EAC3B,OAAO,KAAK,GAAG,CAAC,EAAI,GAAG,CAAG,EAAE,MAAM,GAAG,GAAG,CAAG,EAAE,MAAM,GAAG,MAAM,CAAC,EACjE,EACJ,CACJ,CAEA,SAAS,EAAoB,CAAG,CAAE,CAAG,EACjC,GAAI,EAAI,MAAM,CAAG,EAAG,CAEhB,IADA,IAAI,EAAI,EAAI,EAAE,CAAC,IAAI,MAAM,GAAG,GAAG,CAAE,EAAI,CAAE,EAAI,GAAG,GAAI,CAC3C,EAAI,MAAM,CAAG,GAAK,EAAI,EAAE,CAAC,IAAI,MAAM,GAAG,GAAG,EAAI,GAChD,EAAE,IAAI,CAAC,EAAI,GAAG,IAClB,OAAO,EAAW,EAAG,SAAS,CAAC,EAC3B,OAAO,KAAK,GAAG,CAAC,EAAI,IAAI,CAAG,EAAE,MAAM,GAAG,IAAI,CAAG,EAAE,MAAM,GAAG,KAAK,CAAC,EAClE,EACJ,CACJ,CAEA,SAAS,IACL,GAAI,CAAE,CAAA,OAAO,YAAY,EAAI,OAAO,YAAY,CAAC,OAAM,AAAN,EAC7C,MAAM,IAAI,EAAgB,uDAClC,CAEO,MAAM,UAAc,EAEvB,OAAO,QAAU,CACb,QAAgB,EAAE,CAClB,OAAgB,EAAE,CAClB,cAAgB,OAAO,MAAM,CAAC,KAClC,CAAE,AAEF,aAAY,GAAG,CAAI,CAAE,CACjB,KAAK,IAAI,GAET,IAAI,CAAC,OAAO,CAAG,IAAI,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAClC,IAAI,CAAC,MAAM,CAAG,IAAI,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAChC,IAAI,CAAC,aAAa,CAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,aAAa,AAAA,EAE7C,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,AAAA,IACjB,EAAE,KAAK,CAAG,IAAI,CACd,IAAI,CAAC,mBAAmB,CAAC,EAC7B,GAGA,IAAI,CAAC,QAAQ,CAAG,EAAE,CAClB,IAAI,CAAC,iBAAiB,CAAG,EAAE,CAC3B,IAAI,CAAC,QAAQ,CAAG,CAAC,EAIjB,IAAI,CAAC,iBAAiB,CAAG,KAGzB,IAAI,CAAC,gBAAgB,CAAG,KAGxB,IAAI,CAAC,cAAc,CAAG,CAAA,EAEtB,IAAI,CAAC,eAAe,CAAG,KAEvB,IAAI,CAAC,aAAa,CAAG,EAErB,IAAI,CAAC,YAAY,CAAG,EAEpB,IAAI,CAAC,aAAa,CAAG,KAErB,IAAI,CAAC,aAAa,CAAG,KAGrB,IAAI,CAAC,UAAU,CAAG,IAAI,EAAiB,CAAE,MAAO,IAAI,AAAC,GACrD,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,mBACpB,IAAI,CAAC,gBAAgB,CAAG,IAAI,CAAC,WAAW,CAAC,CACrC,aAAuB,CAAA,EACvB,OAAuB,IAAI,CAAC,UAAU,CACtC,OAAuB,CAAA,EACvB,qBAAuB,CAAA,CAC3B,GAG2B,GAAvB,IAAI,CAAC,OAAO,CAAC,MAAM,EACnB,IAAI,CAAC,YAAY,GAErB,IAAI,EAAQ,IAAI,CAAC,WAAW,CAAC,CAAE,OAAQ,IAAI,CAAC,OAAO,CAAC,EAAE,AAAC,GAEvD,IAAI,CAAC,GAAG,CAAC,GACT,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,EAE9B,IAAI,CAAC,cAAc,CAAC,GACpB,EAAM,WAAW,EACrB,CAEA,eAAgB,CACZ,MAAO,0BACX,CAEA,oBAAoB,CAAG,CAAE,CACrB,EAAI,gBAAgB,CAAC,YAAa,KAC9B,IAAI,EAAK,IAAI,CAAC,cAAc,GAC5B,IAAI,CAAC,eAAe,CAAC,GAAK,OAAO,CAAC,AAAA,IAC1B,IAAM,GACN,IAAI,CAAC,WAAW,CAAC,EAEzB,GACA,AAAA,EAAO,IAAI,CAAC,OAAO,CAAE,GACjB,IAAI,CAAC,eAAe,KAAO,GAC3B,IAAI,CAAC,gBAAgB,CAAC,EAC9B,EACJ,CAEA,eAAe,CAAI,CAAE,CAAO,CAAE,CAC1B,EAAU,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,GAC1B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAC7B,CAEA,kBAAmB,CACX,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAK,CAAA,AAAiC,GAAjC,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAC7B,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,KAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAA,GACtF,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAC7C,IAAI,CAAC,QAAQ,CAAG,EAAE,AACtB,CAEA,cAAe,CACX,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAC9B,CAEA,eAAe,CAAI,CAAE,CACb,GACA,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EACzC,IAAI,CAAC,QAAQ,CAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,KAE5C,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,EAC5C,IAAI,CAAC,QAAQ,CAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,GAElD,CAEA,UAAU,CAAG,CAAE,CAIX,OAHM,aAAe,GACjB,CAAA,EAAM,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,AAAA,GAAK,EAAE,IAAI,EAAI,EAD3C,EAGO,CACX,CAEA,WAAW,CAAG,CAAE,CACZ,EAAM,IAAI,CAAC,SAAS,CAAC,GACrB,IAAI,CAAC,SAAS,CAAC,iBAAkB,GACjC,EAAI,OAAO,EACf,CAEA,aAAa,CAAG,CAAE,CAAI,CAAE,CAEpB,AADA,CAAA,EAAM,IAAI,CAAC,SAAS,CAAC,EAArB,EACI,IAAI,CAAG,EACX,EAAI,SAAS,CAAC,mBAClB,CAEA,mBAAmB,CAAG,CAAE,CACpB,IAAI,CAAC,cAAc,GAAG,SAAS,CAAC,GAChC,IAAI,CAAC,SAAS,CAAC,iBAAkB,EACrC,CAEA,eAAe,CAAS,CAAE,CACtB,IAAI,EAAM,IAAI,CAAC,SAAS,CAAC,GAAY,EAAI,IAAI,CAAC,OAAO,CAQrD,OAPK,GAED,CAAA,EAAM,IAAI,CAAC,YAAY,CAAC,CAAE,KAAM,CAAU,EAAA,EAE9C,AAAA,EAAO,EAAG,GACV,EAAE,OAAO,CAAC,GACV,IAAI,CAAC,kBAAkB,CAAC,GACjB,CACX,CAEA,iBAAiB,CAAG,CAAE,CAClB,IAAI,EAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,AAAA,IACxB,GAAI,IAAQ,EAAK,MAAO,CAAA,EACxB,IAAI,EAAS,CAAA,EAEb,OADA,EAAI,YAAY,CAAC,IAAM,EAAS,CAAA,GACzB,CACX,GACA,GAAI,EAAE,MAAM,CAAG,EAAG,CACd,IAAI,EAAM,CAAC,CAAC,EAAE,CACd,AAAA,EAAO,IAAI,CAAC,OAAO,CAAE,GACrB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAClB,IAAI,CAAC,kBAAkB,CAAC,EAC5B,MACI,IAAI,CAAC,cAAc,CAAC,YAE5B,CAEA,oBAAqB,CACjB,IAAI,EAAI,IAAI,CAAC,OAAO,CACpB,GAAI,EAAE,MAAM,CAAG,EAAG,CACd,IAAI,EAAM,EAAE,KAAK,GACjB,EAAE,IAAI,CAAC,GACP,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,CAChC,CACJ,CAEA,wBAAyB,CACrB,IAAI,EAAI,IAAI,CAAC,OAAO,CACpB,GAAI,EAAE,MAAM,CAAG,EAAG,CACd,IAAI,EAAM,EAAE,GAAG,GACf,EAAE,OAAO,CAAC,GACV,IAAI,CAAC,kBAAkB,CAAC,EAC5B,CACJ,CAEA,cAAc,CAAG,CAAE,CAAC,CAAE,CACT,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAI,EAAI,IAAI,CAAC,OAAO,CACpB,OAAO,CAAC,CAAC,AAAC,CAAA,EAAE,OAAO,CAAC,GAAO,CAAA,EAAK,EAAE,MAAM,CAAC,AAC7C,CAEA,cAAc,CAAG,CAAE,CAAC,CAAE,CAElB,OADS,MAAL,GAAW,CAAA,EAAI,CAAA,EACZ,IAAI,CAAC,aAAa,CAAC,EAAK,CAAC,EACpC,CAEA,gBAAgB,CAAG,CAAE,CAEjB,OADA,EAAM,IAAI,CAAC,SAAS,CAAC,GACd,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,AAAA,GAAK,EAAE,MAAM,GAAK,EAChD,CAEA,aAAa,CAAI,CAAE,CAEf,IAAI,EAAM,IAAI,EADd,EAAO,OAAO,MAAM,CAAC,CAAC,EAAG,EAAM,CAAE,MAAO,IAAI,AAAC,IAM7C,OAJA,IAAI,CAAC,mBAAmB,CAAC,GACpB,EAAK,MAAM,EACZ,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GACtB,IAAI,CAAC,SAAS,CAAC,iBAAkB,GAC1B,CACX,CAEA,YAAY,CAAI,CAAE,CAEd,IAAI,EAAQ,IAAI,EADhB,EAAO,OAAO,MAAM,CAAC,CAAC,EAAG,EAAM,CAAE,MAAO,IAAI,AAAC,IAK7C,OAHK,EAAK,MAAM,EACZ,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GACxB,EAAM,QAAQ,CAAC,IAAI,CAAC,aAAa,EAC1B,CACX,CAEA,cAAc,CAAK,CAAE,CACjB,CAAE,IAAI,CAAC,gBAAgB,IAAK,IAAI,CAAC,MAAM,CAAE,CAAC,OAAO,CAAC,AAAA,GAAS,EAAM,QAAQ,CAAC,GAC9E,CAEA,cAAc,CAAK,CAAE,CACjB,GAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAG,EAAG,CACxB,IAAI,EAAK,EAAM,UAAU,GACzB,KAAO,EAAG,UAAU,EAAI,IAAI,CAAC,iBAAiB,IAC1C,EAAK,EAAG,UAAU,CAClB,IAAO,IACP,EAAG,WAAW,CAAC,EAAM,UAAU,IAC/B,IAAI,CAAC,cAAc,CAAC,GACpB,EAAM,aAAa,GACnB,IAAI,CAAC,MAAM,CAAG,CAAE,EAAO,CAE/B,CACJ,CAEA,YAAY,CAAK,CAAE,CACf,GAAI,IAAI,CAAC,MAAM,CAAC,MAAM,CAAG,EAAG,CACxB,AAAA,EAAO,IAAI,CAAC,MAAM,CAAE,GACpB,IAAI,EAAS,EAAM,UAAU,GAAG,UAAU,CACtC,EAAQ,IAAI,EAAO,QAAQ,CAAC,CAAC,IAAI,CAAC,AAAA,IAClC,IAAI,EAAM,EAAG,aAAa,CAC1B,OAAO,aAAe,GACd,aAAe,GAAe,IAAQ,CAClD,GACA,EAAO,WAAW,CAAC,GACd,AAAA,EAAI,QAAQ,CAAC,EAAO,gBACrB,CAAA,EAAQ,EAAM,aAAa,CAAC,eADhC,EAGA,EAAQ,EAAM,aAAa,CAC3B,IAAI,CAAC,cAAc,CAAC,GACpB,EAAM,aAAa,EACvB,CACJ,CAEA,iBAAkB,CACd,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CACtC,CAEA,OAAQ,CACJ,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,KAAK,EAC5B,CAEA,cAAc,CAAK,CAAE,CACjB,IAAI,CAAC,aAAa,CAAG,CACzB,CAEA,eAAe,CAAK,CAAE,CAAO,CAAE,CAC3B,GAAI,CAAC,EAAM,YAAY,CAAE,CACrB,IAAI,EAAM,IAAI,CAAC,cAAc,GACzB,GACA,EAAI,QAAQ,CAAC,sBAEjB,AAAA,EAAO,IAAI,CAAC,MAAM,CAAE,GACpB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,GACjB,EAAM,QAAQ,CAAC,qBACnB,CACA,IAAI,CAAC,aAAa,CAAG,EAChB,GACD,EAAM,KAAK,EACnB,CAEA,gBAAiB,CACb,OAAO,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,GAC1B,CAEA,iBAAkB,CACd,IAAI,EAAQ,IAAI,CAAC,cAAc,GAC/B,OAAO,EAAQ,EAAM,MAAM,CAAG,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,GAClD,CAEA,cAAc,CAAO,CAAE,CACnB,IAAI,CAAC,QAAQ,CAAC,uBACR,aAAmB,OACrB,CAAA,EAAU,CAAE,EAAS,AAAA,EACzB,EAAQ,OAAO,CAAC,AAAA,IACZ,IAAI,CAAC,QAAQ,CAAC,eAAiB,EACnC,EACJ,CAEA,oBAAoB,CAAG,CAAE,CACrB,IAAI,EAAQ,IAAI,CAAC,cAAc,GAE3B,EAAM,AADE,EAAM,eAAe,GACjB,qBAAqB,GACrC,IAAI,EAAM,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,MAAM,GAAG,IAAI,CAAG,EAAE,MAAM,GAAG,IAAI,EACvE,EAAM,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,MAAM,GAAG,GAAG,CAAG,EAAE,MAAM,GAAG,GAAG,EACzE,OAAO,IAAI,CAAC,mBAAqB,EAAI,CAAC,EAAK,EAAK,EAAK,EACzD,CAEA,qBAAqB,CAAG,CAAE,CAAG,CAAE,CAAG,CAAE,CAAK,CAAE,CAKvC,OAAO,EAJP,EAAM,EAAI,MAAM,CAAC,AAAA,IACb,IAAI,EAAI,EAAE,MAAM,GAChB,OAAO,IAAO,GAAW,EAAE,IAAI,CAAG,EAAI,IAAI,EAAM,EAAE,GAAG,CAAG,EAAI,MAAM,EAAI,EAAI,GAAG,EAAM,EAAE,GAAG,CAAG,EAAE,MAAM,CAAG,EAAI,GAAG,AACjH,GACgC,EACpC,CAEA,sBAAsB,CAAG,CAAE,CAAG,CAAE,CAAG,CAAE,CAAK,CAAE,CAMxC,OALA,EAAI,OAAO,GAKJ,EAJP,EAAM,EAAI,MAAM,CAAC,AAAA,IACb,IAAI,EAAI,EAAE,MAAM,GAChB,OAAO,IAAO,GAAW,EAAE,IAAI,CAAG,EAAI,IAAI,EAAM,EAAE,GAAG,CAAG,EAAI,MAAM,EAAI,EAAI,GAAG,EAAM,EAAE,GAAG,CAAG,EAAE,MAAM,CAAG,EAAI,GAAG,AACjH,GACgC,EACpC,CAEA,mBAAmB,CAAG,CAAE,CAAG,CAAE,CAAG,CAAE,CAAK,CAAE,CAKrC,OAAO,EAJP,EAAM,EAAI,MAAM,CAAC,AAAA,IACb,IAAI,EAAI,EAAE,MAAM,GAChB,OAAO,IAAO,GAAW,EAAE,GAAG,CAAG,EAAI,GAAG,EAAM,EAAE,IAAI,CAAG,EAAI,KAAK,EAAI,EAAI,IAAI,EAAM,EAAE,IAAI,CAAG,EAAE,KAAK,CAAG,EAAI,IAAI,AACjH,GACgC,EACpC,CAEA,qBAAqB,CAAG,CAAE,CAAG,CAAE,CAAG,CAAE,CAAK,CAAE,CAMvC,OALA,EAAI,OAAO,GAKJ,EAJP,EAAM,EAAI,MAAM,CAAC,AAAA,IACb,IAAI,EAAI,EAAE,MAAM,GAChB,OAAO,IAAO,GAAW,EAAE,GAAG,CAAG,EAAI,GAAG,EAAM,EAAE,IAAI,CAAG,EAAI,KAAK,EAAI,EAAI,IAAI,EAAM,EAAE,IAAI,CAAG,EAAE,KAAK,CAAG,EAAI,IAAI,AACjH,GACgC,EACpC,CAIA,QAAS,CAEL,OADA,IACO,KAAK,KAAK,CAAC,aAAa,OAAO,CAAC,WAAa,KACxD,CAEA,OAAO,CAAG,CAAE,CACR,IACA,aAAa,OAAO,CAAC,SAAU,KAAK,SAAS,CAAC,GAClD,CAEA,mBAAmB,CAAI,CAAE,CAAO,CAAE,CAC9B,IAA+D,EAA3D,EAAO,IAAI,CAAC,mBAAmB,CAAC,GAAO,EAAQ,EAAK,KAAK,CAI7D,GAHoB,GAAhB,EAAM,MAAM,EACZ,CAAA,EAAO,EAAK,GAAG,CAAC,CAAK,CAAC,EAAE,CAAC,AAAD,EAExB,AAAQ,MAAR,GAAgB,CAAC,EACjB,MAAM,IAAI,EAAgB,kBAE9B,OAAO,CACX,CAEA,mBAAmB,CAAI,CAAE,CAAO,CAAE,CAC9B,IAAI,EAAQ,IAAI,CAAC,mBAAmB,CAAC,EAAM,OAC3C,CAAA,EAAM,GAAG,CAAC,EAAM,KAAK,CAAC,EAAE,CAAC,CAAG,EAC5B,IAAI,CAAC,MAAM,CAAC,EAAM,KAAK,CAC3B,CAEA,oBAAoB,CAAI,CAAE,CAAM,CAAE,CAC9B,IAAI,EAAO,EAAM,EAAQ,IAAI,CAAC,MAAM,GAAI,EAAO,EAAE,CACjD,EAAO,EAAK,OAAO,CAAC,YAAa,IAAI,KAAK,CAAC,SAE3C,IADA,IAAI,EAAO,EAAE,CAAE,EAAQ,EAAE,CAClB,EAAK,MAAM,CAAG,GAAG,CACpB,IAAI,EAAO,EAAK,KAAK,EACT,CAAA,KAAR,IACA,AAAQ,MAAR,GACA,EAAK,GAAG,GACR,EAAM,EAAK,GAAG,IAET,AAAQ,KAAR,GACL,EAAO,EAAE,CACT,EAAQ,EAAE,CACV,EAAO,EAAE,CACT,EAAM,GAED,EAAI,cAAc,CAAC,IAAU,AAAoB,UAApB,OAAO,CAAG,CAAC,EAAK,EAClD,EAAK,IAAI,CAAC,GACV,EAAM,CAAG,CAAC,EAAK,CACf,EAAK,IAAI,CAAC,IAGV,EAAM,IAAI,CAAC,GAEnB,CACA,GAAI,EAAQ,CAER,IADA,IAAI,EAAI,AAAU,QAAV,EAAmB,EAAI,EACxB,EAAM,MAAM,CAAG,GAClB,EAAM,CAAG,CAAC,EAAM,KAAK,GAAG,CAAG,CAAC,EAEhC,IAAI,CAAC,MAAM,CAAC,EAChB,CACA,MAAO,CACH,MAAQ,EACR,IAAQ,EACR,KAAQ,EACR,MAAQ,EACR,KAAQ,EAAK,MAAM,CAAC,GAAO,IAAI,CAAC,IACpC,CACJ,CAEA,cAAc,CAAI,CAAE,CAChB,IAAI,EAAO,IAAI,CAAC,mBAAmB,CAAC,EACpC,QAAO,EAAK,GAAG,CAAC,EAAK,KAAK,CAAC,IAAI,CAAC,KAAK,CACrC,IAAI,CAAC,MAAM,CAAC,EAAK,KAAK,CAC1B,CAIA,iBAAiB,CAAI,CAAE,CACnB,EAAO,EAAK,OAAO,CAAC,YAAa,IAAI,KAAK,CAAC,SAE3C,IADA,IAAI,EAAM,EAAE,CACL,EAAK,MAAM,CAAG,GAAG,CACpB,IAAI,EAAI,EAAK,KAAK,EACT,CAAA,KAAL,IACI,AAAK,MAAL,EACA,EAAI,GAAG,GACA,AAAK,KAAL,EACP,EAAM,EAAE,CAER,EAAI,IAAI,CAAC,GAGrB,CACA,OAAO,EAAI,IAAI,CAAC,IACpB,CAEA,YAAY,CAAI,CAAE,CAAI,CAAE,CACpB,GAAI,CACA,IAAI,CAAC,kBAAkB,CAAC,GACxB,EAAK,CAAA,EACT,CAAE,MAAM,EAAI,CACR,EAAK,KACT,CACJ,CAEA,mBAAmB,CAAI,CAAE,CAAO,CAAE,CAAI,CAAE,CACpC,IAAI,EAAO,IAAI,CAAC,kBAAkB,CAAC,EAAM,GACzC,EAAK,EAAM,EACf,CAEA,mBAAmB,CAAI,CAAE,CAAO,CAAE,CAAK,CAAE,CAAI,CAAE,CACvC,GAAS,AAAC,CAAA,IAAI,CAAC,kBAAkB,CAAC,EAAM,CAAA,IAAS,EAAA,GAAO,EACxD,EAAK,OAEL,IAAI,CAAC,kBAAkB,CAAC,EAAM,GAC9B,EAAK,GAEb,CAEA,gBAAgB,CAAO,CAAE,CAAI,CAAE,CAC3B,IAAI,EAAO,IAAI,CAAC,mBAAmB,CAAC,EAAS,CAAA,GAE7C,GADA,EAAU,EAAK,IAAI,CAAC,IAAI,CAAC,KACrB,EAAM,CACN,IAAI,EAAQ,CAAC,EACb,IAAK,IAAI,KAAK,EAAK,GAAG,CACd,OAAO,MAAM,CAAC,EAAK,GAAG,CAAE,IACxB,CAAA,CAAK,CAAC,EAAE,CAAG,CACP,KAAO,EACP,KAAO,EAAU,IAAM,EACvB,KAAO,AAAsB,UAAtB,OAAO,EAAK,GAAG,CAAC,EAAE,CAAe,UAAY,WACxD,CAAA,EAGR,EAAK,EACT,MACI,EAAK,KAEb,CAEA,cAAc,CAAI,CAAE,CAAI,CAAE,CACtB,IAAI,CAAC,aAAa,CAAC,GACnB,GACJ,CAEA,YAAY,CAAG,CAAE,CAAI,CAAE,CACnB,EAAK,EACT,CAEA,gBAAiB,CACb,MAAO,CAAC,CAAC,IAAI,CAAC,eAAe,AACjC,CAEA,kBAAmB,CACf,MAAO,CAAC,CAAC,IAAI,CAAC,iBAAiB,AACnC,CAEA,eAAgB,CACZ,IAAI,CAAC,cAAc,CAAG,CAAA,CAC1B,CAEA,WAAW,CAAS,CAAE,OAClB,CAAI,IAAI,CAAC,gBAAgB,KAErB,GACA,IAAI,CAAC,iBAAiB,CAAG,IAAI,CAAC,gBAAgB,EAAI,EAAE,CACpD,IAAI,CAAC,gBAAgB,CAAG,MAExB,IAAI,CAAC,iBAAiB,CAAG,EAAE,CACxB,CAAA,EACX,CAEA,WAAY,CACJ,IAAI,CAAC,iBAAiB,GACtB,IAAI,CAAC,gBAAgB,CAAG,IAAI,CAAC,iBAAiB,CAC9C,IAAI,CAAC,iBAAiB,CAAG,KAEjC,CAEA,cAAe,CACX,OAAO,IAAI,CAAC,gBAAgB,AAChC,CAEA,WAAY,CACR,OAAa,CAKT,GAJI,IAAI,CAAC,YAAY,EAAI,IAAI,CAAC,eAAe,CAAC,MAAM,GAChD,IAAI,CAAC,aAAa,GAClB,IAAI,CAAC,YAAY,CAAG,GAEpB,AAAsB,GAAtB,IAAI,CAAC,aAAa,EAAS,IAAI,CAAC,cAAc,CAAE,CAChD,IAAI,CAAC,aAAa,CAAG,EACrB,IAAI,CAAC,YAAY,CAAG,EACpB,IAAI,CAAC,eAAe,CAAG,KACvB,MACJ,CACA,IAAI,EAAK,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAChD,IAAI,CAAC,eAAe,CAAC,GACrB,IAAI,CAAC,YAAY,EACrB,CACJ,CAEA,SAAS,CAAK,CAAE,CAAK,CAAE,CACnB,GAAI,IAAI,CAAC,gBAAgB,GACrB,MAAO,CAAA,CACX,CAAA,IAAI,CAAC,cAAc,CAAG,CAAA,EACtB,IAAI,CAAC,eAAe,CAAG,EACvB,IAAI,CAAC,YAAY,CAAG,EACpB,IAAI,CAAC,aAAa,CAAG,EACrB,IAAI,EAAO,IAAI,CAEf,OADA,WAAW,WAAa,EAAK,SAAS,EAAI,EAAG,GACtC,CAAA,CACX,CAEA,gBAAgB,CAAE,CAAE,CAEhB,IAAI,EAAS,AADD,IAAI,CAAC,aAAa,CACX,MAAM,CAKzB,OAHI,IAAI,CAAC,iBAAiB,EACtB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,GAEzB,EAAO,eAAe,CAAC,EAClC,CAEA,CAAC,CAAkB,CAAG,IAAK,AAC3B,CAAA,aAAa,CAAA,KACT,EAAO,MAAA,CAAA,KACP,CAAI,CAAA,OACJ,EAAS,CAAA,CAAA,CAAA,QACT,EAAU,CAAA,CAAA,CAAA,QACV,CAAO,CACV,CAAE,CACC,IAAI,EAAQ,IAAI,CAAC,OAAO,EAAK,CAAA,IAAI,CAAC,OAAO,CAAG,IAAI,CAAU,EACtD,EAAK,EAAM,UAAU,GACzB,EAAM,SAAS,CAAC,EAAS,cACpB,IACD,EAAG,KAAK,CAAC,cAAc,CAAC,QACxB,EAAG,KAAK,CAAC,cAAc,CAAC,OACxB,EAAG,KAAK,CAAC,cAAc,CAAC,UACxB,EAAG,KAAK,CAAC,cAAc,CAAC,SACxB,EAAG,KAAK,CAAC,cAAc,CAAC,cAEvB,GACD,CAAA,EAAO,AAAA,EAAI,UAAU,CAAC,EAD1B,EAGA,EAAM,UAAU,CAAC,GACb,EACA,IAAI,CAAC,aAAa,CAAC,EAAM,UAAU,IAEnC,IAAI,CAAC,GAAG,CAAC,GAEb,aAAa,IAAI,CAAC,CAAC,CAAkB,EACjC,GACA,CAAA,IAAI,CAAC,CAAC,CAAkB,CAAG,WAAW,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,EAAG,EAD7E,CAGJ,CAEA,mBAAoB,CACZ,IAAI,CAAC,OAAO,EACZ,IAAI,CAAC,OAAO,CAAC,UAAU,GAAG,MAAM,EAExC,CAEA,mBAAoB,CAChB,OAAO,IAAI,CAAC,UAAU,GAAG,iBAAiB,EAC9C,CAEA,cAAc,CAAE,CAAE,CACd,EAAG,KAAK,CAAC,UAAU,CAAG,SACtB,AAAA,EAAI,QAAQ,CAAC,EAAI,kBACjB,IAAI,CAAC,GAAG,CAAC,GACT,IAAI,EAAQ,IAAI,CAAC,UAAU,GAAG,qBAAqB,GAE/C,EAAO,AADC,IAAI,CAAC,aAAa,CAAC,eAAe,GAC7B,qBAAqB,GAClC,EAAc,CAAE,EAAI,AAAA,CAAA,EAAK,IAAI,CAAG,EAAK,KAAK,AAAL,EAAS,EAC9B,EAAI,AAAA,CAAA,EAAK,GAAG,CAAG,EAAK,MAAM,AAAN,EAAU,CAAE,EAChD,EAAe,CAAE,EAAI,AAAA,CAAA,EAAM,IAAI,CAAG,EAAM,KAAK,AAAL,EAAS,EAChC,EAAI,AAAA,CAAA,EAAM,GAAG,CAAG,EAAM,MAAM,AAAN,EAAU,CAAE,CACnD,CAAA,EAAY,CAAC,CAAG,EAAa,CAAC,CAC1B,EAAY,CAAC,CAAG,EAAa,CAAC,EAC9B,AAAA,EAAI,QAAQ,CAAC,EAAI,kBACjB,EAAG,KAAK,CAAC,SAAS,CAAG,CAAC,0BAA0B,EAAE,EAAK,MAAM,CAAG,EAAE,IAAI,CAAC,GAEvE,AAAA,EAAI,QAAQ,CAAC,EAAI,iBACjB,EAAG,KAAK,CAAC,SAAS,CAAG,CAAC,8BAA8B,EAAE,EAAK,MAAM,CAAG,EAAE,IAAI,CAAC,EAG3E,EAAY,CAAC,CAAG,EAAa,CAAC,EAC9B,AAAA,EAAI,QAAQ,CAAC,EAAI,kBACjB,EAAG,KAAK,CAAC,SAAS,CAAG,CAAC,aAAa,EAAE,EAAK,MAAM,CAAG,EAAE,GAAG,CAAC,GAEzD,AAAA,EAAI,QAAQ,CAAC,EAAI,iBACjB,EAAG,KAAK,CAAC,SAAS,CAAG,CAAC,iBAAiB,EAAE,EAAK,MAAM,CAAG,EAAE,GAAG,CAAC,EAGrE,EAAG,KAAK,CAAC,IAAI,CAAI,EAAY,CAAC,CAAG,EAAM,IAAI,CAAI,KAC/C,EAAG,KAAK,CAAC,GAAG,CAAI,EAAY,CAAC,CAAG,EAAM,GAAG,CAAI,KAC7C,EAAG,KAAK,CAAC,cAAc,CAAC,aAC5B,CACJ,CW9qBO,MAAM,EAET,YAAY,CAAA,OACR,EAAS,IAAA,CAAA,KACT,EAAO,CAAA,CAAA,IACP,EAAM,CAAA,CACT,CAAG,CAAC,CAAC,CAAE,CACJ,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,IAAI,CAAG,EACZ,IAAI,CAAC,GAAG,CAAG,CACf,CAEA,SAAU,CACN,EAAE,IAAI,CAAC,GAAG,AACd,CAEA,SAAU,CACN,EAAE,IAAI,CAAC,GAAG,AACd,CAEA,UAAW,CACP,EAAE,IAAI,CAAC,IAAI,CACX,IAAI,CAAC,GAAG,CAAG,CACf,CAEA,UAAW,CACP,EAAE,IAAI,CAAC,IAAI,CACX,IAAI,CAAC,GAAG,CAAG,CACf,CAEA,KAAK,EAAI,CAAC,CAAE,CACR,GAAI,IAAI,CAAC,IAAI,CAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,CACrC,IAAI,EAAM,IAAI,CAAC,GAAG,CAAG,EACjB,EAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CACtC,GAAI,EAAM,EAAK,MAAM,CAAE,OAAO,EAAK,MAAM,CAAC,GAC1C,GAAI,GAAO,EAAK,MAAM,CAAE,MAAO,IACnC,CACJ,CAEA,MAAO,CACH,IAAI,EAAK,IAAI,CAAC,IAAI,GAClB,IAAI,CAAC,OAAO,GACR,IAAI,CAAC,GAAG,CAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,EAC7C,IAAI,CAAC,QAAQ,GACjB,IAAI,EAAO,IAAI,CAAC,MAAM,CACtB,GAAI,GACI,CAAA,IAAI,CAAC,IAAI,CAAG,EAAK,IAAI,EACjB,IAAI,CAAC,IAAI,EAAI,EAAK,IAAI,EAAI,IAAI,CAAC,GAAG,EAAI,EAAK,GAAG,AAAH,EAE/C,MADA,IAAI,CAAC,MAAM,CAAG,KACR,EAAK,IAAI,EAAI,IAAI,CAAC,GAAG,CAGnC,OAAO,CACX,CAEA,SAAS,EAAM,IAAI,CAAC,IAAI,CAAE,CACtB,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAI,AAChC,CAEA,gBAAgB,EAAM,IAAI,CAAC,IAAI,CAAE,CAC7B,MAAO,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAK,CAAC,EAAE,CAAC,MAAM,AACpD,CAEA,UAAU,CAAI,CAAE,CACZ,IAAI,EAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QACtC,AAAI,aAAgB,OACT,EAAK,IAAI,CAAC,EAAK,MAAM,CAAC,IAAI,CAAC,GAAG,GAE9B,EAAK,MAAM,CAAC,IAAI,CAAC,GAAG,CAAE,EAAK,MAAM,GAAK,CAErD,CAEA,WAAW,CAAG,CAAE,CAGZ,OAFW,MAAP,GACA,CAAA,EAAM,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,GAAG,CAAA,EACpD,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,EAAG,EAC3C,CAEA,UAAU,CAAG,CAAE,CAGX,OAFW,MAAP,GACA,CAAA,EAAM,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,GAAG,CAAA,EACpD,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,EACxC,CAEA,UAAU,CAAK,CAAE,CAAG,CAAE,CAClB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,SAAS,CAAC,EAAO,EAClD,CAEA,OAAO,CAAK,CAAE,CAAG,CAAE,CACf,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC,EAAO,EAC/C,CAEA,KAAM,CACF,OAAO,IAAI,CAAC,GAAG,EAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,AACzD,CAEA,KAAM,CACF,IAAI,EAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAE,EAAI,IAAI,CAAC,IAAI,CAC9C,OAAO,GAAK,GAAK,GAAK,EAAI,GAAK,IAAI,CAAC,GAAG,EAC3C,CAEA,OAAO,CAAI,CAAE,CAAG,CAAE,EAAO,IAAI,CAAC,GAAG,CAAE,CAC/B,IAAI,CAAC,MAAM,CAAG,CAAE,KAAA,EAAM,IAAA,EAAK,KAAA,CAAK,CACpC,CAEA,QAAS,CACL,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,AAClC,CAEA,WAAW,CAAI,CAAE,CAGb,OAFY,MAAR,GACA,CAAA,EAAO,IAAI,CAAC,IAAI,AAAJ,EACT,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,EAAK,CAAC,MAAM,AACxC,CAEA,MAAO,CACH,MAAO,CAAE,OAAQ,IAAI,CAAC,MAAM,CAAE,KAAM,IAAI,CAAC,IAAI,CAAE,IAAK,IAAI,CAAC,GAAG,AAAC,CACjE,CAEA,QAAQ,CAAK,CAAE,CACX,IAAI,CAAC,MAAM,CAAG,EAAM,MAAM,CAC1B,IAAI,CAAC,IAAI,CAAG,EAAM,IAAI,CACtB,IAAI,CAAC,GAAG,CAAG,EAAM,GAAG,AACxB,CAEA,WAAY,CACR,GAAI,IAAI,CAAC,GAAG,GAAI,MAAM,IAAI,CAAC,GAAG,CAC9B,GAAI,IAAI,CAAC,GAAG,GAAI,MAAM,IAAI,CAAC,GAAG,CAC9B,IAAI,EAAO,IAAI,CAAC,MAAM,CACtB,GAAI,GACI,CAAA,IAAI,CAAC,IAAI,CAAG,EAAK,IAAI,EACjB,IAAI,CAAC,IAAI,EAAI,EAAK,IAAI,EAAI,IAAI,CAAC,GAAG,EAAI,EAAK,GAAG,AAAH,EAE/C,MADA,IAAI,CAAC,MAAM,CAAG,KACR,EAAK,IAAI,EAAI,IAAI,CAAC,GAAG,AAGvC,CAEA,SAAU,CACN,KAAO,EAAoB,aAAa,CAAC,IAAI,CAAC,IAAI,KAC9C,IAAI,CAAC,IAAI,EACjB,CAEJ,CAEA,EAAa,SAAS,CAAC,GAAG,CAAG,CAAC,EAC9B,EAAa,SAAS,CAAC,GAAG,CAAG,CAAC,CAEvB,OAAM,EAET,YAAY,CAAA,OACR,EAAS,IAAA,CAAA,KACT,EAAO,CAAA,CAAA,IACP,EAAM,CAAA,CAAA,IACN,EAAM,IAAA,CACT,CAAG,CAAC,CAAC,CAAE,CAMJ,GALA,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,IAAI,CAAG,EACZ,IAAI,CAAC,GAAG,CAAG,EACX,IAAI,CAAC,GAAG,CAAG,EAEP,AAAY,MAAZ,IAAI,CAAC,GAAG,CACR,IAAI,CAAC,GAAG,CAAG,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAE,IAAI,CAAC,GAAG,MACzD,CACH,IAAI,EAAK,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC,GAAG,CAC/C,CAAA,IAAI,CAAC,IAAI,CAAG,EAAG,GAAG,CAClB,IAAI,CAAC,GAAG,CAAG,EAAG,GAAG,AACrB,CACJ,CAEA,OAAO,cAAc,CAAE,CAAE,CACrB,OAAQ,GACN,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,KACL,IAAK,SACL,IAAK,SACL,IAAK,IACH,MAAO,CAAA,CACX,CACJ,CAEA,MAAO,CACH,IAAI,EAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CACpB,EAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QACvB,AAAI,AAAQ,MAAR,EAAqB,KACrB,IAAI,CAAC,GAAG,EAAI,EAAK,MAAM,CAChB,IAAI,CAAC,IAAI,EAAI,EAAE,MAAM,CAAG,EAAI,KAAO,KACvC,EAAK,MAAM,CAAC,IAAI,CAAC,GAAG,CAC/B,CAEA,MAAO,CACH,IAAI,EAAK,IAAI,CAAC,IAAI,GASlB,OARI,IACA,EAAE,IAAI,CAAC,GAAG,CACV,EAAE,IAAI,CAAC,GAAG,CACN,IAAI,CAAC,GAAG,CAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAC7C,IAAI,CAAC,GAAG,CAAG,EACX,EAAE,IAAI,CAAC,IAAI,GAGZ,CACX,CAEA,WAAW,CAAI,CAAE,CAEb,IADA,IAAc,EAAV,EAAM,GACF,AAAA,CAAA,EAAK,IAAI,CAAC,IAAI,EAAA,GAAO,EAAK,IAC9B,GAAO,IAAI,CAAC,IAAI,GACpB,OAAO,CACX,CAEA,SAAU,CACN,OAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,aAAa,CAC7C,CAEA,WAAW,CAAI,CAAE,CACb,IAAI,EAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QACtC,AAAI,aAAgB,OACT,EAAK,IAAI,CAAC,EAAK,MAAM,CAAC,IAAI,CAAC,GAAG,GAE9B,EAAK,MAAM,CAAC,IAAI,CAAC,GAAG,CAAE,EAAK,MAAM,GAAK,CAErD,CAEJ,CAEA,EAAoB,SAAS,CAAC,aAAa,CAAG,EAAoB,aAAa,CAE/E,IAAI,EAAY,OAAO,MAAM,CAAC,KAEvB,OAAM,UAAwB,EAEjC,OAAO,OAAO,CAAI,CAAE,CAAI,CAAE,CACtB,CAAS,CAAC,EAAK,WAAW,GAAG,CAAG,CACpC,CAEA,YAAY,CAAA,OAAE,CAAM,CAAA,KAAE,CAAI,CAAE,CAAE,CAC1B,KAAK,GAEc,UAAf,OAAO,GACP,CAAA,EAAO,CAAS,CAAC,EAAK,WAAW,GAAG,AAAH,EAGrC,IAAI,CAAC,MAAM,CAAG,EACd,IAAI,CAAC,IAAI,CAAG,CAChB,CAEA,OAAQ,CACJ,IAAI,CAAC,MAAM,CAAG,IAAI,EAAa,CAAE,OAAQ,IAAI,CAAC,MAAM,AAAC,GACrD,IAAI,CAAC,SAAS,CAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAE,IAAI,EAC5C,IAAI,CAAC,OAAO,CAAG,EAAE,CACjB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAG,IAAI,CAAC,SAAS,CAAC,IAAI,GACtC,IAAI,CAAC,WAAW,CAAG,KACnB,IAAI,CAAC,KAAK,EACd,CAEA,MAAO,CACH,aAAa,IAAI,CAAC,WAAW,CACjC,CAEA,YAAY,CAAI,CAAE,CAAO,CAAE,CACvB,OAAO,CAAS,CAAC,EAAK,CAAC,IAAI,CAAC,MAAM,CAAE,IAAI,CAAE,EAC9C,CAEA,aAAa,CAAC,CAAE,CACH,MAAL,GACA,CAAA,EAAI,KAAK,KAAK,CAAC,EAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAK,KAAO,GADrD,EAGA,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,sBAAuB,EACtD,CAEA,OAAQ,CACJ,IAAI,CAAC,IAAI,GACT,IAAI,EAAS,IAAI,CAAC,MAAM,CAAE,EAAG,EAAI,IAAI,CAAC,OAAO,CAE7C,IADA,EAAO,IAAI,CAAG,EAAE,MAAM,CACf,CAAE,CAAA,EAAI,CAAC,CAAC,EAAO,IAAI,CAAC,AAAD,GACtB,EAAO,QAAQ,GACnB,EAAO,QAAQ,GACf,EAAI,IACJ,IAAI,EAAO,KACP,IAAI,CAAC,MAAM,CAAC,cAAc,GAC1B,IAAI,EAAI,IAER,OACI,GAAI,CACA,OAAa,EAAE,IAAI,EACvB,CACA,MAAM,EAAI,CACN,GAAI,IAAO,EAAO,GAAG,CAGjB,CAAA,GAFA,CAAC,CAAC,EAAO,IAAI,CAAC,CAAG,EAAE,IAAI,GACvB,EAAO,QAAQ,GACV,AAAO,GAAP,EAAE,EAAQ,CACX,IAAI,CAAC,MAAM,CAAC,aAAa,GACzB,IAAI,CAAC,WAAW,CAAG,WAAW,EAAM,IACpC,MACJ,CAAA,MAEC,GAAI,IAAO,EAAO,GAAG,CAAE,CACxB,CAAC,CAAC,EAAO,IAAI,CAAC,CAAG,EAAE,IAAI,GACvB,IAAI,CAAC,MAAM,CAAC,aAAa,GACzB,KACJ,MACK,MAAM,CACf,CAGR,EACA,GACJ,CAEA,gBAAgB,CAAG,CAAE,CACjB,IAAI,CAAC,QAAQ,CAAC,EAClB,CAEA,gBAAgB,CAAG,CAAE,CACjB,IAAI,CAAC,QAAQ,CAAC,EAClB,CAEA,QAAQ,CAAI,CAAE,CAAE,CAAE,CAAE,CAAE,CAAI,CAAE,CACxB,IAAI,CAAC,SAAS,CAAC,eAAgB,EAAM,EAAI,EAAI,EACjD,CAEA,iBAAiB,CAAG,CAAE,CAAG,CAAE,CACvB,IAAI,CAAC,IAAI,GACT,IAAI,EAAS,IAAI,CAAC,MAAM,CAAE,EAAG,EAAI,IAAI,CAAC,OAAO,CAE7C,IADA,EAAO,IAAI,CAAG,EAAM,EACb,CAAE,CAAA,EAAI,CAAC,CAAC,EAAO,IAAI,CAAC,AAAD,GACtB,EAAO,QAAQ,GACnB,EAAO,QAAQ,GACJ,MAAP,GACA,EAAO,MAAM,CAAC,EAAK,GAEvB,EAAI,IACJ,GAAI,CAEA,IADA,IAAI,CAAC,MAAM,CAAC,cAAc,KACb,CACT,GAAI,AAAO,MAAP,GAAe,EAAO,IAAI,EAAI,EAC9B,OAAO,EAEX,GAAI,CACA,OAAa,EAAE,IAAI,EACvB,CAAE,MAAM,EAAI,CACR,GAAI,IAAO,EAAO,GAAG,CACjB,CAAC,CAAC,EAAO,IAAI,CAAC,CAAG,EAAE,IAAI,GACvB,EAAO,QAAQ,QAEd,GAAI,IAAO,EAAO,GAAG,CACtB,OAAO,OAGP,MAAM,CAEd,CACJ,CACJ,QAAU,CACN,IAAI,CAAC,MAAM,CAAC,aAAa,GACrB,EAAO,IAAI,CAAG,EAAO,MAAM,IAC3B,CAAA,IAAI,CAAC,WAAW,CAAG,WAAW,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAE,EAAO,IAAI,EAAG,GADtE,CAEJ,CACJ,CAEA,YAAa,CAET,OADA,IAAI,CAAC,QAAQ,CAAC,GACP,IAAI,CAAC,aAAa,EAC7B,CAEA,eAAgB,CAEZ,OADA,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,IACjC,IAAI,CAAC,aAAa,EAC7B,CAEA,eAAgB,CACZ,OAAO,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,GAC3B,CAEA,eAAe,CAAG,CAAE,CAAM,CAAE,CACxB,IAAI,EAAI,IAAI,CAAC,gBAAgB,CAAC,GAC9B,GAAI,GAAK,EAAE,WAAW,YAAY,SAC9B,OAAO,EAAE,WAAW,CAAC,EAC7B,CAEA,SAAS,CAAG,CAAE,CACN,IAAI,CAAC,OAAO,CAAC,MAAM,CAAG,GAAK,CAAA,IAAI,CAAC,OAAO,CAAC,MAAM,CAAG,CAArD,CACJ,CAEJ,CAEO,SAAS,EAAc,CAAE,CAAE,CAAE,EAChC,MAAS,AAAA,CAAA,EAAG,GAAG,EAAI,EAAG,IAAG,AAAH,EAAS,CAAA,EAAG,GAAG,EAAI,EAAG,IAAI,AAAJ,EACtC,GACA,AAAC,CAAA,EAAG,GAAG,EAAI,EAAG,IAAI,AAAJ,EAAS,CAAA,EAAG,GAAG,EAAI,EAAG,IAAG,AAAH,EACpC,EACA,AAAC,CAAA,EAAG,GAAG,EAAI,EAAG,EAAE,AAAF,EAAO,CAAA,EAAG,GAAG,EAAI,EAAG,EAAC,AAAD,CAC5C,CAEO,SAAS,EAAM,CAAG,EACrB,IAAI,EAAK,EAAI,OAAO,CAAC,YAAY,CAGjC,MAFA,CAAA,EAAK,aAAc,SAAW,IAAO,CAArC,GACQ,CAAA,EAAK,IAAI,EAAG,CAAC,IAAI,CAAC,EAAN,EACb,CACX,CAEO,SAAS,EAAY,CAAK,CAAE,CAAI,EACnC,OAAO,AAAA,GAAM,EAAE,MAAM,EACR,AAAQ,SAAR,GAAmB,EAAE,KAAK,CACtB,AAA8D,EAA9D,EAAc,CAAE,KAAM,EAAE,KAAK,CAAC,EAAE,CAAE,IAAK,EAAE,KAAK,CAAC,EAAE,AAAC,EAAG,IAC9C,EAAc,CAAE,KAAM,EAAE,KAAK,CAAC,EAAE,CAAE,IAAK,EAAE,KAAK,CAAC,EAAE,AAAC,EAAG,IAAU,EAExE,AAAQ,SAAR,GAAmB,EAAE,KAAK,CACxB,AAA+D,GAA/D,EAAc,CAAE,KAAM,EAAE,KAAK,CAAC,EAAE,CAAE,IAAK,EAAE,KAAK,CAAC,EAAE,AAAC,EAAG,IAC9C,EAAc,CAAE,KAAM,EAAE,KAAK,CAAC,EAAE,CAAE,IAAK,EAAE,KAAK,CAAC,EAAE,AAAC,EAAG,IAAU,EAGtE,AAA0B,EAA1B,EAAc,EAAG,IACV,EAAc,EAAE,MAAM,CAAE,IAAU,CAE9D,CC/YA,AAAA,EAAa,WAAW,CAAC,CAErB,aAAc,AAAA,EAAkB,IAAK,SAAS,CAAC,EAE3C,OADS,MAAL,GAAW,CAAA,EAAI,CAAA,EACZ,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,KAAK,GAAK,EAChD,GAEA,cAAe,AAAA,EAAkB,IAAK,SAAS,CAAC,EAE5C,OADS,MAAL,GAAW,CAAA,EAAI,CAAA,EACZ,IAAI,CAAC,GAAG,CAAC,eAAgB,CAAC,EACrC,GAEA,aAAc,AAAA,EAAkB,IAAK,SAAS,CAAC,EAClC,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAI,EAAK,IAAI,CAAC,OAAO,CAChB,4BAA4B,IAAI,CAAC,IAAI,CAAC,eAAe,GACtD,IAAI,CAAC,IAAI,CAAC,8BAA+B,EAAG,GAAG,EAEnD,IAAI,EAAM,IAAI,CAAC,GAAG,CAAC,YACA,IAAI,CAAC,iBAAiB,CAAC,EAAG,GAAG,CAAG,EACT,KAAK,GAAG,CAAC,EAAG,GAAG,CACN,IAAI,CAAC,IAAI,CAAC,kCAG7D,OAFK,GACD,IAAI,CAAC,IAAI,CAAC,8BAA+B,EAAG,GAAG,EAC5C,CACX,GAEA,cAAe,AAAA,EAAkB,IAAK,SAAS,CAAC,EAE5C,OADS,MAAL,GAAW,CAAA,EAAI,CAAA,EACZ,IAAI,CAAC,GAAG,CAAC,eAAgB,CAAC,EACrC,GAEA,mBAAoB,AAAA,EAAkB,IAAK,SAAS,CAAM,SAEtD,AAAI,IAAI,CAAC,GAAG,CAAC,wBADJ,EAAS,iBAAmB,WAEjC,IAAI,CAAC,GAAG,CAAC,iBACF,CAAA,GACC,SACD,IAAI,CAAC,GAAG,CAAC,gBACxB,GAEA,oBAAqB,AAAA,EAAkB,IAAK,SAAS,CAAM,SAEvD,AAAI,IAAI,CAAC,GAAG,CAAC,yBADJ,EAAS,iBAAmB,WAEjC,IAAI,CAAC,GAAG,CAAC,gBACF,CAAA,GACC,SACD,IAAI,CAAC,GAAG,CAAC,sBACxB,GAEA,kBAAmB,AAAA,EAAkB,WACjC,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,GAC1E,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,EAAK,IAAI,CAAC,OAAO,CAAE,EAAO,IAAI,CAAC,IAAI,CAAC,EAAG,GAAG,CAAC,CAAE,EAAI,KAAK,IAAI,CAAC,GAC/D,GAAI,EACA,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAG,GAAG,CAAE,EAAE,KAAK,EAC3E,GAEA,iCAAkC,AAAA,EAAkB,WAChD,OAAO,IAAI,CAAC,GAAG,CAAC,wBAA0B,IAAI,CAAC,GAAG,CAAC,oBACvD,GAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,EAAK,IAAI,CAAC,OAAO,CACrB,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAG,GAAG,CAAE,IAAI,CAAC,IAAI,CAAC,EAAG,GAAG,CAAC,CAAC,MAAM,EACxF,GAEA,oBAAqB,AAAA,EAAkB,WACnC,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,EACjC,GAEA,cAAe,AAAA,EAAkB,WAC7B,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,WAAW,GACjD,GAEA,MAAO,WACH,OAAO,IAAI,CAAC,KAAK,IAAM,IAAI,CAAC,WAAW,EAC3C,EAEA,MAAO,WACH,OAAO,AAAgB,GAAhB,IAAI,CAAC,KAAK,EACrB,EAEA,MAAO,WACH,IAAI,EAAK,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,IAC1C,OAAO,EAAG,GAAG,EAAI,IAAI,CAAC,IAAI,CAAC,EAAG,IAAI,CAAC,CAAC,MAAM,AAC9C,EAEA,MAAO,WACH,OAAO,AAA4C,GAA5C,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,IAAI,GAAG,AACnD,EAEA,qBAAsB,AAAA,EAAkB,KAAM,SAAS,CAAC,EACpD,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CACtB,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAI,EAAM,IAAI,CAAC,KAAK,GAChB,EAAM,GACN,IAAI,CAAC,WAAW,CAAC,EAAM,EAAG,EAClC,CACJ,GAEA,YAAa,AAAA,EAAkB,KAAM,SAAS,CAAC,EAC3C,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CACtB,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,WAAW,CAAC,EAAK,EAAM,EAChC,CACJ,GAEA,kBAAmB,AAAA,EAAkB,KAAM,SAAS,CAAM,EACtD,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CAC/B,IAAI,EAAI,IAAI,CAAC,KAAK,GAClB,GAAI,IAAI,CAAC,GAAG,CAAC,qBAAsB,GAE/B,OADA,IAAI,CAAC,WAAW,CAAC,EAAG,IAAI,CAAC,KAAK,IACvB,CAAA,CAEf,CACJ,GAEA,2BAA4B,AAAA,EAAkB,KAAM,SAAS,CAAM,EAC/D,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CAC/B,IAAI,EAAI,IAAI,CAAC,KAAK,GAClB,GAAI,IAAI,CAAC,GAAG,CAAC,sBAAuB,GAEhC,OADA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,GAAI,GACxB,CAAA,CAEf,CACJ,GAEA,mBAAoB,AAAA,EAAkB,IAAK,SAAS,CAAQ,EACpD,GACA,IAAI,CAAC,GAAG,CAAC,gBACb,IAAI,CAAC,GAAG,CAAC,uBACT,IAAI,CAAC,GAAG,CAAC,8BACT,IAAI,CAAC,GAAG,CAAC,SAAU,IACvB,GAEA,mBAAoB,AAAA,EAAkB,IAAK,WACvC,IAAI,CAAC,UAAU,CAAC,GACX,IAAI,CAAC,YAAY,EAClB,IAAI,CAAC,aAAa,CAAC,MAC3B,GAEA,eAAgB,AAAA,EAAkB,WAC9B,IAAI,CAAC,kBAAkB,EAC3B,GAEA,oBAAqB,AAAA,EAAkB,KAAM,SAAS,CAAM,EACxD,IAAI,EAAK,IAAI,CAAC,gBAAgB,GAC1B,EAAK,EAAG,GAAG,CACX,EAAK,IAAI,CAAC,OAAO,CACrB,GAAI,AAAa,GAAb,EAAG,MAAM,EAAS,CAAC,EAAG,MAAM,EAAI,CAAC,EAAG,OAAO,CAAE,CAI7C,GAHA,IAAI,CAAC,qBAAqB,GACZ,MAAV,GACA,CAAA,EAAK,EAAG,MAAM,CAAC,EADnB,EAEI,IAAI,CAAC,aAAa,CAAE,CACpB,IAA8B,EAAO,AAA1B,IAAI,CAAC,IAAI,CAAC,EAAG,GAAG,CAAC,CAAc,MAAM,CAAG,EAAG,GAAG,CACrD,EAAO,GACP,IAAI,CAAC,GAAG,CAAC,cAAe,KAAK,GAAG,CAAC,EAAM,GAAU,GACzD,CAEA,OADA,IAAI,CAAC,GAAG,CAAC,SAAU,GACZ,CAAA,CACX,CACA,MAAO,CAAA,CACX,GAEA,QAAS,AAAA,EAAkB,KAAM,SAAS,CAAC,EAC9B,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAI,CAAC,qBAAqB,GAC1B,IAAI,CAAC,GAAG,CAAC,SAAU,KAAK,MAAM,CAAC,GACnC,GAEA,mBAAoB,AAAA,EAAkB,KAAM,SAAS,CAAC,EAC9C,EACA,IAAI,CAAC,GAAG,CAAC,UAAW,IAEpB,IAAI,CAAC,GAAG,CAAC,6BAA8B,CAAA,GACvC,IAAI,CAAC,GAAG,CAAC,WACT,IAAI,CAAC,GAAG,CAAC,eAEjB,GAEA,YAAa,AAAA,EAAkB,IAAK,SAAS,CAAO,EAChD,GAAK,IAAI,CAAC,SAAS,CAEZ,CACH,IAAI,EAAS,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,IAAI,EACjE,GAAI,AAAU,MAAV,EAAgB,CAChB,IAAI,EAAO,IAAI,CAAC,OAAO,GACvB,GAAI,CAAC,GAAW,KAAK,IAAI,CAAC,GAAO,CAC7B,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAM,IAAI,CAAC,KAAK,GAAK,EAAG,GAAG,CAC3B,EAAK,aAAa,IAAI,CAAC,EAAK,CAAC,EAAE,CAAC,MAAM,AACtC,CAAA,EAAK,EACL,IAAI,CAAC,WAAW,CAAC,EAAK,EAAM,EAAK,GAC1B,EAAS,GAChB,IAAI,CAAC,WAAW,CAAC,IAAI,MAAM,CAAC,EAAS,GAAK,GAE1C,EAAG,GAAG,EAAI,GACV,IAAI,CAAC,GAAG,CAAC,YAAa,EAAM,EAEpC,CACJ,CACJ,MAnBI,IAAI,CAAC,GAAG,CAAC,SAAU,IAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,gBAoBhD,GAEA,cAAe,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACrD,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,EAAI,IAAI,CAAC,YAAY,CAAC,GAE1B,IADA,IAAI,CAAC,GAAG,CAAC,YAAa,GACf,IAAI,CAAC,KAAK,GAAK,EAAE,WAAW,KAC/B,IAAI,CAAC,GAAG,CAAC,cAAe,CAAA,GACxB,IAAI,CAAC,GAAG,CAAC,qBACJ,IAAI,CAAC,GAAG,CAAC,mBAGlB,EAAE,OAAO,EACb,EACJ,GAEA,YAAa,SAAS,CAAG,EACrB,OAAO,IAAI,CAAC,YAAY,CAAC,EAC7B,EAEA,WAAY,WACR,OAAO,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAE,UACvC,EAEA,aAAc,WACV,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAE,UACzC,EAEA,eAAgB,AAAA,EAAkB,YAAa,SAAS,CAAG,CAAE,CAAK,EAC9D,IAAI,EAAO,IAAI,CAAC,OAAO,GAAI,EAAQ,IAAI,CAAC,KAAK,GACzC,IAAI,CAAC,IAAI,CAAC,sBACV,EAAO,EAAK,WAAW,GACvB,EAAM,EAAI,WAAW,IAEzB,IAAI,EAAM,EAAK,OAAO,CAAC,EAAK,GAC5B,GAAI,GAAO,GAAM,CAAA,AAAS,MAAT,GAAiB,GAAO,CAAA,EACrC,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,EAAM,EAAI,MAAM,CAErD,GAEA,gBAAiB,AAAA,EAAkB,qBAAsB,SAAS,CAAG,CAAE,CAAK,EACxE,IAAI,EAAO,IAAI,CAAC,OAAO,GAAI,EAAQ,IAAI,CAAC,KAAK,GACzC,IAAI,CAAC,IAAI,CAAC,sBACV,EAAO,EAAK,WAAW,GACvB,EAAM,EAAI,WAAW,IAEzB,IAAI,EAAM,EAAK,WAAW,CAAC,EAAK,GAGhC,GAFI,GAAO,GACP,CAAA,EAAM,EAAK,WAAW,CAAC,EAAK,EAAQ,EADxC,EAEI,GAAO,GAAK,GAAO,GAAU,CAAA,AAAS,MAAT,GAAiB,GAAO,CAAA,EACrD,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,EAErC,GAEA,YAAa,SAAS,CAAE,EACpB,GAAI,CAAE,CAAA,aAAc,MAAA,EAAS,CACzB,IAAI,EAAY,CAAC,IAAI,CAAC,IAAI,CAAC,oBAC3B,GAAI,CACA,EAAK,IAAI,OAAO,EAAI,EAAY,IAAM,KAC1C,CAAE,MAAM,EAAI,CACR,MAAM,IAAI,EAAgB,iBAC9B,CACJ,CACA,OAAO,CACX,EAEA,sBAAuB,AAAA,EAAkB,mBAAoB,SAAS,CAAE,EAEpE,IAAI,EAAM,AADV,CAAA,EAAK,IAAI,CAAC,GAAG,CAAC,cAAe,EAA7B,EACa,SAAS,CAAG,IAAI,CAAC,KAAK,GAC/B,EAAI,EAAG,IAAI,CAAC,IAAI,CAAC,OAAO,IAC5B,GAAI,GAAK,EAAG,SAAS,EAAI,EAIrB,OAHA,EAAE,KAAK,CAAG,EAAG,SAAS,CACtB,IAAI,CAAC,SAAS,CAAG,EACjB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAG,SAAS,EAC3B,CAAA,CAEf,GAEA,uBAAwB,AAAA,EAAkB,4BAA6B,SAAS,CAAE,EAC9E,EAAK,IAAI,CAAC,GAAG,CAAC,cAAe,GAC7B,IAAI,EAAI,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,OAAO,GAAI,EAAI,IAAI,CAAC,KAAK,IAC7D,GAAI,GAAK,EAAE,KAAK,EAAI,IAAI,CAAC,KAAK,GAE1B,OADA,IAAI,CAAC,GAAG,CAAC,YAAa,EAAE,KAAK,EACtB,CAAA,CAEf,GAEA,aAAc,AAAA,EAAoB,WAE9B,IADA,IAAI,EAAc,IAAI,CAAC,IAAI,CAAC,eAAgB,EAAM,CAAA,EAC3C,CAAC,GAAO,CAAC,EAAY,IAAI,CAAC,IAAI,CAAC,MAAM,KACnC,IAAI,CAAC,GAAG,CAAC,iBACV,CAAA,EAAM,CAAA,CAFd,EAGA,KAAO,CAAC,GAAO,EAAY,IAAI,CAAC,IAAI,CAAC,MAAM,KAClC,IAAI,CAAC,GAAG,CAAC,iBACV,CAAA,EAAM,CAAA,CAFd,CAGJ,GAEA,cAAe,AAAA,EAAoB,WAE/B,IADA,IAAI,EAAc,IAAI,CAAC,IAAI,CAAC,eAAgB,EAAM,CAAA,EAC3C,CAAC,GAAO,CAAC,EAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MACpC,IAAI,CAAC,GAAG,CAAC,kBACV,CAAA,EAAM,CAAA,CAFd,EAGA,KAAO,CAAC,GAAO,EAAY,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MACnC,IAAI,CAAC,GAAG,CAAC,kBACV,CAAA,EAAM,CAAA,CAFd,CAGJ,GAEA,kBAAmB,AAAA,EAAoB,WACnC,IAAI,EAAK,IAAI,CAAC,IAAI,CAAC,wBACnB,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,GAAG,CAAC,iBACL,IAAI,CAAC,GAAG,CAAC,aAAc,IACvB,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,GAAG,CAAC,cAE/B,IAAI,CAAC,GAAG,CAAC,wBAAyB,GAClC,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,GAAG,CAAC,mBAAqB,GAEpD,IAAI,CAAC,GAAG,CAAC,gBAEjB,GAEA,mBAAoB,AAAA,EAAoB,WACpC,IAAI,EAAK,IAAI,CAAC,IAAI,CAAC,wBACnB,IAAI,CAAC,GAAG,CAAC,qBACL,IAAI,CAAC,GAAG,CAAC,eAAgB,IACzB,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,GAAG,CAAC,oBAE/B,IAAI,CAAC,GAAG,CAAC,yBAA0B,GACnC,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,GAAG,CAAC,cAE/B,IAAI,CAAC,GAAG,CAAC,sBAEjB,GAEA,eAAgB,AAAA,EAAkB,KAAM,SAAS,CAAK,CAAE,CAAG,EAClD,IAAI,CAAC,eAAe,CAMpB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACxB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,GAAG,CAAC,YAAa,GAC1B,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,IACvB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAC9C,IAZI,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,IACvB,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,GAAG,CAAC,uBAUb,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,IAAI,CAAC,cAAe,CAAA,EAC7B,GAEA,gBAAiB,AAAA,EAAoB,WAIjC,IAAI,CAAC,GAAG,CAAC,iBACL,IAAI,CAAC,IAAI,CAAC,eAAe,IAAI,CAAC,IAAI,CAAC,MAAM,KACzC,IAAI,CAAC,GAAG,CAAC,gBAEb,IAAI,EAAI,EAAE,CACV,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC3C,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC5C,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC5C,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC3C,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,UAAU,CAAC,GAC1C,GAEA,gBAAiB,AAAA,EAAoB,WACjC,IAAI,EAAI,EAAE,CACV,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,CAAC,GAAG,CAAC,qBAAsB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAChD,IAAI,CAAC,GAAG,CAAC,eAAgB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC1C,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC3C,IAAI,CAAC,GAAG,CAAC,eAAgB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC1C,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,UAAU,CAAC,GAAK,EAC/C,GAEA,gBAAiB,AAAA,EAAoB,WACjC,IAAI,EAAM,IAAI,CAAC,KAAK,GAChB,IAAI,CAAC,GAAG,CAAC,kBACT,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,UAAU,CAAC,CAAE,EAAM,EAAG,EAAK,EAAK,EAAM,EAAG,EAC5E,GAEA,UAAW,AAAA,EAAkB,KAAM,SAAS,CAAM,EAC9C,GAAI,IAAI,CAAC,eAAe,CAAE,CACtB,IAAI,EAAI,IAAI,CAAC,SAAS,GACtB,IAAI,CAAC,GAAG,CAAC,cAAe,EAAE,KAAK,CAAE,EAAE,GAAG,EACtC,IAAI,CAAC,kBAAkB,EAC3B,KAAO,CACH,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,GAAG,CAAC,eAAgB,AAAU,MAAV,EAAiB,EAAI,GAC9C,IAAI,EAAO,IAAI,CAAC,KAAK,GACrB,IAAI,CAAC,cAAc,CAAC,EAAK,EAAM,CAAA,EACnC,CACJ,GAEA,mBAAoB,AAAA,EAAoB,WACpC,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,EAAO,IAAI,CAAC,KAAK,GACrB,IAAI,CAAC,cAAc,CAAC,EAAK,EAAM,CAAA,EACnC,GAEA,yBAA0B,SAAU,CAAE,CAAE,CAAE,EACtC,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,GAAI,IAAI,CAAC,IAAI,CAAC,eAAe,IAAI,CAAC,IAAI,CAAC,MAAM,IAAK,CAC9C,IAAI,EAAO,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAElC,OADA,IAAI,CAAC,GAAG,CAAC,gBACF,IAAI,CAAC,KAAK,EACrB,GACI,EAAO,EAAG,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,EAAK,IAC9C,IAAI,CAAC,WAAW,CAAC,EAAK,GACtB,IAAI,CAAC,WAAW,CAAC,EACrB,MACI,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,CAAC,GAAG,CAAC,iBACL,GAAO,IAAI,CAAC,KAAK,IACjB,IAAI,CAAC,GAAG,CAAC,EAErB,EAEA,gBAAiB,AAAA,EAAoB,WACjC,IAAI,CAAC,GAAG,CAAC,2BAA4B,WACjC,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,WAAW,GAAK,IAAI,CAAC,MAAM,CAAC,GAAG,WAAW,EACpE,EAAG,kBACP,GAEA,cAAe,AAAA,EAAoB,WAC/B,IAAI,CAAC,GAAG,CAAC,2BAA4B,OAAO,SAAS,CAAC,WAAW,CAAE,gBACvE,GAEA,YAAa,AAAA,EAAoB,WAC7B,IAAI,CAAC,GAAG,CAAC,2BAA4B,OAAO,SAAS,CAAC,WAAW,CAAE,cACvE,GAEA,UAAW,AAAA,EAAkB,eAAgB,SAAS,CAAG,EACrD,OAAO,IAAI,CAAC,gBAAgB,CAAC,EACjC,GAEA,UAAW,AAAA,EAAkB,eAAgB,SAAS,CAAG,EACrD,IAAI,EAAM,IAAI,CAAC,iBAAiB,CAAC,EAAM,EAAG,GAC1C,OAAO,IAAI,CAAC,GAAG,CAAC,YAAa,EACjC,GAEA,eAAgB,AAAA,EAAkB,oBAAqB,SAAS,CAAG,CAAE,CAAK,EACtE,IAAI,EAAK,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,IACtC,EAAO,IAAI,CAAC,IAAI,CAAC,EAAG,GAAG,CAAC,AACxB,CAAA,EAAK,MAAM,CAAG,EACV,GACA,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,SAAU,IAAI,MAAM,CAAC,EAAM,EAAK,MAAM,IAE/C,IAAI,CAAC,GAAG,CAAC,eAGb,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAG,GAAG,CAAE,GAE7D,GAEA,cAAe,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACrD,IAAI,CAAC,WAAW,CAAC,EAAO,EAC5B,GAEA,OAAQ,AAAA,EAAkB,iBAAkB,SAAS,GAAG,CAAI,EACxD,OAAO,IAAI,CAAC,WAAW,CAAC,EAAK,IAAI,CAAC,IACtC,GAEA,cAAe,AAAA,EAAkB,WAC7B,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,YAAY,CAAC,KAAA,GAClB,IAAI,CAAC,aAAa,CAAC,GACvB,GAEA,iBAAkB,SAAS,CAAK,CAAE,CAAG,EACjC,GAAI,AAAoB,GAApB,UAAU,MAAM,CAAO,CACvB,IAAI,EAAI,IAAI,CAAC,SAAS,GACtB,EAAQ,EAAE,KAAK,CACf,EAAM,EAAE,GAAG,AACf,CACA,OAAO,IAAI,CAAC,gBAAgB,CAAC,EAAO,EACxC,EAEA,UAAW,AAAA,EAAkB,KAAM,SAAS,CAAM,EAC9C,GAAI,IAAI,CAAC,eAAe,CAAE,CACtB,IAAI,EAAI,IAAI,CAAC,SAAS,GACtB,IAAI,CAAC,GAAG,CAAC,cAAe,EAAE,KAAK,CAAE,EAAE,GAAG,EACtC,IAAI,CAAC,kBAAkB,EAC3B,MAAO,GAAI,AAAU,MAAV,EACP,IAAI,CAAC,cAAc,CACf,IAAI,CAAC,KAAK,GACV,IAAI,CAAC,GAAG,CAAC,iBAAkB,KACvB,IAAI,CAAC,GAAG,CAAC,eAAgB,GACzB,IAAI,CAAC,GAAG,CAAC,qBACF,IAAI,CAAC,KAAK,UAGtB,CACH,IAAI,EAAM,IAAI,CAAC,KAAK,GAChB,EAAK,IAAI,CAAC,OAAO,CAEjB,EAAM,EAAM,AADL,IAAI,CAAC,IAAI,CAAC,EAAG,GAAG,CAAC,CACP,MAAM,CAAG,EAAG,GAAG,AAChC,CAAA,EAAG,GAAG,CAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAG,GAAK,IAAI,CAAC,GAAG,CAAC,aAAc,WACxD,IACJ,IAAI,CAAC,cAAc,CAAC,EAAK,EAC7B,CACJ,GAEA,eAAgB,WACZ,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAE,UAC3C,EAEA,aAAc,WACV,OAAO,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,IAAI,CAAE,UACzC,EAEA,MAAO,WACH,OAAO,IAAI,CAAC,WAAW,CAAC,WAAW,EACvC,EAEA,YAAa,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACnD,IAAI,CAAC,cAAc,CAAC,EAAO,EAC/B,GAEA,oBAAqB,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EAC3D,IAAI,CAAC,cAAc,CAAC,EAAO,EAAK,CAAA,EAAO,CAAA,EAC3C,GAEA,KAAM,AAAA,EAAkB,KAAM,SAAS,CAAO,EAC1C,IAAI,CAAC,qBAAqB,GAC1B,IAAI,EAAQ,IAAI,CAAC,KAAK,GACtB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,YAAY,IACxC,IAAI,CAAC,OAAO,CAAC,GACT,GACA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAC7C,GAEA,2BAA4B,AAAA,EAAkB,iBAC1C,GAAI,CACA,IAAI,EAAO,MAAM,UAAU,SAAS,CAAC,QAAQ,GAC7C,IAAI,CAAC,eAAe,CAAC,GACrB,IAAI,CAAC,iBAAiB,CAAC,OAC3B,CAAE,MAAM,EAAI,CACR,QAAQ,KAAK,CAAC,GACd,IAAI,CAAC,WAAW,CAAC,+DACrB,CACJ,GAEA,0BAA2B,AAAA,EAAkB,IAAK,eAAe,CAAK,CAAE,CAAG,EACvE,GAAI,CACA,IAAI,EAAO,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,EAC/C,OAAM,UAAU,SAAS,CAAC,SAAS,CAAC,EACxC,CAAE,MAAM,EAAI,CACR,QAAQ,KAAK,CAAC,GACd,IAAI,CAAC,WAAW,CAAC,+DACrB,CACJ,GAEA,SAAU,AAAA,EAAkB,WACpB,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,GACjC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAA,GAC1B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,EAClD,IAAI,CAAC,GAAG,CAAC,SAET,IAAI,CAAC,WAAW,CAAC,kCAEzB,GAEA,WAAY,AAAA,EAAkB,WACtB,QAAQ,IAAI,CAAC,IAAI,CAAC,eAAe,GACjC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAA,GAC1B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAE,IAAI,CAAC,UAAU,EAClD,IAAI,CAAC,GAAG,CAAC,SAET,IAAI,CAAC,WAAW,CAAC,kCAEzB,GAEA,KAAM,WACF,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,EACtC,EAEA,iBAAkB,AAAA,EAAkB,IAAK,SAAS,CAAC,EAC/C,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,OAAO,CAAC,GACc,oBAAvB,IAAI,CAAC,cAAc,GACnB,IAAI,CAAC,UAAU,CAAC,WAAY,KAAM,KAClC,IAAI,CAAC,IAAI,CAAC,cAAe,CAAA,GAEjC,GAEA,wBAAyB,AAAA,EAAkB,IAAK,WAC5C,IAAI,CAAC,eAAe,CAAG,IAAI,CAAC,YAAY,GACxC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,EACrC,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,IAAI,CAAC,cAAe,CAAA,EAC7B,GAEA,kBAAmB,AAAA,EAAkB,WACjC,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,GAAG,CAAC,uBACT,IAAI,CAAC,mBAAmB,EAC5B,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,EAAM,iBAAiB,EAC3B,EACJ,GAEA,SAAU,AAAA,EAAkB,WACxB,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,EAAM,aAAa,EACvB,EACJ,GAEA,qBAAsB,AAAA,EAAkB,WACpC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC3B,EAAM,kBAAkB,IACxB,EAAM,aAAa,EAC3B,EACJ,GAIA,0BAA2B,WACvB,IAAI,EAAK,IAAI,CAAC,GAAG,CAAC,iBAAkB,KAC3B,IAAI,CAAC,GAAG,CAAC,aAAc,IAAI,CAAC,IAAI,CAAC,0BAClC,IAAI,CAAC,GAAG,CAAC,qBACb,IAAI,EAAM,IAAI,CAAC,KAAK,GAAK,EAGzB,OAFA,IAAI,CAAC,GAAG,CAAC,sBAEF,CAAE,MADG,IAAI,CAAC,KAAK,GACN,IAAA,CAAI,CACxB,GACI,EAAK,IAAI,CAAC,GAAG,CAAC,wCAClB,AAAI,EACO,CAAE,MAAO,KAAK,GAAG,CAAC,EAAG,KAAK,CAAE,EAAG,KAAK,EAClC,IAAK,KAAK,GAAG,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,CAAE,EAEpC,CACX,EAEA,eAAgB,AAAA,EAAkB,MAAO,SAAS,CAAK,CAAE,CAAG,CAAE,CAAQ,EAClE,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,GAAK,IAAI,CAAC,eAAe,CAKrB,IAAI,CAAC,kBAAkB,OALA,CACvB,IAAI,EAAI,IAAI,CAAC,GAAG,CAAC,6BACjB,EAAQ,EAAE,KAAK,CACf,EAAM,EAAE,GAAG,AACf,CAIA,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,EAAM,IAAI,CAAC,YAAY,CAAC,GAGxB,EAAS,GAAI,EAAM,OAwBvB,IAvBI,IAAI,CAAC,GAAG,CAAC,aAAc,iBACvB,EAAS,IAAI,CAAC,SAAS,CAAC,EAAE,CAC1B,EAAM,gBAED,IAAI,CAAC,GAAG,CAAC,aAAc,gBAC5B,EAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,EAC5C,EAAM,cAED,IAAI,CAAC,GAAG,CAAC,aAAc,oBAC5B,EAAS,IAAI,CAAC,SAAS,CAAC,EAAE,CAC1B,EAAM,mBAED,IAAI,CAAC,GAAG,CAAC,aAAc,4CAC5B,EAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,EAC5C,EAAM,mBAGN,IACA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,KAAK,GAAK,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,EACtE,EAAS,IAKT,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,+BACL,CAAA,IAAI,CAAC,KAAK,IAAM,EAAI,WAAW,EAAA,GAEnC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,KAAK,GAAK,EAAG,KAC9C,GAAO,IAAI,CAAC,GAAG,CAAC,aAAc,IAC9B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,KAAK,GAAK,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,EAI9E,IAAI,CAAC,GAAG,CAAC,qBAIT,IADA,IAAI,EAAM,IAAI,CAAC,KAAK,GAAI,EAAO,CAAA,EACxB,CAAC,GAAM,CACV,IAAI,EAAI,IAAI,CAAC,KAAK,GACb,IAAI,CAAC,GAAG,CAAC,wBAAyB,QACnC,CAAA,EAAO,CAAA,CADX,EAGI,IAAI,CAAC,KAAK,IAAM,EAAI,WAAW,KAC/B,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,EAAO,CAAA,GAEP,IAAI,CAAC,OAAO,CAAC,GAAG,CAAG,IAAI,CAAC,IAAI,CAAC,eAAiB,IAC1C,EAAI,GACJ,IAAI,CAAC,GAAG,CAAC,YAAa,GAE1B,IAAI,CAAC,GAAG,CAAC,8BACT,IAAI,CAAC,GAAG,CAAC,WACT,IAAI,CAAC,GAAG,CAAC,SAAU,GACnB,EAAM,IAAI,CAAC,KAAK,GAExB,CAEA,EAAI,OAAO,EACf,EACJ,GAKA,qBAAsB,AAAA,EAAkB,WACpC,IAAI,CAAC,GAAG,CAAC,sBAGT,IAAI,EAAS,GACT,IAAI,CAAC,GAAG,CAAC,aAAc,yBACvB,EAAS,IAAI,CAAC,SAAS,CAAC,EAAE,CACrB,CAAA,SAAS,IAAI,CAAC,SAAS,CAAC,EAAE,CAAE,IAAM,CAAA,EACnC,IAAI,CAAC,SAAS,CAAC,EAAE,CAEhB,IAAI,CAAC,GAAG,CAAC,aAAc,gCAC5B,EAAS,IAAI,CAAC,SAAS,CAAC,EAAE,CACtB,OAAO,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,UAAU,CAAC,GAAK,GACtD,IAAI,CAAC,SAAS,CAAC,EAAE,CAEhB,IAAI,CAAC,GAAG,CAAC,aAAc,sBAC5B,CAAA,EAAS,IAAI,CAAC,SAAS,CAAC,EAAE,AAAF,EAG5B,IAAI,CAAC,GAAG,CAAC,qBACL,IAAI,CAAC,GAAG,CAAC,UACT,IAAI,CAAC,GAAG,CAAC,WAEb,IAAI,CAAC,GAAG,CAAC,SAAU,KAAM,GAEpB,IAAI,CAAC,GAAG,CAAC,aAAc,WACxB,IAAI,CAAC,GAAG,CAAC,WACT,IAAI,CAAC,GAAG,CAAC,iBAEjB,GAEA,iBAAkB,AAAA,EAAoB,WAClC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,IAAI,EAAK,EAAM,aAAa,GAC5B,IAAI,CAAC,GAAG,CAAC,eAAgB,KAAK,KAAK,CAAC,EAAK,OACzC,IAAI,CAAC,GAAG,CAAC,WACb,EACJ,GAEA,eAAgB,AAAA,EAAoB,WAChC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,IAAI,EAAK,EAAM,aAAa,GAC5B,IAAI,CAAC,GAAG,CAAC,gBAAiB,KAAK,KAAK,CAAC,EAAK,OAC1C,IAAI,CAAC,GAAG,CAAC,WACb,EACJ,GAEA,UAAW,AAAA,EAAkB,IAAK,SAAS,CAAG,EAC/B,MAAP,GAAa,CAAA,EAAM,CAAA,EACvB,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,EAAM,QAAQ,CAAC,EACnB,EACJ,GAEA,YAAa,AAAA,EAAkB,IAAK,SAAS,CAAG,EACjC,MAAP,GAAa,CAAA,EAAM,CAAA,EACvB,IAAI,CAAC,eAAe,CAAC,SAAS,CAAK,EAC/B,EAAM,UAAU,CAAC,EACrB,EACJ,GAEA,yBAA0B,AAAA,EAAkB,WACxC,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAEvB,IADA,IAAI,CAAC,GAAG,CAAC,YAAa,GACf,IAAI,CAAC,OAAO,CAAC,GAAG,CAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,CACxC,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CACtC,EAAI,OAAO,IAAI,CAAC,GAKhB,GAJI,IACA,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,GAAK,EAAE,KAAK,CAAE,IAAI,CAAC,KAAK,GAAK,EAAK,MAAM,GAEnE,CAAC,IAAI,CAAC,GAAG,CAAC,gBACV,KACR,CACJ,EACJ,GAEA,aAAc,SAAS,CAAC,EACpB,OAAO,IAAI,CAAC,SAAS,CAAC,EAAE,AAC5B,EAEA,gBAAiB,WACb,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,AAC/B,EAEA,UAAW,WACP,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,CAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,AAC1D,EAEA,KAAM,AAAA,EAAoB,WACtB,IAAI,CAAC,kBAAkB,GAClB,IAAI,CAAC,aAAa,IACnB,IAAI,CAAC,WAAW,CAAC,8BAEzB,GAEA,YAAa,AAAA,EAAkB,IAAK,SAAS,CAAC,EACjC,MAAL,GAAW,CAAA,EAAI,CAAA,EACnB,IAAK,IAAI,EAAI,EAAG,EAAI,EAAG,EAAE,EACjB,EAAI,GAAG,IAAI,CAAC,GAAG,CAAC,gBACpB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,6BAA8B,CAAA,GACvC,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,GAAG,CAAC,oBAAqB,CAAA,GAC9B,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAClC,EAAS,KAAK,KAAK,CAAE,AAAA,CAAA,IAAI,CAAC,IAAI,CAAC,eAAiB,EAAK,MAAK,AAAL,EAAU,GACnE,IAAI,CAAC,GAAG,CAAC,SAAU,IAAI,MAAM,CAAC,GAClC,EAER,GAIA,eAAgB,AAAA,EAAoB,WACJ,kBAAxB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,IAAI,CAAC,kBAAmB,MAEjC,IAqBI,EArBA,EAAM,IAAI,CAAC,IAAI,CAAC,mBACpB,GAAI,CAAC,EAAK,CACN,EAAM,IAAI,CAAC,IAAI,CAAC,kBAAmB,CAAC,GACpC,IAAI,EAAK,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAIhC,OAHA,IAAI,CAAC,GAAG,CAAC,iBAAkB,CACvB,YAAa,IAAI,CAAC,IAAI,CAAC,sBAC3B,EAAG,iBACI,IAAI,CAAC,KAAK,EACrB,GACA,GAAI,GAAM,IAAI,CAAC,KAAK,GAChB,OAAO,IAAI,CAAC,WAAW,CAAC,oBAC5B,CAAA,EAAI,MAAM,CAAG,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAI,IAAI,CAAC,KAAK,IACxD,EAAI,KAAK,CAAG,EACZ,EAAI,MAAM,CAAG,IAAI,CAAC,KAAK,GAAK,EAC5B,EAAI,UAAU,CAAG,EACjB,EAAI,WAAW,CAAG,OAAO,MAAM,CAAC,MAChC,EAAI,OAAO,CAAG,CAAA,EACd,EAAI,MAAM,CAAG,IAAI,CACjB,EAAI,WAAW,CAAG,CAAE,IAAI,CAAE,CAC1B,EAAI,WAAW,CAAG,IAAI,AAC1B,CAQA,EAAI,MAAM,CAAC,GAAG,CAAC,iBAAkB,SAAS,IACtC,IACI,EADA,EAAO,IAAI,CAAC,IAAI,CAAC,uBAEjB,EAAQ,CAAA,EAGZ,GAFA,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,UAAU,EAE/B,EAAI,OAAO,CAiBT,CACH,KAAO,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAI,MAAM,GACxC,GAAI,CAAC,EAAK,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAI,MAAM,CAAC,MAAM,CAAG,IAAK,CACjD,EAAQ,CAAA,EACR,KACJ,CACJ,GAAI,EACA,EAAI,UAAU,CAAG,IAAI,CAAC,KAAK,GAC3B,EAAK,IAAI,CAAC,KAAK,GAAK,EAAI,MAAM,CAAC,MAAM,KAClC,CAEH,GADA,EAAI,MAAM,CAAG,IAAI,CAAC,SAAS,CAAC,gBAAiB,IAAI,EAC7C,EAAI,WAAW,CAAC,QAAQ,CAAC,EAAI,MAAM,EAAG,CACtC,EAAY,EAAI,MAAM,CACtB,EAAI,WAAW,CAAC,WAAW,CAAC,uBAC5B,EAAI,UAAU,CAAG,EAAI,KAAK,CAAG,EAAI,MAAM,CACvC,EAAI,WAAW,CAAC,IAAI,CAAC,kBAAmB,MACxC,MACJ,CACI,EAAI,WAAW,CAAC,IAAI,CAAC,EAAI,MAAM,EAC/B,EAAI,UAAU,CAAG,EACjB,EAAI,MAAM,CAAC,GAAG,CAAC,iBAAkB,GACjC,MAER,CACJ,KAzCkB,CACd,KAAO,IAAI,CAAC,GAAG,CAAC,kBAAmB,EAAI,MAAM,GACzC,GAAI,CAAC,EAAK,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,KAAM,CAC7B,EAAQ,CAAA,EACR,KACJ,CAEJ,GAAI,EACA,EAAK,IAAI,CAAC,KAAK,GACf,EAAI,UAAU,CAAG,EACjB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAK,EAAI,MAAM,CAAC,MAAM,MACzC,CACH,EAAI,OAAO,CAAG,CAAA,EACd,EAAI,UAAU,CAAG,EAAI,KAAK,CAAG,EAAI,MAAM,CACvC,EAAO,IAAI,CAAC,IAAI,EAChB,MACJ,CACJ,CAyBU,MAAN,IAEA,IAAI,CAAC,GAAG,CAAC,iBAAkB,CACvB,YAAa,IAAI,CAAC,IAAI,CAAC,sBAC3B,EAAG,gBACH,EAAY,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAI,IAAI,CAAC,KAAK,IACnD,EAAI,WAAW,CAAC,EAAU,EAC1B,EAAO,IAAI,CAAC,IAAI,EAE5B,GACiB,MAAb,IACA,IAAI,CAAC,YAAY,CAAC,EAAI,KAAK,CAAE,EAAI,KAAK,CAAG,EAAI,MAAM,CAAE,GACrD,EAAI,MAAM,CAAG,EAAU,MAAM,CAC7B,EAAI,WAAW,CAAC,EAAU,CAAG,CAAA,EAErC,GAIA,uBAAwB,AAAA,EAAkB,IAAK,SAAS,CAAO,EACvD,AAAW,MAAX,EAAiB,EAAU,MAC1B,GAAW,IAChB,IAAI,CAAC,eAAe,CAAC,SAAU,EACnC,GAEA,yBAA0B,AAAA,EAAkB,IAAK,SAAS,CAAO,EACzD,AAAW,MAAX,EAAiB,EAAU,MAC1B,GAAW,IAChB,IAAI,CAAC,eAAe,CAAC,SAAU,EACnC,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,CAAC,eAAe,CAAC,oBACzB,GAEA,aAAc,AAAA,EAAkB,WAC5B,IAAI,CAAC,eAAe,CAAC,cACzB,GAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,CAAC,SAAS,CAAC,kBACnB,GAEA,SAAU,SAAS,CAAG,EAClB,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EACzB,IAAI,EAAI,EAAM,mBAAmB,CAAC,GAC9B,GAAG,EAAE,KAAK,EAClB,EACJ,EAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,CAAC,SAAS,CAAC,qBAAsB,IAAI,CAAC,gBAAgB,GAAK,EACnE,GAEA,gBAAiB,AAAA,EAAkB,WAC/B,IAAI,CAAC,SAAS,CAAC,yBAA0B,IAAI,CAAC,gBAAgB,GAAK,EACvE,GAEA,iBAAkB,AAAA,EAAkB,sBAAuB,SAAS,CAAM,EACtE,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EACzB,GAAI,CAAC,KAAK,IAAI,CAAC,GAAS,CACpB,GAAI,EAAM,OAAO,CAAC,MAAM,CAAG,EAAG,OAC9B,EAAS,EAAM,OAAO,CAAC,EAAE,AAC7B,CACA,EAAM,cAAc,CAAC,EACzB,EACJ,GAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,EAAO,IAAI,CACf,SAAS,IACL,EAAK,SAAS,CAAC,SAAS,CAAK,EACzB,EAAM,UAAU,CAAC,EACrB,EACJ,CACA,GAAI,EAAK,KAAK,GAAI,CACd,IAAI,EAAM,UAAY,EAAK,IAAI,CAAG,0BAClC,EAAK,GAAG,CAAC,gBAAiB,EAAK,SAAS,CAAG,EACnC,GAAK,GACb,EACJ,MACI,GAER,GAEA,cAAe,AAAA,EAAkB,8BAA+B,SAAS,CAAI,EACzE,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EACzB,EAAM,YAAY,CAAC,IAAI,CAAE,EAC7B,EACJ,GAIA,sBAAuB,AAAA,EAAkB,IAAK,WAC1C,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CAC/B,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,EAAM,IAAI,CAAC,KAAK,GAGpB,GAFA,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,gBACL,IAAI,CAAC,KAAK,IAAM,EAEhB,OADA,IAAI,CAAC,WAAW,CAAC,EAAK,IAAI,CAAC,KAAK,IACzB,CAAA,CAEf,CACJ,GAGA,mBAAoB,AAAA,EAAoB,WACpC,IAAI,EAeJ,GAdA,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAEvB,IADA,IAAI,EAAO,EACJ,AAAQ,GAAR,GAAa,IAAI,CAAC,GAAG,CAAC,yBAA0B,6BACnD,EAAM,IAAI,CAAC,GAAG,CAAC,eAAgB,GAC3B,IAAI,CAAC,GAAG,CAAC,aAAc,UACvB,EAAE,EAEG,CAAC,IAAI,CAAC,GAAG,CAAC,aAAc,yBAC7B,EAAE,CAGE,CAAA,GAAR,GACA,CAAA,EAAM,IADV,CAEJ,GACI,EACA,IAAI,CAAC,GAAG,CAAC,SAAU,KAAM,EAAK,UAE9B,MAAM,IAAI,EAAgB,+BAElC,GAEA,eAAgB,WACZ,OAAO,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAE,UAC1C,EAEA,WAAY,AAAA,EAAkB,uCAAwC,SAAS,CAAK,CAAE,CAAG,CAAE,CAAI,EAC3F,GAAI,EAAM,EAAO,CAAE,IAAI,EAAM,EAAO,EAAQ,EAAK,EAAM,CAAK,CACtD,aAAgB,UAClB,CAAA,EAAO,IAAI,CAAC,QAAQ,CAAC,EAAK,AAAL,EACzB,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,EAAQ,IAAI,CAAC,YAAY,CAAC,EAAO,CAAA,GACjC,EAAM,IAAI,CAAC,YAAY,CAAC,GACxB,IAAI,CAAC,YAAY,CACb,CACI,UAAW,SAAS,CAAG,EACnB,GAAI,GAAO,EAAM,WAAW,IAAM,GAAO,EAAI,WAAW,GACpD,OAAO,IAAI,CAAC,gBAAgB,CAAC,EACjC,MAAM,gBACV,CACJ,EACA,WACI,GAAI,CACA,OAAa,CACT,IAAI,EAAM,IAAI,CAAC,KAAK,GAEpB,GADA,EAAK,IAAI,CAAC,IAAI,EACV,IAAI,CAAC,KAAK,IAAM,GAAO,CAAC,IAAI,CAAC,GAAG,CAAC,gBACjC,KACR,CACJ,CAAE,MAAM,EAAI,CACR,GAAI,AAAO,mBAAP,EACA,MAAM,CACd,QAAU,CACN,EAAM,OAAO,GACb,EAAI,OAAO,EACf,CACJ,EAER,GAEA,eAAgB,AAAA,EAAkB,KAAM,SAAS,CAAK,CAAE,CAAG,EACvD,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,wBAA0B,IAAI,CAAC,IAAI,CAAC,wBACpD,IACL,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,EAAM,IAAI,CAAC,YAAY,CAAC,GACxB,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,EAAM,IACV,EAAK,KAAO,IAAI,CAAC,KAAK,GAAK,EAAI,WAAW,IAAI,CAC1C,KAAO,IAAI,CAAC,GAAG,CAAC,aAAc,WAC1B,GAAI,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAiB,MAAM,EAGzC,IADA,IAAI,EAAM,IAAI,CAAC,OAAO,CAAC,GAAG,CACnB,IAAI,CAAC,GAAG,CAAC,aAAc,QAAU,EAAM,GAAK,CAC/C,GAAI,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAiB,MAAM,CACrC,GAAE,CACN,CAUA,GATI,EAAM,GAAK,CAAA,EAAM,CAArB,EACI,MAAM,OAAO,CAAC,EAAK,EAAE,GACrB,IAAI,CAAC,GAAG,CAAC,SAAU,EAAK,EAAE,CAAC,EAAE,CAAE,KAC/B,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,SAAU,IAAK,EAAK,EAAE,CAAC,EAAE,GAElC,IAAI,CAAC,GAAG,CAAC,SAAU,EAAK,EAAE,CAAE,KAEhC,IAAI,CAAC,GAAG,CAAC,qBACL,CAAC,IAAI,CAAC,GAAG,CAAC,gBAAiB,KACnC,CACA,IAAI,CAAC,GAAG,CAAC,YAAa,GAClB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAG,GAAK,CAAC,IAAI,CAAC,GAAG,CAAC,aAAc,WAChD,IAAI,CAAC,GAAG,CAAC,qBACjB,GACJ,GAEA,iBAAkB,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACxD,IAAI,EAAQ,IAAI,CAAC,IAAI,CAAC,uBAClB,EAAQ,IAAI,CAAC,IAAI,CAAC,wBAClB,CAAA,AAAC,GAAU,CAAA,IACf,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAGvB,IAFA,EAAM,IAAI,CAAC,YAAY,CAAC,GACxB,IAAI,CAAC,GAAG,CAAC,YAAa,GACf,IAAI,CAAC,KAAK,GAAK,EAAI,WAAW,KACjC,IAAI,CAAC,GAAG,CAAC,sBACL,GAAS,IAAI,CAAC,GAAG,CAAC,aAAc,EAAM,EAAE,EACxC,IAAI,CAAC,GAAG,CAAC,cAAe,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,EACzC,GAAS,IAAI,CAAC,GAAG,CAAC,aAAc,EAAM,EAAE,GAC/C,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,KAAK,GAAK,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CAAE,IAAI,CAAC,SAAS,CAAC,EAAE,EAE9F,IAAI,CAAC,GAAG,CAAC,qBACJ,IAAI,CAAC,GAAG,CAAC,mBAEtB,GACJ,GAEA,aAAc,AAAA,EAAkB,KAAM,SAAS,CAAK,CAAE,CAAG,EACrD,IAAI,EAAQ,IAAI,CAAC,IAAI,CAAC,uBAClB,EAAQ,IAAI,CAAC,IAAI,CAAC,wBAClB,CAAA,AAAC,GAAU,CAAA,IACX,IAAI,CAAC,eAAe,CACpB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,CAAC,GAAG,CAAC,YAAa,GAElB,GAAU,IAAI,CAAC,GAAG,CAAC,aAAc,EAAM,EAAE,GAExC,GAAS,IAAI,CAAC,GAAG,CAAC,aAAc,EAAM,EAAE,EAEzC,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,GAEpC,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAO,EAE1C,IAEA,IAAI,CAAC,GAAG,CAAC,eACL,EACA,IAAI,CAAC,GAAG,CAAC,SAAU,IAAK,EAAM,EAAE,CAAE,MAElC,IAAI,CAAC,GAAG,CAAC,SAAU,IAAK,EAAM,EAAE,CAAC,EAAE,CAAE,EAAM,EAAE,CAAC,EAAE,EAChD,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAM,EAAE,CAAC,EAAE,CAAC,MAAM,GAEhD,IAAI,CAAC,GAAG,CAAC,gBAEjB,GAEA,qBAAsB,AAAA,EAAkB,IAAK,WACzC,IAAI,EAAK,IAAI,CAAC,MAAM,GAAI,EAAS,CAC7B,AAAM,OAAN,EACA,EAAS,MACJ,AAAM,KAAN,EACL,EAAS,QACE,MAAN,GACL,CAAA,EAAS,SADR,EAEL,IAAI,CAAC,YAAY,CAAC,CACd,OAAQ,CAAA,EACR,QAAS,CAAA,EACT,KAAM,AAnrClB,SAAwB,CAAA,GACpB,CAAE,CAAA,KAAE,CAAI,CAAA,QAAE,CAAO,CAAA,MAAE,CAAK,CAAA,OAAE,CAAM,CACnC,EACG,MAAO,CAAC;;0EAE8D,EAAE,EAAG;EAC7E,EAAE,AAAQ,MAAR,EAAe,CAAC;6EACyD,EAAE,EAAK,KAAK,EAAE,EAAQ;EACjG,CAAC,CAAG,GAAG;0EACiE,EAAE,EAAM;6EACL,EAAE,EAAO;QAC9E,CAAC,AACT,EAuqCiC,CACjB,GAAU,AAAA,EAAI,UAAU,CAAC,GACzB,KAAU,EAAK,EAAG,UAAU,CAAC,GAAK,KAClC,QAAU,EAAK,EAAG,UAAU,GAAG,QAAQ,CAAC,IAAI,WAAW,GAAK,KAC5D,MAAU,IAAI,CAAC,KAAK,GACpB,KAAU,IAAI,CAAC,WAAW,GAC1B,OAAU,AAAA,EAAY,IAAI,CAAC,WAAW,GAAI,EAC9C,EACJ,EACJ,GAEA,gBAAiB,AAAA,EAAkB,IAAK,SAAS,CAAK,EAClD,IAAI,EAAO,AAAA,IACP,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,eACrB,IAAI,CAAC,IAAI,CAAC,cAAe,CAAC,GAC1B,IAAI,CAAC,UAAU,CAAC,CAAC,mBAAmB,EAAE,EAAM,MAAM,EAAE,EAAK,CAAC,CAAC,CAAE,CAAA,EAAO,IACxE,CACI,AAAS,OAAT,EACA,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,IAAI,CAAC,GAAG,CAAC,oBAAqB,wBAC9B,EAAG,OAAO,GACV,EAAG,eAAe,CAAG,EAAG,YAAY,CAAC,EAAG,KAAK,GAAI,CAAA,GACjD,EAAG,GAAG,CAAC,SAAU,OAAO,IAAI,CAAC,OAAO,CAAC,GAAG,GACxC,EAAG,mBAAmB,GACtB,IAAI,CAAC,GAAG,CAAC,yBAA0B,EACvC,GAEA,EAAK,EAEb,EAEJ,GAIC,AAAA,WAEG,SAAS,EAAmB,CAAM,CAAE,CAAK,CAAE,CAAG,CAAE,CAAI,EAChD,EAAO,GAAG,CAAC,iBAAkB,WAIzB,IAAK,IAHD,EAAK,IAAI,CAAC,iBAAiB,CAAC,GAChC,EAAK,IAAI,CAAC,iBAAiB,CAAC,GAC5B,EAAQ,KAAK,GAAG,CAAC,EAAG,GAAG,CAAG,EAAG,GAAG,EACvB,EAAO,EAAG,GAAG,CAAE,GAAQ,EAAG,GAAG,CAAE,EAAE,EAAM,CAC5C,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAM,IACnD,IAAI,EAAO,IAAI,CAAC,IAAI,CAAC,EAAK,CAC1B,EAAK,EAAG,GAAG,CACX,EAAK,EAAG,GAAG,CACX,EAAI,IAAI,CAAC,KAAK,GAAI,EAAK,EACvB,GAAI,EAAK,EAAI,CACT,IAAI,EAAM,EACV,EAAK,EACL,EAAK,CACT,CACI,EAAK,EAAK,MAAM,GAChB,EAAK,EAAK,EAAK,MAAM,CACrB,EAAK,EAAK,MAAM,EAEhB,EAAK,EAAK,MAAM,EAChB,CAAA,EAAK,EAAK,MAAM,AAAN,EAEd,EAAK,IAAI,CAAC,IAAI,CAAE,EAAI,EAAI,EAAI,EAAI,EAAI,EACxC,CACJ,EAAG,GAAS,EAAO,KAAK,GAC5B,CAEA,AAAA,EAAa,WAAW,CAAC,CAErB,iBAAkB,AAAA,EAAkB,yBAA0B,SAAS,CAAK,CAAE,CAAG,CAAE,CAAM,EACrF,EAAmB,IAAI,CAAE,EAAO,EAAK,SAAS,CAAE,CAAE,CAAE,CAAE,CAAE,EAChD,EAAK,EACL,IAAI,CAAC,WAAW,CAAC,IAAI,MAAM,CAAC,GAAK,GAEjC,IAAI,CAAC,WAAW,CAAC,EAAI,GAEzB,IAAI,CAAC,WAAW,CAAC,EAAQ,EAAK,EAClC,EACJ,GAEA,eAAgB,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACtD,IAAI,EAAO,EAAE,CACb,EAAmB,IAAI,CAAE,EAAO,EAAK,SAAS,CAAE,CAAE,CAAE,CAAE,CAAE,CAAE,CAAK,EAC3D,IAAI,EAAM,IAAI,CAAC,gBAAgB,CAAC,EAAI,GAChC,EAAK,EAAK,GACV,CAAA,GAAO,IAAI,MAAM,CAAC,EAAQ,EAAK,EADnC,EAEA,EAAK,IAAI,CAAC,GACV,IAAI,CAAC,WAAW,CAAC,EAAI,EACzB,GACA,IAAI,CAAC,IAAI,CAAC,mBAAoB,EAClC,GAEA,gBAAiB,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACvD,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,EAC3B,IAAI,MAAM,CAAC,KAAK,GAAG,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAK,GAAG,CAC/B,IAAI,CAAC,iBAAiB,CAAC,GAAO,GAAG,GAClE,GAEA,iBAAkB,SAAS,CAAK,CAAE,CAAI,EAClC,IAAI,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAAO,GAAG,CAC3C,IAAI,CAAC,OAAO,CAAC,GACb,EAAK,OAAO,CAAC,CAAC,EAAM,KACZ,EAAI,IACC,IAAI,CAAC,GAAG,CAAC,kBACV,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,YAEb,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAK,CAAA,IAEpC,IAAI,CAAC,GAAG,CAAC,SAAU,EACvB,EACJ,EAEA,eAAgB,AAAA,EAAkB,IAAK,SAAS,CAAK,EACjD,IAAI,EAAK,IAAI,CAAC,IAAI,CAAC,oBACnB,GAAI,AAAM,MAAN,EACA,MAAM,IAAI,EAAgB,uBAC9B,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,EACxC,GAEA,cAAe,WACN,IAAI,CAAC,YAAY,GAClB,IAAI,CAAC,YAAY,CAAG,CAAA,EACpB,IAAI,CAAC,WAAW,CAAC,GAAG,GAE5B,CAEJ,EAEJ,IAGI,AAAA,EAAa,WAAW,CAAC,CACrB,mBAAoB,AAAA,EAAkB,IAAK,SAAS,CAAG,EACnD,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,IAG7B,GAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAAI,CAC/B,IAAI,CAAC,WAAW,CAAC,oCACjB,MACJ,CACA,IAAI,CAAC,UAAU,CAAC,2BAChB,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,AAAQ,OAAR,GAC1B,GACA,iBAAkB,AAAA,EAAkB,WAChC,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,IAG7B,GAAI,CAAC,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAAI,CAChC,IAAI,CAAC,UAAU,CAAC,0BAChB,MACJ,CACA,IAAI,CAAC,UAAU,CAAC,0BAChB,IAAI,CAAC,KAAK,CAAC,SAAS,GACxB,GACA,0BAA2B,AAAA,EAAkB,IAAK,SAAS,CAAG,EAC1D,IAAI,CAAC,KAAK,CAAC,SAAS,GACR,OAAR,GACA,CAAA,EAAM,CAAA,EACV,IAAI,EAAQ,IAAI,CAAC,KAAK,CAAC,YAAY,GACnC,IAAI,CAAC,gBAAgB,CAAC,MACtB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAK,EAC7B,EACJ,GAKJ,CACI,eACA,eACA,eACA,oBACA,eACA,oBACA,mCACA,sBACA,gBACA,gBACA,gBACA,qBACA,gBACA,cACA,gBAEH,CAAC,OAAO,CAAC,SAAS,CAAG,EAClB,AAAA,EAAa,QAAQ,CAAC,EAAM,QAAQ,CAAG,AAAA,EAAkB,IAAK,WAC1D,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,QAAQ,CAAC,EAAK,WACnB,IAAI,CAAC,mBAAmB,EAC5B,EACJ,GEh3CA,IAAI,EAAQ,KAAM,EAAiB,KAAM,EAAgB,KACzD,SAAS,GAAoB,CAAK,CAAE,CAAI,EACpC,IAAI,EAAgB,SAAS,aAAa,CACtC,EAAQ,IAAI,CAAC,KAAK,CAEtB,AADA,CAAA,EAAQ,IAAI,CAAZ,EACM,QAAQ,CAAC,cACf,EAAK,OAAO,CAAC,CAAC,EAAO,KACjB,IAAI,EAAQ,CACQ,CAAA,UAAhB,OAAO,IACP,EAAQ,EAAM,KAAK,CACnB,EAAQ,EAAM,KAAK,EAEvB,IAAI,EAAK,AAAA,EAAI,QAAQ,CAAC,CAAC,yCAAyC,EAAE,AAAA,EAAI,UAAU,CAAC,GAAO;sDAC1C,EAAE,EAAM,EAAE,EAAE,AAAA,EAAI,UAAU,CAAC,GAAO,MAAM,CAAC,EACvF,EAAM,GAAG,CAAC,EACd,GACA,AAAA,EAAI,EAAE,CAAC,EAAM,iBAAiB,GAAI,CAC9B,MAAO,AAAA,IACH,EAAc,KAAK,GACnB,IAAI,EAAO,EAAG,MAAM,CACf,AAAA,EAAI,QAAQ,CAAC,EAAM,qBACxB,GAAO,CAAC,EAAK,OAAO,CAAC,KAAK,EAC1B,GAAa,IAAI,CAAC,IAAI,EACtB,GAAa,IAAI,CAAC,IAAI,EAC1B,CACJ,GACA,EAAM,aAAa,CAAC,EAAM,UAAU,IACpC,GAAO,GAEP,IAAI,CAAC,UAAU,CAAC,IAChB,EAAM,gBAAgB,CAAC,YAAa,IAAM,IAAI,CAAC,SAAS,CAAC,IAC7D,CAEA,SAAS,KACD,GAAO,EAAM,OAAO,GACxB,EAAQ,KACR,EAAgB,KAChB,EAAiB,IACrB,CAEA,SAAS,GAAO,CAAG,EAEf,IAAI,EAAQ,IAAI,AADL,EAAM,iBAAiB,GACb,gBAAgB,CAAC,oBAAoB,CACtD,EAAI,EAAM,MAAM,CACpB,EAAkB,AAAC,CAAA,EAAM,EAAK,CAAA,EAAK,EACnC,EAAM,OAAO,CAAC,AAAA,IACV,IAAI,EAAU,EAAG,OAAO,CAAC,KAAK,EAAI,EAC9B,GAAS,CAAA,EAAgB,CAA7B,EACA,AAAA,EAAI,SAAS,CAAC,EAAI,EAAS,WAC/B,GACA,EAAc,cAAc,CAAC,CAAE,MAAO,SAAU,EACpD,CAEO,SAAS,GAAuB,CAAW,CAAE,CAAI,CAAE,CAAQ,EAC9D,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,IAAI,EAAe,EAAG,IAAI,CAAC,CACvB,gBAAiB,EACjB,sBAAuB,CAAC,EAAM,KACd,MAAR,GACA,CAAA,EAAO,EAAG,GAAG,CAAC,sBADlB,EAEI,EACA,EAAS,IAAI,CAAC,IAAI,CAAE,EAAI,EAAM,GAE9B,EAAM,CAAA,EACd,EACA,wBAAyB,AAAA,IACrB,EAAG,IAAI,CAAC,GACJ,GACA,EAAK,IAAI,CAAC,IAAI,CAAE,EACxB,CACJ,EACJ,EACJ,CAEA,SAAS,GAAoB,CAAE,CAAE,CAAG,CAAE,CAAE,CAAE,CAAI,EAC1C,IAAI,EAAO,IAAI,CACX,EAAY,EAAI,WAAW,CAAC,KAC5B,EAAM,EAAI,KAAK,CAAC,EAAG,EAAU,GAC7B,EAAU,EAAI,KAAK,CAAC,EAAU,GAClC,EAAK,KAAK,CAAC,eAAe,CAAC,EAAK,SAAU,CAAK,EAQ3C,GAAK,EAGE,CACH,IAAI,EAAc,EAAE,CACpB,IAAK,IAAI,KAAK,EACgB,GAAtB,EAAE,OAAO,CAAC,IACV,EAAY,IAAI,CAbxB,AAAI,AAAoB,aAApB,CAAK,CAa0C,EAbpC,CAAC,IAAI,CACT,AAYwC,EAZjC,IAYiC,GAGnD,GAAI,AAAsB,GAAtB,EAAY,MAAM,CAClB,EAAK,EAAE,MACJ,CACH,IAAI,EAAS,AAAA,EAAc,EACvB,CAAA,GAAU,GACV,EAAG,GAAG,CAAC,2BAA4B,EAAM,GACzC,EAAK,OACE,AAAsB,GAAtB,EAAY,MAAM,CACzB,EAAK,CAAC,EAAI,GAKV,QAAQ,GAAG,CAHX,EAAc,EAAY,GAAG,CAAC,SAAS,CAAI,EACvC,MAAO,CAAE,MAAO,EAAM,MAAO,EAAM,CAAK,CAC5C,IAEA,GAAoB,IAAI,CAAC,EAAI,EAAK,kBAAkB,GAAI,GACxD,EAAK,MAEb,CACJ,MA3BI,EAAG,WAAW,CAAC,aACf,EAAK,KA2Bb,EACJ,CA+NA,SAAS,KACD,GACA,GAAO,EAAiB,EAEhC,CAEA,SAAS,KACD,GACA,GAAO,EAAiB,EAEhC,CAcA,SAAS,KACD,EACI,GACA,IAAI,CAAC,GAAG,CAAC,2BAA4B,EAAc,OAAO,CAAC,KAAK,EAChE,MAEA,IAAI,CAAC,WAAW,CAAC,uBAGrB,IAAI,CAAC,GAAG,CAAC,+BAEjB,CAhQA,AAAA,EAAa,WAAW,CAAC,CAErB,kBAAmB,SAAS,CAAM,CAAE,CAAO,EACvC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,IAAI,EAAI,IAAI,CAAC,kBAAkB,GAC/B,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,GACzB,EAAG,MAAM,CAAC,GACL,GACD,EAAE,KAAK,EACf,EACJ,EAEA,cAAe,SAAS,CAAM,CAAE,CAAI,EAChC,IAAI,CAAC,GAAG,CAAC,oBAAqB,EAAS,iBACvC,IAAI,CAAC,GAAG,CAAC,qBAAsB,SAAU,CAAI,EACzC,EAAK,AAAQ,OAAR,EACT,EACJ,EAEA,mBAAoB,SAAS,CAAI,EAC7B,GAAuB,IAAI,CAAC,IAAI,CAAE,CAAE,MAAO,KAAM,CAAE,EAAM,SAAS,CAAE,CAAE,CAAI,CAAE,CAAK,EACzE,AAAQ,OAAR,GAAiB,AAAQ,MAAR,EACjB,EAAM,CAAA,GAEN,EAAG,WAAW,CAAC,yBACvB,EACJ,EAEA,uBAAwB,SAAS,CAAI,EACjC,GAAuB,IAAI,CAAC,IAAI,CAAE,KAAM,EAAM,SAAS,CAAE,CAAE,CAAI,CAAE,CAAK,EAClE,IAAI,EAAI,SAAS,EAAM,IACnB,MAAM,IACN,EAAG,WAAW,CAAC,yBACnB,EAAM,CAAC,MAAM,GACjB,EACJ,EAEA,wBAAyB,SAAS,CAAI,EAClC,IAAI,EAAc,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,AAAA,GAAO,IAAI,CAAC,QAAQ,CAAC,EAAI,CAAC,gBAAgB,EAAE,IAAI,GACpG,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAa,EAAM,SAAS,CAAE,CAAE,CAAI,CAAE,CAAK,EACzE,IAAI,EAAM,IAAI,CAAC,QAAQ,CAAC,EAAK,CACzB,EAAM,GAAO,EAAI,gBAAgB,CAChC,GACD,EAAG,WAAW,CAAC,oBAAsB,GAEzC,EAAM,EACV,EACJ,EAEA,yBAA0B,SAAS,CAAI,EACnC,IAAI,EAAe,MAAM,QAAQ,CAAC,AAAA,EAAa,QAAQ,EAAE,IAAI,GAC7D,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAc,EAAM,SAAS,CAAE,CAAE,CAAI,CAAE,CAAK,EAC1E,IACI,EAAM,CAAC,CADD,IAAI,CAAC,QAAQ,CAAC,EAAK,CAExB,GACD,EAAG,WAAW,CAAC,qBAAuB,GAC1C,EAAM,EACV,EACJ,EAEA,uBAAwB,SAAS,CAAI,EACjC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EACzB,IAAI,EAAc,EAAM,OAAO,CAAC,GAAG,CAAC,AAAA,GAAK,EAAE,IAAI,EAC/C,EAAY,IAAI,CAAC,EAAY,KAAK,IAClC,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAa,EAEnD,EACJ,EAEA,uBAAwB,SAAS,CAAW,CAAE,CAAI,CAAE,CAAQ,EACxD,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAa,EAAM,EACzD,EAEA,yBAA0B,SAAS,CAAI,EAEnC,IAAI,EAAc,OAAO,IAAI,CADnB,OAAO,MAAM,CAAC,CAAC,EAAG,IAAI,CAAC,eAAe,CAAE,IAAI,CAAC,SAAS,GAC7B,MAAM,CAAC,AAAA,GAAQ,CAAC,MAAM,IAAI,CAAC,IAAO,IAAI,GACzE,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAa,SAAS,CAAI,EACxD,IAAI,EAAM,IAAI,CAAC,IAAI,CAAC,GAEpB,OADA,IAAI,CAAC,UAAU,CAAC,CAAC,oBAAoB,EAAE,AAAA,EAAI,UAAU,CAAC,GAAM,UAAU,EAAE,AAAA,EAAI,UAAU,CAAC,GAAK,IAAI,CAAC,CAAE,CAAA,EAAM,KAClG,EAAK,KAAK,CAAC,IAAI,CAAE,UAC5B,EACJ,EAEA,8BAA+B,SAAS,CAAI,EACxC,IAAI,EAAO,IAAI,CACf,EAAK,GAAG,CAAC,0CAA2C,WAChD,GAAuB,IAAI,CAAC,EAAM,GAAqB,EAAM,SAAS,CAAE,CAAE,CAAI,CAAE,CAAK,EACjF,EAAK,KAAK,CAAC,WAAW,CAAC,EAAM,SAAU,CAAI,EACnC,AAAQ,MAAR,GACA,EAAG,WAAW,CAAC,iBAAmB,GAClC,EAAM,CAAA,IAEN,EAAM,CAAA,EAEd,EACJ,EACJ,EACJ,EAEA,qBAAsB,SAAS,CAAI,EAC/B,IAAI,EAAO,IAAI,CACf,EAAK,GAAG,CAAC,0CAA2C,WAChD,GAAuB,IAAI,CAAC,EAAM,GAAqB,EAC3D,EACJ,EAEA,kCAAmC,SAAS,CAAI,EAC5C,IAAI,EAAO,IAAI,CACf,EAAK,GAAG,CAAC,0CAA2C,WAChD,GAAuB,IAAI,CAAC,EAAM,GAAqB,EAC3D,EACJ,EAEA,0BAA2B,SAAS,CAAI,EACpC,IAAI,EAAO,IAAI,CACf,EAAK,GAAG,CAAC,0CAA2C,WAChD,GAAuB,IAAI,CAAC,EAAM,GAAqB,EAC3D,EACJ,EAEA,sBAAuB,WACnB,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAClC,OAAO,EAAG,YAAY,CAAC,WAAW,EACtC,EACJ,EAEA,oBAAqB,WACjB,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAClC,OAAO,EAAG,gBAAgB,CAAC,EAAG,YAAY,CAC9C,EACJ,EAEA,yBAA0B,SAAS,CAAK,EACpC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,EAAG,YAAY,CAAC,EAAG,YAAY,CAAE,EAAG,WAAW,GAAI,GACnD,IAAI,CAAC,kBAAkB,GAAG,WAAW,CAAC,CAAA,EAC1C,EACJ,EAEA,wCAAyC,SAAU,CAAI,EACnD,IAAI,CAAC,SAAS,CAAC,SAAS,CAAK,EACzB,IAAI,EAAO,IAAI,CACX,EAAO,EAAM,eAAe,GAAG,IAAI,CACnC,EAAM,EAAK,KAAK,CAAC,EAAG,EAAK,WAAW,CAAC,KAAK,GAC9C,EAAM,WAAW,CAAC,EAAK,SAAU,CAAG,EAChC,EAAK,GAAG,CAAC,2BAA4B,GACrC,GACJ,EACJ,EACJ,EAEA,oBAAqB,WACjB,IAAI,EAAO,IAAI,CACf,EAAK,cAAc,CAAC,SAAS,CAAE,EAE3B,SAAS,EAAS,CAAC,EACf,GAAI,AAAC,GAAK,AAAY,GAAZ,EAAE,MAAM,CAGb,CACD,IAAI,EAAS,AAAA,EAAc,EACvB,CAAA,GAAU,EACV,EAAG,GAAG,CAAC,2BAA4B,GAE9B,AAAY,GAAZ,EAAE,MAAM,CACb,EAAG,WAAW,CAAC,mBAGf,GAAoB,IAAI,CAAC,EAAI,EAAK,kBAAkB,GAAI,EAEhE,MAbI,EAAG,WAAW,CAAC,iBAcvB,CAEA,IAAI,EAAI,EAAG,IAAI,CAAC,mBACZ,EAAM,EAAG,GAAG,CAAC,uBACb,EAAK,EAAI,OAAO,CAAC,gCAAiC,QAAQ,OAAO,CAAC,UAAW,cACjF,EAAK,AAAI,OAAO,IAAM,EAAI,KACtB,aAAa,SACb,EAAE,IAAI,CAAC,EAAM,EAAI,EAAK,EAAI,SAAU,CAAC,EAC7B,GACA,EAAS,EACjB,GAEK,GAAK,EAAE,MAAM,CAAG,EAErB,EADA,EAAI,EAAE,MAAM,CAAC,AAAA,GAAO,EAAG,IAAI,CAAC,KAI5B,EAAS,EACjB,EACJ,EAEA,6BAA8B,WAC1B,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,EAAG,IAAI,CAAC,yBAAyB,IAAI,CAAC,EAAI,KAAM,AAAA,IACxC,GACA,EAAG,GAAG,CAAC,2BAA4B,IAAI,CAAC,IAAI,CAAC,2BACrD,EACJ,EACJ,EAEA,yBAA0B,SAAS,CAAI,EACnC,IAAI,CAAC,cAAc,CAAC,SAAS,CAAE,EAC3B,IAAI,EAAO,IAAI,CAAC,GAAG,CAAC,uBACpB,EAAG,OAAO,CAAC,IACX,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,IAClD,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,KAAK,GAC5B,GACD,EAAG,SAAS,CAAC,SAEjB,WAAW,KACH,GACA,EAAK,IAAI,CAAC,IAAI,CAAE,GACpB,IAAI,CAAC,YAAY,EACrB,EAAG,EACP,GACA,IACJ,CAEJ,GA4DA,IAAI,GAAe,CACf,IAtBJ,WACS,EAGD,GAAkB,IAAI,CAAC,IAAI,EAF3B,IAAI,CAAC,GAAG,CAAC,sBAGjB,EAkBI,MAAuC,GACvC,cAbJ,WACI,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,YAAY,CAC3C,EAYI,kBAAuC,AAAA,EAAkB,IAV7D,WACI,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,YAAY,EACvC,IAAI,CAAC,mBAAmB,EAC5B,EAOA,EAEI,GAAmB,AAAA,EAAa,MAAM,CAAC,KAAM,OAAO,MAAM,CAAC,CAC3D,gBAAkB,0BACtB,EAAG,KAEC,GAAsB,AAAA,EAAa,MAAM,CAAC,KAAM,OAAO,MAAM,CAAC,CAC9D,QA1BJ,WACI,GAAgB,IAAI,CAAC,IAAI,CAC7B,EAyBI,wCAA0C,GAC1C,qCAA0C,GAC1C,SAA0C,GAC1C,OAA0C,GAC1C,eAzDJ,WACQ,GACA,GAAO,GAEf,EAsDI,gBAhEJ,WACQ,GACA,GAAO,EAEf,EA6DI,OAA0C,WACtC,IACJ,CACJ,EAAG,IACH,CAAA,GAAoB,cAAc,CAAG,CAAE,WAEnC,OADA,KACO,CAAA,CACX,EAAG,CAEH,AAAA,EAAa,OAAO,CAAC,kBAAmB,WAEpC,OADA,IAAI,CAAC,UAAU,CAAC,IACT,WACH,IAAI,CAAC,SAAS,CAAC,GACnB,CACJ,GDhbA,AAAA,EAAa,WAAW,CAAC,CAErB,WAAY,WACR,OAAO,IAAI,CAAC,SAAS,EACzB,EAEA,gBAAiB,SAAS,CAAI,EACrB,GACD,CAAA,EAAO,IAAI,CAAC,OAAO,EADvB,EAEA,IAAI,EAAQ,EAAK,KAAK,CAAC,MAGvB,IAAK,IAAI,KAFL,EAAM,MAAM,CAAG,GACf,EAAM,MAAM,CAAC,EAAG,EAAM,MAAM,CAAG,GAClB,GAAO,CACpB,IAAI,EAAI,uBAAuB,IAAI,CAAC,GACpC,GAAI,EAAG,OAAO,CAAC,CAAC,EAAE,AACtB,CACJ,EAIA,eAAgB,SAAS,CAAI,EAGzB,OAFK,GAAM,CAAA,EAAO,IAAI,CAAC,IAAI,AAAJ,EACb,AAAC,CAAA,WAAW,IAAI,CAAC,IAAS,CAAC,GAAE,AAAC,CAAC,CAAC,EAAE,EAE1C,IAAK,OACH,MAAO,KAET,KAAK,MACH,MAAO,YAET,KAAK,QACL,IAAK,OACL,IAAK,MACH,MAAO,MAET,KAAK,MACH,MAAO,UAET,KAAK,OACH,MAAO,KAET,KAAK,QACH,MAAO,MACX,CACA,OAAO,IACX,EAEA,gBAAiB,SAAS,CAAI,EACrB,GACD,CAAA,EAAO,IAAI,CAAC,GAAG,CAAC,oBAAsB,IAAI,CAAC,GAAG,CAAC,iBADnD,EAEI,IACI,IAAI,CAAC,QAAQ,CAAC,EAAK,CACnB,IAAI,CAAC,GAAG,CAAC,EAAM,CAAA,GACR,IAAI,CAAC,QAAQ,CAAC,EAAO,QAAQ,EACpC,IAAI,CAAC,GAAG,CAAC,EAAO,QAAS,CAAA,GAGrC,EAEA,aAAc,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAG,EACpD,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,EAAQ,IAAI,CAAC,iBAAiB,CAAC,GAAM,EAAM,EAAG,EAAQ,EAAE,CAC5D,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,CAAC,GAAG,CAAC,qBAAsB,CAAA,GAC/B,IAAI,EAAK,IAAI,CAAC,MAAM,GACpB,GAAI,EAAG,WAAW,IAAM,EAAG,WAAW,GAAI,CACtC,IAAI,CAAC,WAAW,CAAC,sBACjB,MACJ,CACA,KAAO,IAAI,CAAC,OAAO,CAAC,GAAG,EAAI,EAAM,GAAG,EAAE,CAClC,IAAI,EAAM,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,GAMjC,GALI,GAAO,IACH,EAAM,GACN,CAAA,EAAM,CADV,EAEA,EAAM,IAAI,CAAC,CAAE,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,EAAK,GAEpC,CAAC,IAAI,CAAC,GAAG,CAAC,gBACV,KACR,CACA,EAAE,EACF,EAAM,OAAO,CAAC,AAAA,IACV,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,EAAE,CAAE,CAAC,CAAC,EAAE,GACvD,IAAI,CAAC,GAAG,CAAC,SAAU,IAAI,MAAM,CAAC,EAAM,CAAC,CAAC,EAAE,EAC5C,EACJ,EACJ,GAEA,eAAgB,AAAA,EAAkB,OAAQ,SAAS,CAAK,CAAE,CAAG,CAAE,CAAO,EAClE,IAAI,CAAC,SAAS,CAAC,aAAa,GAC5B,IAGI,EAHA,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAAO,GAAG,CACvC,EAAO,GACP,EAAO,EAMX,IAJI,GAAW,CAAC,EAAQ,KAAK,EACzB,CAAA,EAAO,SAAS,EAAS,GAD7B,EAGA,EAAM,OADN,EAAM,IAAI,CAAC,iBAAiB,CAAC,GAAK,GAAG,EACnB,MAAM,CACjB,GAAO,GACV,GAAQ,qBACJ,GACA,CAAA,GAAQ,6BAA+B,AZiHhD,SAAiB,CAAK,CAAE,CAAK,CAAE,EAAO,GAAG,EACxB,UAAhB,OAAO,GACP,CAAA,EAAQ,KAAK,KAAK,CAAC,EADvB,EAIA,IADA,IAAI,EAAI,GAAK,EACN,EAAE,MAAM,CAAG,GACd,EAAI,EAAO,EACf,OAAO,CACX,EYzH+D,EAAM,EAAK,KAAO,SADrE,EAEA,EAAE,EACF,GAAQ,IAAI,CAAC,eAAe,CAAC,WAAW,CAAC,EAAK,IAAI,CAAC,IAAI,CAAC,EAAI,CAAE,MAAQ,WACtE,EAAE,EAEN,IAAI,EAAM,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,aACpC,EAAI,OAAO,CAAC,GACZ,EAAI,GAAG,CAAC,WAAY,CAAA,EACxB,GAEA,yBAA0B,AAAA,EAAkB,SAAU,SAAS,CAAG,EAC9D,IAAI,CAAC,iBAAiB,CAAC,EAC3B,GAEA,aAAc,AAAA,EAAkB,+BAAgC,SAAS,CAAQ,CAAE,CAAK,EACpF,IAAI,EAAM,WAAW,GAChB,MAAM,IACP,CAAA,EAAQ,CADZ,EAEA,IAAI,CAAC,IAAI,CAAC,EAAU,EACxB,GAEA,YAAa,AAAA,EAAkB,kBAAmB,SAAS,CAAI,EAC3D,GAAI,CACA,IAAI,EAAY,CACZ,IAAI,CACJ,IAAI,CAAC,KAAK,CACb,CAED,AADA,CAAA,EAAO,AAAI,SAAS,SAAU,QAAS,EAAvC,EACK,KAAK,CAAC,IAAI,CAAE,GACjB,IAAI,CAAC,kBAAkB,EAC3B,CAAE,MAAM,EAAI,CACR,IAAI,CAAC,WAAW,CAAC,EAAG,IAAI,CAAG,KAAO,EAAG,OAAO,EACxC,OAAO,OAAO,EACd,QAAQ,GAAG,CAAC,EACpB,CACJ,GAEA,YAAa,AAAA,EAAkB,KAAM,SAAS,CAAK,CAAE,CAAG,EACpD,IAAI,CAAC,GAAG,CAAC,cAAe,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,GAChE,GAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,CAAC,GAAG,CAAC,cAAe,IAAI,CAAC,OAAO,GACxC,GAEA,oBAAqB,AAAA,EAAkB,IAAK,WACxC,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,qBAC3B,GAEA,UAAW,AAAA,EAAkB,gBAAiB,SAAS,CAAI,EACvD,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAAM,IAAI,CAAC,OAAO,IAChD,IAAI,CAAC,UAAU,CAAC,yBACpB,GAEA,UAAW,AAAA,EAAkB,eAAgB,SAAS,CAAI,EACtD,IAAI,EAAO,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,GACrC,EAAS,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,CAAE,KAAM,CAAK,GAClD,EAAO,OAAO,CAAC,GACf,EAAO,GAAG,CAAC,mBACX,EAAO,GAAG,CAAC,mBAAoB,EACnC,GAEA,UAAW,AAAA,EAAkB,eAAgB,SAAS,CAAI,EACtD,IAAI,EAAO,IAAI,CACf,EAAO,EAAK,KAAK,CAAC,gBAAgB,CAAC,GACnC,EAAK,KAAK,CAAC,WAAW,CAAC,EAAM,SAAU,CAAI,EACnC,AAAS,cAAT,EACA,EAAK,UAAU,CAAC,wBAEhB,EAAK,KAAK,CAAC,kBAAkB,CAAC,EAAM,CAAA,EAAM,SAAU,CAAI,CAAE,CAAK,EAC3D,IAAI,EAAS,EAAK,KAAK,CAAC,SAAS,CAAC,GAElC,SAAS,IACL,EAAO,OAAO,CAAC,GAAQ,IACvB,EAAO,KAAK,CAAG,EACf,EAAO,KAAK,CAAC,CAAA,GACb,EAAO,GAAG,CAAC,mBACX,EAAO,GAAG,CAAC,mBAAoB,EACnC,CAEA,GAAI,GACA,GAAI,AAAS,MAAT,EACA,SACG,GAAI,EAAO,KAAK,EAAI,EACvB,EAAO,GAAG,CAAC,mBAAoB,OAC5B,CACH,IAAI,EAAM,QAAU,EAAO,sBACpB,CAAA,EAAO,KAAK,GAAK,sBAAwB,mBAAA,EAChD,EAAO,GAAG,CAAC,gBAAiB,EAAK,SAAU,CAAG,EACtC,GACA,GACR,EACJ,OAEA,EAAS,EAAK,KAAK,CAAC,YAAY,CAAC,CAAE,KAAM,EAAM,MAAO,CAAM,GAChD,MAAR,GACA,EAAK,UAAU,CAAC,YACpB,GAER,EAER,EACJ,GAEA,WAAY,AAAA,EAAkB,gBAAiB,SAAS,CAAI,EACxD,IAAI,EAAO,IAAI,CAEf,SAAS,IACL,EAAK,KAAK,CAAC,kBAAkB,CAAC,EAAM,EAAK,OAAO,GAAI,KAAM,SAAU,CAAK,EACrE,EAAK,GAAG,CAAC,gBAAiB,GAC1B,EAAK,KAAK,CAAC,CAAA,GACX,EAAK,KAAK,CAAG,EACb,EAAK,UAAU,CAAC,SAAS,EAC7B,EACJ,CAEA,IAAI,EAAS,EAAK,KAAK,CAAC,SAAS,CAAC,GAClC,GAAK,EAEA,CACD,IAAI,EAAM,wBAAwB,EAAK,aACvC,EAAO,GAAG,CAAC,gBAAiB,EAAK,SAAU,CAAG,EACtC,IACA,EAAK,KAAK,CAAC,UAAU,CAAC,GACtB,IAER,EACJ,MATI,GAUR,GAEA,kBAAmB,WACf,IAAI,CAAC,GAAG,CAAC,sCAAuC,CAAA,EAAM,WAAc,EACxE,EAEA,oCAAqC,SAAU,CAAG,CAAE,CAAI,EAEpD,IAAI,EAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,IASnC,AAPA,SAAS,EAAK,CAAK,EACX,EAAK,MAAM,CAAG,EACd,EAAK,KAAK,GAAG,GAAG,CAAC,gCAAiC,EAAK,GAEvD,GACR,EAEK,CAAA,EACT,EAEA,8BAA+B,SAAU,CAAG,CAAE,CAAI,EAE9C,IAAI,EAAO,IAAI,CAEf,SAAS,EAAS,CAAK,EACnB,EAAK,KAAK,CAAC,CAAA,GACX,EAAK,KAAK,CAAG,EACb,EAAK,CAAA,EACT,CAEA,SAAS,IACL,EAAK,KAAK,CAAC,kBAAkB,CAAC,EAAK,IAAI,CAAE,EAAK,OAAO,GAAI,EAAK,KAAK,CAAE,SAAU,CAAK,EAC5E,AAAS,MAAT,EACA,EAAS,GAET,EAAK,GAAG,CAAC,gBAAiB,EAAK,IAAI,CAAG,qDAAsD,SAAU,CAAG,EAChG,EAGD,EAAK,KAAK,CAAC,kBAAkB,CAAC,EAAK,IAAI,CAAE,EAAK,OAAO,GAAI,KAAM,SAAU,CAAK,EAC1E,EAAS,EACb,GAJA,EAAK,CAAA,EAMb,EAER,EACJ,CAEI,CAAC,EAAK,KAAK,IAAO,GAAO,EAAK,IAAI,CAAC,KAAK,CAAC,YACzC,EAAK,CAAA,GACG,EAGR,EAAK,GAAG,CAAC,gBAAiB,aAAe,EAAK,IAAI,CAAG,IAAK,SAAU,CAAG,EAC9D,EAGD,IAFA,EAAK,CAAA,EAIb,GARA,GAUR,EAEA,YAAa,AAAA,EAAkB,GAAI,WAC/B,IAAI,EAAO,IAAI,CACX,EAAK,KAAK,GACV,EAAK,GAAG,CAAC,gCAAiC,CAAA,EAAO,SAAU,CAAK,EACxD,GACA,EAAK,UAAU,CAAC,SAAS,EAAK,IAAI,CAC1C,GAEA,EAAK,UAAU,CAAC,8BACxB,GAEA,YAAa,AAAA,EAAkB,iBAAkB,SAAS,CAAI,EAC1D,IAAI,EAAO,IAAI,CACf,EAAK,KAAK,CAAC,aAAa,CAAC,EAAM,WAC3B,EAAK,UAAU,CAAC,WAAW,EAC/B,EACJ,GAEA,UAAW,AAAA,EAAkB,eAAgB,SAAS,CAAI,EACtD,IAAI,EAAO,IAAI,CACf,EAAK,KAAK,CAAC,kBAAkB,CAAC,EAAM,CAAA,EAAO,SAAU,CAAI,CAAE,CAAK,EAC5D,EAAK,GAAG,CAAC,cAAe,EAC5B,EACJ,GAEA,oBAAqB,AAAA,EAAkB,iBACnC,GAAI,CACA,IAAI,CAAC,KAAK,CAAC,iBAAiB,EAChC,CAAE,MAAM,EAAI,CACR,QAAQ,KAAK,CAAC,GACd,IAAI,CAAC,WAAW,CAAC,qBAAsB,CAAA,EAAO,IAClD,CACJ,GAEA,gBAAiB,AAAA,EAAkB,SAAS,CAAK,EAC7C,GAAI,EACA,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,OACtB,CACH,IAAI,EAAQ,AZxFjB,CAAA,WACH,IAAI,EAAS,EAAE,CACf,IAAK,IAAI,KAAM,SAAS,WAAW,CAAE,AAGrC,CAAA,SAAS,EAAS,CAAE,EAChB,IAAK,IAAI,KAAQ,EAAG,QAAQ,CAAE,AAGlC,CAAA,SAAiB,CAAI,EACjB,GAAI,aAAgB,cAChB,EAAS,EAAK,UAAU,MACrB,CACH,IAAI,EAAI,iCAAiC,IAAI,CAAC,EAAK,YAAY,EAC3D,GACI,AAAuB,EAAvB,EAAO,OAAO,CAAC,CAAC,CAAC,EAAE,GACnB,EAAO,IAAI,CAAC,CAAC,CAAC,EAAE,CAG5B,CACJ,CAAA,EAd0C,EAC1C,CAAA,EAL8C,GAC9C,OAAO,CAkBX,CAAA,IYmEyC,IAAI,GACjC,IAAI,CAAC,GAAG,CAAC,oBAAqB,iBAC9B,AAAA,GAAuB,IAAI,CAAC,IAAI,CAAE,EAAO,AAAA,IACrC,IAAI,CAAC,KAAK,CAAC,aAAa,CAAC,EAC7B,EAAG,CAAC,EAAI,EAAO,KAEX,GADA,EAAQ,EAAM,IAAI,UAGX,AAAI,AAAuB,EAAvB,EAAM,OAAO,CAAC,IACrB,EAAG,WAAW,CAAC,iBACR,EAAK,CAAA,IAEL,EAAK,CAAA,GALZ,EAAG,GAAG,CAAC,sBAOf,EACJ,CACJ,EAEJ,GE5VA,IAAI,GAAuB,AAAA,EAAa,MAAM,CAAC,UAAW,CACtD,OAA0B,CAAE,gBAAiB,CAAA,EAAM,CACnD,MAA0B,yBAC1B,eAA0B,4BAC1B,MAA0B,kBAC1B,MAA0B,mBAC1B,MAA0B,gBAC1B,QAA0B,uBAC1B,eAA0B,sBAC1B,eAA0B,2BAC1B,uBAA0B,gCAC1B,MAA0B,gBAC1B,MAA0B,sBAC1B,UAA0B,WAClB,IAAI,CAAC,aAAa,GAAG,KAAK,GAAK,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,WAAW,KACtE,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC,wBACzB,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,eAAe,CAAC,SAAS,EACpD,GAAY,IAAI,CAAC,IAAI,EACrB,GAAc,IAAI,CAAC,IAAI,EAE/B,CACJ,GAGA,SAAS,GAAY,CAAA,QACjB,EAAU,CAAA,CAAA,CAAA,OACV,EAAS,CAAA,CAAA,CAAA,IACT,EAAM,CAAA,CAAA,CAAA,KACN,EAAO,CAAA,CAAA,CAAA,UACP,EAAY,IAAI,CAAC,IAAI,CAAC,mBAAA,CAAA,aACtB,EAAe,IAAI,CAAC,IAAI,CAAC,eAAA,CAAA,SACzB,EAAW,CAAA,CAAA,CAAA,OACX,EAAS,IAAA,CACZ,CAAG,CAAC,CAAC,EACF,GAAI,CAAC,IAAI,CAAC,eAAe,CAoBrB,OAnBA,IAAI,CAAC,eAAe,CAAG,CACnB,QAAe,EACf,OAAe,EACf,IAAe,EACf,KAAe,EACf,UAAe,EACf,aAAe,EACf,UAAe,IAAI,CAAC,KAAK,GACzB,UAAe,IAAI,CAAC,KAAK,GACzB,QAAe,CAAE,MAAO,IAAI,CAAC,KAAK,GAAI,IAAK,IAAI,CAAC,KAAK,EAAG,EACxD,OAAe,IAAI,CAAC,aAAa,GAAG,YAAY,CAChD,MAAe,GACf,SAAe,EACf,OAAe,CACnB,EACK,IACD,IAAI,CAAC,UAAU,CAAC,IAChB,GAAY,IAAI,CAAC,IAAI,GAElB,CAAA,CAEf,CAEA,SAAS,KACL,OAAO,IAAI,CAAC,eAAe,CAAC,KAAK,CAAG,IAAI,CAAC,aAAa,GAAG,gBAAgB,CAAC,IAAI,CAAC,eAAe,CAAC,MAAM,CACzG,CAEA,SAAS,GAAc,CAAA,QAAE,CAAO,CAAE,CAAG,CAAC,CAAC,EACnC,IAAI,EAAQ,IAAI,CAAC,eAAe,CAAC,KAAK,CAatC,MAZI,CAAC,KAAK,IAAI,CAAC,IAAU,IAAI,CAAC,IAAI,CAAC,0BAC/B,IAAI,CAAC,eAAe,CAAG,IAAI,CAAC,IAAI,CAAC,wBACjC,EAAQ,IAAI,CAAC,eAAe,CAAC,KAAK,CAClC,IAAI,CAAC,aAAa,GAAG,kBAAkB,GACvC,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC,SAAU,GACnC,IAAI,CAAC,eAAe,CAAC,SAAS,CAAG,IAAI,CAAC,KAAK,GAC3C,IAAI,CAAC,eAAe,CAAC,OAAO,CAAG,CAAE,MAAO,IAAI,CAAC,KAAK,GAAI,IAAK,IAAI,CAAC,KAAK,EAAG,GAE5E,IAAI,CAAC,eAAe,CAAC,SAAS,CAAG,IAAI,CAAC,KAAK,GAC5B,MAAX,GACA,CAAA,IAAI,CAAC,eAAe,CAAC,OAAO,CAAG,CADnC,EAGO,GAAS,IAAI,CAAC,IAAI,CAC7B,CAEA,SAAS,KACL,IAAI,EAAM,IAAI,CAAC,eAAe,CAC1B,EAAQ,EAAI,KAAK,CACrB,OAAO,EAAI,SAAS,EACf,AAAA,CAAA,EAAI,MAAM,CAAI,EAAQ,EAAM,OAAO,CAAC,OAAQ,IAAO,CAAA,GAAU,EAAM,WAAW,EAEvF,CAEA,SAAS,GAAc,CAAG,CAAE,CAAM,EAC9B,IAAI,EAAS,IAAI,CAAC,OAAO,CACrB,EAAS,IAAI,CAAC,iBAAiB,CAAC,EAAO,GAAG,CAAG,GAAI,GACjD,EAAS,IAAI,CAAC,iBAAiB,CAAC,EAAO,GAAG,CAAG,GAAI,KACjD,EAAO,IAAI,CAAC,OAAO,GACnB,EAAK,EAAE,CACP,EAAM,IAAI,CAAC,eAAe,CAC1B,EAAQ,IAAI,CAAC,KAAK,GAClB,EAAQ,EACR,EAAO,EAEX,IADA,EAAI,SAAS,CAAG,EAAI,MAAM,EAAE,OAAS,IACxB,CACT,IAAI,EAAI,EAAI,IAAI,CAAC,GACjB,GAAI,GAAK,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,CAClB,GAAI,EAAI,MAAM,EAAI,EAAI,SAAS,CAAG,EAAI,MAAM,CAAC,GAAG,CAC5C,MAGJ,GADA,IACI,EAAE,KAAK,EAAI,GAAU,EAAE,KAAK,EAAI,EAAQ,CACxC,IAAI,EAAK,IAAI,CAAC,iBAAiB,CAAC,EAAE,KAAK,EACnC,EAAK,IAAI,CAAC,iBAAiB,CAAC,EAAI,SAAS,EAC7C,EAAG,IAAI,CAAC,CACJ,MAAO,EAAG,GAAG,CAAE,KAAM,EAAG,GAAG,CAC3B,MAAO,EAAG,GAAG,CAAE,KAAM,EAAG,GAAG,AAC/B,EACJ,CACI,CAAA,GAAS,EAAE,KAAK,EAAI,EAAQ,EAAI,SAAS,EAAK,GAAS,EAAI,SAAS,EAAI,EAAI,OAAO,AAAP,GAC5E,CAAA,EAAO,CADX,CAGJ,MACI,KAER,CACA,GAAY,IAAI,CAAC,IAAI,CAAE,EAAO,EAAM,GACpC,IAAI,CAAC,UAAU,CAAC,eAAgB,EACpC,CAEA,SAAS,GAAY,CAAK,CAAE,CAAI,CAAE,CAAM,EACpC,IAAI,EAAM,IAAI,CAAC,eAAe,CAC9B,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,GAAI,EACA,EAAG,MAAM,CAAC,EAAO,IAAI,CAAC,IAAI,CAAE,EAAO,EAAM,QACtC,CACH,IAAI,EAAM,EAAI,QAAQ,EAAI,EAAQ,CAAC,CAAC,EAAE,EAAM,EAAE,CAAC,CACzC,GAAU,EAAQ,CAAC,CAAC,EAAE,EAAK,CAAC,EAAE,EAAM,EAAE,CAAC,CACvC,GACN,EAAG,MAAM,CAAC,CAAC,EAAE,EAAI,EAC3B,EAAI,QAAQ,CAAG,gBAAkB,WAAW,EAC5C,EAAI,MAAM,CAAG,UAAY,EAAI,IAAI,CAAG,QAAU,GAAG,EACjD,EAAI,OAAO,CAAG,GAAK,YAAY,CAAC,CAAC,CAC3B,CACA,IAAI,EAAQ,EAAI,MAAM,CAClB,EAAM,EAAQ,EAAI,cAAc,EAAE,MAC3B,OAAP,IACA,EAAG,WAAW,CAAC,CAAC,EAAM,EAAI,KACtB,EAAG,eAAe,CAAC,eAAe,CAAC,EAAM,EAAI,EAAI,MACrD,EAAG,EAAO,GACV,EAAG,WAAW,CAAC,CAAC,EAAM,EAAI,KACtB,EAAG,eAAe,CAAC,YAAY,CAAC,EAAM,EAAI,EAAI,MAAO,eACzD,EAAG,GAEX,EACJ,CAEA,SAAS,GAAS,CAAA,QAAE,CAAO,CAAE,CAAG,IAAI,CAAC,eAAe,EAChD,IAAI,EAAM,IAAI,CAAC,eAAe,CAC1B,EAAQ,EAAI,KAAK,CACjB,EAAQ,CAAA,EACZ,GAAI,CACA,IAAI,EAAK,GAAa,IAAI,CAAC,IAAI,EAE/B,GADA,EAAQ,IAAI,CAAC,GAAG,CAAC,EAAU,wBAA0B,yBAA0B,GACpE,CACP,EAAI,cAAc,CAAG,EACrB,IAAI,CAAC,GAAG,CAAC,wBACT,IAAI,EAAK,IAAI,CAAC,KAAK,GACf,EAAK,EAAM,AAAA,CAAA,EAAU,GAAK,CAAA,EAAK,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,MAAM,CACvD,GAAS,CAAA,CAAE,EAAI,EAAI,CAAG,CAAE,EAAI,EAAI,AAAA,EACpC,EAAI,OAAO,CAAG,CAAE,MAAO,EAAI,IAAK,CAAG,EACnC,IAAI,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAC9B,EAAO,IAAI,CAAC,iBAAiB,CAAC,GAClC,IAAI,CAAC,UAAU,CAAC,UAAW,CACvB,MAAO,EAAK,GAAG,CAAE,KAAM,EAAK,GAAG,CAC/B,MAAO,EAAK,GAAG,CAAE,KAAM,EAAK,GAAG,AACnC,EACJ,CACA,GAAc,IAAI,CAAC,IAAI,CAAE,EAC7B,CAAE,KAAM,CAAC,CACT,OAAO,CACX,CAEA,SAAS,GAAa,CAAA,MAClB,EAAQ,IAAA,CAAA,OACR,EAAS,CAAA,CAAA,CAAA,IACT,EAAM,CAAA,CAAA,CAAA,UACN,EAAY,CAAA,CAAA,CAAA,KACZ,EAAO,CAAA,CAAA,CACV,CAAI,IAAI,CAAC,eAAe,EAAI,CAAC,CAAE,EAC5B,IAAI,EAAW,EAWf,MAVI,CAAC,IACD,EAAW,EAAM,OAAO,CAAC,kCAAmC,QACxD,GAEA,CAAA,EAAW,MAAQ,EAAW,KAA9B,GAGJ,GACA,CAAA,EAAW,EAAS,OAAO,CAAC,OAAQ,OADxC,EAGO,IAAI,OAAO,EAAU,GAAS,IAAI,CAAC,IAAI,EAAI,MAAQ,KAC9D,CA9KA,GAAqB,cAAc,CAAG,CAAE,wBAAyB,CAgLjE,AAAA,EAAa,WAAW,CAAC,CAErB,gBAAiB,AAAA,EAAkB,WAC/B,IAAI,EAAM,CAAE,QAAS,CAAA,CAAK,EACrB,GAAY,IAAI,CAAC,IAAI,CAAE,IACnB,GAAc,IAAI,CAAC,IAAI,CAAE,IAC1B,IAAI,CAAC,WAAW,CAAC,iDAE7B,GAEA,iBAAkB,AAAA,EAAkB,WAChC,IAAI,EAAM,CAAE,QAAS,CAAA,CAAM,EACtB,GAAY,IAAI,CAAC,IAAI,CAAE,IACnB,GAAc,IAAI,CAAC,IAAI,CAAE,IAC1B,IAAI,CAAC,WAAW,CAAC,kDAG7B,GAEA,uBAAwB,AAAA,EAAkB,WACtC,IAAI,EAAM,CAAE,QAAS,CAAA,EAAM,OAAQ,CAAA,CAAK,EACnC,GAAY,IAAI,CAAC,IAAI,CAAE,IACnB,GAAc,IAAI,CAAC,IAAI,CAAE,IAC1B,IAAI,CAAC,WAAW,CAAC,iDAE7B,GAEA,wBAAyB,AAAA,EAAkB,WACvC,IAAI,EAAM,CAAE,QAAS,CAAA,EAAO,OAAQ,CAAA,CAAK,EACpC,GAAY,IAAI,CAAC,IAAI,CAAE,IACnB,GAAc,IAAI,CAAC,IAAI,CAAE,IAC1B,IAAI,CAAC,WAAW,CAAC,iDAE7B,GAEA,0BAA2B,AAAA,EAAkB,WACpC,IAAI,CAAC,eAAe,EACrB,GAAY,IAAI,CAAC,IAAI,CAAE,CAAE,QAAS,CAAA,CAAK,GAE3C,IAAI,EAAM,IAAI,CAAC,eAAe,CAC9B,IAAI,EAAM,EAAI,OAAO,CAAC,GAAG,CACrB,EAAO,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAGlC,OAFA,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,CAAC,GAAG,CAAC,gBACF,IAAI,CAAC,KAAK,EACrB,GACA,GAAI,GAAQ,EAAK,CACb,IAAI,EAAO,IAAI,CAAC,gBAAgB,CAAC,EAAK,GACtC,IAAI,CAAC,aAAa,GAAG,kBAAkB,GACvC,IAAI,CAAC,aAAa,GAAG,GAAG,CAAC,SAAU,EAAK,WAAW,IACnD,EAAO,GAAY,IAAI,CAAC,IAAI,EAC5B,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,OAAO,CAAC,KAAK,EACvC,GAAS,IAAI,CAAC,IAAI,CAAE,CAAE,QAAS,CAAA,CAAK,EACxC,CACJ,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,EAAM,IAAI,CAAC,eAAe,AAC9B,CAAA,EAAI,IAAI,CAAG,CAAC,EAAI,IAAI,CAChB,EAAI,IAAI,EAAE,CAAA,EAAI,MAAM,CAAG,CAAA,CAA3B,EACA,IAAI,CAAC,UAAU,CAAC,CAAC,aAAa,EAAE,EAAI,IAAI,CAAG,KAAO,MAAM,CAAC,CAAE,CAAA,EAAO,KAClE,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EACxD,GAAS,IAAI,CAAC,IAAI,CACtB,GAEA,yBAA0B,AAAA,EAAkB,WACxC,IAAI,EAAM,IAAI,CAAC,eAAe,AAC1B,AAAiB,OAAjB,EAAI,SAAS,CAAU,EAAI,SAAS,CAAG,CAAA,EAClC,AAAkB,CAAA,IAAlB,EAAI,SAAS,CAAY,EAAI,SAAS,CAAG,CAAA,EACvB,CAAA,IAAlB,EAAI,SAAS,EAAW,CAAA,EAAI,SAAS,CAAG,IAA5C,EACL,IAAI,CAAC,UAAU,CAAC,CAAC,gBAAgB,EAAE,AAAiB,MAAjB,EAAI,SAAS,CAAW,OAAS,EAAI,SAAS,CAAG,MAAQ,KAAK,CAAC,CAAE,CAAA,EAAO,KAC3G,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EACxD,GAAS,IAAI,CAAC,IAAI,CACtB,GAEA,8BAA+B,AAAA,EAAkB,WAC7C,IAAI,EAAM,IAAI,CAAC,eAAe,AAC9B,CAAA,EAAI,GAAG,CAAG,CAAC,EAAI,GAAG,CAClB,IAAI,CAAC,UAAU,CAAC,CAAC,kBAAkB,EAAE,EAAI,GAAG,CAAG,KAAO,MAAM,CAAC,CAAE,CAAA,EAAO,KACtE,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,EACxD,GAAS,IAAI,CAAC,IAAI,CACtB,GAEA,sBAAuB,AAAA,EAAkB,WACrC,IAAI,EAAM,IAAI,CAAC,eAAe,CAC9B,IAAI,EAAK,IAAI,CAAC,gBAAgB,UAC9B,AAAI,GAAI,KAAK,QAAU,GAAM,EAAG,OAAO,EAAK,EAAG,MAAM,EASjD,IAAI,CAAC,GAAG,CAAC,iBACF,CAAA,IATP,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,EAAG,GAAG,CAAC,uBACP,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,SAAS,EACnC,GAAY,IAAI,CAAC,IAAI,EACrB,GAAS,IAAI,CAAC,IAAI,CACtB,GACO,CAAA,EAKf,GAEA,cAAe,AAAA,EAAkB,SAAS,CAAS,EAa/C,OAZK,GACD,IAAI,CAAC,SAAS,CAAC,uBAAwB,IAAI,CAAC,eAAe,EAC/D,IAAI,CAAC,aAAa,CAAC,IACnB,IAAI,CAAC,SAAS,CAAC,IACX,EACA,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,eAAe,CAAC,SAAS,EAEpD,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,SAAS,EAE9D,IAAI,CAAC,eAAe,CAAG,KACvB,IAAI,CAAC,aAAa,CAAC,WACnB,IAAI,CAAC,aAAa,CAAC,gBACZ,CAAA,CACX,GAEA,uBAAwB,AAAA,EAAkB,WACtC,IAAI,EAAM,IAAI,CAAC,eAAe,AAC1B,AAAC,CAAA,EAAI,cAAc,EAAI,EAAI,KAAK,EAAI,EAAI,cAAc,CAGtD,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,EAAG,YAAY,CAAC,EAAI,MAAM,CAAE,EAAG,OAAO,GAAG,MAAM,CAAE,EAAI,cAAc,EACnE,EAAI,KAAK,CAAG,EAAI,cAAc,CAC9B,GAAS,IAAI,CAAC,IAAI,CACtB,GANA,IAAI,CAAC,GAAG,CAAC,gBAAiB,CAAA,EAQlC,EACJ,GAIA,IAAI,GAA6B,AAAA,EAAa,MAAM,CAAC,gBAAiB,CAClE,aAA6B,oCAC7B,IAA6B,6CAC7B,2BAA6B,mCAC7B,EAA6B,8BAC7B,IAA6B,oCAC7B,aAA6B,CAAE,sBAAuB,CAAA,EAAM,CAC5D,MAA6B,qBACjC,GAGA,SAAS,GAAgB,EAAO,CAAC,CAAC,EAC9B,IAAI,CAAC,cAAc,CAAC,AAAA,IAChB,GAAY,IAAI,CAAC,IAAI,CAAE,CAAE,GAAG,CAAI,CAAE,SAAU,CAAA,CAAK,GACjD,IAAI,EAAM,IAAI,CAAC,eAAe,CAC9B,IAAI,CAAC,GAAG,CAAC,oBAAqB,CAAC,aAAa,EAAE,EAAI,MAAM,CAAG,UAAY,EAAI,IAAI,CAAG,QAAU,GAAG,EAAE,CAAC,EAClG,IAAI,EAAS,KACT,GAAY,IAAI,CAAC,IAAI,EACrB,GAAI,CACA,GAAc,IAAI,CAAC,IAAI,CAAE,GAAa,IAAI,CAAC,IAAI,EACnD,CAAE,KAAM,CAAC,CACb,EACA,EAAG,gBAAgB,CAAC,0BAA2B,GAC/C,IAAI,EAAS,AAAC,IACV,EAAG,mBAAmB,CAAC,0BAA2B,GAClD,EAAG,mBAAmB,CAAC,QAAS,GAC3B,IACD,IAAI,CAAC,aAAa,CAAC,WACnB,IAAI,CAAC,aAAa,CAAC,gBACnB,IAAI,CAAC,eAAe,CAAG,KAE/B,EACA,EAAG,gBAAgB,CAAC,QAAS,GAC7B,IAAI,CAAC,GAAG,CAAC,yBAA0B,KAAM,AAAA,IACrC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAG,EAC7B,GAAgB,IAAI,CAAC,IAAI,EACzB,EAAO,CAAA,EACX,EAAG,CAAC,EAAK,EAAO,KACZ,EAAI,KAAK,CAAG,EACZ,GAAI,CACA,GAAc,IAAI,CAAC,IAAI,CAAE,GAAa,IAAI,CAAC,IAAI,GAC/C,EAAK,EACT,CAAE,KAAM,CACJ,EAAI,YAAY,CAAC,CAAE,KAAM,QAAS,KAAM,oBAAqB,QAAS,CAAA,CAAK,EAC/E,CACJ,EACJ,EACJ,CAEA,SAAS,KACL,IAAI,EAAK,IAAI,CAAC,aAAa,GACvB,EAAM,IAAI,CAAC,eAAe,CAC1B,EAAQ,EAAI,KAAK,CACjB,EAAS,GAAa,IAAI,CAAC,IAAI,EAEnC,GADA,GAAc,IAAI,CAAC,IAAI,CAAE,GACrB,EAAQ,CACR,IAAI,CAAC,GAAG,CAAC,oBAAqB,CAAC,QAAQ,EAAE,EAAI,MAAM,CAAG,UAAY,GAAG,QAAC,EAAE,EAAM,eAAQ,CAAC,EACvF,IAAI,EAAS,KACT,IAAI,CAAC,aAAa,CAAC,WACnB,IAAI,CAAC,aAAa,CAAC,gBACnB,IAAI,CAAC,eAAe,CAAG,KACvB,EAAG,mBAAmB,CAAC,QAAS,EACpC,EACA,EAAG,gBAAgB,CAAC,QAAS,GAC7B,IAAI,CAAC,GAAG,CAAC,yBAA0B,KAAM,AAAA,IACrC,IAAI,CAAC,kBAAkB,GACvB,GAAgB,IAAI,CAAC,IAAI,CAAE,EAAI,EAAQ,EAC3C,EACJ,CACJ,CAEA,SAAS,GAAY,CAAI,EAErB,GAAI,AADM,IAAI,CAAC,eAAe,CACtB,YAAY,EAAI,GAAQ,EAAK,WAAW,GAAI,CAChD,IAAI,EAAO,IAAI,CAAC,SAAS,CAAC,EAAE,CAC5B,GAAI,GAAQ,EAAK,WAAW,GAAI,OAAO,EAAK,WAAW,GACvD,GAAI,GAAQ,IAAI,CAAC,UAAU,CAAC,GAAO,OAAO,IAAI,CAAC,UAAU,CAAC,EAC9D,CACA,OAAO,CACX,CAEA,SAAS,GAAgB,CAAE,CAAE,CAAM,CAAE,CAAW,EAC5C,IAAI,EAAM,IAAI,CAAC,eAAe,CAC9B,IAAI,CAAC,UAAU,CAAC,IAChB,IAAI,EAAM,EAAM,EAAM,EAAQ,EAC1B,EAAQ,EAAE,CACV,EAAM,EAAI,MAAM,EAAI,IAAI,CAAC,YAAY,CAAC,EAAI,MAAM,CAAC,GAAG,EACxD,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,MAAM,CAAG,EAAI,MAAM,CAAC,KAAK,CAAG,EAAI,OAAO,CAAC,KAAK,EAEvE,IAAI,EAAU,AAAA,IACN,EAAI,MAAM,EAEV,CAAA,EAAc,EAAY,OAAO,CAC7B,8BACA,CAAC,EAAG,IAAM,AAAK,MAAL,EAAY,KACZ,AAAK,KAAL,EAAW,EACX,AAAK,KAAL,EAAW,IAAI,CAAC,SAAS,CAAC,EAAE,CAC5B,AAAQ,KAAR,CAAC,CAAC,EAAE,CAAU,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,EAAG,EAAE,MAAM,CAAG,GAAG,CAClE,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,CAAA,EAGzB,GAAY,IAAI,CAAC,IAAI,CAAE,IAG9B,EAAW,AAAC,IACZ,IAAI,EAAQ,IAAI,CAAC,KAAK,GAClB,EAAQ,IAAI,CAAC,GAAG,CAAC,wBAAyB,GAC9C,GAAI,EAAO,CACP,IAAI,EAAI,IAAI,CAAC,SAAS,CACtB,GAAI,EAAI,MAAM,EAAK,CAAA,EAAE,KAAK,CAAG,EAAI,MAAM,CAAC,KAAK,EAAI,EAAE,KAAK,CAAG,CAAA,EAIvD,OAHK,GACD,IAAI,CAAC,GAAG,CAAC,YAAa,GAEnB,KAEX,IAAI,EAAQ,IAAI,CAAC,SAAS,CAAC,KAAK,CAEhC,GADA,EAAQ,CAAE,MAAO,EAAO,IAAK,IAAI,CAAC,KAAK,EAAG,EACtC,CAAC,EAAK,CACN,IAAI,CAAC,GAAG,CAAC,wBACT,IAAI,EAAW,IAAI,CAAC,iBAAiB,CAAC,GACtC,IAAI,CAAC,UAAU,CAAC,UAAW,CACvB,MAAO,EAAS,GAAG,CAAE,KAAM,EAAS,GAAG,CACvC,MAAO,IAAI,CAAC,OAAO,CAAC,GAAG,CAAE,KAAM,IAAI,CAAC,OAAO,CAAC,GAAG,AACnD,EACJ,CACJ,CAKA,OAJK,GACD,GAAc,IAAI,CAAC,IAAI,CAAE,EAAQ,CAAC,EAAO,IACrC,CAAC,CAAC,EAAE,EAAM,uBAAgB,EAAE,EAAQ,GAAa,mBAAY,CAAC,EAE/D,CACX,EAEA,EAAO,IAAI,CAAC,eAAe,CAAC,CACxB,kCAAmC,AAAA,EAAkB,KACjD,EAAM,IAAI,CAAC,GACX,IAAI,CAAC,YAAY,CAAC,EAAK,KAAK,CAAE,EAAK,GAAG,CAAE,EAAQ,IAChD,IACA,CAAA,EAAO,GAAP,GACW,GACf,GACA,2CAA4C,AAAA,EAAkB,KAC1D,EAAM,IAAI,CAAC,GACX,IAAI,CAAC,YAAY,CAAC,EAAK,KAAK,CAAE,EAAK,GAAG,CAAE,EAAQ,IAChD,IACA,GACJ,GACA,iCAAkC,AAAA,EAAkB,KAChD,CAAA,EAAO,GAAP,GACW,GACf,GACA,kCAAmC,AAAA,EAAkB,KACjD,IAAI,EACJ,KAAO,GACH,EAAO,EACP,IAAI,CAAC,YAAY,CAAC,EAAK,KAAK,CAAE,EAAK,GAAG,CAAE,EAAQ,IAChD,IACA,EAAO,EAAS,CAAA,GAEhB,IACA,IAAI,CAAC,GAAG,CAAC,YAAa,EAAK,KAAK,EAChC,IAAI,CAAC,GAAG,CAAC,yBAEb,GACJ,GACA,4BAA6B,AAAA,EAAkB,KAC3C,IAAI,EAAO,EAAM,GAAG,GACpB,GAAI,EAAM,CACN,IACA,IAAI,CAAC,GAAG,CAAC,QAIT,IAAI,EAAO,IAAI,CAAC,aAAa,CACzB,EAAK,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAG,GACnC,WAAW,KACP,IAAI,CAAC,aAAa,CAAG,EACrB,IAAI,CAAC,WAAW,CAAG,CACvB,GAEA,IAAI,CAAC,GAAG,CAAC,YAAa,EAAK,KAAK,EAChC,EAAO,GACX,MACI,IAAI,CAAC,WAAW,CAAC,eAEzB,GACA,oBAAqB,AAAA,EAAkB,AAAA,IACnC,IACO,GAEf,GACA,EAAO,KACC,GAAK,EAAI,OAAO,GACpB,EAAG,mBAAmB,CAAC,QAAS,GAChC,IAAI,CAAC,WAAW,CAAC,GACjB,IAAI,CAAC,aAAa,CAAC,WACnB,IAAI,CAAC,aAAa,CAAC,gBACnB,IAAI,CAAC,eAAe,CAAG,KACvB,IAAI,CAAC,SAAS,CAAC,IACf,EAAG,GAAG,CAAC,4BACP,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,EAAE,EAAM,YAAY,CAAC,CACnD,EACA,CAAA,EAAO,GAAP,EAII,EAAG,gBAAgB,CAAC,QAAS,GAF7B,GAIR,CAEA,SAAS,GAAc,CAAM,EACzB,OAAO,AAAA,EAAkB,KAAM,SAAS,CAAI,EACxC,IAAI,EAAM,IAAI,CAAC,eAAe,CAC1B,EAAO,CACP,SAAU,CAAA,EACV,OAAQ,AAAU,MAAV,GAAkB,EAAM,EAAI,MAAM,CAAG,CAAC,CAAC,EAC/C,KAAM,CAAC,CAAC,EACR,OAAQ,IAAI,CAAC,eAAe,EAAI,IAAI,CAAC,SAAS,EAClD,EACI,GACA,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,CAAC,eAAe,CAAG,OAAO,MAAM,CAAC,CAAC,EAAG,EAAK,GAC9C,GAAgB,IAAI,CAAC,IAAI,GAEzB,GAAgB,IAAI,CAAC,IAAI,CAAE,EAEnC,EACJ,CA1NA,GAA2B,cAAc,CAAG,CAAE,sBAAuB,CA4NrE,AAAA,EAAa,WAAW,CAAC,CACrB,cAAe,GAAc,MAC7B,qBAAsB,GAAc,CAAA,EACxC,GCnjBA,AAAA,EAAgB,MAAM,CAAC,MAAO,SAAS,CAAM,CAAE,CAAG,EAE9C,IAAI,EAAS,CACT,KAmGJ,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MACpB,IAAwB,EAApB,EAAK,EAAO,IAAI,GACpB,GAAI,EAAO,SAAS,CAAC,MACjB,EAAa,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,oBACxC,EAAM,IAAI,CAAC,QAEV,GAAI,EAAO,SAAS,CAAC,MACtB,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,mBACxC,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,gBAExD,GAAI,AAAO,MAAP,GAAc,AAAO,MAAP,EACnB,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAY,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EAChD,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,EAAM,IAAI,CAAC,EAAW,IAAI,CAAC,KAAM,EAAI,gBAEpC,GAAK,EAxEH,CAAU,CAwEW,EAxEP,CAyEjB,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,mBAEpC,GAAK,EAxEH,CAAW,CAwEW,EAxEP,CAwEa,CAC/B,IAAI,EAAI,EAAQ,GAAG,EACf,CAAC,GAAK,EAAE,IAAI,EAAI,GAGhB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,gBAJrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAM7C,KACU,CAAA,EAAM,EAAO,SAAS,CAAC,+BAAA,GAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAG,EAAG,CAAG,CAAC,EAAE,CAAG,gBAAkB,WACnF,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,aAE/B,CAAA,EAAM,EAAO,SAAS,CAAC,2DAAA,GAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,UAChD,CAAG,CAAC,EAAE,EACN,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,SAGlD,CAAA,EAAM,EAAO,SAAS,CAAC,yBAAA,EAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,iBAE9C,CAAA,EAAM,EAAO,SAAS,CAAC,wBAAA,EAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,YAE9C,CAAA,EAAM,EAAO,SAAS,CAAC,wBAAA,EAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,WAE9C,CAAA,EAAM,EAAO,SAAS,CAAC,kFAAA,EAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,WAGpD,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAE7C,EA7JI,KAUJ,WACI,IAAI,EAAI,EAAO,OAAO,CAAG,CACrB,OAAe,EAAQ,KAAK,CAAC,GAC7B,aAAe,EAAc,KAAK,CAAC,GACnC,KAAe,EAAM,KAAK,CAAC,GAC3B,SAAe,EACf,UAAe,CACnB,EACA,SAAS,IAML,OALA,EAAgB,EAAE,MAAM,CAAC,KAAK,CAAC,GAC/B,EAAgB,EAAE,YAAY,CAAC,KAAK,CAAC,GACrC,EAAgB,EAAE,IAAI,CAAC,KAAK,CAAC,GAC7B,EAAgB,EAAE,QAAQ,CAC1B,EAAgB,EAAE,SAAS,CACpB,CACX,CACA,OAAO,CACX,EA1BI,YA8JJ,WAEI,GAAI,EACA,OAAO,EAEX,IAAI,EAAM,EAAO,IAAI,CACjB,EAAc,EAAO,QAAQ,GAC7B,EAAS,EAEb,GAAI,EAAY,CACZ,IAAI,EAAmB,EAAO,QAAQ,CAAC,EAAW,IAAI,EAEtD,GADA,EAAS,EAAW,EAAE,CAAG,EACrB,CAAC,SAAS,IAAI,CAAC,GAAc,CAE7B,IAAI,EAAK,SACT,CAAA,EAAG,SAAS,CAAG,EAAW,EAAE,CAAG,EAC/B,IAAI,EAAI,EAAG,IAAI,CAAC,GACZ,GACA,CAAA,EAAS,EAAE,KAAK,AAAL,CACnB,CACA,OAAO,CACX,CAEA,IAAI,EAAI,EAAQ,EAAE,CAAC,IACnB,GAAI,EAAG,CAEH,IAAI,EAAK,AAAI,OAAO,UAAY,CAAU,CAAC,EAAE,IAAI,CAAC,EAC9C,EAAiB,EAAG,IAAI,CAAC,GAGzB,EAAO,EAAO,QAAQ,CAAC,EAAE,IAAI,CAEjC,CADA,CAAA,EAAK,KAAL,EACG,SAAS,CAAG,EAAE,GAAG,CAAG,EACvB,IAAI,EAAI,EAAG,IAAI,CAAC,GACZ,EAEA,EAAS,EAAiB,EAAE,GAAG,CAAG,EAAE,KAAK,EAKzC,EAAS,EAAO,eAAe,CAAC,EAAE,IAAI,EAAI,IAGtC,GACA,CAAA,GAAU,GADd,EAGR,KACK,CACD,IAAI,EAAI,EAAK,EACb,KAAO,KAAM,IAAQ,CAAA,EAAI,KAAK,IAAI,CAAC,EAAO,QAAQ,CAAC,GAAA,IAC/C,GAAG,CAAA,EAAS,EAAE,KAAK,AAAL,CACtB,CAEA,OAAO,CACX,CApNA,EAEI,EAAU,EAAE,CACZ,EAAgB,EAAE,CAClB,EAAQ,EAAE,CACV,EAAY,KACZ,EAAa,KAqBjB,SAAS,IACL,OAAO,EAAI,MAAM,CAAC,IAAI,CAAC,eAC3B,CAEA,IAAI,EAAa,CACb,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,EAAc,CACd,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAUA,SAAS,EAAW,CAAE,CAAE,CAAE,CAAE,CAAI,EAC5B,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,EACrC,CAEA,SAAS,IACL,IAAI,EAAO,EAAO,QAAQ,GAAI,EAAM,EAAK,OAAO,CAAC,KAAM,EAAO,GAAG,EAC7D,EAAI,UAAU,IAAI,CAAC,EAAK,MAAM,CAAC,EAAO,GAAG,GACzC,GACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,oBAElD,GAAO,GACP,EAAM,GAAG,GACT,EAAa,KACb,EAAW,EAAO,GAAG,CAAE,EAAK,YAC5B,EAAW,EAAK,GAAO,EAAG,oBAC1B,EAAO,GAAG,CAAG,IAEb,EAAW,EAAO,GAAG,CAAE,EAAK,MAAM,CAAE,YACpC,EAAO,GAAG,CAAG,EAAK,MAAM,CAEhC,CAEA,SAAS,EAAW,CAAG,CAAE,CAAI,EAEzB,IADA,IAAI,EAAI,EAAM,CAAA,EAAO,EAAQ,EAAO,GAAG,CAChC,CAAC,EAAO,GAAG,IAAI,CAElB,GADA,EAAK,EAAO,IAAI,GACZ,CAAC,GAAO,IAAO,EAAK,CACpB,EAAM,GAAG,GACT,EAAY,KACZ,EAAW,EAAO,EAAO,GAAG,CAAE,GAC9B,IAAI,EAAI,EAAQ,EAAE,CAAC,IACf,GAAK,EAAE,IAAI,EAAI,IACf,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,IAEvB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,EAAO,YAC5C,MACJ,CACA,EAAM,CAAC,GAAO,AAAO,OAAP,EACd,EAAO,OAAO,EAClB,CACA,EAAW,EAAO,EAAO,GAAG,CAAE,EAClC,CAwHA,OAAO,CAEX,GAEA,AAAA,EAAa,OAAO,CAAC,WAAY,WAC7B,IAAI,EAAM,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAgB,CAAE,OAAQ,IAAI,CAAE,KAAM,KAAM,IAClE,IAAI,EAAkB,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GAC/C,EAAe,IAAI,CAAC,IAAI,CAAC,CACzB,qBAAsB,uBACtB,oBAAqB,CACjB,GAAI,uBACJ,GAAI,IACR,EACA,qBAAsB,CAClB,GAAI,+BACJ,GAAI,CAAE,KAAM,KAAM,AACtB,CACJ,GAEA,OAAO,WACH,IAAI,CAAC,YAAY,CAAC,GACb,GACD,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACjC,IAAI,CAAC,IAAI,CAAC,EACd,CACJ,GCnPC,AAAA,WAEG,SAAS,EAAG,CAAG,EACX,OAAO,EAAI,IAAI,GAAG,KAAK,CAAC,MAC5B,CAEA,SAAS,EAAO,CAAC,EACb,OAAO,EAAE,MAAM,CAAC,CAAC,EAAG,EAAK,IAAO,CAAA,CAAC,CAAC,EAAI,CAAG,EAAI,EAAG,CAAA,EAAI,OAAO,MAAM,CAAC,MACtE,CAEA,IAAI,EAAW,EAAG,0UAUd,EAAgB,EAAG,2GAGnB,EAAiB,EAAG,oDAEpB,EAAmB,EAAG,4LAKtB,EAAqB,2DAEzB,SAAS,EAAS,CAAE,EAChB,OAAO,EAAG,WAAW,IAAM,EAAG,WAAW,EAC7C,CAUA,IAAI,EAAa,CACb,IAAO,IACP,IAAO,IACP,IAAO,GACX,EAEI,EAAc,CACd,IAAM,IACN,IAAM,IACN,IAAM,GACV,EA0SA,AAAA,EAAgB,MAAM,CAAC,KAAM,AAhS7B,CAAA,SAAmB,CAAQ,CAAE,CAAa,CAAE,CAAc,CAAE,CAAgB,CAAE,CAAM,CAAE,CAAG,EAErF,IAAI,EAAQ,EAAE,CACV,EAAU,EAAE,CACZ,EAAgB,EAAE,CAClB,EAAa,KACb,EAAY,CAAA,EACZ,EAAS,CACT,KAoLJ,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MACpB,GACJ,EAxLI,KAQJ,WACI,IAAI,EAAU,EAAQ,OAAO,CAAG,CAC5B,KAAe,EAAM,KAAK,CAAC,GAC3B,UAAe,EACf,SAAe,EACf,OAAe,EAAQ,KAAK,CAAC,GAC7B,aAAe,EAAc,KAAK,CAAC,EACvC,EACA,SAAS,IAML,OALA,EAAiB,EAAQ,IAAI,CAAC,KAAK,CAAC,GACpC,EAAiB,EAAQ,SAAS,CAClC,EAAiB,EAAQ,QAAQ,CACjC,EAAiB,EAAQ,MAAM,CAAC,KAAK,CAAC,GACtC,EAAiB,EAAQ,YAAY,CAAC,KAAK,CAAC,GACrC,CACX,CACA,OAAO,CACX,EAxBI,YAyLJ,WACI,IAAI,EAAM,EAAO,IAAI,CACjB,EAAc,EAAO,QAAQ,GAC7B,EAAS,EAEb,GAAI,SAEA,AAAI,EAAM,GAAK,CAAC,KAAK,IAAI,CAAC,GAEf,EAAO,eAAe,CAAC,EAAM,GAGjC,KAGX,GAAI,EAAY,CACZ,IAAI,EAAmB,EAAO,QAAQ,CAAC,EAAW,IAAI,EAEtD,GADA,EAAS,EAAW,EAAE,CAAG,EACrB,CAAC,SAAS,IAAI,CAAC,GAAc,CAE7B,IAAI,EAAK,SACT,CAAA,EAAG,SAAS,CAAG,EAAW,EAAE,CAAG,EAC/B,IAAI,EAAI,EAAG,IAAI,CAAC,GACZ,GACA,CAAA,EAAS,EAAE,KAAK,AAAL,CACnB,CACA,OAAO,CACX,CAEA,IAAI,EAAI,EAAQ,EAAE,CAAC,IACnB,GAAI,EAAG,CAEH,IAAI,EAAK,AAAI,OAAO,UAAY,CAAU,CAAC,EAAE,IAAI,CAAC,EAC9C,EAAiB,EAAG,IAAI,CAAC,GAGzB,EAAO,EAAO,QAAQ,CAAC,EAAE,IAAI,CAEjC,CADA,CAAA,EAAK,KAAL,EACG,SAAS,CAAG,EAAE,GAAG,CAAG,EACvB,IAAI,EAAI,EAAG,IAAI,CAAC,GACZ,EAEA,EAAS,EAAiB,EAAE,GAAG,CAAG,EAAE,KAAK,EAKzC,EAAS,EAAO,eAAe,CAAC,EAAE,IAAI,EAAI,IAGtC,GACA,CAAA,GAAU,GADd,EAGR,KACK,CACD,IAAI,EAAI,EAAK,EACb,KAAO,KAAM,IAAQ,CAAA,EAAI,KAAK,IAAI,CAAC,EAAO,QAAQ,CAAC,GAAA,IAC/C,GAAG,CAAA,EAAS,EAAE,KAAK,AAAL,CACtB,CAMA,GAAI,EAAM,EAAG,CACT,IAAI,EAAS,EAAO,UAAU,GAC9B,GAAI,SAAS,IAAI,CAAC,IAAW,EAAc,MAAM,CAAG,EAAG,CAMnD,EAAI,EAAc,EAAE,CAAC,IACrB,IAAI,EAAW,EAAO,QAAQ,CAAC,EAAE,IAAI,EACjC,uBAAuB,IAAI,CAAC,IAC5B,CAAA,GAAU,GADd,CAEJ,KACS,aAAa,IAAI,CAAC,IACvB,CAAA,GAAU,GAFd,CAIJ,CAMA,MAHI,uBAAuB,IAAI,CAAC,IAC5B,CAAA,GAAU,IAAiB,CAAA,EAExB,CACX,CA/QA,EAEA,SAAS,IACL,OAAO,EAAO,MAAM,CAAC,IAAI,CAAC,eAC9B,CAqBA,SAAS,EAAW,CAAE,CAAE,CAAE,CAAE,CAAI,EAC5B,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,EACrC,CAeA,SAAS,IACL,IAAI,EAAO,EAAO,QAAQ,GAAI,EAAM,EAAK,OAAO,CAAC,KAAM,EAAO,GAAG,EAC7D,EAAI,UAAU,IAAI,CAAC,EAAK,MAAM,CAAC,EAAO,GAAG,GACzC,GACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,oBAElD,GAAO,GACP,EAAM,GAAG,GACT,EAAa,KACb,EAAW,EAAO,GAAG,CAAE,EAAK,YAC5B,EAAW,EAAK,GAAO,EAAG,oBAC1B,EAAO,GAAG,CAAG,IAEb,EAAW,EAAO,GAAG,CAAE,EAAK,MAAM,CAAE,YACpC,EAAO,GAAG,CAAG,EAAK,MAAM,CAEhC,CAEA,SAAS,EAAW,CAAG,CAAE,CAAI,EACzB,EAAY,CAAA,EAEZ,IADA,IAAI,EAAI,EAAM,CAAA,EAAO,EAAQ,EAAO,GAAG,CAChC,CAAC,EAAO,GAAG,IAAI,CAElB,GADA,EAAK,EAAO,IAAI,GACZ,CAAC,GAAO,IAAO,EAAK,CACpB,EAAM,GAAG,GACT,EAAY,CAAA,EACZ,EAAW,EAAO,EAAO,GAAG,CAAE,GAC9B,IAAI,EAAI,EAAQ,EAAE,CAAC,IACf,GAAK,EAAE,IAAI,EAAI,IACf,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,IAEvB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,EAAO,YAC5C,MACJ,CACA,GAAI,CAAC,GAAO,AAAO,KAAP,GAAc,EAAO,SAAS,CAAC,MAAO,CAC9C,EAAY,CAAA,EACZ,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,IAAK,GAC9D,EAAW,EAAO,EAAO,GAAG,CAAE,GAC9B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,cACxC,EAAM,IAAI,CAAC,GACX,MACJ,CACA,EAAM,CAAC,GAAO,AAAO,OAAP,EACd,EAAO,OAAO,EAClB,CACA,EAAW,EAAO,EAAO,GAAG,CAAE,EAClC,CAEA,SAAS,IAEL,IADA,IAAI,EAAI,EAAM,CAAA,EAAO,EAAQ,EAAG,EAAQ,EAAO,GAAG,CAC3C,CAAC,EAAO,GAAG,IAAI,CASlB,GAzHD,CAAU,CAiHT,EAAK,EAAO,IAAI,GAjHH,EAkHU,CAAC,GAAO,CAAC,GAC5B,IA/GL,CAAW,CAgHO,EAhHH,EAgHU,CAAC,GAEjB,EAAA,EAAQ,GACR,CAAA,EAAQ,CAAA,EAEZ,AAAO,MAAP,GAAc,CAAC,GAAO,CAAC,EAAO,CAC9B,EAAM,GAAG,GACT,EAAW,EAAO,EAAO,GAAG,CAAE,UAC9B,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,IAAI,EAAI,EAAO,SAAS,CAAC,cAGzB,OAFI,GACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,mBAC/C,CAAA,CACX,CACA,EAAM,CAAC,GAAO,AAAO,OAAP,EACd,EAAO,OAAO,EAClB,CACA,EAAW,EAAO,EAAO,GAAG,CAAE,SAClC,CAEA,SAAS,IACL,IAAwB,EAAG,EAAvB,EAAK,EAAO,IAAI,GACpB,GAAI,EAAO,SAAS,CAAC,MACjB,EAAa,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,oBACxC,EAAM,IAAI,CAAC,QAEV,GAAI,EAAO,SAAS,CAAC,MACtB,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,mBACxC,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,gBAExD,GAAI,AAAO,MAAP,GAAc,AAAO,MAAP,GAAc,AAAO,MAAP,EACjC,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,EAAM,IAAI,CAAC,EAAW,IAAI,CAAC,KAAM,EAAI,gBAEpC,GAAK,EAAI,EAAO,SAAS,CAAC,iCAC3B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,eAEjD,GAAI,AAAY,GA/KX,CAAA,EA+KW,IA/KK,SAAS,IAAI,CA+KlB,EA/KmB,GA+KX,CAAA,EAAM,AA5GvC,WAGI,IAFA,IAjEY,EAiER,EAAM,EAAO,GAAG,CAAE,EAAK,EAAO,IAAI,GACtC,EAAO,EAGH,AAFG,CAAC,EAAO,GAAG,KAnEN,EAoER,EAAK,EAAO,IAAI,KAnEV,CAAA,EAAS,IAAO,YAAY,IAAI,CAAC,EAAA,GAsEvC,GAAQ,EACR,EAAO,OAAO,GAElB,OAAO,GAAM,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAK,GAAI,EAAO,GAAG,CAAE,GAAI,CAAK,CACxE,GAiGuC,EAAa,CAC5C,IAAI,EAAO,EAAI,EAAE,IAAI,EAAW,UAC1B,EAAI,EAAE,IAAI,EAAgB,OAC1B,EAAI,EAAE,IAAI,EAAiB,WAC3B,EAAI,EAAE,IAAI,EAAmB,UAC7B,KACN,EAAW,EAAI,EAAE,CAAE,EAAI,EAAE,CAAE,EAC/B,MACK,GAAK,EAnKP,CAAU,CAmKe,EAnKX,CAoKb,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,mBAEpC,GAAK,EAnKP,CAAW,CAmKe,EAnKX,CAmKiB,CAC/B,IAAI,EAAI,EAAQ,GAAG,EACf,AAAM,CAAA,KAAN,GAAa,GAAK,AAAU,MAAV,EAAE,IAAI,EACxB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,eACrC,EAAM,GAAG,IAEJ,AAAC,GAAK,EAAE,IAAI,EAAI,GAGrB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,gBAJrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAM7C,KACS,AAAO,MAAP,GAAc,EAAmB,IAAI,CAAC,EAAO,UAAU,KAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,EAAM,IAAI,CAAC,IAEL,CAAA,EAAI,EAAO,SAAS,CAAC,QAAA,EAC3B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,uBAGlD,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAE7C,CAkGA,OAAO,CAEX,CAAA,EAEuC,IAAI,CACvC,KACA,EAAO,GACP,EAAO,GACP,EAAO,GACP,EAAO,IAGf,IAIA,IAAI,GAAkB,AAAA,EAAa,MAAM,CAAC,KAAM,CAC5C,IAAQ,CAAE,oBAAqB,IAAK,IAAK,UAAW,CACpD,IAAQ,CAAE,oBAAqB,IAAK,IAAK,UAAW,CACpD,MAAQ,CAAE,qBAAsB,IAAK,IAAK,UAAW,CACrD,MAAQ,CAAE,qBAAsB,IAAK,IAAK,UAAW,AACzD,GAIA,AAAA,EAAa,OAAO,CAAC,kBAAmB,WACpC,IAAI,EAAM,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAgB,CAAE,OAAQ,IAAI,CAAE,KAAM,IAAK,IACjE,IAAI,EAAkB,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACnD,IAAI,CAAC,UAAU,CAAC,IAChB,IAAI,EAAe,IAAI,CAAC,IAAI,CAAC,CACzB,qBAAsB,uBACtB,oBAAqB,CACjB,GAAI,uBACJ,GAAI,IACR,EACA,qBAAsB,CAClB,GAAI,+BACJ,GAAI,CAAE,KAAM,KAAM,AACtB,CACJ,GAEA,OAAO,WACH,IAAI,CAAC,YAAY,CAAC,GACb,GACD,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACjC,IAAI,CAAC,SAAS,CAAC,IACf,IAAI,CAAC,IAAI,CAAC,EACd,CACJ,GC9YC,AAAA,WAEG,SAAS,EAAQ,CAAK,EAClB,IAAI,CAAC,KAAK,CAAG,CACjB,CAEA,SAAS,EAAY,CAAM,CAAE,CAAG,EAC5B,IAAI,EAAQ,IAAI,EAAoB,CAAE,OAAQ,EAAQ,IAAK,CAAI,GAC/D,SAAS,IAAS,OAAO,EAAM,IAAI,EAAG,CACtC,SAAS,IAAS,OAAO,EAAM,IAAI,EAAG,CACtC,SAAS,IACL,OAAO,EAAM,UAAU,CAAC,SAAS,CAAE,QAC/B,AAAI,CAAA,EAAC,GAAe,AAAS,MAAT,GAAiB,EAAM,GAAG,EAAI,CAAA,GAC3C,EAAM,aAAa,CAAC,EAC/B,EACJ,CAEA,SAAS,EAAW,CAAI,EAAI,OAAO,EAAM,UAAU,CAAC,EAAM,CAC1D,SAAS,EAAa,CAAK,CAAE,CAAG,CAAE,CAAK,EAFnB,IAMhB,IAFA,IAAI,EAAU,CAAA,EACV,EAAM,KACG,CACT,IAAI,EAAK,IACT,GAAI,CAAC,EAAI,MAAM,IAAI,EAAQ,GAC3B,GAAI,EACA,GAAO,EACP,EAAU,CAAA,OACP,GAAI,AAAM,MAAN,EACH,GAAO,CAAA,GAAO,CAAlB,EACA,EAAU,CAAA,OACP,GAAI,GAAM,EACb,WAEA,GAAO,CAEf,CACA,OAAO,CACX,CACA,SAAS,IACL,OAAO,EAAW,SAAS,CAAE,EAAG,OAAO,GAAM,AAAM,MAAN,CAAW,EAC5D,CACA,SAAS,IACL,IAAI,EAAU,EAAW,WACrB,MAAO,CAAC,EAAM,UAAU,CAAC,KAC7B,GAEA,OA/BgB,IAAA,IA+BT,CACX,CACA,SAAS,IACL,OAAO,EAAa,IAAM,IAC9B,CACA,SAAS,EAAU,CAAG,CAAE,CAAG,EACvB,IAAI,EAAkB,EACtB,EAAa,EACb,GAAI,CACA,IAAI,EAAM,EAAE,CAxCA,IA0CZ,EAAK,OAED,OADA,IACQ,KACN,KAAK,EAAK,MAAM,CAChB,MAAK,KAAM,MAAM,IAAI,EAAQ,EAC7B,SACE,EAAI,IAAI,CAAC,KACT,EAAE,CACN,CAGJ,OArDY,IAqDL,CACX,QAAU,CACN,EAAa,CACjB,CACJ,CACA,SAAS,IAWL,MAAO,CAAE,QAVC,EAAa,IAAK,IAAK,CAAA,GAUV,UATZ,EAAW,SAAS,CAAE,EAC7B,GAAI,EAAI,OAAQ,EAAG,WAAW,IAC5B,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACH,MAAO,CAAA,CACX,CACJ,GAAG,WAAW,EACyB,CAC3C,CACA,SAAS,IACL,OAAO,EAAW,SAAS,CAAE,EACzB,OAAQ,GACN,KAAK,KACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,IACL,IAAK,KACL,IAAK,IACL,IAAK,KACL,IAAK,SACL,IAAK,SACL,IAAK,IACH,MAAO,CAAA,CACX,CACA,MAAO,CAAA,CACX,EACJ,CACA,SAAS,IACL,OAAO,IAAS,EAAW,SAAS,CAAE,EAClC,OAAQ,GAAM,KAAO,GAAM,KACtB,GAAM,KAAO,GAAM,KACnB,GAAM,KAAO,GAAM,KACpB,AAAM,KAAN,GAAa,AAAM,KAAN,CACrB,EACJ,CACA,SAAS,IAEL,OA7GgB,IA6GR,KACN,IAAK,KAAc,OAAR,IAAe,EAAM,OAAQ,EACxC,KAAK,IAAK,OAAO,EAAM,SAAU,EACjC,KAAK,IAAK,OAAO,EAAM,SAAU,EAAU,IAAI,CAAC,KAAM,IAAK,KAC3D,KAAK,IAAa,OAAR,IAAe,EAAM,WAAY,EAC3C,KAAK,IAAa,OAAR,IAAe,EAAM,UAAW,EAC1C,SACE,OAAO,EAAM,UAAW,EAC5B,CACJ,CACA,SAAS,IAEL,GADA,IACI,CAAC,GAAe,AAAS,MAAT,GAAiB,EAAM,GAAG,EAAI,GAAU,CAAA,CAAC,GAAU,AAAe,QAAf,EAAO,IAAI,AAAI,EAClF,OAAO,EAAc,EAAM,SAE/B,OAAQ,KACN,IAAK,IAAO,OAAO,EAAM,UAAW,EACpC,KAAK,IAAO,OAAO,EAAM,SAAU,EACnC,KAAK,IAAO,OAAO,EAAM,OAAQ,EAAU,IAAI,CAAC,KAAM,IAAK,KAC3D,KAAK,IAAO,OAAO,EAAM,OAAQ,EAAU,IAAI,CAAC,KAAM,IAAK,KAC3D,KAAK,IAAO,OAAO,EAAM,OAAQ,EAAU,IAAI,CAAC,KAAM,IAAK,KAC3D,KAAK,IAAO,OAAO,EAAM,QAAS,EAClC,KAAK,IAAe,OAAR,IAAe,EAAM,KAAM,EAAY,GACnD,KAAK,IAEH,GADA,IACI,AAAU,KAAV,IAEA,OADA,IACO,EAAM,SAAU,EAAY,IAEvC,OAAO,EAAM,UAAW,EAAY,GACtC,KAAK,IAAe,OAAR,IAAe,EAAM,QAAS,EAAY,GACtD,KAAK,IACL,KAAK,KADO,OAAO,IAErB,CACA,OAAO,EAAM,SAAU,EAC3B,CACA,SAAS,IAEL,IADA,IAAI,EAAM,EAAE,CACL,AAAU,MAAV,KAAgB,CACnB,IAAI,EAAM,IACV,GAAI,AAAO,MAAP,EAAa,MACjB,EAAI,IAAI,CAAC,GACT,EAAE,CACN,CACA,OAAO,CACX,CACA,IAAI,EAAc,KACd,EAAa,EACb,EAAQ,KACR,EAAS,KACT,EAAW,KACf,SAAS,EAAM,CAAI,CAAE,CAAM,CAAE,CAAY,EACjB,MAAhB,GAAsB,CAAA,EAAe,CAAA,EACzC,IAAI,EAAc,EAClB,GAAI,CACA,IAAI,EAAM,CACN,MAAU,KACV,MAAU,EACV,KAAU,EACV,MAAU,EAAM,GAAG,CAAG,EACtB,OAAU,EACV,MAAU,EAAS,EAAO,KAAK,CAAG,EAAI,EACtC,QAAU,CAAA,CACd,CACY,CAAA,QAAR,GAAgB,CAAA,EAAS,CAA7B,EACA,GAAI,CACI,IACA,EAAI,KAAK,CAAG,IACM,KAAd,EAAI,KAAK,EAET,IAGZ,CAAE,MAAM,EAAI,CACR,GAAI,aAAc,EACd,EAAI,KAAK,CAAG,EAAG,KAAK,CACpB,EAAI,OAAO,CAAG,CAAA,OAEd,MAAM,CAEd,CAOA,OANA,EAAI,GAAG,CAAG,EAAM,GAAG,CACN,MAAT,GACI,EAAI,KAAK,EAAI,GAAS,EAAI,GAAG,EAAI,GAC7B,CAAC,GAAU,CAAA,EAAW,CAA1B,EAGD,CACX,QAAU,CACN,EAAS,CACb,CACJ,CACA,MAAO,CACH,MAAO,SAAS,CAAG,EAEf,OADA,EAAQ,EACD,EAAM,OAAQ,EACzB,EACA,KAAM,WACF,OAAO,GACX,EACA,SAAU,kBACN,AAAI,EACO,EAAY,MAAM,CAAC,KAAK,CAAC,EAAY,KAAK,CAAG,EAAE,CAC/C,EACP,AAAI,AAAiB,QAAjB,EAAS,IAAI,EAAc,EAAS,GAAG,EAAI,EAAQ,EAC5C,EAAS,KAAK,CAAC,EAAE,CAAC,IACtB,EAAS,MAAM,CAAC,KAAK,CAAC,EAAS,KAAK,CAAC,OAEpD,EACA,YAAa,WACT,OAAO,CACX,EACA,SAAU,WACN,OAAO,CACX,EACA,KAAM,WAEF,IADA,IAAI,EAAM,EACH,GAAQ,CAAA,CAAC,oBAAoB,IAAI,CAAC,EAAI,IAAI,GAAK,EAAI,GAAG,EAAI,CAAA,GAC7D,EAAM,EAAI,MAAM,CACpB,OAAO,CACX,CACJ,CACJ,CA+DA,SAAS,EAAG,CAAG,EACX,OAAO,EAAI,IAAI,GAAG,KAAK,CAAC,MAC5B,CAEA,SAAS,EAAO,CAAG,EACf,OAAO,EAAG,GAAK,MAAM,CAAC,CAAC,EAAG,EAAK,IAAO,CAAA,CAAC,CAAC,EAAI,CAAG,EAAI,EAAG,CAAA,EAAI,OAAO,MAAM,CAAC,MAC5E,CAnEA,AAAA,EAAa,WAAW,CAAC,CAErB,gBAAiB,AAAA,EAAkB,WAC/B,GAAI,CACA,IAAI,EAAI,EAAY,IAAI,EACpB,EAAM,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,IAC5B,QAAQ,GAAG,CAAC,GACZ,QAAQ,GAAG,CAAC,EAAE,WAAW,IACzB,QAAQ,GAAG,CAAC,EAAE,QAAQ,IACtB,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAC1B,CAAE,MAAM,EAAI,CACR,QAAQ,GAAG,CAAC,EAChB,CACJ,GAEA,uBAAwB,WACpB,OAAO,EAAY,KAAK,CAAC,IAAI,CAAE,CAAC,IAAI,IAAK,UAAU,CACvD,EAEA,kBAAmB,AAAA,EAAkB,WAEjC,IAAI,EAAM,AADF,EAAY,IAAI,CAAE,IAAI,CAAC,KAAK,IACxB,IAAI,GACZ,GAAK,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,GAAG,CAC1C,GAEA,mBAAoB,AAAA,EAAkB,WAClC,IAAI,EAAI,EAAY,IAAI,EACxB,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,IAClB,IAAI,EAAM,EAAE,QAAQ,GAChB,GAAK,IAAI,CAAC,GAAG,CAAC,YAAa,EAAI,KAAK,CAC5C,GAEA,sBAAuB,AAAA,EAAkB,WACrC,IAAI,EAAI,EAAY,IAAI,EACxB,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,IAClB,IAAI,EAAO,EAAE,IAAI,GACb,GAAQ,EAAK,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,YAAa,EAAK,KAAK,CAC7D,GAEA,yBAA0B,AAAA,EAAkB,WACxC,IAAI,EAAI,EAAY,IAAI,EACxB,EAAE,KAAK,CAAC,IAAI,CAAC,KAAK,IAClB,IAAI,EAAM,EAAE,QAAQ,EAChB,CAAA,GAAO,AAAY,UAAZ,EAAI,IAAI,EAAgB,IAAI,CAAC,KAAK,GAAK,EAAI,GAAG,CACjD,IAAI,CAAC,GAAG,CAAC,aAAc,OACvB,IAAI,CAAC,GAAG,CAAC,gBACH,IAAI,CAAC,GAAG,CAAC,eAAgB,OAG/B,IAAI,CAAC,GAAG,CAAC,SAAU,KAFnB,IAAI,CAAC,GAAG,CAAC,SAAU,QAIvB,IAAI,CAAC,GAAG,CAAC,SAAU,MACnB,IAAI,CAAC,GAAG,CAAC,iBAEjB,EAEJ,GAkBA,IALoB,EAKhB,GAJgB,UAAZ,OADY,EAKW,0rBAJD,CAAA,EAAI,EAAG,EAAjC,EACO,AAAI,OAAO,KAAO,EAAE,IAAI,CAAC,KAAO,KAckC,MAEzE,EAAc,EAAO,cAErB,EAAY,EAAO,SAEnB,EAAa,CACb,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,EAAc,CACd,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,EAAmB,EAAO,uCAE1B,EAAe,EAAO,8BAEtB,EAAY,CACZ,GAAwB,KACxB,IAAwB,KACxB,KAAwB,KACxB,MAAwB,KACxB,YAAwB,KACxB,OAAwB,KACxB,OAAwB,KACxB,MAAwB,KACxB,WAAwB,KACxB,WAAwB,KACxB,UAAwB,KACxB,SAAwB,KACxB,UAAwB,KACxB,SAAwB,KACxB,MAAwB,KACxB,MAAwB,KACxB,MAAwB,KACxB,MAAwB,KACxB,IAAwB,KACxB,OAAwB,KACxB,KAAwB,KACxB,SAAwB,KACxB,kBAAwB,KACxB,qBAAwB,KACxB,iBAAwB,KACxB,MAAwB,KACxB,KAAwB,KACxB,MAAwB,KACxB,KAAwB,KACxB,eAAwB,KACxB,eAAwB,KACxB,eAAwB,KACxB,eAAwB,KACxB,cAAwB,KACxB,MAAwB,KACxB,QAAwB,KACxB,OAAwB,KACxB,sBAAwB,KACxB,UAAwB,KACxB,YAAwB,IAC5B,EAEI,EAAgB,EAAO,wBAW3B,AAAA,EAAgB,MAAM,CAAC,OAAQ,SAAS,CAAM,CAAE,CAAG,CAAE,CAAO,EAIxD,SAAS,EAAc,CAAE,QACrB,CAAI,CAAA,EAAQ,UAAU,EAAI,EAAQ,UAAU,CAAC,IAAI,CAAC,EAAA,GAE3C,CAAA,EAAG,WAAW,IAAM,EAAG,WAAW,IACrC,gCAAgC,IAAI,CAAC,EADzC,CAEJ,CAPK,GAAS,CAAA,EAAU,CAAC,CAAA,EAczB,IAAI,EAAiB,EAAE,CACvB,EAAiB,CAAA,EACjB,EAAiB,CAAA,EACjB,EAAiB,KACjB,EAAiB,EAAE,CACnB,EAAiB,EAAE,CACnB,EAAiB,EAAE,CACnB,EAAiB,EAAE,CACnB,EAAiB,CAAE,KAwGnB,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MACpB,IAAwB,EAApB,EAAK,EAAO,IAAI,GACpB,GAAK,EAAM,EAAO,SAAS,CAAC,qBACxB,IACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,iBAEnD,GAAK,EAAM,EAAO,SAAS,CAAC,uCAC7B,IACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,kBACxC,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,UACpD,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,kBACpC,CAAG,CAAC,EAAE,EACN,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,wBAEvD,GAAI,EAAO,SAAS,CAAC,cACtB,IACA,EAAO,GAAG,EAAI,EAEd,EAAW,AADX,CAAA,EAAM,GAAN,EACe,EAAE,CAAE,EAAI,EAAE,CAAE,sBAE1B,GAAI,EAAO,SAAS,CAAC,MACtB,EAAa,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,oBACxC,EAAM,IAAI,CAAC,QAEV,GAAK,EAAM,EAAO,SAAS,CAAC,OAC7B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,mBACpD,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,gBAExD,GAAI,AAAO,MAAP,EACL,IACA,EAAY,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EAChD,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,EAAM,IAAI,CAAC,EAAW,IAAI,CAAC,KAAM,EAAI,gBAEpC,GAAK,EAAM,EAAO,SAAS,CAAC,mIAC7B,IACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAG,CAAC,EAAE,CAAC,MAAM,CAAE,eAEnD,GAAK,EAnLP,CAAU,CAmLe,EAnLX,CAoLb,IACA,EAAU,IAAI,CAAC,GACf,EAAQ,EAAE,CACV,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,mBAEpC,GAAK,EAtLP,CAAW,CAsLe,EAtLX,CAsLiB,CAC/B,IAAI,EAAI,EAAQ,GAAG,EACf,CAAC,GAAK,EAAE,IAAI,EAAI,GAGhB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAQ,EAAU,GAAG,GACrB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,gBALrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAO7C,MACK,GAAI,AAhLF,EAgLqB,IAAQ,CAAA,EAAM,GAAA,EAAa,CACnD,IAAI,EAAO,AAAM,KAAN,EAAY,eACjB,AAAM,KAAN,EAAY,OACZ,MAAM,IAAI,CAAC,EAAI,EAAE,EAAI,eACrB,EAAc,IAAI,CAAC,EAAI,EAAE,EAAI,UAC7B,EAAI,EAAE,IAAI,EAAc,QACxB,EAAI,EAAE,IAAI,EAAY,WACtB,IACF,EAAC,IAEG,EAAO,IAAqB,AAAgB,GAAhB,EAAM,MAAM,CACxC,EAAO,gBAEF,EAAO,IAAiB,AAAgB,GAAhB,EAAM,MAAM,CACzC,EAAO,OAGF,yCAAyC,IAAI,CAAC,EAAI,EAAE,GACzD,CAAA,EAAO,SADN,GAIT,EAAO,GACP,EAAW,EAAI,EAAE,CAAE,EAAI,EAAE,CAAE,EAC/B,MAEI,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAE7C,EAhM+B,KAE/B,WACI,IAAI,EAAU,EAAQ,OAAO,CAAG,CAC5B,KAAe,EAAM,KAAK,CAAC,GAC3B,MAAe,EACf,SAAe,EACf,UAAe,EACf,OAAe,EAAQ,KAAK,CAAC,GAC7B,aAAe,EAAc,KAAK,CAAC,GACnC,SAAe,EAAU,KAAK,CAAC,GAC/B,KAAe,EAAM,KAAK,CAAC,EAC/B,EACA,SAAS,IASL,OARA,EAAiB,EAAQ,IAAI,CAAC,KAAK,CAAC,GACpC,EAAiB,EAAQ,QAAQ,CACjC,EAAiB,EAAQ,KAAK,CAC9B,EAAiB,EAAQ,SAAS,CAClC,EAAiB,EAAQ,MAAM,CAAC,KAAK,CAAC,GACtC,EAAiB,EAAQ,YAAY,CAAC,KAAK,CAAC,GAC5C,EAAiB,EAAQ,QAAQ,CAAC,KAAK,CAAC,GACxC,EAAiB,EAAQ,IAAI,CAAC,KAAK,CAAC,GAC7B,CACX,CACA,OAAO,CACX,EAzB2C,YAkM3C,WACI,IAAI,EAAc,EAAO,QAAQ,GACjC,GAAI,EACA,OAAO,KAAK,GAAG,CAAC,EAAG,EAAY,MAAM,CAAC,cAE1C,IAAI,EAAS,EAIT,EAAI,EAAQ,EAAE,CAAC,IACnB,GAAI,EAAG,CACH,IAKI,EALA,EAAO,EAAO,QAAQ,CAAC,EAAE,IAAI,EAEjC,GADA,EAAS,EAAE,GAAG,CAAG,EACb,SAAS,IAAI,CAAC,EAAK,MAAM,CAAC,EAAE,GAAG,CAAG,IAClC,OAAO,EAGX,GA9NG,EA8NoB,EAAK,MAAM,CAAC,IAAU,CACzC,IAAI,EAAK,OACT,CAAA,EAAG,SAAS,CAAG,EAAE,GAAG,CACpB,CAAA,EAAe,EAAG,IAAI,CAAC,EAAvB,GAEI,CAAA,EAAS,EAAe,EAAa,KAAK,CAAG,CAAA,CAErD,CACA,GAAI,GAAS,EAAM,MAAM,CAAE,CACvB,IAAI,EAAc,IAClB,GAAI,EAAa,CAEb,IAAI,EAAW,CAAS,CADxB,EAAc,EAAY,OAAO,CAAC,MAAO,IACJ,CAYrC,GAXI,CAAC,GAAY,cAAc,IAAI,CAAC,IAEhC,CAAA,EAAW,IAAX,EAEA,CAAC,GAAY,OAAO,IAAI,CAAC,KAGrB,EADA,GAAgB,WAAW,IAAI,CAAC,EAAK,MAAM,CAAC,IACjC,KAEA,MAEf,CAAC,EAAU,GAAI,CACX,OAAO,MAAM,CAAC,EAAe,CAAS,CAAC,EAAU,MAAM,CAAG,EAAE,CAAC,EAAE,CAAC,EAAE,GAClE,CAAA,EAAW,IADf,CAGJ,CAAE,MAAM,EAAG,CAAC,CACZ,GAAI,EAAU,CACV,IAAI,EAAI,SAAS,EAAU,IACvB,EAAU,KAAK,IAAI,CAAC,GACX,KAAK,IAAI,CAAC,GACvB,EAAS,EAAE,GAAG,CAAG,IACb,GAAW,EACX,EAAS,EAEH,EAAI,GAAK,EAAM,MAAM,CAAG,EAAI,IAE9B,EACA,EAAS,EAET,GAAU,IAEtB,CACJ,CACJ,CACJ,CAEA,OAAO,CACX,CArQoE,EA2BpE,SAAS,EAAW,CAAE,CAAE,CAAE,CAAE,CAAI,EAC5B,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,EACrC,CAEA,SAAS,EAAO,CAAI,EACJ,MAAR,GACA,CAAA,EAAO,CAAE,GAAI,EAAO,GAAG,AAAC,CAAA,EAC5B,EAAM,IAAI,CAAC,EACf,CAEA,SAAS,IAAiB,OAAO,EAAO,MAAM,CAAC,IAAI,CAAC,eAAiB,CAErE,SAAS,IAGL,IAFA,IAAI,EAAM,EAAO,GAAG,CAAE,EAAK,EAAO,IAAI,GACtC,EAAO,EAGH,AAFG,CAAC,EAAO,GAAG,IAET,EADL,EAAK,EAAO,IAAI,KAGhB,GAAQ,EACR,EAAO,OAAO,GAElB,IAAI,EAAM,GAAM,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAK,GAAI,EAAO,GAAG,CAAE,GAAI,EAAK,WAAW,EAAG,EACrF,GAAI,EAAI,EAAE,CAAG,EAAI,EAAE,CAAE,OAAO,CAChC,CAEA,SAAS,EAAW,CAAG,CAAE,CAAI,EAEzB,IADA,IAAI,EAAI,EAAM,CAAA,EAAO,EAAQ,EAAO,GAAG,CAChC,CAAC,EAAO,GAAG,IAAI,CAElB,GADA,EAAK,EAAO,IAAI,GACZ,CAAC,GAAO,IAAO,EAAK,CACpB,EAAM,GAAG,GACT,EAAY,KACZ,EAAW,EAAO,EAAO,GAAG,CAAE,GAC9B,IAAI,EAAI,EAAQ,EAAE,CAAC,IAOnB,OANI,GAAK,EAAE,IAAI,EAAI,IACf,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,IAEvB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,EAAO,YACrC,CAAA,CACX,CACA,EAAM,CAAC,GAAO,AAAO,OAAP,EACd,EAAO,OAAO,EAClB,CACA,EAAW,EAAO,EAAO,GAAG,CAAE,EAClC,CAEA,SAAS,IACL,IAAI,EAAO,EAAO,QAAQ,GAAI,EAAM,EAAK,OAAO,CAAC,KAAM,EAAO,GAAG,EAC7D,EAAI,UAAU,IAAI,CAAC,EAAK,MAAM,CAAC,EAAO,GAAG,GACzC,GACA,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,oBAElD,GAAO,GACP,EAAM,GAAG,GACT,EAAa,KACb,EAAW,EAAO,GAAG,CAAE,EAAK,YAC5B,EAAW,EAAK,GAAO,EAAG,oBAC1B,EAAO,GAAG,CAAG,IAEb,EAAW,EAAO,GAAG,CAAE,EAAK,MAAM,CAAE,YACpC,EAAO,GAAG,CAAG,EAAK,MAAM,CAEhC,CAEA,SAAS,EAAO,CAAI,CAAE,EAAO,CAAK,EAC9B,IAAI,EAAI,GAAQ,EAAK,MAAM,CAAG,GAAK,CAAI,CAAC,EAAE,CAAC,EAAE,CAC7C,GAAI,QAEA,CADA,EAAI,EAAE,WAAW,GACb,AAAQ,MAAR,GACO,EACJ,AAAe,UAAf,OAAO,EAAmB,GAAK,EAAO,KAAK,CAE1D,CAiKA,OAAO,CACX,EAEJ,IAEA,IAAI,GAAwB,AAAA,EAAa,MAAM,CAAC,OAAQ,CACpD,IAAM,CAAE,2BAA4B,AACxC,GAEA,AAAA,EAAa,OAAO,CAAC,YAAa,WAE9B,IAAI,EAAM,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAgB,CAAE,OAAQ,IAAI,CAAE,KAAM,MAAO,IACnE,IAAI,EAAe,IAAI,CAAC,IAAI,CAAC,CACzB,aAAc,EACd,qBAAsB,oBACtB,oBAAqB,CACjB,GAAI,mBACJ,GAAI,IACR,EACA,oBAAqB,2BACzB,GACI,EAAkB,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACnD,IAAI,CAAC,UAAU,CAAC,IAEhB,IAAI,EAAmB,IAAI,CAAC,eAAe,CAAC,CACxC,aAA4B,oBAC5B,cAA4B,qBAC5B,iBAA4B,uBAChC,GAEA,OAAO,WACH,IAAI,CAAC,YAAY,CAAC,GAClB,IAAI,CAAC,IAAI,CAAC,GACV,IAAI,CAAC,WAAW,CAAC,GACZ,GACD,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACjC,IAAI,CAAC,SAAS,CAAC,GACnB,CAEJ,GCvuBA,AAAA,EAAgB,MAAM,CAAC,WAAY,SAAS,CAAM,CAAE,CAAG,EAEnD,IAAI,EAAS,CAAE,KAqDf,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MACpB,AAGJ,CAAA,WACI,IAAI,EAAK,EAAO,IAAI,GAAI,EACxB,GAAI,AAAc,GAAd,EAAO,GAAG,EAAU,CAAA,EAAM,EAAO,SAAS,CAAC,QAAA,EAC3C,EAAW,EAAG,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,mBAAqB,CAAG,CAAC,EAAE,CAAC,MAAM,OAEjF,GAAI,EAAO,IAAI,CAAG,GAAK,AAAc,GAAd,EAAO,GAAG,EAAU,CAAA,EAAM,EAAO,SAAS,CAAC,UAAA,GAAe,KAAK,IAAI,CAAC,EAAO,QAAQ,CAAC,EAAO,IAAI,CAAG,IAE1H,EAAM,mBADN,CAAA,EAAM,AAAoB,KAApB,CAAG,CAAC,EAAE,CAAC,MAAM,CAAC,GAAY,EAAI,CAAA,EAEpC,EAAI,OAAO,CAAC,EAAO,IAAI,CAAG,EAAG,EAAG,EAAO,UAAU,CAAC,EAAO,IAAI,CAAG,GAAI,GACpE,EAAW,EAAG,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,QAE/C,GAAI,AAAc,GAAd,EAAO,GAAG,EAAU,CAAA,EAAM,EAAO,SAAS,CAAC,cAAA,EAChD,CAAA,EAAM,CAAG,CAAC,EAAE,CAAC,OAAO,CAAC,OAAQ,IAAI,MAAM,AAAN,EACvB,GACN,CAAA,EAAM,EADV,EAEA,EAAM,sBAAwB,EAC9B,EAAW,EAAG,EAAO,GAAG,CAAG,EAAO,UAAU,GAAI,QAE/C,GAAK,EAhCH,CAAU,CAgCW,EAhCP,CAiCjB,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,mBAEpC,GAAK,EAhCH,CAAW,CAgCW,EAhCP,CAgCa,CAC/B,IAAI,EAAI,EAAQ,GAAG,EACf,CAAC,GAAK,EAAE,IAAI,EAAI,GAGhB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,gBAJrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAM7C,MAEI,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAE7C,CAAA,GArCA,EA1D2B,KAM3B,WACI,IAAI,EAAU,EAAQ,OAAO,CAAG,CAC5B,KAAe,IAAI,EAAM,CACzB,OAAe,IAAI,EAAQ,CAC3B,OAAe,IAAI,EAAQ,CAC3B,aAAe,IAAI,EAAc,AACrC,EACA,SAAS,IAKL,OAJA,EAAgB,IAAI,EAAQ,IAAI,CAAC,CACjC,EAAgB,IAAI,EAAQ,MAAM,CAAC,CACnC,EAAgB,IAAI,EAAQ,MAAM,CAAC,CACnC,EAAgB,IAAI,EAAQ,YAAY,CAAC,CAClC,CACX,CACA,OAAO,CACX,CArBsC,EAClC,EAAU,EAAE,CACZ,EAAU,EAAE,CACZ,EAAQ,EAAE,CACV,EAAgB,EAAE,CAmBlB,EAAa,CACb,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,EAAc,CACd,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEA,SAAS,EAAW,CAAE,CAAE,CAAE,CAAE,CAAI,EAC5B,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,EACrC,CAsDA,OAAO,CAEX,GAEA,AAAA,EAAa,OAAO,CAAC,gBAAiB,WAElC,IAAI,EAAM,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAgB,CAAE,OAAQ,IAAI,CAAE,KAAM,UAAW,IACvE,IAAI,EAAkB,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACnD,OAAO,WACH,IAAI,CAAC,YAAY,CAAC,GACb,GACD,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,EACrC,CAEJ,GC9GA,IAAI,GAA0B,AAAA,EAAa,MAAM,CAAC,aAAc,CAC5D,QAAiC,sBACjC,QAAiC,cACjC,iBAAiC,eACjC,iBAAiC,gBACjC,8BAAiC,mBACjC,QAAiC,qBACjC,QAAiC,eACjC,MAAiC,UACjC,gBAAiC,YACjC,QAAiC,YACjC,YAAiC,YACjC,QAAiC,kBAEjC,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,CAClE,IAAiC,CAAE,oBAAqB,IAAK,IAAK,UAAW,CAE7E,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,IAAiC,CAAE,qBAAsB,IAAK,IAAK,CAEnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,CACnE,MAAiC,CAAE,qBAAsB,IAAK,IAAK,UAAW,CAE9E,MAAiC,qBACjC,MAAiC,sBACjC,UAAiC,+BAEjC,MAAiC,6BACjC,mBAAiC,uBACrC,GAEA,IAAI,GAAS,CACT,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,GAAW,CACX,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEA,SAAS,GAAM,CAAC,EACZ,MAAM,IAAI,EAAgB,gCAC9B,CAEA,SAAS,GAAU,CAAK,CAAE,CAAK,EAC3B,GAAI,EAAM,GAAG,EAAI,EAAM,IAAI,QACvB,AAAI,AAAa,MAAb,EAAM,GAAG,CACF,EAAM,GAAG,EAAI,EAAM,GAAG,CAEtB,EAAM,EAAE,EAAI,EAAM,GAAG,EACrB,EAAM,GAAG,EAAI,EAAM,EAAE,AAGxC,CAEA,SAAS,GAAU,CAAK,CAAE,CAAK,EAC3B,GAAI,EAAM,GAAG,EAAI,EAAM,IAAI,QACvB,AAAI,AAAa,MAAb,EAAM,GAAG,CACF,EAAM,GAAG,EAAI,EAAM,GAAG,CAAG,EAEzB,EAAM,EAAE,EAAI,EAAM,GAAG,EACrB,EAAM,GAAG,EAAI,EAAM,EAAE,AAGxC,CAEA,SAAS,GAAQ,CAAK,EAClB,OAAO,EAAM,EAAE,EAAI,EAAM,GAAG,AAChC,CAEA,SAAS,GAAM,CAAK,EAChB,OAAO,EAAM,EAAE,EAAK,EAAM,GAAG,CAAG,CACpC,CAEA,AAAA,EAAa,WAAW,CAAC,CAErB,eAAgB,WACZ,IAAI,EAAS,IAAI,CAAC,SAAS,CAAC,aAAa,GACzC,GAAI,EAAQ,CACR,IAAI,EAAK,IAAI,CAAC,OAAO,CAErB,IAAK,IAAI,KADI,AAAA,EAAM,GACI,CACnB,IAAI,EAAK,EAAG,MAAM,CAClB,GAAI,GAAU,EAAI,GACd,OAAO,IAAI,CAAC,iBAAiB,CAAC,EAAG,IAAI,CAAE,GAAM,IAC1C,GAAI,GAAU,EAAI,GACrB,OAAO,IAAI,CAAC,iBAAiB,CAAC,EAAG,IAAI,CAAE,GAAQ,GAEvD,CACJ,CACJ,EAEA,YAAa,AAAA,EAAkB,WAC3B,IAAI,EAAM,IAAI,CAAC,GAAG,CAAC,iBACf,AAAO,OAAP,EACA,IAAI,CAAC,GAAG,CAAC,gBAAiB,IAAI,CAAC,KAAK,GAAI,GAExC,GAAM,IAAI,CAElB,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,EAAM,IAAI,CAAC,GAAG,CAAC,kBACnB,GAAI,AAAO,MAAP,EAEA,OADA,IAAI,CAAC,GAAG,CAAC,YAAa,GACf,CAAA,CAEf,GAEA,aAAc,AAAA,EAAkB,WAC5B,IAAI,EAAS,IAAI,CAAC,SAAS,CAAC,aAAa,GAAI,EAC7C,GAAI,EAAQ,CAER,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAS,AAAA,EAAM,GACnB,IAAK,IAAI,EAAI,EAAG,EAAI,EAAO,MAAM,CAAE,EAAE,EAAG,CACpC,IAAI,EAAI,CAAM,CAAC,EAAE,CACjB,GAAI,EAAE,IAAI,CAAG,EAAG,GAAG,EAAK,EAAE,IAAI,EAAI,EAAG,GAAG,EAAI,GAAQ,IAAM,EAAG,GAAG,CAAG,CAC/D,EAAO,EACP,KACJ,CACJ,CACJ,CACA,IAAI,CAAC,aAAa,CAAC,CACf,YAAa,IAAI,CAAC,IAAI,CAAC,mBAC3B,EAAG,gBACC,GAAQ,EAAK,MAAM,EAAI,AAAA,EAAc,IAAI,CAAC,OAAO,CAAE,GAAQ,GAC3D,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAK,MAAM,CAAC,IAAI,CAAE,GAAM,EAAK,MAAM,GAExF,GAEA,cAAe,AAAA,EAAkB,WAC7B,IAAI,EAAS,IAAI,CAAC,SAAS,CAAC,aAAa,GAAI,EAC7C,GAAI,EAAQ,CAER,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAS,AAAA,EAAM,GAAQ,MAAM,CAAC,AAAA,GAAK,EAAE,MAAM,EAAE,GAAG,CAAC,AAAA,GAAK,EAAE,MAAM,EAAE,IAAI,CAAC,GACzE,IAAK,IAAI,EAAI,EAAO,MAAM,CAAE,EAAE,GAAK,GAAI,CACnC,IAAI,EAAI,CAAM,CAAC,EAAE,CACjB,GAAI,EAAE,IAAI,CAAG,EAAG,GAAG,EAAK,EAAE,IAAI,EAAI,EAAG,GAAG,EAAI,GAAQ,GAAK,EAAG,GAAG,CAAG,CAC9D,EAAO,EACP,KACJ,CACJ,CACJ,CACA,IAAI,CAAC,aAAa,CAAC,CACf,YAAa,IAAI,CAAC,IAAI,CAAC,mBAC3B,EAAG,iBACC,GAAQ,EAAK,MAAM,EAAI,AAAqE,EAArE,AAAA,EAAc,IAAI,CAAC,OAAO,CAAE,CAAE,KAAM,EAAK,IAAI,CAAE,IAAK,GAAM,EAAM,IACvF,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAK,MAAM,CAAC,IAAI,CAAE,GAAQ,EAAK,MAAM,GAE1F,GAEA,UAAW,AAAA,EAAkB,KAAM,SAAS,CAAK,CAAE,CAAG,EAClD,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACnB,IAAI,CAAC,eAAe,EACpB,IAAI,CAAC,GAAG,CAAC,YAAa,GAC1B,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,IACvB,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAC9C,GACA,IAAI,CAAC,mBAAmB,GACxB,IAAI,CAAC,IAAI,CAAC,cAAe,CAAA,EAC7B,GAEA,UAAW,AAAA,EAAkB,WACzB,IAAI,CAAC,cAAc,CACf,IAAI,CAAC,KAAK,GACV,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAEvB,OADA,IAAI,CAAC,GAAG,CAAC,gBACF,IAAI,CAAC,KAAK,EACrB,GAER,GAEA,gBAAiB,AAAA,EAAkB,WAC/B,IAAI,EAAI,EAAE,CACV,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC3C,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC5C,IAAI,CAAC,GAAG,CAAC,iBAAkB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC5C,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAC3C,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,UAAU,CAAC,GAC1C,GAEA,UAAW,AAAA,EAAkB,WACzB,IAAI,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,GACtC,GAAI,EAAK,CACL,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAK,CAAE,KAAM,EAAG,GAAG,CAAE,IAAK,EAAG,GAAG,AAAC,EACjC,EAAI,AAAA,EAAM,GAAK,MAAM,CAAC,AAAA,GAAK,EAAE,MAAM,EAAE,IAAI,CAAC,AAAA,GAAK,AAAA,EAAc,EAAG,IAAO,EACvE,AAAK,OAAL,EACA,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,CAAE,GAAM,KAE3D,GAAM,IAAI,CAElB,CACJ,GAEA,iBAAkB,AAAA,EAAkB,WAChC,IAAI,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,GACtC,GAAI,EAAK,CACL,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAI,AAAA,EAAM,GAAK,MAAM,CAAC,AAAA,EAAY,IAAK,EAAE,CAAC,GAC1C,AAAK,OAAL,EACA,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,CAAE,GAAQ,KAE7D,GAAM,IAAI,CAElB,CACJ,GAEA,QAAS,AAAA,EAAkB,WACvB,IAAI,CAAC,GAAG,CAAC,oBACT,IAAI,CAAC,GAAG,CAAC,eACb,GAEA,mBAAoB,AAAA,EAAkB,WAClC,IAAI,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,GACtC,GAAI,EAAK,CACL,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAI,AAAA,EAAM,GAAK,MAAM,CAAC,AAAA,EAAY,GAAI,CAAC,EAAE,AACzC,AAAK,OAAL,GACA,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,CAAE,GAAQ,KAC7D,IAAI,CAAC,GAAG,CAAC,wBAET,IAAI,CAAC,GAAG,CAAC,gBAEjB,CACJ,GAEA,aAAc,AAAA,EAAkB,WAC5B,IAAI,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,GACtC,GAAI,EAAK,CACL,IAAI,EAAK,IAAI,CAAC,OAAO,CACjB,EAAI,AAAA,EAAM,GAAK,MAAM,CAAC,AAAA,EAAY,GAAI,CAAC,EAAE,AACzC,AAAK,OAAL,GACA,EAAI,EAAE,MAAM,CACZ,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,iBAAiB,CAAC,EAAE,IAAI,CAAE,GAAM,MAE3D,IAAI,CAAC,GAAG,CAAC,eAEjB,CACJ,GAEA,mBAAoB,AAAA,EAAkB,WAClC,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,EAAQ,IAAI,CAAC,KAAK,GACtB,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,GAAG,CAAC,oBACT,IAAI,EAAS,IAAI,CAAC,KAAK,GACvB,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,EAAO,IAAI,CAAC,KAAK,GACjB,EAAO,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,GAC/C,IAAI,CAAC,YAAY,CAAC,EAAQ,EAAM,GAChC,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAQ,EAAS,EAAK,MAAM,CAC1D,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,EAAI,AAAA,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,IACrC,MAAM,CAAC,AAAA,EAAY,IAAI,CAAC,OAAO,CAAE,UAAU,EAAE,CAAC,GAC/C,CAAA,EAAE,KAAK,EAAI,EAAE,KAAK,CAClB,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,EAAc,IAAI,CAAC,iBAAiB,CAAC,EAAE,KAAK,CAAC,EAAE,CAAE,EAAE,KAAK,CAAC,EAAE,EAC3D,EAAY,IAAI,CAAC,iBAAiB,CAAC,EAAE,KAAK,CAAC,EAAE,CAAE,EAAE,KAAK,CAAC,EAAE,EACzD,EAAc,IAAI,CAAC,iBAAiB,CAAC,EAAE,KAAK,CAAC,EAAE,CAAE,EAAE,KAAK,CAAC,EAAE,EAC3D,EAAY,IAAI,CAAC,iBAAiB,CAAC,EAAE,KAAK,CAAC,EAAE,CAAE,EAAE,KAAK,CAAC,EAAE,EAC7D,IAAI,CAAC,WAAW,CAAC,CAAC,EAAI,KAClB,IAAI,CAAC,WAAW,CAAC,EAAW,GAC5B,IAAI,CAAC,WAAW,CAAC,EAAa,GAC9B,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAI,EAClC,EAAG,EAAa,EACpB,GAEA,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,CAAC,GAAG,CAAC,oBACT,IAAI,EAAQ,IAAI,CAAC,KAAK,GACtB,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,CAAC,GAAG,CAAC,wBACT,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,GAAG,CAAC,YAAa,GACtB,IAAI,CAAC,GAAG,CAAC,eACT,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAO,EAAM,EAC3C,EAER,GAEA,6BAA8B,AAAA,EAAkB,KAAM,SAAS,CAAC,EAC5D,GAAI,AAAK,MAAL,EAAW,OAAO,IAAI,CAAC,GAAG,CAAC,uBAAwB,GACvD,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CAC/B,GAAI,IAAI,CAAC,GAAG,CAAC,eAAgB,uBAAwB,CACjD,IAAI,EAAQ,EAAM,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CACrC,GAAI,EAAO,CACP,IAAI,EAAK,AAAI,OAAO,SAAW,EAAO,MAClC,IAAI,CAAC,GAAG,CAAC,aAAc,IAAK,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvD,IAAI,CAAC,GAAG,CAAC,qBACT,IAAI,CAAC,GAAG,CAAC,cACb,EACJ,CACJ,CACA,IAAI,CAAC,GAAG,CAAC,uBACb,CACJ,GAEA,oBAAqB,AAAA,EAAkB,KAAM,SAAS,CAAC,EACnD,GAAI,AAAK,MAAL,EAAW,OAAO,IAAI,CAAC,GAAG,CAAC,cAAe,GAC9C,GAAI,CAAC,IAAI,CAAC,qBAAqB,GAAI,CAC/B,GAAI,IAAI,CAAC,GAAG,CAAC,aAAc,uBAAwB,CAC/C,IAAI,EAAO,EAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CACtC,GAAI,EAAM,CACN,IAAI,EAAK,AAAI,OAAO,KAAO,EAAO,OAAQ,MACtC,IAAI,CAAC,GAAG,CAAC,eAAgB,IAAK,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACzD,IAAI,CAAC,GAAG,CAAC,8BACT,IAAI,CAAC,GAAG,CAAC,uBACb,EACJ,CACJ,CACA,IAAI,CAAC,GAAG,CAAC,cACb,CACJ,GAEA,kBAAmB,AAAA,EAAkB,IAAK,SAAS,CAAM,CAAE,CAAM,CAAE,CAAS,EACxE,GAAI,IAAI,CAAC,eAAe,CAAE,CACtB,IAAI,CAAC,GAAG,CAAC,qBAAsB,EAAQ,EAAQ,GAC/C,MACJ,CACI,GAAU,GAAU,IAAI,CAAC,UAAU,CAAC,GAEpC,IAAI,CAAC,GAAG,CAAC,iBAET,IAAI,CAAC,GAAG,CAAC,SAAU,GACnB,IAAI,CAAC,GAAG,CAAC,SAAU,GACnB,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAO,MAAM,GAE3C,IAAI,CAAC,GAAG,CAAC,uBACb,GAEA,mBAAoB,AAAA,EAAkB,IAAK,SAAS,CAAM,CAAE,CAAM,EAC9D,GAAI,IAAI,CAAC,eAAe,CAAE,CACtB,IAAI,CAAC,GAAG,CAAC,qBAAsB,EAAQ,GACvC,MACJ,CACA,IAAI,EAAK,AAAI,OAAO,SAAW,EAAQ,MACnC,IAAI,CAAC,GAAG,CAAC,aAAc,IACvB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,GAAI,IAAI,CAAC,SAAS,CAAC,KAAK,EACvD,IAAI,CAAC,GAAG,CAAC,SAAU,GACnB,IAAI,CAAC,GAAG,CAAC,uBACb,GAEA,mBAAoB,AAAA,EAAkB,IAAK,SAAS,CAAK,CAAE,CAAO,CAAE,CAAS,EACzE,IAAI,EAAI,IAAI,CAAC,eAAe,CACtB,IAAI,CAAC,SAAS,GACd,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACzB,IAAI,EAAQ,IAAI,CAAC,KAAK,GAEtB,OADA,IAAI,CAAC,GAAG,CAAC,gBACF,CAAE,MAAO,EAAO,IAAK,IAAI,CAAC,KAAK,EAAG,CAC7C,GACA,EAAM,IAAI,CAAC,gBAAgB,CAAC,EAAE,KAAK,CAAE,EAAE,GAAG,EAC1C,EAAS,IAAI,CAAC,KAAK,GAAK,EAAE,GAAG,CAC7B,GACA,CAAA,EAAM,EAAI,OAAO,CAAC,EAAW,AAAA,GAAK,KAAO,EAD7C,EAGA,IAAI,EAAI,IAAI,CAAC,YAAY,CAAC,EAAE,GAAG,EAC/B,IAAI,CAAC,GAAG,CAAC,iBAAkB,WACvB,IAAI,CAAC,YAAY,CAAC,EAAE,KAAK,CAAE,EAAE,GAAG,CAAE,EAAQ,EAAM,EACpD,EAAG,GACC,GACA,IAAI,CAAC,GAAG,CAAC,gBAEb,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAE,KAAK,CAAE,EAAE,WAAW,IAChD,EAAE,OAAO,EACb,GAEA,2BAA4B,AAAA,EAAkB,WAC1C,IAAI,EAAW,IAAI,CAAC,UAAU,CAAC,oBACxB,IAAI,CAAC,YAAY,CAAC,AAAI,OAAO,KAAO,EAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAG,UAAW,MACpF,IAAI,CAAC,GAAG,CAAC,sBACL,IACA,IAAI,CAAC,GAAG,CAAC,sBACT,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,CAAC,GAAG,CAAC,eAEjB,GAEA,qBAAsB,WACd,IAAI,CAAC,IAAI,CAAC,oBACV,IAAI,CAAC,GAAG,CAAC,cAEjB,EAEA,sBAAuB,AAAA,EAAkB,WACrC,IAAI,CAAC,GAAG,CAAC,uBACT,IAAI,CAAC,GAAG,CAAC,uBACb,EAEJ,GAEA,AAAA,EAAa,OAAO,CAAC,mBAAoB,WAErC,IAAI,CAAC,UAAU,CAAC,IAEhB,IAAI,EAAW,AAAA,CAAA,WACX,IAAI,CAAC,aAAa,CAAC,cACvB,CAAA,EAAE,IAAI,CAAC,IAAI,EAMX,IAAI,EAAS,CACT,yBAA0B,WACtB,GACJ,EACA,wBAAyB,AAAA,EAAQ,KAC7B,IAAI,EAAI,IAAI,CAAC,SAAS,CAAC,aAAa,GAAI,EAAK,IAAI,CAAC,OAAO,CACrD,EAAK,EAAE,CACX,GAAI,EAAG,IAAK,IAAI,KAAS,AAAA,EAAM,GAAI,CAC/B,IAAI,EAAQ,EAAM,MAAM,CACpB,EAAM,EAAM,EAAE,EAAI,EAAM,GAAG,CAAE,EAAM,EAAM,EAAE,EAAK,EAAM,GAAG,CAAG,EAAM,IAAI,CAAC,MAAM,CAC7E,EAAM,EAAM,EAAE,EAAI,EAAM,GAAG,CAAE,EAAM,EAAM,EAAE,EAAK,EAAM,GAAG,CAAG,EAChE,GAAI,GAAU,EAAI,IAAU,GAAU,EAAI,GAAQ,CAC9C,EAAG,IAAI,CAAC,CACJ,MAAO,EAAM,IAAI,CAAE,KAAM,EACzB,MAAO,EAAM,IAAI,CAAE,KAAM,CAC7B,EAAG,CACC,MAAO,EAAM,IAAI,CAAE,KAAM,EACzB,MAAO,EAAM,IAAI,CAAE,KAAM,CAC7B,GACA,KACJ,CACJ,CACA,IAAI,CAAC,UAAU,CAAC,cAAe,EACnC,EAAG,IACP,EAOA,OANA,IAAI,CAAC,gBAAgB,CAAC,GAEc,MAAhC,IAAI,CAAC,IAAI,CAAC,oBACV,IAAI,CAAC,IAAI,CAAC,kBAAmB,CAAA,GAG1B,WACH,IACA,IAAI,CAAC,SAAS,CAAC,IACf,IAAI,CAAC,mBAAmB,CAAC,EAC7B,CAEJ,GCheA,IAAM,GAAe,8EACf,GAAe,oMAErB,AAAA,EAAgB,MAAM,CAAC,MAgEvB,SAAuB,CAAM,CAAE,CAAG,CAAE,CAAA,UAAE,CAAS,CAAA,OAAE,CAAM,CAAE,CAAG,CAAC,CAAC,EAC1D,IAAI,EAAQ,EAAE,CACV,EAAQ,EAAE,CACV,EAAU,EAAE,CACZ,EAAgB,EAAE,CAClB,EAAS,KACT,EAAa,KACb,EAAY,CAAA,EACZ,EAAU,EACV,EAAS,CAAE,KAqMf,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MACpB,IAAI,EAAK,EAAO,IAAI,GAAI,EACxB,GAAI,EAAO,SAAS,CAAC,aAAc,CAC/B,IAAI,EAAK,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,CAAE,GAAI,EAAO,GAAG,CAAG,EAAG,KAAM,WAAY,EACpF,EAAQ,IAAI,CAAC,GACb,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,qBACxC,EAAa,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAM,IAAI,CAAC,EAAY,IAAI,CAAC,KAAM,YAAa,MAAO,GAC1D,MACK,GAAI,EAAO,SAAS,CAAC,QAAS,CAC/B,IAAI,EAAK,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,CAAE,GAAI,EAAO,GAAG,CAAG,EAAG,KAAM,MAAO,EAC/E,EAAQ,IAAI,CAAC,GACb,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,EAAG,oBACxC,EAAa,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAM,IAAI,CAAC,EAAY,IAAI,CAAC,KAAM,WAAY,MAAO,GACzD,MACK,GAAK,EAAI,EAAO,SAAS,CAAC,WAC3B,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,kBAEjD,GAAI,EAAO,SAAS,CAAC,OAAS,EAAY,EAAO,IAAI,CAAC,IAAM,CAC7D,IAAI,EAAO,EAAM,GAAG,GAChB,IACA,EAAK,KAAK,CAAC,EAAE,CAAG,EAAO,IAAI,CAC3B,EAAK,KAAK,CAAC,EAAE,CAAG,EAAO,GAAG,CACtB,GACA,CAAA,GAAW,EAAO,IAAI,CAAC,EAAK,EAAE,CAAA,GAGtC,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,CAAE,GAAI,EAAO,GAAG,CAAG,EAAG,KAAM,IAAK,GACjF,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,oBACrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,sBACrC,IAAI,EAAO,IAIX,GAHA,EAAW,EAAK,EAAE,CAAE,EAAK,EAAE,CAAI,GAAQ,EAAK,EAAE,EAAI,EAAK,EAAE,CAC1B,gBACA,SAC3B,EAAM,CACN,IAAI,EAAQ,CAAE,KAAM,EAAK,IAAI,CAAE,GAAI,EAAK,EAAE,CAAE,GAAI,EAAK,EAAE,CAAE,KAAM,EAAK,EAAE,CACxD,MAAO,EAAK,KAAK,CAAE,MAAO,EAAK,KAAK,AAAC,EAC/C,EAAS,CAAE,KAAM,EAAK,IAAI,CAAE,GAAI,EAAK,EAAE,CAAE,GAAI,EAAK,EAAE,CAAE,OAAQ,CAAM,CACxE,CAAA,EAAM,MAAM,CAAG,EACf,EAAc,IAAI,CAAC,EACvB,CACA,EAAM,IAAI,CAAC,EAAiB,IAAI,CAAC,KAAM,GAC3C,MACK,GAAI,AAAO,MAAP,GAAc,EAAY,EAAO,IAAI,CAAC,IAAM,CACjD,IAAI,EAAQ,CAAE,GAAI,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EAC9C,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,oBACrC,IAAI,EAAM,GACV,CAAA,EAAI,KAAK,CAAG,EACZ,EAAW,EAAI,EAAE,CAAE,EAAI,EAAE,CAAE,gBAC3B,EAAS,EACT,EAAM,IAAI,CAAC,EACf,MACK,GAAK,EAAI,EAAO,SAAS,CAAC,UAC3B,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,sBACrC,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAG,EAAG,cACtD,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,2BAEpC,GAAI,AAAO,MAAP,EACL,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,cAEpC,GAAK,EAxEH,CAAU,CAwES,EAxEL,CAyEjB,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,aAAc,CAAA,QAElD,GAAK,EAxEH,CAAW,CAwES,EAxEL,CAwEW,CAC7B,IAAI,EAAI,EAAQ,GAAG,EACf,CAAC,GAAK,EAAE,IAAI,EAAI,GAGhB,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,cAAe,CAAA,IAJpD,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAM7C,MAEI,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAAM,AAAM,KAAN,EAEnD,EAvR2B,KAG3B,WACI,IAAI,EAAU,EAAO,OAAO,CAAG,CAC3B,KAAM,EAAM,KAAK,CAAC,GAClB,KAAM,EAAM,KAAK,CAAC,GAClB,OAAQ,EAAQ,KAAK,CAAC,GACtB,aAAc,EAAc,KAAK,CAAC,GAClC,MAAO,EACP,UAAW,EACX,SAAU,EACV,OAAQ,CACZ,EACA,SAAS,IASL,OARA,EAAQ,EAAQ,IAAI,CAAC,KAAK,CAAC,GAC3B,EAAQ,EAAQ,IAAI,CAAC,KAAK,CAAC,GAC3B,EAAU,EAAQ,MAAM,CAAC,KAAK,CAAC,GAC/B,EAAgB,EAAQ,YAAY,CAAC,KAAK,CAAC,GAC3C,EAAS,EAAQ,KAAK,CACtB,EAAa,EAAQ,SAAS,CAC9B,EAAY,EAAQ,QAAQ,CAC5B,EAAU,EAAQ,MAAM,CACjB,CACX,CACA,OAAO,CACX,EA1BuC,YAyRvC,WACI,IAAI,EAAQ,EACZ,GAAI,EACA,EAAS,EAAO,eAAe,CAAC,EAAW,IAAI,EAAI,SAElD,GAAI,EAAQ,CACb,IAAI,EAAM,EAAO,QAAQ,CAAC,EAAO,IAAI,EAEjC,EADA,QAAQ,IAAI,CAAC,EAAI,MAAM,CAAC,EAAG,EAAO,EAAE,CAAG,IAC9B,EAAO,EAAE,CAAG,EAAO,EAAE,CAAC,MAAM,CAAG,EAE/B,EAAO,eAAe,CAAC,EAAO,IAAI,CAEnD,KACU,CAAA,EAAU,EAAM,EAAE,CAAC,GAAA,IACzB,EAAS,EAAO,eAAe,CAAC,EAAQ,IAAI,EAAI,IAE5C,YAAY,IAAI,CAAC,EAAO,QAAQ,KAChC,CAAA,GAAU,GADd,GAIJ,GAAI,AAAU,MAAV,EAAgB,CAChB,IAAI,EAAO,EAAO,IAAI,CACtB,KAAO,EAAO,GAAK,CAAC,KAAK,IAAI,CAAC,EAAO,QAAQ,CAAC,KAAQ,IACtD,EAAS,EAAO,eAAe,CAAC,EACpC,CAEA,OAAO,CACX,EAnTe,IAAI,MAAO,CAAE,OAAO,CAAM,CAAE,EA2B3C,SAAS,IACL,OAAO,EAAO,MAAM,CAAC,IAAI,CAAC,eAC9B,CAEA,SAAS,EAAW,CAAE,CAAE,CAAE,CAAE,CAAI,CAAE,CAAS,EACvC,GAAI,GAAa,EAAQ,CACrB,IAAI,EAAM,GAAU,EAAO,GAAG,CAAC,IAAY,GACvC,GAAM,CAAA,GAAO,IAAM,CAAvB,EACA,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,GAAO,KAC5C,MACI,EAAI,OAAO,CAAC,EAAO,IAAI,CAAE,EAAI,EAAI,EAEzC,CAEA,SAAS,EAAS,CAAE,EAChB,OAAO,EAAG,WAAW,IAAM,EAAG,WAAW,EAC7C,CAEA,SAAS,EAAY,CAAE,EACnB,OAAO,GAAO,CAAA,EAAS,IAAO,UAAU,IAAI,CAAC,EAAA,CACjD,CAMA,SAAS,IAGL,IAFA,IALgB,EAKZ,EAAM,EAAO,GAAG,CAAE,EAAK,EAAO,IAAI,GACtC,EAAO,EAGH,AAFG,CAAC,EAAO,GAAG,KAPF,EAQZ,EAAK,EAAO,IAAI,KAPN,CAAA,EAAS,IAAO,aAAa,IAAI,CAAC,EAAA,GAU5C,GAAQ,EACR,EAAO,OAAO,GAElB,OAAO,GAAM,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAK,GAAI,EAAO,GAAG,CAAE,GAAI,CAAK,CACxE,CAEA,SAAS,EAAW,CAAG,EACnB,EAAY,CAAA,EAEZ,IADA,IAAI,EAAI,EAAM,CAAA,EAAO,EAAQ,EAAO,GAAG,CAChC,CAAC,EAAO,GAAG,IAAI,CAElB,GADA,EAAK,EAAO,IAAI,GACZ,CAAC,GAAO,IAAO,EAAK,CACpB,EAAM,GAAG,GACT,EAAY,CAAA,EACZ,EAAW,EAAO,EAAO,GAAG,CAAE,UAC9B,IAAI,EAAI,EAAQ,EAAE,CAAC,IACf,GAAK,EAAE,IAAI,EAAI,IACf,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,IAEvB,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,MACJ,CACA,EAAM,CAAC,GAAO,AAAO,OAAP,EACd,EAAO,OAAO,EAClB,CACA,EAAW,EAAO,EAAO,GAAG,CAAE,SAClC,CAEA,SAAS,IACL,IAAwB,EAApB,EAAK,EAAO,IAAI,GACpB,GAAI,EAAO,SAAS,CAAC,MAAO,CACxB,IAAI,EAAI,EAAQ,EAAE,CAAC,IACf,GAAK,AAAU,KAAV,EAAE,IAAI,GACX,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAG,EAAG,OAAQ,CAAE,EAC/D,EAAc,IAAI,CAAC,IAEvB,EAAM,GAAG,GACT,EAAS,KACT,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,sBACrC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,oBACzC,MACK,GAAI,AAAO,MAAP,EAAY,CACjB,IAAI,EAAI,EAAQ,EAAE,CAAC,IACf,GAAK,AAAU,KAAV,EAAE,IAAI,GACX,EAAQ,GAAG,GACX,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,IAEvB,EAAM,GAAG,GACT,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,qBACjC,CAAC,GAAW,KAAK,EAAO,EAAE,IAC1B,EAAO,KAAK,CAAG,CAAE,GAAI,EAAO,IAAI,CAAE,GAAI,EAAO,GAAG,AAAC,EACjD,EAAM,IAAI,CAAC,GACP,GACA,CAAA,GAAW,EAAO,IAAI,CAAC,EAAO,EAAE,CAAA,GAGxC,EAAS,IACb,MACS,EAAY,IAAQ,CAAA,EAAO,GAAA,EAChC,EAAW,EAAK,EAAE,CAAE,EAAK,EAAE,CAAE,iBAExB,AAAO,MAAP,GAAc,AAAO,MAAP,GACnB,EAAQ,IAAI,CAAC,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,KAAM,CAAG,GAC5D,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,kBACrC,EAAM,IAAI,CAAC,EAAW,IAAI,CAAC,KAAM,KAEhC,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,KAC9C,CAEA,SAAS,EAAY,CAAI,CAAE,CAAG,CAAE,CAAE,EAC9B,IAAI,EAAO,EAAO,QAAQ,GAAI,EAAM,EAAK,OAAO,CAAC,EAAK,EAAO,GAAG,CAC5D,CAAA,GAAO,GACP,EAAM,GAAG,GACT,EAAW,EAAO,GAAG,CAAE,EAAK,GAC5B,EAAa,KACb,EAAG,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,GAAI,EAAK,GAAI,EAAM,EAAI,MAAM,CAAE,OAAQ,CAAG,EAC3E,EAAc,IAAI,CAAC,GACnB,EAAW,EAAK,GAAO,EAAI,MAAM,CAAE,EAAO,YAC1C,EAAO,GAAG,CAAG,IAEb,EAAW,EAAO,GAAG,CAAE,EAAK,MAAM,CAAE,GACpC,EAAO,GAAG,CAAG,EAAK,MAAM,CAEhC,CAEA,SAAS,EAAiB,CAAG,EACzB,IAAI,EAAI,EAAO,SAAS,CAAC,oBACzB,GAAI,GAAK,CAAC,CAAC,EAAE,CAGT,CAAA,GAFI,CAAC,CAAC,EAAE,EACJ,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,MAClD,CAAC,CAAC,EAAE,CAAE,CACN,IAAI,EAAI,EAAQ,GAAG,EACnB,CAAA,EAAE,MAAM,CAAG,CAAE,KAAM,EAAO,IAAI,CAAE,IAAK,EAAO,GAAG,CAAE,OAAQ,CAAE,EAC3D,EAAc,IAAI,CAAC,GACnB,EAAW,EAAO,GAAG,CAAE,EAAO,GAAG,EAAI,CAAC,CAAC,EAAE,CAAC,MAAM,CAAE,qBAClD,EAAM,GAAG,GACL,IACA,EAAI,KAAK,CAAC,EAAE,CAAG,EAAO,IAAI,CAC1B,EAAI,KAAK,CAAC,EAAE,CAAG,EAAO,GAAG,CAEjC,CAAA,MAEA,EAAW,EAAO,GAAG,CAAE,EAAE,EAAO,GAAG,CAAE,QAE7C,CAEA,IAAI,EAAa,CACb,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EAEI,EAAc,CACd,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,IACN,IAAM,GACV,EA2HA,OAAO,CACX,GA/XA,AAAA,EAAgB,MAAM,CAAC,OAwZvB,SAAwB,CAAM,CAAE,CAAG,EAC/B,IAAI,EAAQ,EAAE,CACV,EAAO,EAAI,WAAW,CAAC,MAAO,CAC9B,UAAW,GACX,OAAQ,CAAE,KAAM,GAAY,IAAK,EAAU,CAC/C,GACI,EAAM,EAAI,WAAW,CAAC,MACtB,EAAO,EAAI,WAAW,CAAC,OACvB,EAAQ,EAER,EAAS,CACT,KAcJ,WAEI,GADA,EAAO,SAAS,GACZ,EAAM,MAAM,CAAG,EACf,OAAO,EAAM,EAAE,CAAC,MAEpB,GAAI,IAAU,EAAM,CAChB,IAAI,EAAM,EAAK,IAAI,CAAC,EAAE,CAAC,GACnB,CAAA,GAAK,IAAM,SACX,EAAQ,EACD,GAAK,IAAM,SAClB,CAAA,EAAQ,CADL,CAGX,CACI,IAAU,GACN,EAAO,SAAS,CAAC,aACjB,CAAA,EAAQ,CADZ,EAIA,IAAU,GACN,EAAO,SAAS,CAAC,YACjB,CAAA,EAAQ,CADZ,EAKJ,EAAM,IAAI,EACd,EAtCI,KAwCJ,WACI,IAAI,EAAQ,IAAI,EAAM,CAClB,EAAQ,EAAK,IAAI,GACjB,EAAM,EAAI,IAAI,GACd,EAAO,EAAK,IAAI,GAChB,EAAQ,EACZ,SAAS,IAML,OALA,EAAQ,IAAI,EAAM,CAClB,EAAO,IACP,EAAM,IACN,EAAO,IACP,EAAQ,EACD,CACX,CAaA,OAZA,EAAO,OAAO,CAAG,CACb,IAAI,cAAe,CACf,MAAO,IACA,EAAM,OAAO,CAAC,YAAY,IAC1B,EAAI,OAAO,CAAC,YAAY,IACxB,EAAK,OAAO,CAAC,YAAY,CAC/B,AACL,EACA,IAAI,MAAO,CACP,OAAO,EAAM,OAAO,CAAC,IAAI,AAC7B,CACJ,EACO,CACX,EAlEI,IAAI,MAAO,CACP,OAAO,IAAU,EAAO,SACjB,IAAU,EAAO,MACjB,IAAU,EAAM,KAChB,IACX,EACA,IAAI,MAAO,CACP,OAAO,EAAK,IAAI,AACpB,EACA,YA2DJ,iBACI,AAAI,UAAU,IAAI,CAAC,EAAO,QAAQ,IACvB,EAAK,WAAW,GACpB,EAAM,WAAW,EAC5B,CA9DA,EAgEA,OAAO,CACX,GA9eA,IAAI,GAAmB,AAAA,EAAa,MAAM,CAAC,MAAO,CAC9C,QAAY,gBACZ,IAAY,yBACZ,IAAY,sBACZ,UAAY,iBACZ,MAAY,wBAChB,GAEI,GAAc,AAAA,GAAY,WAC1B,IAAI,EAAM,IAAI,CAAC,SAAS,CACxB,IAAI,CAAC,YAAY,CAAC,IAAI,EAAgB,CAAE,OAAQ,IAAI,CAAE,KAAM,CAAS,IACrE,IAAI,EAAkB,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACnD,IAAI,CAAC,UAAU,CAAC,IAChB,IAAI,EAAe,IAAI,CAAC,IAAI,CAAC,CACzB,aAAc,EACd,qBAAsB,CAClB,GAAI,iDACJ,GAAI,CAAE,OAAQ,MAAO,AACzB,EACA,oBAAqB,uBACrB,iBAAkB,sBACtB,GACA,OAAO,WACH,IAAI,CAAC,YAAY,CAAC,GACb,GACD,IAAI,CAAC,GAAG,CAAC,mBAAoB,CAAA,GACjC,IAAI,CAAC,SAAS,CAAC,IACf,IAAI,CAAC,IAAI,CAAC,EACd,CACJ,EAkWA,SAAS,GAAW,CAAG,EACnB,MAAQ,AAAO,KAAP,GAAc,AAAO,MAAP,EAAc,EAC5B,AAAO,KAAP,GAAc,AAAO,UAAP,EAAkB,EAChC,AAAO,KAAP,EAAa,EACb,AAAO,MAAP,EAAc,EACd,AAAO,MAAP,EAAc,GACd,AAAO,MAAP,EAAc,GACd,AAAO,MAAP,EAAc,GACd,CACZ,CAEA,SAAS,GAAU,CAAM,EACrB,IAAI,EAAM,GAQV,OAPa,EAAT,GAAY,CAAA,GAAO,SAAvB,EACa,EAAT,GAAY,CAAA,GAAO,OAAvB,EACa,EAAT,GAAY,CAAA,GAAO,OAAvB,EACa,EAAT,GAAY,CAAA,GAAO,WAAvB,EACa,GAAT,GAAa,CAAA,GAAO,WAAxB,EACa,GAAT,GAAa,CAAA,GAAO,WAAxB,EACa,GAAT,GAAa,CAAA,GAAO,WAAxB,EACO,EAAI,IAAI,IAAM,IACzB,CArXA,AAAA,EAAa,OAAO,CAAC,WAAY,GAAY,QAC7C,AAAA,EAAa,OAAO,CAAC,YAAa,GAAY,SAE9C,AAAA,EAAa,WAAW,CAAC,CACrB,8BAA+B,WAC3B,IAAI,EAAM,AAAA,EAAM,IAAI,CAAC,SAAS,CAAC,aAAa,IACvC,MAAM,CAAC,AAAA,EAAY,IAAI,CAAC,OAAO,CAAE,UACjC,QAAQ,CAAC,AAAA,GAAK,GAAa,IAAI,CAAC,EAAE,IAAI,GAC3C,GAAI,EAAK,CACL,IAAI,EAAI,CACJ,MAAO,IAAI,CAAC,iBAAiB,CAAC,EAAI,KAAK,CAAC,EAAE,CAAE,EAAI,KAAK,CAAC,EAAE,EACxD,IAAK,IAAI,CAAC,iBAAiB,CAAC,EAAI,KAAK,CAAC,EAAE,CAAE,EAAI,KAAK,CAAC,EAAE,CAC1D,EAaA,OAZA,IAAI,CAAC,GAAG,CAAC,iBAAkB,KACvB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAE,KAAK,EACzB,IAAI,CAAC,GAAG,CAAC,aAAc,oBACvB,IAAI,CAAC,GAAG,CAAC,YAAa,IAAI,CAAC,SAAS,CAAC,KAAK,EAC1C,EAAE,KAAK,CAAG,IAAI,CAAC,KAAK,IAExB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAE,GAAG,EACvB,IAAI,CAAC,GAAG,CAAC,eAAgB,mBACzB,IAAI,CAAC,GAAG,CAAC,uBACT,EAAE,GAAG,CAAG,IAAI,CAAC,KAAK,GAE1B,GACO,CACX,CACJ,CACJ,GAqbC,AAAA,WAEG,IAAI,EAAuB,AAAA,EAAa,MAAM,CAAC,UAAW,CACtD,IAAU,mBACV,QAAU,mBACV,MAAU,cACd,GA8GA,SAAS,IACL,IAAI,EAAQ,IAAI,CAAC,KAAK,GACtB,EAAI,IAAI,CAAC,IAAI,CAAC,mBACd,EAAQ,CAAC,CAAC,EAAE,CACZ,EAAM,EAAE,EAAE,CAAC,IACP,CAAA,EAAQ,EAAM,WAAW,IAAM,EAAQ,EAAI,WAAW,IACtD,EAAI,WAAW,IAAM,EAAE,EAAE,CAAC,IAAI,WAAW,EAAA,GACzC,IAAI,CAAC,GAAG,CAAC,eAEjB,CAEA,AAAA,EAAa,WAAW,CAAC,CAErB,cAAe,AAAA,EAAkB,WAC7B,IAAI,CAAC,GAAG,CAAC,sBACT,IAAI,CAAC,GAAG,CAAC,cACb,GAEA,uBAAwB,AAAA,EAAkB,WAEtC,GADA,IAAI,CAAC,GAAG,CAAC,uBACL,IAAI,CAAC,YAAY,CAAC,MAAO,CACzB,IAAI,EAAK,IAAI,CAAC,OAAO,CAGjB,EAAM,AADA,AADG,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,EAC1C,IAAI,GAAG,OAAO,CACjB,IAAI,CAAC,EAAE,CAAC,IAClB,IACA,IAAI,CAAC,kBAAkB,GACvB,IAAI,CAAC,GAAG,CAAC,SAAU,EAAI,EAAE,CAAE,KAC3B,IAAI,CAAC,GAAG,CAAC,eAEjB,CACJ,GAEA,oBAAqB,AAAA,EAAkB,WACnC,IAAI,CAAC,GAAG,CAAC,uBACT,IAAI,EAAK,IAAI,CAAC,OAAO,CAGjB,EAAM,AADA,AADG,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,EAAG,GAAG,CAAE,EAAG,GAAG,EAC1C,IAAI,GAAG,OAAO,CACjB,IAAI,CAAC,EAAE,CAAC,IACtB,GAAI,GAAK,OAAO,IAAM,EAAG,GAAG,EAAI,EAAI,KAAK,CAAC,EAAE,EAAI,EAAG,GAAG,CAAE,CACpD,IAAI,CAAC,kBAAkB,GACvB,IAAI,EAAM,IAAI,CAAC,KAAK,GACpB,IAAI,CAAC,GAAG,CAAC,SAAU,KAAM,EAAI,EAAE,CAAE,KACjC,IAAI,CAAC,GAAG,CAAC,YAAa,EAC1B,CACJ,GAEA,eAAgB,AAAA,EAAkB,WAC9B,IAAI,CAAC,GAAG,CAAC,gBACT,IAAI,EAAO,GACP,EAAQ,IAAI,CAAC,GAAG,CAAC,iBAAkB,WAEnC,IADA,IAAI,CAAC,GAAG,CAAC,uBACF,CAAC,IAAI,CAAC,GAAG,CAAC,eAAgB,wBACxB,IAAI,CAAC,GAAG,CAAC,mBAElB,OAAO,IAAI,CAAC,KAAK,EACrB,GACI,EAAQ,IAAI,CAAC,KAAK,GAEtB,GAAI,EACA,AAtKZ,SAAS,EAAW,CAAE,CAAE,CAAI,EAExB,IAAK,IADD,EAAI,EAAG,MAAM,EAAI,EACZ,EAAI,EAAG,GAAK,EAAG,EAAE,EAClB,EAAI,GACJ,EAAK,MACT,EAAK,IAAK,EAAG,IAAI,EACb,EAAG,EAAE,EACL,EAAK,QAAS,EAAG,EAAE,CAAC,OAAO,CAAC,MAAO,GAAI,KAEvC,EAAG,KAAK,EACR,EAAK,WAAY,EAAG,KAAK,CAAC,OAAO,CAAC,MAAO,GAAI,KAE7C,EAAG,UAAU,EACb,EAAG,UAAU,CAAC,OAAO,CAAC,AAAA,GAAQ,EAAK,IAAK,EAAM,SAElD,EAAK,KACD,EAAG,KAAK,EACR,EAAK,MACL,EAAW,EAAG,KAAK,CAAE,GACrB,EAAK,OAEL,EAAK,KAET,EAAK,KAAM,EAAG,IAAI,CAAE,KAChB,EAAG,IAAI,GACP,EAAK,MACL,EAAW,EAAG,IAAI,CAAE,GAGhC,EA0IgB,AAxIhB,SAAS,EAAU,CAAG,CAAE,CAAC,EACrB,IAAI,EAAK,CAAE,KAAM,EAAG,EAAG,EAlCX,EAmCZ,EAAO,KAAO,EAAI,EAAI,MAAM,EAAE,CAC1B,IAAI,EAAK,EAAI,MAAM,CAAC,KACpB,OAAQ,GAEN,IAAK,IACH,EAxCiC,EAyCjC,EAAG,EAAE,CAAG,GACR,KAEF,KAAK,IACH,EA7CoB,EA8ChB,AAAY,MAAZ,EAAG,KAAK,CACR,EAAG,KAAK,EAAI,IAEZ,EAAG,KAAK,CAAG,GAEf,KAEF,KAAK,IACH,EAtDiE,EAuD5C,MAAjB,EAAG,UAAU,EACb,CAAA,EAAG,UAAU,CAAG,EAAE,AAAF,EACpB,EAAG,UAAU,CAAC,IAAI,CAAC,IACnB,KAEF,KAAK,IACH,EA7DkD,EA8DlD,EAAG,MAAM,CAAG,GACZ,KAEF,KAAK,IACH,EAAG,KAAK,CAAG,EAAU,EAAK,GAC1B,EAAI,EAAG,KAAK,CAAC,CAAC,CACd,MAAM,CAER,KAAK,IACH,EAAG,KAAK,CAAG,EAAU,EAAK,GAC1B,EAAI,EAAG,KAAK,CAAC,CAAC,CACd,KAEF,KAAK,IACH,MAAM,CAER,KAAK,IACH,EAAG,IAAI,CAAG,EAAU,EAAK,GACzB,EAAI,EAAG,IAAI,CAAC,CAAC,CACb,MAAM,CAER,SACE,OAAQ,GACN,KArFE,EAsFA,EAAG,IAAI,EAAI,EACX,KACF,MAxFkB,EAyFhB,EAAG,KAAK,EAAI,EACZ,KACF,MA3F+B,EA4F7B,EAAG,EAAE,EAAI,EACT,KACF,MA9FgD,EA+F9C,EAAG,MAAM,CAAG,SAAS,OAAO,EAAG,MAAM,EAAI,EAAI,IAC7C,KACF,MAjG+D,EAkG7D,EAAG,UAAU,CAAC,IAAI,CAAC,EAAG,UAAU,CAAC,GAAG,GAAK,EAE7C,CACJ,CACJ,CAGA,OADA,EAAG,CAAC,CAAG,EACA,CACX,EAgEoB,IAAI,CAAC,GAAG,CAAC,mBAAoB,EAAO,GAAO,IAAI,GAAI,GAEvD,CAAC,GAAG,IAAS,GAAQ,EAAK,IAAI,CAAC,IAEvC,CAAE,MAAM,EAAI,CACR,MAAM,IAAI,EAAgB,kCAC9B,CAEA,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAO,GACjC,IAAI,CAAC,GAAG,CAAC,SAAU,GACnB,EAAQ,IAAI,CAAC,YAAY,CAAC,EAAO,CAAA,EAAO,WAGxC,IAAI,EAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,GAAI,CAAA,EAAM,WAAY,EAAU,EAAE,CAExE,IADA,IAAI,CAAC,GAAG,CAAC,YAAa,EAAM,WAAW,IAChC,IAAI,CAAC,GAAG,CAAC,iBAAkB,IAAK,EAAI,WAAW,KAClD,IAAI,CAAC,GAAG,CAAC,wBACT,EAAQ,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,GAAI,CAAA,EAAM,kBACnD,EAAQ,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,GAAI,CAAA,EAAO,gBAGxD,IAAI,CAAC,GAAG,CAAC,gBAAiB,EAAM,WAAW,GAAI,EAAI,WAAW,IAG1D,AADQ,EAAQ,MAAM,CACd,GAER,IAAI,CAAC,GAAG,CAAC,YAAa,CAAO,CAAC,EAAE,EAChC,EAAQ,OAAO,CAAC,GAChB,EAAQ,IAAI,CAAC,GACb,IAAI,CAAC,IAAI,CAAC,kBAAmB,GAC7B,IAAI,CAAC,UAAU,CAAC,GAChB,IAAI,CAAC,gBAAgB,CAAC,0BAA2B,KAEjD,EAAM,OAAO,GACb,EAAI,OAAO,GAEnB,GAEA,aAAc,AAAA,EAAkB,WAC5B,IAAI,EAAM,IAAI,CAAC,IAAI,CAAC,mBAChB,IACA,EAAI,GAAG,CAAC,AAAA,GAAK,EAAE,OAAO,IACtB,IAAI,CAAC,IAAI,CAAC,kBAAmB,OAEjC,IAAI,CAAC,SAAS,CAAC,GACf,IAAI,CAAC,mBAAmB,CAAC,0BAA2B,EACxD,GAEA,iBAAkB,AAAA,EAAkB,WAChC,IAAI,EAAU,IAAI,CAAC,IAAI,CAAC,mBAAoB,EAAM,IAAI,CAAC,KAAK,GAC5D,IAAK,IAAI,EAAI,EAAG,EAAI,EAAQ,MAAM,CAAE,EAAE,EAAG,CACrC,IAAI,EAAI,CAAO,CAAC,EAAE,CAClB,GAAI,EAAE,WAAW,GAAK,EAAK,CACvB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAE,WAAW,IACnC,KACJ,CACJ,CACJ,GAEA,iBAAkB,AAAA,EAAkB,WAChC,IAAI,EAAU,IAAI,CAAC,IAAI,CAAC,mBAAoB,EAAM,IAAI,CAAC,KAAK,GAC5D,IAAK,IAAI,EAAI,EAAQ,MAAM,CAAE,EAAE,GAAK,GAAI,CACpC,IAAI,EAAI,CAAO,CAAC,EAAE,CAClB,GAAI,EAAE,WAAW,GAAK,EAAK,CACvB,IAAI,CAAC,GAAG,CAAC,YAAa,EAAE,WAAW,IACnC,KACJ,CACJ,CACJ,GAEA,uBAAwB,AAAA,EAAkB,WACtC,IAAI,EAAW,IAAI,CAAC,UAAU,CAAC,OAAS,IAAI,CAAC,YAAY,CAAC,KAC1D,IAAI,CAAC,GAAG,CAAC,sBACL,IACA,IAAI,CAAC,GAAG,CAAC,sBACT,IAAI,CAAC,GAAG,CAAC,iBACT,IAAI,CAAC,GAAG,CAAC,eAEjB,EAEJ,EAEJ,W,K,K,C,K,Y,C,K,Y,C,K,kB,C,K,e,C,K,iB,C,K,e","sources":["<anon>","src/index.js","src/js/ymacs.js","src/js/ymacs-utils.js","src/js/ymacs-buffer.js","src/js/ymacs-marker.js","src/js/ymacs-keymap.js","src/js/ymacs-keymap-emacs.js","src/js/ymacs-interactive.js","src/js/ymacs-exception.js","src/js/ymacs-textprop.js","src/js/ymacs-popup.js","src/js/ymacs-frame.js","src/js/ymacs-tokenizer.js","src/js/ymacs-commands.js","src/js/ymacs-commands-utils.js","src/js/ymacs-minibuffer.js","src/js/ymacs-isearch.js","src/js/ymacs-mode-css.js","src/js/ymacs-mode-js.js","src/js/ymacs-mode-lisp.js","src/js/ymacs-mode-markdown.js","src/js/ymacs-mode-paren-match.js","src/js/ymacs-mode-xml.js"],"sourcesContent":["/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\nlet $08a06a2e99accb03$var$TEMPLATE = document.createElement(\"template\");\nlet $08a06a2e99accb03$var$OVERLAY;\nlet $08a06a2e99accb03$export$cb0933279c36a66b = {\n    fromHTML (html) {\n        $08a06a2e99accb03$var$TEMPLATE.innerHTML = html.trim();\n        let cont = $08a06a2e99accb03$var$TEMPLATE.content;\n        return cont.children.length > 1 ? cont : cont.children[0];\n    },\n    addClass (el, cls) {\n        el.classList.add(cls);\n    },\n    delClass (el, cls) {\n        if (cls instanceof RegExp) el.className = el.className.replace(cls, \"\");\n        else el.classList.remove(cls);\n    },\n    hasClass (el, cls) {\n        return el.classList.contains(cls);\n    },\n    condClass (el, cond, clsTrue, clsFalse) {\n        el.classList.toggle(clsTrue, !!cond);\n        if (clsFalse) el.classList.toggle(clsFalse, !cond);\n    },\n    toggleClass (el, ...args) {\n        el.classList.toggle(...args);\n    },\n    trash (el) {\n        el && el.remove();\n    },\n    on (element, event, handler, options) {\n        if (typeof event == \"string\") element.addEventListener(event, handler, options || {});\n        else Object.keys(event).forEach((ev)=>$08a06a2e99accb03$export$cb0933279c36a66b.on(element, ev, event[ev], handler || {}));\n    },\n    off (element, event, handler, options) {\n        if (typeof event == \"string\") element.removeEventListener(event, handler, options || {});\n        else Object.keys(event).forEach((ev)=>$08a06a2e99accb03$export$cb0933279c36a66b.off(element, ev, event[ev], handler || {}));\n    },\n    overlayOn (cls) {\n        document.body.appendChild($08a06a2e99accb03$var$OVERLAY);\n        if (cls) $08a06a2e99accb03$var$OVERLAY.className = cls;\n        return $08a06a2e99accb03$var$OVERLAY;\n    },\n    overlayOff () {\n        $08a06a2e99accb03$var$OVERLAY.remove();\n    },\n    mousePos (ev, el) {\n        let box = el.getBoundingClientRect();\n        return {\n            x: ev.clientX - box.left,\n            y: ev.clientY - box.top\n        };\n    },\n    htmlEscape: function(str) {\n        return (str + \"\").replace(/&/g, \"&amp;\").replace(/\\x22/g, \"&quot;\").replace(/\\x27/g, \"&#x27;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\\u00A0/g, \"&#xa0;\");\n    }\n};\n$08a06a2e99accb03$var$OVERLAY = $08a06a2e99accb03$export$cb0933279c36a66b.fromHTML(`<div style=\"position: fixed; z-index: 20000; left: 0; top: 0; right: 0; bottom: 0\"></div>`);\nclass $08a06a2e99accb03$export$76712d54f90f7348 {\n    constructor(options){\n        this._ev_handlers = Object.create(null);\n        this.o = Object.assign(Object.create(this.constructor.options || null), options);\n    }\n    addEventListener(event, handler) {\n        if (typeof event == \"string\") {\n            let a = this._getHandlers(event);\n            $08a06a2e99accb03$export$cd7f480d6b8286c3(a, handler);\n            a.push(handler);\n        } else Object.keys(event).forEach((ev)=>this.addEventListener(ev, event[ev]));\n    }\n    removeEventListener(event, handler) {\n        if (typeof event == \"string\") $08a06a2e99accb03$export$cd7f480d6b8286c3(this._getHandlers(event), handler);\n        else Object.keys(event).forEach((ev)=>this.removeEventListener(ev, event[ev]));\n    }\n    listenOnce(event, handler) {\n        this.addEventListener(event, function fn(...args) {\n            this.removeEventListener(event, fn);\n            return handler.apply(this, args);\n        });\n    }\n    callHooks(ev, ...args) {\n        this._getHandlers(ev).forEach((f)=>f.apply(this, args));\n    }\n    destroy() {\n        this.callHooks(\"onDestroy\");\n    }\n    _getHandlers(ev) {\n        return this._ev_handlers[ev] || (this._ev_handlers[ev] = []);\n    }\n}\nclass $08a06a2e99accb03$export$a829527ff4e4114a extends $08a06a2e99accb03$export$76712d54f90f7348 {\n    constructor(...args){\n        super(...args);\n        this.createElement();\n    }\n    createElement() {\n        let el = document.createElement(\"div\");\n        el.className = this.initClassName();\n        el._ymacs_object = this;\n        this.el = el;\n        return el;\n    }\n    initClassName() {\n        return this.constructor.name; // XXX: fail after minification\n    }\n    getContentElement() {\n        return this.el;\n    }\n    getElement() {\n        return this.el;\n    }\n    add(thing) {\n        if (thing instanceof $08a06a2e99accb03$export$a829527ff4e4114a) thing = thing.getElement();\n        this.getContentElement().appendChild(thing);\n    }\n    addClass(cls) {\n        $08a06a2e99accb03$export$cb0933279c36a66b.addClass(this.getElement(), cls);\n    }\n    delClass(cls) {\n        $08a06a2e99accb03$export$cb0933279c36a66b.delClass(this.getElement(), cls);\n    }\n    hasClass(cls) {\n        return $08a06a2e99accb03$export$cb0933279c36a66b.hasClass(this.getElement(), cls);\n    }\n    condClass(cond, clsTrue, clsFalse) {\n        $08a06a2e99accb03$export$cb0933279c36a66b.condClass(this.getElement(), cond, clsTrue, clsFalse);\n    }\n    toggleClass(...args) {\n        $08a06a2e99accb03$export$cb0933279c36a66b.toggleClass(this.getElement(), ...args);\n    }\n    setContent(cont) {\n        this.getContentElement().innerHTML = cont;\n    }\n    setStyle(prop, val) {\n        let style = this.getElement().style;\n        if (typeof prop == \"string\") style[prop] = val;\n        else Object.assign(style, prop);\n    }\n    getBox() {\n        return this.getElement().getBoundingClientRect();\n    }\n    destroy() {\n        $08a06a2e99accb03$export$cb0933279c36a66b.trash(this.getElement());\n        super.destroy(...arguments);\n    }\n}\nfunction $08a06a2e99accb03$export$cd7f480d6b8286c3(array, element) {\n    let pos = 0;\n    while((pos = array.indexOf(element, pos)) >= 0)array.splice(pos, 1);\n}\nfunction $08a06a2e99accb03$export$ad41d882ec94ba04(fn, timeout = 0, obj, ...args) {\n    if (arguments.length > 2) fn = fn.bind(obj, ...args);\n    let timer = null;\n    return function() {\n        clearTimeout(timer);\n        timer = setTimeout(fn, timeout);\n    };\n}\nvar $08a06a2e99accb03$var$$1K = 1024, $08a06a2e99accb03$var$$1M = $08a06a2e99accb03$var$$1K * 1024, $08a06a2e99accb03$var$$1G = $08a06a2e99accb03$var$$1M * 1024, $08a06a2e99accb03$var$$1T = $08a06a2e99accb03$var$$1G * 1024;\nfunction $08a06a2e99accb03$export$e1a3971de07c83b5(number, fixed) {\n    var sz = number, spec, r;\n    if (sz < $08a06a2e99accb03$var$$1K) spec = \"B\";\n    else if (sz < $08a06a2e99accb03$var$$1M) {\n        sz /= $08a06a2e99accb03$var$$1K;\n        spec = \"K\";\n    } else if (sz < $08a06a2e99accb03$var$$1G) {\n        sz /= $08a06a2e99accb03$var$$1M;\n        spec = \"M\";\n    } else if (sz < $08a06a2e99accb03$var$$1T) {\n        sz /= $08a06a2e99accb03$var$$1G;\n        spec = \"G\";\n    }\n    // spec = \"\" + spec;\n    r = Math.round(sz);\n    if (fixed && sz != r) return sz.toFixed(fixed) + spec;\n    else return r + spec;\n}\nfunction $08a06a2e99accb03$export$3cdc770bf8b2ed3d(thing, width, zero = \"0\") {\n    if (typeof thing == \"number\") thing = Math.round(thing);\n    var s = \"\" + thing;\n    while(s.length < width)s = zero + s;\n    return s;\n}\nfunction $08a06a2e99accb03$export$b43564a9f178c38c(strings) {\n    switch(strings.length){\n        case 0:\n            return \"\";\n        case 1:\n            return strings[0];\n        case 2:\n            let a = strings[0];\n            let b = strings[1];\n            let n = Math.min(a.length, b.length);\n            let i = 0;\n            while(i < n && a.charAt(i) === b.charAt(i))++i;\n            return a.substring(0, i);\n        default:\n            return $08a06a2e99accb03$export$b43564a9f178c38c([\n                strings[0],\n                $08a06a2e99accb03$export$b43564a9f178c38c(strings.slice(1))\n            ]);\n    }\n}\nfunction $08a06a2e99accb03$export$2ceef881d0b4a563() {\n    let themes = [];\n    for (let st of document.styleSheets)digStyle(st);\n    return themes;\n    function digStyle(st) {\n        for (let rule of st.cssRules)digRule(rule);\n    }\n    function digRule(rule) {\n        if (rule instanceof CSSImportRule) digStyle(rule.styleSheet);\n        else {\n            let m = /\\.Ymacs-Theme-([\\p{L}0-9_-]+)/u.exec(rule.selectorText);\n            if (m) {\n                if (themes.indexOf(m[1]) < 0) themes.push(m[1]);\n            }\n        }\n    }\n}\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nclass $c35b14db10f870d1$export$57a830c2aa4f8317 {\n    constructor({ pos: pos = null, editor: editor = null, before: before = false, name: name = null } = {}){\n        this.position = pos;\n        this.editor = editor;\n        this.before = before;\n        this.name = name;\n        this.editor.markers.push(this);\n        this.rowcol = null;\n        this.onChange = [];\n    }\n    destroy() {\n        (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.editor.markers, this);\n        this.editor = null;\n    }\n    editorChange(pos, diff, min) {\n        var p = this.position;\n        if (this.before) --p;\n        if (diff != 0 && pos <= p) {\n            this.rowcol = null;\n            this.position += diff;\n            if (this.position < min) this.position = min;\n            this.callHooks(this.onChange, this.position);\n        }\n    }\n    callHooks(a, arg) {\n        for(var i = a.length; --i >= 0;)a[i].call(this.editor, arg);\n    }\n    getPosition() {\n        return this.position;\n    }\n    valueOf() {\n        return this.position;\n    }\n    setPosition(pos, noHooks, force) {\n        if (force || this.position != pos) {\n            this.rowcol = null;\n            this.position = pos;\n            if (!noHooks) this.callHooks(this.onChange, this.position);\n        }\n    }\n    getRowCol() {\n        return this.rowcol || (this.rowcol = this.editor._positionToRowCol(this.position));\n    }\n    swap(other, noHooks, force) {\n        var tmp = this.getPosition();\n        this.setPosition(other.getPosition(), noHooks, force);\n        other.setPosition(tmp, noHooks, force);\n    }\n}\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\nlet $d9a61832b63ddf79$var$KEYMAPS = Object.create(null);\nclass $d9a61832b63ddf79$export$6b6e17e3540cb3d2 {\n    constructor(keys){\n        this.definitions = Object.create(null);\n        this.defineKeys(keys);\n    }\n    static define(name, keys) {\n        let obj = name && $d9a61832b63ddf79$var$KEYMAPS[name];\n        if (!obj) {\n            obj = keys instanceof this ? keys : new this(keys);\n            if (name) $d9a61832b63ddf79$var$KEYMAPS[name] = obj;\n        }\n        return obj;\n    }\n    static get(name) {\n        return $d9a61832b63ddf79$var$KEYMAPS[name];\n    }\n    static parseKey(str) {\n        var key = {};\n        var a = str.split(/-/);\n        a.reverse();\n        a.forEach((c, i)=>{\n            if (i == 0) key.key = c == \"Space\" ? \" \" : c.length == 1 ? c.toLowerCase() : c;\n            else switch(c){\n                case \"C\":\n                    key.ctrlKey = true;\n                    break;\n                case \"M\":\n                    key.metaKey = true;\n                    break;\n                case \"S\":\n                    key.shiftKey = true;\n                    break;\n            }\n        });\n        a.reverse();\n        var c = a.pop();\n        key.str = a.sort().join(\"-\");\n        if (key.str) key.str += \"-\";\n        key.str += c;\n        return key;\n    }\n    static unparseKey(ev) {\n        var key, a = [];\n        if (\"wheelDelta\" in ev) key = ev.wheelDelta > 0 ? \"WheelUp\" : \"WheelDown\";\n        else {\n            key = ev.key;\n            if (key == \" \") key = \"Space\";\n            if (key.length == 1) key = key.toLowerCase();\n        }\n        if (ev.ctrlKey) a.push(\"C\");\n        if (ev.altKey || ev.ymacsMeta) a.push(\"M\");\n        if (ev.shiftKey && (key.length > 1 || key.toLowerCase() != key.toUpperCase())) a.push(\"S\");\n        a.sort();\n        a.push(key);\n        return a.join(\"-\");\n    }\n    defineKey(key, func, args) {\n        if (func instanceof Array) {\n            args = func.slice(1);\n            func = func[0];\n        }\n        key = key.trim().split(/\\s*&&\\s*/);\n        if (key.length > 1) key.forEach((key)=>this.defineKey(key, func, args));\n        else {\n            key = key[0].trim();\n            var dfn = this.definitions;\n            if (key.indexOf(\" \") >= 0) {\n                var a = key.split(/\\s+/);\n                key = a.pop();\n                a.forEach((key)=>{\n                    key = this.parseKey(key).str;\n                    if (!dfn[key]) dfn[key] = {};\n                    dfn = dfn[key];\n                });\n            }\n            key = this.parseKey(key);\n            dfn[key.str] = [\n                func,\n                args\n            ];\n        }\n    }\n    defineKeys(map) {\n        Object.keys(map).forEach((key)=>this.defineKey(key, map[key]));\n    }\n    getHandler(keys) {\n        let handler = null, def = this.definitions;\n        for (let key of keys){\n            let tmp = handler ? handler[key] : def[key];\n            if (tmp) {\n                handler = tmp;\n                if (Array.isArray(handler)) break;\n            } else {\n                handler = null;\n                break;\n            }\n        }\n        return handler;\n    }\n    attached() {}\n    detached() {}\n}\n$d9a61832b63ddf79$export$6b6e17e3540cb3d2.prototype.parseKey = $d9a61832b63ddf79$export$6b6e17e3540cb3d2.parseKey;\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\nfunction $541ef653595620bf$export$c411e7bd03572a3a(why) {\n    this.message = why;\n}\n\n\nfunction $92bab0a532b3076f$export$1c2a1b3d78098030(args, func) {\n    if (arguments.length == 1) {\n        func = args;\n        args = null;\n    } else {\n        let documentation;\n        if (!(func instanceof Function)) {\n            documentation = func;\n            func = arguments[2];\n            func.ymacsDoc = documentation;\n        }\n    }\n    func.ymacsInteractive = true;\n    if (args != null) {\n        if (!Array.isArray(args)) {\n            var m = /^[\\^\\@\\*]+/.exec(args);\n            if (m) {\n                m = m[0];\n                args = args.substr(m.length);\n                if (m.indexOf(\"^\") >= 0) func.ymacsMarkExtend = true;\n                if (m.indexOf(\"*\") >= 0) func.ymacsWarnReadonly = true;\n                if (m.indexOf(\"@\") >= 0) func.ymacsSelectFrame = true;\n            }\n            if (args) args = args.split(/\\n+/);\n        }\n        if (args) {\n            let collect;\n            let execute = function(...rest) {\n                collect = collect.concat(rest);\n                return this.callInteractively(func, collect, true);\n            };\n            while(args.length > 0){\n                let next = execute;\n                execute = $92bab0a532b3076f$var$createArgumentFunction(args.pop(), function(...rest) {\n                    collect = collect.concat(rest);\n                    return next.call(this);\n                });\n            }\n            func.ymacsCallInteractively = function() {\n                collect = [];\n                return execute.call(this);\n            };\n        }\n    }\n    return func;\n}\nfunction $92bab0a532b3076f$export$8c34793404b3efcb(func) {\n    return $92bab0a532b3076f$export$1c2a1b3d78098030(\"p\", function(n) {\n        if (n == null) n = 1;\n        while(n-- > 0)func.call(this);\n    });\n}\nvar $92bab0a532b3076f$var$$TRUE = function() {};\n$92bab0a532b3076f$var$$TRUE.toString = function() {\n    return \"\";\n};\n$92bab0a532b3076f$var$$TRUE.empty = true;\n/* -----[ argument reader functions ]----- */ function $92bab0a532b3076f$var$prompt(arg) {\n    var pr = this.getPrefixArg(true);\n    if (pr) arg = pr + \" \" + arg;\n    return this.cmd(\"minibuffer_prompt\", arg);\n}\nfunction $92bab0a532b3076f$var$read_function_name(arg, cont) {\n    console.log(\"read_function_name\", arg);\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_function\", cont);\n// XXX: enforce it!\n}\nfunction $92bab0a532b3076f$var$read_existing_buffer_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_buffer\", cont);\n// XXX: enforce it!\n}\nfunction $92bab0a532b3076f$var$read_buffer_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_buffer\", cont);\n}\nfunction $92bab0a532b3076f$var$read_character(arg, cont) {}\nfunction $92bab0a532b3076f$var$read_command_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_command\", cont);\n// XXX: enforce it!\n}\nfunction $92bab0a532b3076f$var$get_point(arg, cont) {\n    return cont.call(this, this.point());\n}\nfunction $92bab0a532b3076f$var$get_mouse_event(arg, cont) {}\nfunction $92bab0a532b3076f$var$irrelevant(arg, cont) {\n    return cont.call(this, null);\n}\nfunction $92bab0a532b3076f$var$read_key_sequence(arg, cont) {}\nfunction $92bab0a532b3076f$var$read_key_sequence2(arg, cont) {}\nfunction $92bab0a532b3076f$var$get_mark(arg, cont) {\n    return cont.call(this, this.markMarker.getPosition());\n}\nfunction $92bab0a532b3076f$var$read_arbitrary_text(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_string\", null, cont);\n}\nfunction $92bab0a532b3076f$var$read_number(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_number\", cont);\n}\nfunction $92bab0a532b3076f$var$read_number_or_prefix(arg, cont) {\n    var n = parseInt(this.getPrefixArg(), 10);\n    if (!isNaN(n)) return cont.call(this, n);\n    else return $92bab0a532b3076f$var$read_number.call(this, arg, cont);\n}\nfunction $92bab0a532b3076f$var$get_numeric_prefix(arg, cont) {\n    var n = parseInt(this.getPrefixArg(), 10);\n    if (isNaN(n)) n = null;\n    return cont.call(this, n);\n}\nfunction $92bab0a532b3076f$var$get_raw_prefix(arg, cont) {\n    arg = this.getPrefixArg();\n    if (arg === \"\") arg = $92bab0a532b3076f$var$$TRUE;\n    return cont.call(this, arg);\n}\nfunction $92bab0a532b3076f$var$get_point_and_mark(arg, cont) {\n    var r = this.getRegion();\n    return cont.call(this, r.begin, r.end);\n}\nfunction $92bab0a532b3076f$var$read_key_sequence3(arg, cont) {}\nfunction $92bab0a532b3076f$var$read_variable_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_variable\", cont);\n}\nfunction $92bab0a532b3076f$var$read_existing_file_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_existing_file\", cont);\n}\nfunction $92bab0a532b3076f$var$read_file_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_file\", cont);\n}\nfunction $92bab0a532b3076f$var$read_file_or_directory_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_file_or_directory\", cont);\n}\nfunction $92bab0a532b3076f$var$read_existing_directory_name(arg, cont) {\n    $92bab0a532b3076f$var$prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_directory\", cont);\n}\nvar $92bab0a532b3076f$var$ARG_READERS = {\n    a: $92bab0a532b3076f$var$read_function_name,\n    b: $92bab0a532b3076f$var$read_existing_buffer_name,\n    B: $92bab0a532b3076f$var$read_buffer_name,\n    c: $92bab0a532b3076f$var$read_character,\n    C: $92bab0a532b3076f$var$read_command_name,\n    d: $92bab0a532b3076f$var$get_point,\n    e: $92bab0a532b3076f$var$get_mouse_event,\n    i: $92bab0a532b3076f$var$irrelevant,\n    k: $92bab0a532b3076f$var$read_key_sequence,\n    K: $92bab0a532b3076f$var$read_key_sequence2,\n    m: $92bab0a532b3076f$var$get_mark,\n    M: $92bab0a532b3076f$var$read_arbitrary_text,\n    n: $92bab0a532b3076f$var$read_number,\n    N: $92bab0a532b3076f$var$read_number_or_prefix,\n    p: $92bab0a532b3076f$var$get_numeric_prefix,\n    P: $92bab0a532b3076f$var$get_raw_prefix,\n    r: $92bab0a532b3076f$var$get_point_and_mark,\n    s: $92bab0a532b3076f$var$read_arbitrary_text,\n    U: $92bab0a532b3076f$var$read_key_sequence3,\n    v: $92bab0a532b3076f$var$read_variable_name,\n    f: $92bab0a532b3076f$var$read_existing_file_name,\n    F: $92bab0a532b3076f$var$read_file_name,\n    G: $92bab0a532b3076f$var$read_file_or_directory_name,\n    D: $92bab0a532b3076f$var$read_existing_directory_name\n};\nfunction $92bab0a532b3076f$var$createArgumentFunction(arg, cont) {\n    let reader = $92bab0a532b3076f$var$ARG_READERS[arg.charAt(0)];\n    arg = arg.substr(1);\n    return function() {\n        return reader.call(this, arg, cont);\n    };\n}\n\n\n// This is the default keymap, as configured in\n// Ymacs_Buffer::makeDefaultKeymap.  It follows closely the standard\n// Emacs keybindings, with some small deviations that match my taste\n// (search for \"my stuff\" below).\n// It would be nice to have more options, such as an Eclipse keymap,\n// or Visual Studio -- but I'm not familiar with any of them.\n// Contributions welcome.\n// A keymap inherits from Ymacs_Keymap and should define its bindings\n// in D.KEYS.  They can also define a defaultHandler property to take\n// whatever action they consider necessary -- for example the Isearch\n// keymap will, by default, print the entered character in the\n// minibuffer and trigger a search action.  Isearch mode is almost\n// completely defined in a keymap -- with the minor note that\n// isearch_forward and isearch_backward are assigned below to key\n// combinations; once pressed, they will push the Isearch keymap onto\n// the buffer's keymap stack, and it will be used until isearch is\n// ended.\n/* KEY DEFINITIONS.  A key is generally defined in standard Emacs\n   notation, with the following notes:\n\n   - it is possible to define multiple keys at once for the same\n     operation, by using the \"&&\" combination (separate with spaces\n     from the actual keys)\n\n   - some special characters are named literally (see event.key\n     https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)\n\n   Normally you would define commands using Ymacs_Buffer.newCommands\n   (see ymacs-commands.js) and specify the command name for key\n   bindings, but you can directly use a function as well:\n\n   \"C-8\": function() {\n     alert(\"You pressed CTRL-8\");\n   }\n\n   It is advised to define commands for more than simple cases, for\n   two reasons:\n\n   1. they can be used for \"non-interactive\" calls too\n\n   2. the command name is saved in this.currentCommand /\n      this.previousCommand, which is useful in a number of cases.\n\n*/ let $2a60837ab2b03436$var$minibuffer_keys = {\n    // movement\n    \"ArrowLeft   && C-b\": \"backward_char\",\n    \"ArrowRight  && C-f\": \"forward_char\",\n    \"Home\": \"beginning_of_indentation_or_line\",\n    \"End && C-e\": \"end_of_line\",\n    \"C-a\": \"beginning_of_line\",\n    \"C-Home && M-<\": \"beginning_of_buffer\",\n    \"C-End && M->\": \"end_of_buffer\",\n    \"C-ArrowRight && M-f\": \"forward_word\",\n    \"C-ArrowLeft && M-b\": \"backward_word\",\n    // transient mark\n    \"S-ArrowLeft     && S-C-b\": \"backward_char_mark\",\n    \"S-ArrowRight    && S-C-f\": \"forward_char_mark\",\n    \"S-C-ArrowRight  && S-M-f\": \"forward_word_mark\",\n    \"S-C-ArrowLeft   && S-M-b\": \"backward_word_mark\",\n    \"S-Home\": \"beginning_of_indentation_or_line_mark\",\n    \"S-C-a\": \"beginning_of_line_mark\",\n    \"S-End && S-C-e\": \"end_of_line_mark\",\n    \"S-C-Home\": \"beginning_of_buffer_mark\",\n    \"S-C-End\": \"end_of_buffer_mark\",\n    // basic editing\n    \"Backspace\": \"backward_delete_char\",\n    \"Delete && C-d\": \"delete_char\",\n    \"M-d && C-Delete\": \"kill_word\",\n    \"C-Backspace && M-Backspace && M-Delete\": \"backward_kill_word\",\n    \"C-k\": \"kill_line\",\n    \"C-y && S-Insert\": \"yank\",\n    \"M-y\": \"yank_pop\",\n    \"C-Space\": \"set_mark_command\",\n    \"C-x C-x\": \"exchange_point_and_mark\",\n    \"C-w\": \"kill_region\",\n    \"M-t\": \"transpose_words\",\n    \"C-t\": \"transpose_chars\",\n    \"M-w\": \"copy_region_as_kill\",\n    \"M-c\": \"capitalize_word\",\n    \"M-u\": \"upcase_word\",\n    \"M-l\": \"downcase_word\",\n    \"F11\": \"nuke_trailing_whitespace\",\n    \"C-/ && C-x u && C-_ && C-z\": \"undo\",\n    \"Insert\": \"overwrite_mode\",\n    \"M-/\": \"dabbrev_expand\",\n    \"C-g\": \"keyboard_quit\",\n    \"Escape\": \"keyboard_quit\",\n    // \"Escape\"                                  : \"_next_is_meta\",\n    // \"M-Escape Escape\"                         : \"keyboard_quit\",\n    \"C-S-y && C-v\": \"yank_from_operating_system\",\n    \"M-S-w\": \"copy_for_operating_system\",\n    \"C-c /\": \"close_last_xml_tag\",\n    \"S-Backspace\": \"backward_delete_whitespace\",\n    \"S-Delete\": \"delete_whitespace\",\n    \"C-x =\": \"what_cursor_position\"\n};\nlet $2a60837ab2b03436$var$emacs_keys = Object.assign({}, $2a60837ab2b03436$var$minibuffer_keys, {\n    // movement\n    \"ArrowUp     && C-p\": \"backward_line\",\n    \"ArrowDown   && C-n\": \"forward_line\",\n    \"ArrowLeft   && C-b\": \"backward_char\",\n    \"ArrowRight  && C-f\": \"forward_char\",\n    \"Home\": \"beginning_of_indentation_or_line\",\n    \"End && C-e\": \"end_of_line\",\n    \"C-a\": \"beginning_of_line\",\n    \"C-Home && M-<\": \"beginning_of_buffer\",\n    \"C-End && M->\": \"end_of_buffer\",\n    \"C-ArrowRight && M-f\": \"forward_word\",\n    \"C-ArrowLeft && M-b\": \"backward_word\",\n    \"C-ArrowDown\": \"forward_paragraph\",\n    \"C-ArrowUp\": \"backward_paragraph\",\n    \"M-h\": \"mark_paragraph\",\n    \"C-l\": \"recenter_top_bottom\",\n    \"PageUp\": \"scroll_up_half\",\n    \"PageDown\": \"scroll_down_half\",\n    \"WheelUp\": \"scroll_up\",\n    \"WheelDown\": \"scroll_down\",\n    // transient mark\n    \"S-ArrowUp       && S-C-p\": \"backward_line_mark\",\n    \"S-ArrowDown     && S-C-n\": \"forward_line_mark\",\n    \"S-ArrowLeft     && S-C-b\": \"backward_char_mark\",\n    \"S-ArrowRight    && S-C-f\": \"forward_char_mark\",\n    \"S-C-ArrowRight  && S-M-f\": \"forward_word_mark\",\n    \"S-C-ArrowLeft   && S-M-b\": \"backward_word_mark\",\n    \"S-C-ArrowDown\": \"forward_paragraph_mark\",\n    \"S-C-ArrowUp\": \"backward_paragraph_mark\",\n    \"S-Home\": \"beginning_of_indentation_or_line_mark\",\n    \"S-C-a\": \"beginning_of_line_mark\",\n    \"S-End && S-C-e\": \"end_of_line_mark\",\n    \"S-C-Home\": \"beginning_of_buffer_mark\",\n    \"S-C-End\": \"end_of_buffer_mark\",\n    // basic editing\n    \"Backspace\": \"backward_delete_char\",\n    \"Delete && C-d\": \"delete_char\",\n    \"Enter && C-m\": \"newline\",\n    \"M-d && C-Delete\": \"kill_word\",\n    \"C-Backspace && M-Backspace && M-Delete\": \"backward_kill_word\",\n    \"C-k\": \"kill_line\",\n    \"C-y && S-Insert\": \"yank\",\n    \"M-y\": \"yank_pop\",\n    \"C-Space\": \"set_mark_command\",\n    \"C-x C-x\": \"exchange_point_and_mark\",\n    \"C-w\": \"kill_region\",\n    \"M-t\": \"transpose_words\",\n    \"C-t\": \"transpose_chars\",\n    \"C-x C-t\": \"transpose_lines\",\n    \"M-w\": \"copy_region_as_kill\",\n    \"M-c\": \"capitalize_word\",\n    \"M-u\": \"upcase_word\",\n    \"M-l\": \"downcase_word\",\n    \"F11\": \"nuke_trailing_whitespace\",\n    \"Tab\": \"indent_line\",\n    \"C-M-\\\\\": \"indent_region\",\n    \"M-q\": \"fill_paragraph\",\n    \"C-/ && C-x u && C-_ && C-z\": \"undo\",\n    \"Insert\": \"overwrite_mode\",\n    \"M-s\": \"center_line\",\n    \"M-/\": \"dabbrev_expand\",\n    \"C-s\": \"isearch_forward\",\n    \"C-r\": \"isearch_backward\",\n    \"C-S-s\": \"isearch_yank_word_or_char\",\n    \"M-C-s\": \"isearch_forward_regexp\",\n    \"M-C-r\": \"isearch_backward_regexp\",\n    \"M-%\": \"query_replace\",\n    \"C-M-%\": \"query_replace_regexp\",\n    \"C-u\": \"universal_argument\",\n    \"M-g\": \"goto_line\",\n    \"C-x h\": \"mark_whole_buffer\",\n    \"C-g\": \"keyboard_quit\",\n    \"M-^\": \"delete_indentation\",\n    \"M-;\": \"comment_dwim\",\n    \"C-x =\": \"what_cursor_position\",\n    \"C-x f\": \"set_fill_column\",\n    // vertical editing\n    \"C-x r t\": \"string_rectangle\",\n    \"C-x r c\": \"clear_rectangle\",\n    \"C-x r k\": \"kill_rectangle\",\n    \"C-x r y\": \"yank_rectangle\",\n    // buffers\n    \"C-x C-ArrowRight && C-x ArrowRight && C-Tab\": \"next_buffer\",\n    \"C-x C-ArrowLeft && C-x ArrowLeft && C-S-Tab\": \"previous_buffer\",\n    \"C-x b\": \"switch_to_buffer\",\n    \"C-x k\": \"kill_buffer\",\n    // frames\n    \"C-x 0\": \"delete_frame\",\n    \"C-x 1\": \"delete_other_frames\",\n    \"C-x 2\": \"split_frame_vertically\",\n    \"C-x 3\": \"split_frame_horizontally\",\n    \"C-x o\": \"other_frame\",\n    \"C-x l\": \"toggle_line_numbers\",\n    // eval\n    \"M-x\": \"execute_extended_command\",\n    \"C-S-y && C-v\": \"yank_from_operating_system\",\n    \"M-S-w\": \"copy_for_operating_system\",\n    // my stuff, sorry if these have different meanings in the standard Emacs keys\n    \"M-S-y\": \"yank_shift\",\n    \"C-c /\": \"close_last_xml_tag\",\n    \"S-Backspace\": \"backward_delete_whitespace\",\n    \"S-Delete\": \"delete_whitespace\",\n    \"C-M-d\": \"delete_region_or_line\",\n    \"M-Enter\": \"start_next_paragraph\",\n    \"C-M-|\": \"cperl_lineup\",\n    \"C-F4\": \"kill_buffer\",\n    \"M-ArrowLeft\": [\n        \"windmove\",\n        \"left\"\n    ],\n    \"M-ArrowRight\": [\n        \"windmove\",\n        \"right\"\n    ],\n    \"M-ArrowUp\": [\n        \"windmove\",\n        \"up\"\n    ],\n    \"M-ArrowDown\": [\n        \"windmove\",\n        \"down\"\n    ],\n    \"C-x e\": \"kmacro_end_and_call_macro\",\n    \"C-x (\": \"kmacro_start_macro\",\n    \"C-x )\": \"kmacro_end_macro\",\n    // file system commands\n    \"C-x C-f\": \"find_file\",\n    \"C-x C-w\": \"write_file\",\n    \"C-x C-s\": \"save_buffer\",\n    \"C-x s\": \"save_some_buffers\"\n});\nlet $2a60837ab2b03436$export$649e07e86b62d08f = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"emacs_mb\", $2a60837ab2b03436$var$minibuffer_keys);\n$2a60837ab2b03436$export$649e07e86b62d08f.defaultHandler = [\n    \"self_insert_command\"\n];\nlet $2a60837ab2b03436$export$e144e07a20daa9d = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"emacs\", $2a60837ab2b03436$var$emacs_keys);\n$2a60837ab2b03436$export$e144e07a20daa9d.defaultHandler = [\n    \"self_insert_command\"\n];\nlet $2a60837ab2b03436$export$7f1c7eed09402475 = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"universal_arg\", {});\n$2a60837ab2b03436$export$7f1c7eed09402475.defaultHandler = [\n    (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        var ev = this.interactiveEvent();\n        var ch = ev.key;\n        var prefix = this.getPrefixArg(true);\n        if ((/^[0-9]$/.test(ch) || ch === \"-\" && prefix === \"\") && !ev.altKey && !ev.ctrlKey) {\n            prefix += ch;\n            this.setPrefixArg(prefix);\n            if (!this.isMinibuffer) this.whenMinibuffer(function(mb) {\n                mb.cmd(\"insert\", \" \", ch);\n            });\n            return true;\n        }\n        this.popKeymap($2a60837ab2b03436$export$7f1c7eed09402475);\n        return false;\n    })\n];\n$2a60837ab2b03436$export$7f1c7eed09402475.attached = (buffer)=>buffer.setPrefixArg(\"\");\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nclass $9e9d7d2dbe50ab17$export$bdebb5ddaa01123f extends (0, $08a06a2e99accb03$export$76712d54f90f7348) {\n    constructor({ buffer: buffer }){\n        super(...arguments);\n        this.buffer = buffer;\n        this.reset();\n    }\n    reset() {\n        this.props = [];\n    }\n    insertLine(row) {\n        if (this.props.length < row) this.props[row] = null;\n        else this.props.splice(row, 0, null);\n    }\n    deleteLine(row) {\n        this.props.splice(row, 1);\n    }\n    replaceLine(row, text) {\n        var p = this.props[row];\n        if (p && p.length > text.length) // remove extra-properties\n        p.splice(text.length);\n    }\n    addLineProps(row, i, j, prop, val) {\n        var p = this.props, o, changed = false;\n        if (i < j) {\n            p = p[row] || (p[row] = []);\n            while(i < j){\n                o = p[i] || (p[i] = {});\n                if (o[prop] != val) changed = true;\n                o[prop] = val;\n                ++i;\n            }\n            if (changed) this.callHooks(\"onChange\", row);\n        }\n        return changed;\n    }\n    removeLineProps(row, i, j, prop) {\n        var p = this.props[row], o, changed = false;\n        if (p && i < j) {\n            while(i < j){\n                o = p[i];\n                if (o && prop in o) {\n                    changed = true;\n                    delete o[prop];\n                }\n                ++i;\n            }\n            if (changed) this.callHooks(\"onChange\", row);\n        }\n        return changed;\n    }\n    spliceLineProps(row, i, diff) {\n        let p = this.props[row];\n        if (p) {\n            if (diff > 0) p.splice(i, 0, ...new Array(diff));\n            else if (diff < 0) p.splice(i, -diff);\n        }\n    }\n    // this uses the \"css\" text property to intercalate <span class=\"$css\"> ... </span> tags in the given text.\n    // \"css\" properties are added as the tokenizer parses the code and sends onFoundToken events.\n    //\n    // XXX: this function will be called a lot of times; seems complicated for what it does. Figure out if it can be\n    // optimized.\n    //\n    // Update: the mess got bigger once I decided to embed the caret in the text, rather than have it absolutely\n    // positioned (which seems to be the only practical way to position the cursor at the correct location).  It is\n    // ESSENTIAL that the start tag of the element that defines the caret ends with \"Ymacs-caret'>\", so that the\n    // frame widget can find it.\n    getLineHTML(row, text, caret) {\n        var p = this.props[row];\n        if (caret === null) {\n            if (text == \"\") return \"<br/>\";\n            if (!p || p.length == 0) return (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text);\n        } else {\n            if (text == \"\") return \"<span class='Ymacs-caret'>&nbsp;</span>\";\n            if (!p || p.length == 0) {\n                if (caret === text.length) return (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text) + \"<span class='Ymacs-caret'>&nbsp;</span>\";\n                return (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text.substr(0, caret)) + \"<span class='Ymacs-caret'>\" + (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text.charAt(caret)) + \"</span>\" + (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text.substr(caret + 1));\n            }\n        }\n        var i = 0, n = text.length, last = null, o, ret = \"\", ch;\n        while(i < n){\n            o = p[i];\n            o = o && o.css;\n            if (i === caret) o = o ? o + \" Ymacs-caret\" : \"Ymacs-caret\";\n            if (o && o != last) {\n                if (last) ret += \"</span>\";\n                ret += \"<span class='\" + o + \"'>\";\n            } else if (!o && last) ret += \"</span>\";\n            last = o;\n            // XXX: Should have used a hash rather than a\n            // switch statement?  I'm not sure but I have\n            // a feeling that switch is faster.\n            ch = text.charAt(i);\n            switch(ch){\n                case \"<\":\n                    ret += \"&lt;\";\n                    break;\n                case \">\":\n                    ret += \"&gt;\";\n                    break;\n                case \"&\":\n                    ret += \"&amp;\";\n                    break;\n                default:\n                    ret += ch;\n                    break;\n            }\n            ++i;\n        }\n        if (last) ret += \"</span>\";\n        if (i === caret) // caret is at EOL\n        ret += \"<span class='Ymacs-caret'>&nbsp;</span>\";\n        return ret;\n    }\n}\n\n\n\n\nlet $5e779a545e33325b$var$GLOBAL_VARS = {\n    case_fold_search: null,\n    case_replace: true,\n    line_movement_requested_col: 0,\n    fill_column: 78,\n    tab_width: 8,\n    indent_level: 4,\n    sticky_mark: false,\n    // syntax variables\n    syntax_word: /^[\\p{N}\\p{L}]$/u,\n    syntax_capitalize_word: /([\\p{N}\\p{L}])([\\p{N}\\p{L}]*)/ug,\n    syntax_word_dabbrev: /^[\\p{N}_$\\p{L}]$/u,\n    syntax_word_sexp: /^[\\p{N}_$\\p{L}]$/u,\n    syntax_paragraph_sep: /\\n(?:[^\\S\\r\\n]*\\n)+/g\n};\nconst $5e779a545e33325b$var$MAX_UNDO_RECORDS = 50000; // XXX: should we not limit?\nfunction $5e779a545e33325b$var$setq(key, val) {\n    if (typeof key == \"string\") {\n        if (val === undefined) delete this[key];\n        else this[key] = val;\n        if (val instanceof Function) val.ymacsCommand = key;\n        return val;\n    } else {\n        var changed = Object.create(null);\n        for(var i in key){\n            changed[i] = this[i];\n            $5e779a545e33325b$var$setq.call(this, i, key[i]);\n        }\n        return changed;\n    }\n}\nfunction $5e779a545e33325b$var$MRK(x) {\n    return x instanceof (0, $c35b14db10f870d1$export$57a830c2aa4f8317) ? x.getPosition() : x;\n}\nclass $5e779a545e33325b$export$df331bdfc76955b4 extends (0, $08a06a2e99accb03$export$76712d54f90f7348) {\n    static options = {\n        name: \"*scratch*\",\n        code: \"\",\n        ymacs: null,\n        tokenizer: null\n    };\n    static COMMANDS = Object.create(null);\n    static newCommands(...args) {\n        return $5e779a545e33325b$var$setq.apply(this.COMMANDS, args);\n    }\n    static replaceCommands(cmds) {\n        this.COMMANDS = Object.assign(Object.create(null), this.COMMANDS);\n        let replacements = Object.create(null);\n        Object.keys(cmds).forEach((oldcmd)=>{\n            let newcmd = cmds[oldcmd];\n            if (typeof newcmd == \"string\") newcmd = this.COMMANDS[newcmd];\n            replacements[oldcmd] = newcmd;\n        });\n        return this.newCommands(replacements);\n    }\n    static newMode(name, activate) {\n        let modevar = \"*\" + name + \"*\", hookvar = modevar + \"hooks\";\n        $5e779a545e33325b$export$df331bdfc76955b4.setGlobal(hookvar, []);\n        this.COMMANDS[name] = (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"P\", function(force) {\n            let status = this.getq(modevar);\n            if (status) // currently active\n            {\n                if (force !== true) {\n                    // deactivate\n                    this.getq(hookvar).forEach((hook)=>hook.call(this, false));\n                    if (status instanceof Function) // clean-up\n                    status.call(this);\n                    this.setq(modevar, null);\n                    (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.modes, name);\n                }\n            } else // inactive\n            if (force !== false) {\n                let off = activate.apply(this, arguments);\n                if (!(off instanceof Function)) off = true;\n                this.setq(modevar, off);\n                this.modes.push(name);\n                this.getq(hookvar).forEach((hook)=>hook.call(this, true));\n            }\n            return status;\n        });\n    }\n    static getVariable(key) {\n        return $5e779a545e33325b$var$GLOBAL_VARS[key];\n    }\n    static setVariable() {\n        return $5e779a545e33325b$var$setq.apply($5e779a545e33325b$var$GLOBAL_VARS, arguments);\n    }\n    constructor(...args){\n        super(...args);\n        this.isMinibuffer = this instanceof $5e779a545e33325b$export$36a0d48d1b18d0fa;\n        this.COMMANDS = Object.assign(Object.create(null), this.COMMANDS);\n        this.name = this.o.name;\n        this.ymacs = this.o.ymacs;\n        this.tokenizer = this.o.tokenizer;\n        this.__savingExcursion = 0;\n        this.__preventUpdates = 0;\n        this.__preventUndo = 0;\n        this.__undoInProgress = 0;\n        this.__dirtyLines = [];\n        this.__undoQueue = [];\n        this.__undoPointer = 0;\n        this.markers = [];\n        this.caretMarker = this.createMarker(0, false, \"point\");\n        this.markMarker = this.createMarker(0, true, \"mark\");\n        this.matchData = [];\n        this.previousCommand = null;\n        this.currentCommand = null;\n        this.currentKeys = [];\n        this.progress = Object.create(null);\n        this.variables = Object.create(null);\n        this.globalVariables = $5e779a545e33325b$var$GLOBAL_VARS;\n        this.modes = [];\n        this.caretMarker.onChange.push(function(pos) {\n            this._rowcol = this.caretMarker.getRowCol();\n            // XXX: this shouldn't be needed\n            if (!this.__preventUpdates) this.callHooks(\"onPointChange\", this._rowcol, this.point());\n        });\n        this._tokenizerEvents = {\n            \"onFoundToken\": this._on_tokenizerFoundToken.bind(this)\n        };\n        this._textProperties = new (0, $9e9d7d2dbe50ab17$export$bdebb5ddaa01123f)({\n            buffer: this\n        });\n        this._textProperties.addEventListener(\"onChange\", this._on_textPropertiesChange.bind(this));\n        this.keymap = [];\n        this.pushKeymap(this.makeDefaultKeymap());\n        this.setCode(this.o.code);\n        this._lastCommandWasKill = 0;\n    }\n    addModeHook(name, func) {\n        if (typeof func == \"string\") func = this.COMMANDS[func];\n        let hookvar = \"*\" + name + \"*hooks\";\n        this.getq(hookvar).pushUnique(func);\n    }\n    removeModeHook(name, func) {\n        if (typeof func == \"string\") func = this.COMMANDS[func];\n        let hookvar = \"*\" + name + \"*hooks\";\n        (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.getq(hookvar), func);\n    }\n    withVariables(vars, cont) {\n        var saved = this.variables;\n        this.variables = Object.assign(Object.create(this.variables), vars);\n        try {\n            if (cont instanceof Function) return cont.apply(this, [\n                ...arguments\n            ].slice(2));\n            else return this.cmdApply(cont, [\n                ...arguments\n            ].slice(2));\n        } finally{\n            this.variables = saved;\n        }\n    }\n    withCommands(cmds, cont) {\n        var saved = this.COMMANDS;\n        this.COMMANDS = Object.assign(Object.create(this.COMMANDS), cmds);\n        try {\n            if (cont instanceof Function) return cont.apply(this, [\n                ...arguments\n            ].slice(2));\n            else return this.cmdApply(cont, [\n                ...arguments\n            ].slice(2));\n        } finally{\n            this.COMMANDS = saved;\n        }\n    }\n    getVariable(name) {\n        return name in this.variables ? this.variables[name] : $5e779a545e33325b$var$GLOBAL_VARS[name];\n    }\n    setVariable() {\n        return $5e779a545e33325b$var$setq.apply(this.variables, arguments);\n    }\n    /* -----[ public API ]----- */ lastIndexOfRegexp(str, rx, caret, bound = 0) {\n        if (!rx.global) rx = new RegExp(rx.source, rx.flags + \"g\");\n        rx.lastIndex = bound;\n        let match;\n        while(true){\n            let pos = rx.lastIndex;\n            let m = rx.exec(str);\n            if (!m || rx.lastIndex > caret) break;\n            match = m;\n            match.after = rx.lastIndex;\n            if (rx.lastIndex <= pos) {\n                // this can happer when rx matches the empty string in the middle of an unicode\n                // surrogate pair (which we don't properly support for now). the browser will rewind\n                // lastIndex to the proper start of the code point (:-o I'm impressed!), so let's\n                // skip it to avoid an endless loop.\n                let skipOne = /[^]/ug;\n                skipOne.lastIndex = rx.lastIndex;\n                skipOne.exec(str);\n                rx.lastIndex = skipOne.lastIndex;\n            }\n        }\n        if (match) return this.matchData = match;\n    }\n    pushKeymap(keymap) {\n        if (keymap instanceof Array) keymap.forEach(this.pushKeymap, this);\n        else {\n            this.popKeymap(keymap);\n            this.keymap.push(keymap);\n            keymap.attached(this);\n        }\n    }\n    popKeymap(keymap) {\n        (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.keymap, keymap);\n        keymap.detached(this);\n    }\n    makeDefaultKeymap() {\n        return this.isMinibuffer ? (0, $2a60837ab2b03436$export$649e07e86b62d08f) : (0, $2a60837ab2b03436$export$e144e07a20daa9d);\n    }\n    signalError(text, isHtml, timeout) {\n        // Terminates a running macro\n        this.ymacs.indicateError();\n        this.callHooks(\"onMessage\", {\n            type: \"error\",\n            text: text,\n            isHtml: isHtml,\n            timeout: timeout\n        });\n    }\n    signalInfo(text, isHtml, timeout) {\n        this.callHooks(\"onMessage\", {\n            type: \"info\",\n            text: text,\n            isHtml: isHtml,\n            timeout: timeout\n        });\n    }\n    popupMessage(args) {\n        this.callHooks(\"onMessage\", args);\n    }\n    createMarker(pos, before, name) {\n        if (pos == null) pos = this.point();\n        return new (0, $c35b14db10f870d1$export$57a830c2aa4f8317)({\n            editor: this,\n            pos: pos,\n            name: name,\n            before: before\n        });\n    }\n    point() {\n        return this.caretMarker.getPosition();\n    }\n    dirty(dirty) {\n        if (arguments.length > 0) {\n            this.__isDirty = dirty;\n            this.__undoQueue.forEach((x)=>{\n                if (x.type !== 3) x.dirty = true;\n            });\n            this.updateModeline();\n        }\n        return this.__isDirty;\n    }\n    setCode(code) {\n        // this.__code = code = code.replace(/\\t/g, \" \".repeat(this.getq(\"tab_width\")));\n        this.__isDirty = false;\n        this.__code = code;\n        this.__size = code.length;\n        this.__undoQueue = [];\n        this.__undoPointer = 0;\n        this.markers.map((m)=>m.setPosition(0, true, true));\n        this.code = code.split(/\\n/);\n        this._textProperties.reset();\n        if (this.tokenizer) this.tokenizer.reset();\n        this.callHooks(\"onResetCode\", this.code);\n        this.caretMarker.setPosition(0, false, true);\n        this.markMarker.setPosition(0, true);\n        this.forAllFrames((frame)=>{\n            frame.ensureCaretVisible();\n            frame.redrawModelineWithTimer();\n        });\n    }\n    setTokenizer(tok) {\n        if (this.tokenizer != null) this.tokenizer.removeEventListener(this._tokenizerEvents);\n        this.tokenizer = tok;\n        if (tok) {\n            tok.addEventListener(this._tokenizerEvents);\n            tok.reset();\n        } else {\n            this._textProperties.reset();\n            this.callHooks(\"onResetCode\", this.code);\n        }\n    }\n    getCode() {\n        return this.__code || (this.__code = this.code.join(\"\\n\"));\n    }\n    getCodeSize() {\n        if (this.__size) return this.__size;\n        var i = this.code.length, size = i > 0 ? -1 : 0;\n        while(--i >= 0)size += this.code[i].length + 1;\n        return this.__size = size;\n    }\n    getLine(row) {\n        if (row == null) row = this._rowcol.row;\n        return this.code[row];\n    }\n    charAtRowCol(row, col) {\n        let n = this.code.length;\n        if (row >= n--) return null;\n        var line = this.code[row];\n        if (col == line.length) return row == n ? null : \"\\n\";\n        return line.charAt(col);\n    }\n    charAt(point) {\n        if (point == null) point = this.point();\n        else {\n            point = $5e779a545e33325b$var$MRK(point);\n            if (point < 0) point += this.point();\n        }\n        var rc = this._positionToRowCol(point);\n        return this.charAtRowCol(rc.row, rc.col);\n    }\n    callInteractively(func, args, finalArgs) {\n        if (!args) args = [];\n        var cmd;\n        if (!(func instanceof Function)) {\n            cmd = func;\n            func = this.COMMANDS[func];\n        } else cmd = func.ymacsCommand || null;\n        if (func.ymacsCallInteractively && !finalArgs) // after prompting for eventual\n        // arguments, ymacsCallInteractively\n        // will actually call back again\n        // buffer's callInteractively, so we\n        // should STOP here.\n        return func.ymacsCallInteractively.apply(this, args);\n        this.currentCommand = cmd;\n        if (this.previousCommand != cmd) {\n            this.sameCommandCount(0);\n            if (cmd != \"undo\") this._placeUndoBoundary();\n        } else if (cmd != \"self_insert_command\" || this.sameCommandCount() % 20 == 0) {\n            if (cmd != \"undo\") this._placeUndoBoundary();\n        }\n        this.preventUpdates();\n        try {\n            this.callHooks(\"beforeInteractiveCommand\", cmd, func);\n            if (!func.ymacsMarkExtend && !this.getq(\"sticky_mark\")) this.clearTransientMark();\n            return func.apply(this, args);\n        } catch (ex) {\n            if (ex instanceof (0, $541ef653595620bf$export$c411e7bd03572a3a)) this.signalError(ex.message);\n            else throw ex;\n        } finally{\n            if (this.getq(\"sticky_mark\")) this.ensureTransientMark();\n            if (cmd != \"undo\") this.__undoPointer = this.__undoQueue.length;\n            this.resumeUpdates();\n            this.callHooks(\"afterInteractiveCommand\", cmd, func);\n            this.previousCommand = cmd;\n            this.sameCommandCount(1);\n            if (this.tokenizer) this.tokenizer.start();\n        }\n    }\n    resetOverwriteMode(om) {\n        if (arguments.length == 0) om = this.overwriteMode;\n        this.callHooks(\"onOverwriteMode\", this.overwriteMode = !om);\n        this.signalInfo(om ? \"Insert mode\" : \"Overwrite mode\");\n    }\n    getMinibuffer() {\n        return this.whenYmacs(function(ymacs) {\n            return ymacs.minibuffer;\n        });\n    }\n    getMinibufferFrame() {\n        return this.whenYmacs(function(ymacs) {\n            return ymacs.minibuffer_frame;\n        });\n    }\n    setMinibuffer(text) {\n        this.whenMinibuffer(function(mb) {\n            mb.setCode(text);\n            mb.cmd(\"end_of_buffer\");\n        });\n    }\n    cmd(cmd, ...args) {\n        return this.COMMANDS[cmd].apply(this, args);\n    }\n    cmdApply(cmd, args) {\n        return this.COMMANDS[cmd].apply(this, args);\n    }\n    forEachLine(func, begin = this.markMarker(), end = this.point()) {\n        begin = $5e779a545e33325b$var$MRK(begin);\n        end = $5e779a545e33325b$var$MRK(end);\n        if (end < begin) {\n            let tmp = begin;\n            begin = end;\n            end = tmp;\n        }\n        begin = this._positionToRowCol(begin);\n        end = this._positionToRowCol(end);\n        for(let i = begin.row; i <= end.row; ++i){\n            let c1 = i == begin.row ? begin.col : 0;\n            let c2 = i == end.row ? end.col : this.getLine(i).length;\n            func(i, c1, c2);\n        }\n    }\n    getActiveFrame() {\n        return this.whenYmacs(\"getActiveFrame\");\n    }\n    // This function receives a string and a continuation.  If\n    // there is an object property or variable named $what, then\n    // $cont is called in the context of this object and given the\n    // value of $what as first argument.  The returned value is\n    // passed back to caller.\n    //\n    // The continuation can also be a string, in which case it's\n    // assumed to be a method in the value of $what, thus called\n    // on it.\n    //\n    // This is a bit messy, but should work well as long as we\n    // don't use the same name for both an object property and a\n    // variable in this.variables.  Otherwise, the property takes\n    // precedence.\n    when(what, cont, ...args) {\n        what = this[what] || this.getq(what);\n        if (what != null) {\n            if (cont instanceof Function) return cont.call(this, what);\n            else return what[cont].apply(what, args);\n        }\n    }\n    // XXX: this is way too ugly. (15 years later: Oh Yeah.)\n    whenActiveFrame() {\n        var fr = this.getActiveFrame(); // miserable hack\n        if (fr.buffer === this) {\n            this.activeFrame = fr;\n            var a = [\n                \"activeFrame\",\n                ...arguments\n            ];\n            return this.when.apply(this, a);\n        } else this.activeFrame = null;\n    }\n    forAllFrames(cont) {\n        if (this.ymacs) this.ymacs.getBufferFrames(this).forEach(cont);\n    }\n    whenYmacs() {\n        var a = [\n            \"ymacs\",\n            ...arguments\n        ];\n        return this.when.apply(this, a);\n    }\n    whenMinibuffer(cont) {\n        // In fact, we should move when() into some base\n        // object... but which one?  JS doesn't have multiple\n        // inheritance, though we could easily \"invent\" it.\n        return this.whenYmacs(function(ymacs) {\n            if (ymacs.minibuffer) return cont.call(this, ymacs.minibuffer);\n        });\n    }\n    withMarkers(cont, ...args) {\n        let a = args.map((arg)=>this.createMarker(arg));\n        try {\n            return cont.apply(this, a);\n        } finally{\n            a.forEach((m)=>m.destroy());\n        }\n    }\n    preventUpdates() {\n        ++this.__preventUpdates;\n    }\n    resumeUpdates() {\n        if ((this.__preventUpdates = Math.max(this.__preventUpdates - 1, 0)) == 0) this.redrawDirtyLines();\n    }\n    getRegion(begin = this.caretMarker, end = this.markMarker) {\n        begin = $5e779a545e33325b$var$MRK(begin);\n        end = $5e779a545e33325b$var$MRK(end);\n        if (end < begin) {\n            var tmp = begin;\n            begin = end;\n            end = tmp;\n        }\n        return {\n            begin: begin,\n            end: end\n        };\n    }\n    redrawDirtyLines() {\n        this.callHooks(\"beforeRedraw\");\n        this.__dirtyLines.forEach((draw, row)=>{\n            if (draw) this.callHooks(\"onLineChange\", row);\n        });\n        this.__dirtyLines = [];\n        this.callHooks(\"afterRedraw\");\n    }\n    setOverlay(name, props) {\n        this.callHooks(\"onOverlayChange\", name, props);\n    }\n    deleteOverlay(name) {\n        this.callHooks(\"onOverlayDelete\", name);\n    }\n    setMark(pos = this.point()) {\n        this.markMarker.setPosition(pos);\n    }\n    ensureTransientMark() {\n        var rc = this._rowcol, tm;\n        if (!this.transientMarker) {\n            this.transientMarker = this.createMarker();\n            this.markMarker.setPosition(this.point());\n            tm = rc;\n        }\n        if (!tm) tm = this.transientMarker.getRowCol();\n        this.setOverlay(\"selection\", {\n            line1: tm.row,\n            col1: tm.col,\n            line2: rc.row,\n            col2: rc.col\n        });\n    }\n    clearTransientMark() {\n        if (this.transientMarker) {\n            this.transientMarker.destroy();\n            this.transientMarker = null;\n            this.deleteOverlay(\"selection\");\n            this.setq(\"sticky_mark\", false);\n        }\n    }\n    deleteTransientRegion() {\n        if (this.transientMarker) {\n            this._deleteText(this.caretMarker, this.transientMarker);\n            this.clearTransientMark();\n            this._placeUndoBoundary();\n            return true;\n        }\n    }\n    static #sameCommandCount = 0;\n    sameCommandCount(diff) {\n        if (diff == null) return $5e779a545e33325b$export$df331bdfc76955b4.#sameCommandCount;\n        if (diff == 0) return $5e779a545e33325b$export$df331bdfc76955b4.#sameCommandCount = 0;\n        return $5e779a545e33325b$export$df331bdfc76955b4.#sameCommandCount += diff;\n    }\n    static #lastKeyEvent = null;\n    interactiveEvent(ev) {\n        if (arguments.length == 0) return $5e779a545e33325b$export$df331bdfc76955b4.#lastKeyEvent;\n        return $5e779a545e33325b$export$df331bdfc76955b4.#lastKeyEvent = ev;\n    }\n    getPrefixArg(noDiscard) {\n        var ret = this.getq(\"universal_prefix\");\n        if (!noDiscard && ret !== undefined) {\n            this.setq(\"universal_prefix\", undefined);\n            if (!this.isMinibuffer) this.setMinibuffer(\"\");\n        }\n        return ret;\n    }\n    setPrefixArg(val) {\n        return this.setq(\"universal_prefix\", val);\n    }\n    updateProgress(name, val) {\n        if (val == null) delete this.progress[name];\n        else this.progress[name] = val;\n        this.callHooks(\"onProgressChange\");\n    }\n    updateModeline() {\n        this.callHooks(\"onProgressChange\");\n    }\n    renderModelineContent(rc, percent) {\n        var ml = (this.__isDirty ? \"**\" : \"--\") + ` <span class=\"mode-line-buffer-id\">${(0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(this.name)}</span>` + \"\\xa0\\xa0\" + percent + \" of \" + (0, $08a06a2e99accb03$export$e1a3971de07c83b5)(this.getCodeSize(), 2).toLowerCase() + \"\\xa0\\xa0\" + \"(\" + (rc.row + 1) + \",\" + rc.col + \") \";\n        var custom = this.getq(\"modeline_custom_handler\");\n        if (custom) {\n            custom = custom.call(this, this, rc);\n            if (custom) ml += \"[\" + custom + \"] \";\n        }\n        var pr = [];\n        for(var i in this.progress)pr.push(i + \": \" + this.progress[i]);\n        if (pr.length > 0) ml += \"{\" + pr.join(\", \") + \"}\";\n        return ml;\n    }\n    /* -----[ not-so-public API ]----- */ // BEGIN: undo queue\n    _recordChange(type, pos, len, text) {\n        if (len > 0) {\n            var q = this.__undoQueue;\n            q.push({\n                type: type,\n                pos: pos,\n                len: len,\n                text: text,\n                dirty: this.__isDirty\n            });\n            this.__isDirty = true;\n            if (q.length > $5e779a545e33325b$var$MAX_UNDO_RECORDS) q.shift();\n        }\n    }\n    _placeUndoBoundary() {\n        var q = this.__undoQueue;\n        var m = this.markers.map((m)=>[\n                m,\n                m.getPosition()\n            ]);\n        var last = q.at(-1);\n        if (!last || last.type != 3) q.push({\n            type: 3,\n            markers: m\n        });\n        else last.markers = m;\n    }\n    _playbackUndo() {\n        var q = this.__undoQueue;\n        if (q.length == 0) return false;\n        ++this.__undoInProgress;\n        var didit = false, action;\n        while(--this.__undoPointer >= 0){\n            action = q[this.__undoPointer];\n            if (action.type == 3) {\n                // restore markers\n                action.markers.forEach((m)=>m[0].setPosition(m[1]));\n                if (!didit) continue;\n                break;\n            }\n            didit = true;\n            var pos = action.pos;\n            switch(action.type){\n                case 1:\n                    this._deleteText(pos, pos + action.len);\n                    break;\n                case 2:\n                    this._insertText(action.text, pos);\n                    break;\n            }\n            this.__isDirty = action.dirty;\n        }\n        --this.__undoInProgress;\n        return didit;\n    }\n    // END: undo\n    _replaceLine(row, text) {\n        this.code[row] = text;\n        this._textProperties.replaceLine(row, text);\n        if (!this.__preventUpdates) this.callHooks(\"onLineChange\", row);\n        else this.__dirtyLines[row] = true;\n    }\n    _deleteLine(row) {\n        this.code.splice(row, 1);\n        this._textProperties.deleteLine(row);\n        if (this.tokenizer) this.tokenizer.quickDeleteLine(row);\n        this.__dirtyLines.splice(row, 1);\n        this.callHooks(\"onDeleteLine\", row);\n    }\n    _insertLine(row, text) {\n        this.code.splice(row, 0, text);\n        this._textProperties.insertLine(row);\n        if (this.tokenizer) this.tokenizer.quickInsertLine(row);\n        var drawIt = !this.__preventUpdates;\n        this.callHooks(\"onInsertLine\", row, drawIt);\n        if (!drawIt) {\n            if (this.__dirtyLines.length <= row) this.__dirtyLines[row] = true;\n            else this.__dirtyLines.splice(row, 0, true);\n        }\n    }\n    _insertText(text, pos) {\n        if (text.length == 0) return;\n        if (pos == null) pos = this.caretMarker.getPosition();\n        pos = $5e779a545e33325b$var$MRK(pos);\n        // *** UNDO RECORDING\n        if (!this.__preventUndo) this._recordChange(1, pos, text.length);\n        var rc = pos == this.point() ? this._rowcol : this._positionToRowCol(pos), i = rc.row;\n        if (/^\\n+$/.test(text) && rc.col == 0) // handle this case separately, since it's so\n        // frequently used (ENTER pressed) and the\n        // default algorithm messes up colorization\n        // for a fraction of a second, flashing badly.\n        for(let j = 0; j < text.length; ++j)this._insertLine(i + j, \"\");\n        else {\n            var lines = text.split(\"\\n\"), ln = this.code[i], rest = ln.substr(rc.col);\n            if (lines.length > 1) {\n                this._replaceLine(i, ln.substr(0, rc.col) + lines.shift());\n                lines.forEach((text)=>this._insertLine(++i, text));\n                this._replaceLine(i, this.code[i] + rest);\n            } else this._replaceLine(i, ln.substr(0, rc.col) + lines[0] + ln.substr(rc.col));\n        }\n        this._updateMarkers(pos, text.length);\n        this.callHooks(\"onTextInsert\", pos, text);\n    }\n    _deleteText(begin, end) {\n        begin = this._boundPosition($5e779a545e33325b$var$MRK(begin));\n        end = this._boundPosition($5e779a545e33325b$var$MRK(end));\n        if (begin == end) return;\n        if (end < begin) {\n            var tmp = begin;\n            begin = end;\n            end = tmp;\n        }\n        // *** UNDO RECORDING\n        if (!this.__preventUndo) this._recordChange(2, begin, end - begin, this._bufferSubstring(begin, end));\n        var brc = this._positionToRowCol(begin), erc = this._positionToRowCol(end);\n        var line = this.code[brc.row];\n        if (brc.row == erc.row) {\n            // same line, that's easy\n            line = line.substr(0, brc.col) + line.substr(erc.col);\n            this._replaceLine(brc.row, line);\n        } else {\n            // fix first line\n            line = line.substr(0, brc.col) + this.code[erc.row].substr(erc.col);\n            this._replaceLine(brc.row, line);\n            // delete lines in between\n            line = brc.row + 1;\n            for(let n = erc.row - brc.row; n-- > 0;)this._deleteLine(line);\n        }\n        this._updateMarkers(begin, begin - end, begin);\n        this.callHooks(\"onTextDelete\", begin, end);\n    }\n    _replaceText(begin, end, text) {\n        this._deleteText(begin, end);\n        this._insertText(text, begin);\n    }\n    _swapAreas(a) {\n        a = a.map($5e779a545e33325b$var$MRK).sort();\n        var b1 = a[0];\n        var e1 = a[1];\n        var b2 = a[2];\n        var e2 = a[3];\n        var t1 = this._bufferSubstring(b1, e1);\n        var t2 = this._bufferSubstring(b2, e2);\n        this._replaceText(b2, e2, t1);\n        this._replaceText(b1, e1, t2);\n        return e2;\n    }\n    _bufferSubstring(begin, end) {\n        if (begin == null) begin = this.point();\n        else begin = $5e779a545e33325b$var$MRK(begin);\n        if (end == null) end = this.getCodeSize();\n        else end = $5e779a545e33325b$var$MRK(end);\n        if (end < begin) {\n            var tmp = begin;\n            begin = end;\n            end = tmp;\n        }\n        // var brc = this._positionToRowCol(begin),\n        //     erc = this._positionToRowCol(end);\n        // if (brc.row == erc.row) {\n        //         return this.code[brc.row].substring(brc.col, erc.col);\n        // } else return [ this.code[brc.row].substr(brc.col) ].\n        //         concat(this.code.slice(brc.row + 1, erc.row)).\n        //         concat(this.code[erc.row].substr(0, erc.col)).\n        //         join(\"\\n\");\n        return this.getCode().substring(begin, end);\n    }\n    _killingAction(p1, p2, prepend, noDelete) {\n        p1 = $5e779a545e33325b$var$MRK(p1);\n        p2 = $5e779a545e33325b$var$MRK(p2);\n        var text = this._bufferSubstring(p1, p2);\n        this._saveKilledText(text, prepend);\n        if (!noDelete) this._deleteText(p1, p2);\n        this.clearTransientMark();\n    }\n    _saveKilledText(text, prepend) {\n        if (!this._lastCommandWasKill) this.ymacs.killRingToMaster();\n        this.ymacs.pushToKillRing(text, prepend);\n        this._lastCommandWasKill++;\n        if (this.interactiveEvent()) try {\n            navigator.clipboard.writeText(this.ymacs.killRingText());\n        } catch  {}\n    }\n    _positionToRowCol(pos) {\n        var line = 0, a = this.code, n = a.length;\n        while(pos > 0 && line < n){\n            var len = a[line].length;\n            if (len >= pos) break;\n            pos -= len + 1; // one for the newline\n            line++;\n        }\n        return {\n            row: line,\n            col: pos\n        };\n    }\n    _rowColToPosition(row, col) {\n        var pos = 0, a = this.code, i = Math.min(row, a.length - 1), n = i;\n        if (i < 0) return 0;\n        while(--i >= 0)pos += a[i].length + 1; // one for the newline\n        return pos + Math.min(col, a[n].length);\n    }\n    _boundPosition(pos) {\n        if (pos < 0) return 0;\n        return Math.min(pos, this.getCodeSize());\n    }\n    _repositionCaret(pos) {\n        var p = this.caretMarker.getPosition();\n        if (pos == null) pos = p;\n        pos = $5e779a545e33325b$var$MRK(pos);\n        pos = this._boundPosition(pos);\n        this.caretMarker.setPosition(pos);\n        return pos != p;\n    }\n    _updateMarkers(offset, delta, min = 0) {\n        this.__size = null;\n        this.__code = null;\n        // if (this.__undoInProgress == 0) {\n        this.markers.map((m)=>m.editorChange(offset, delta, min));\n        // }\n        if (this.tokenizer) {\n            let row = this._positionToRowCol(Math.min(offset, offset + delta)).row;\n            this.tokenizer.truncate(row);\n        }\n    }\n    _saveExcursion(cont, markerBefore) {\n        var tmp = this.createMarker(null, markerBefore);\n        ++this.__savingExcursion;\n        try {\n            return cont.call(this);\n        } finally{\n            --this.__savingExcursion;\n            this.caretMarker.swap(tmp, false, true);\n            tmp.destroy();\n        }\n    }\n    _disableUndo(cont) {\n        ++this.__preventUndo;\n        try {\n            return cont.call(this);\n        } finally{\n            --this.__preventUndo;\n        }\n    }\n    _handleKeyEvent(ev) {\n        var handled = false;\n        this.interactiveEvent(ev);\n        var lcwk = this._lastCommandWasKill;\n        if (this.__nextIsMeta) ev.ymacsMeta = true;\n        this.__nextIsMeta = false;\n        var key = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).unparseKey(ev);\n        var cc = this.currentKeys;\n        var foundPrefix = false;\n        cc.push(key);\n        for(let i = this.keymap.length; --i >= 0;){\n            let km = this.keymap[i];\n            let h = km.getHandler(cc);\n            if (h instanceof Array) {\n                this.callInteractively(h[0], h[1]);\n                handled = true;\n            } else if (h) handled = foundPrefix = true;\n            else if (km.defaultHandler && cc.length == 1) handled = this.callInteractively(km.defaultHandler[0], km.defaultHandler[1]);\n            if (handled) break;\n        }\n        if (!foundPrefix) {\n            if (!handled) {\n                if (cc.length > 1) {\n                    this.signalError(cc.join(\" \").bold() + \" is undefined\", true);\n                    handled = true;\n                }\n            }\n            cc.splice(0, cc.length);\n        }\n        if (this._lastCommandWasKill == lcwk && typeof handled != \"object\" && !this.__nextIsMeta) // selecting a prefix keymap shouldn't clear the killRing\n        this._lastCommandWasKill = 0;\n        this.callHooks(\"finishedEvent\", handled);\n        this.interactiveEvent(null);\n        // XXX: always preventDefault() in minibuffer (return true\n        // here); seems good, objections?\n        return handled || this.isMinibuffer;\n    }\n    _on_tokenizerFoundToken(row, c1, c2, what) {\n        if (what) this._textProperties.addLineProps(row, c1, c2, \"css\", what);\n        else this._textProperties.removeLineProps(row, c1, c2, \"css\");\n    }\n    _on_textPropertiesChange(row) {\n        if (!this.__preventUpdates) this.callHooks(\"onLineChange\", row);\n        else this.__dirtyLines[row] = true;\n    }\n    formatLineHTML(row, caret) {\n        var rc = this._rowcol;\n        if (caret instanceof (0, $c35b14db10f870d1$export$57a830c2aa4f8317)) rc = caret.getRowCol();\n        caret = row == rc.row ? rc.col : null;\n        return this._textProperties.getLineHTML(row, this.code[row], caret);\n    }\n    looking_at(needle) {\n        var haystack = this.getCode();\n        if (needle instanceof RegExp) {\n            var pos = needle.lastIndex = this.point();\n            var ret = needle.exec(haystack);\n            if (ret && ret.index == pos) {\n                ret.after = needle.lastIndex;\n                return this.matchData = ret;\n            }\n        } else if (typeof needle == \"string\") // XXX: account for case_fold_search here?\n        return haystack.substr(this.point(), needle.length) == needle;\n    }\n    looking_back(needle) {\n        var haystack = this.getCode();\n        if (needle instanceof RegExp) {\n            var m = this.lastIndexOfRegexp(haystack, needle, this.point());\n            if (m && m.after == this.point()) return m;\n        } else if (typeof needle == \"string\") // XXX: account for case_fold_search here?\n        return haystack.substr(this.point() - needle.length, needle.length) == needle;\n    }\n    capitalize(str) {\n        return str.replace(this.getq(\"syntax_capitalize_word\"), (_, a, b)=>a.toUpperCase() + b.toLowerCase());\n    }\n}\n// XXX: what a mess..\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.COMMANDS = $5e779a545e33325b$export$df331bdfc76955b4.COMMANDS;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.newCommands = $5e779a545e33325b$export$df331bdfc76955b4.newCommands;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.replaceCommands = $5e779a545e33325b$export$df331bdfc76955b4.replaceCommands;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.newMode = $5e779a545e33325b$export$df331bdfc76955b4.newMode;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.addModeHook = $5e779a545e33325b$export$df331bdfc76955b4.addModeHook;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.removeModeHook = $5e779a545e33325b$export$df331bdfc76955b4.removeModeHook;\n$5e779a545e33325b$export$df331bdfc76955b4.setq = $5e779a545e33325b$export$df331bdfc76955b4.setGlobal = $5e779a545e33325b$export$df331bdfc76955b4.prototype.setGlobal = $5e779a545e33325b$export$df331bdfc76955b4.setVariable;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.setq = $5e779a545e33325b$export$df331bdfc76955b4.prototype.setVariable;\n$5e779a545e33325b$export$df331bdfc76955b4.prototype.getq = $5e779a545e33325b$export$df331bdfc76955b4.prototype.getVariable;\n$5e779a545e33325b$export$df331bdfc76955b4.getq = $5e779a545e33325b$export$df331bdfc76955b4.getVariable;\nclass $5e779a545e33325b$export$36a0d48d1b18d0fa extends $5e779a545e33325b$export$df331bdfc76955b4 {\n    constructor(...args){\n        super(...args);\n        this.promptMarker = this.createMarker(0, true, \"prompt\");\n        this.setq(\"minibuffer_validation\", (whatever)=>true);\n    }\n    // prompt(text) {\n    //     text = text.trim() + \" \";\n    //     this._disableUndo(() => {\n    //         this.setCode(text);\n    //         this._textProperties.addLineProps(0, 0, text.length - 1, \"css\", \"minibuffer-prompt\");\n    //         this._repositionCaret(text.length);\n    //         this.promptMarker.setPosition(text.length, true, true);\n    //     });\n    // }\n    prompt(text) {\n        text = text.trim() + \" \";\n        this._disableUndo(()=>{\n            let pos = this.promptMarker.getPosition();\n            this.promptMarker.setPosition(0, true, true);\n            this._replaceText(0, pos, text);\n            this.promptMarker.setPosition(text.length, true, true);\n            this._textProperties.spliceLineProps(0, 0, text.length - pos);\n            this._textProperties.addLineProps(0, 0, text.length - 1, \"css\", \"minibuffer-prompt\");\n        });\n    }\n    _boundPosition(pos) {\n        return Math.max($5e779a545e33325b$var$MRK(this.promptMarker), Math.min(pos, this.getCodeSize()));\n    }\n}\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nclass $ec4394da1a74075f$export$731251e1d39d8621 extends (0, $08a06a2e99accb03$export$a829527ff4e4114a) {\n    static options = {};\n    constructor(...args){\n        super(...args);\n        this._cont = (0, $08a06a2e99accb03$export$cb0933279c36a66b).fromHTML(`<div class=\"Ymacs_Menu\"></div>`);\n        this.getElement().appendChild(this._cont);\n    }\n    getContentElement() {\n        return this._cont;\n    }\n    initClassName() {\n        return \"Ymacs_Popup\";\n    }\n}\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nfunction $9526afefc19b5eea$var$textColX(div, col) {\n    let range = document.createRange();\n    range.selectNodeContents(div);\n    let treeWalker = document.createTreeWalker(div, NodeFilter.SHOW_TEXT);\n    let len = 0;\n    while(treeWalker.nextNode()){\n        let node = treeWalker.currentNode;\n        let clen = node.nodeValue.length;\n        if (len + clen >= col) {\n            range.setStart(node, col - len);\n            range.setEnd(node, col - len);\n            break;\n        }\n        len += clen;\n    }\n    return range.getBoundingClientRect().right;\n}\nfunction $9526afefc19b5eea$var$normalizeRect(p) {\n    return p.line1 > p.line2 || p.line1 == p.line2 && p.col1 > p.col2 ? {\n        line1: p.line2,\n        col1: p.col2,\n        line2: p.line1,\n        col2: p.col1\n    } : p;\n}\nvar $9526afefc19b5eea$var$DBL_CLICK_SPEED = 300;\nvar $9526afefc19b5eea$var$CLICK_COUNT = 0, $9526afefc19b5eea$var$CLICK_COUNT_TIMER = null, $9526afefc19b5eea$var$CLICK_LAST_TIME = null;\nfunction $9526afefc19b5eea$var$CLEAR_CLICK_COUNT() {\n    $9526afefc19b5eea$var$CLICK_COUNT = null;\n}\nvar $9526afefc19b5eea$var$LINE_DIV = (0, $08a06a2e99accb03$export$cb0933279c36a66b).fromHTML(`<div class=\"line\"><br/></div>`);\nvar $9526afefc19b5eea$var$COUNT = 0;\nclass $9526afefc19b5eea$export$3230e5a51f22d844 extends (0, $08a06a2e99accb03$export$a829527ff4e4114a) {\n    static options = {\n        highlightCurrentLine: true,\n        buffer: null,\n        ymacs: null,\n        isMinibuffer: false\n    };\n    constructor(...args){\n        super(...args);\n        this.buffer = this.o.buffer;\n        this.ymacs = this.o.ymacs;\n        this.isMinibuffer = this.o.isMinibuffer;\n        // <XXX> // during transition\n        this.el = this.getElement();\n        this.el._ymacs_object = this;\n        // </XXX>\n        this.id = `ymacs-frame-${++$9526afefc19b5eea$var$COUNT}`;\n        this.__caretId = `ymacs-caret-${$9526afefc19b5eea$var$COUNT}`;\n        this.redrawModelineWithTimer = (0, $08a06a2e99accb03$export$ad41d882ec94ba04)(this.redrawModeline.bind(this));\n        this.getElement().tabIndex = 0;\n        this.getElement().innerHTML = \"<div class='Ymacs-frame-overlays'><div class='Ymacs-frame-content'></div></div><div class='Ymacs_Modeline'></div>\";\n        this.addEventListener({\n            onDestroy: this._on_destroy\n        });\n        this._dragSelectHandlers = {\n            mousemove: this._dragSelect_onMouseMove.bind(this),\n            mouseup: this._dragSelect_onMouseUp.bind(this)\n        };\n        this._bufferEvents = {\n            onLineChange: this._on_bufferLineChange.bind(this),\n            onInsertLine: this._on_bufferInsertLine.bind(this),\n            onDeleteLine: this._on_bufferDeleteLine.bind(this),\n            onPointChange: this._on_bufferPointChange.bind(this),\n            onResetCode: this._on_bufferResetCode.bind(this),\n            onOverwriteMode: this._on_bufferOverwriteMode.bind(this),\n            onProgressChange: this._on_bufferProgressChange.bind(this),\n            beforeInteractiveCommand: this._on_bufferBeforeInteractiveCommand.bind(this),\n            afterInteractiveCommand: this._on_bufferAfterInteractiveCommand.bind(this),\n            onOverlayChange: this._on_bufferOverlayChange.bind(this),\n            onOverlayDelete: this._on_bufferOverlayDelete.bind(this)\n        };\n        this._moreBufferEvents = {\n            onMessage: this._on_bufferMessage.bind(this),\n            afterInteractiveCommand: (function() {\n                if (this.__ensureCaretVisible) this.ensureCaretVisible();\n            }).bind(this)\n        };\n        var buffer = this.buffer;\n        this.buffer = null;\n        if (buffer) this.setBuffer(buffer);\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).on(this.getOverlaysContainer(), \"scroll\", this._on_scroll.bind(this));\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).on(this.getElement(), {\n            mousedown: this._dragSelect_onMouseDown.bind(this),\n            focus: this._on_focus.bind(this),\n            blur: this._on_blur.bind(this),\n            keydown: this._on_keyDown.bind(this),\n            keyup: this._on_keyUp.bind(this),\n            wheel: this._on_mouseWheel.bind(this)\n        });\n    }\n    initClassName() {\n        return `Ymacs_Frame${this.o.isMinibuffer ? \" Ymacs_Minibuffer\" : \"\"}`;\n    }\n    focus(exitAllowed) {\n        this.getElement().focus();\n    // if (exitAllowed instanceof Function) {\n    //     this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n    //     this.addEventListener(\"onBlur\", this.__exitFocusHandler = function(){\n    //         if (exitAllowed.call(this.buffer)) {\n    //             this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n    //         } else {\n    //             this.focus.delayed(2, this, null);\n    //         }\n    //     });\n    // }\n    }\n    blur(force) {\n    // if (force)\n    //     this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n    }\n    getOverlaysContainer() {\n        return this.getElement().firstChild;\n    }\n    getModelineElement() {\n        return this.getElement().childNodes[1];\n    }\n    getContentElement() {\n        return this.getElement().firstChild.firstChild;\n    }\n    getCaretElement() {\n        return document.getElementById(this.__caretId);\n    }\n    getLineDivElement(row) {\n        return this.getContentElement().childNodes[row] || null;\n    }\n    ensureCaretVisible() {\n        // return true if the scroll position has changed\n        let div = this.getOverlaysContainer();\n        let st = div.scrollTop;\n        this.redrawCaret();\n        let caret = this.getCaretElement();\n        if (caret) {\n            caret.scrollIntoView({\n                block: \"nearest\",\n                inline: \"nearest\"\n            });\n            if (caret.offsetLeft < div.clientWidth / 2) div.scrollLeft = 0;\n        }\n        return st != div.scrollTop;\n    }\n    focusInside() {\n        return document.activeElement === this.getElement();\n    }\n    setBuffer(buffer) {\n        if (this.buffer) {\n            if (this.caretMarker && !this.o.isMinibuffer) {\n                this.caretMarker.destroy();\n                this.caretMarker = null;\n            }\n            this.buffer.removeEventListener(this._bufferEvents);\n            this.buffer.removeEventListener(this._moreBufferEvents);\n        }\n        this.buffer = buffer;\n        if (buffer) {\n            buffer.addEventListener(this._bufferEvents);\n            if (this.focusInside()) buffer.addEventListener(this._moreBufferEvents);\n            if (this.o.isMinibuffer) this.caretMarker = buffer.caretMarker;\n            else this.caretMarker = buffer.createMarker(buffer.caretMarker.getPosition(), false, \"framecaret\");\n            this._redrawBuffer();\n            this.redrawCaret(true);\n            this.centerOnCaret();\n        }\n    }\n    recenterTopBottom() {\n        let row = this.buffer._rowcol.row;\n        let line = this.getLineDivElement(row);\n        let div = this.getOverlaysContainer();\n        let st = div.scrollTop;\n        let center = Math.round(line.offsetTop - div.clientHeight / 2 + line.offsetHeight / 2);\n        let top = Math.round(line.offsetTop) - 1;\n        let bottom = Math.round(line.offsetTop - div.clientHeight + line.offsetHeight) + 1;\n        if (st == top) div.scrollTop = bottom;\n        else if (st == center) div.scrollTop = top;\n        else div.scrollTop = center;\n    }\n    centerOnCaret() {\n        this.centerOnLine(this.buffer._rowcol.row);\n    }\n    centerOnLine(row) {\n        var line = this.getLineDivElement(row), div = this.getOverlaysContainer();\n        div.scrollTop = Math.round(line.offsetTop - div.clientHeight / 2 + line.offsetHeight / 2);\n    // this._redrawBuffer();\n    }\n    setModelineContent(html) {\n        this.getModelineElement().innerHTML = html;\n    }\n    deleteOtherFrames() {\n        this.ymacs.keepOnlyFrame(this);\n    }\n    deleteFrame() {\n        this.ymacs.deleteFrame(this);\n    }\n    _split(horiz) {\n        let ovdiv = this.getOverlaysContainer();\n        let scroll = ovdiv.scrollTop;\n        let fr = this.ymacs.createFrame({\n            buffer: this.buffer\n        });\n        let sc = new $9526afefc19b5eea$export$7b0e4d18ade0c4c9({\n            horiz: horiz\n        });\n        this.getElement().replaceWith(sc.getElement());\n        sc.setSplit(this, fr);\n        ovdiv.scrollTop = scroll;\n        fr.getOverlaysContainer().scrollTop = scroll;\n        this.focus(); // XXX: only if necessary\n        return fr;\n    }\n    vsplit() {\n        return this._split(true);\n    }\n    hsplit(percent) {\n        return this._split(false);\n    }\n    __showCaret() {\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(this.getCaretElement(), \"Ymacs-caret\");\n    }\n    _unhoverLine() {\n        let el = this.__hoverLine != null && this.getLineDivElement(this.__hoverLine);\n        if (el) (0, $08a06a2e99accb03$export$cb0933279c36a66b).delClass(el, \"Ymacs-current-line\");\n        this.__hoverLine = null;\n    }\n    redrawCaret(force) {\n        if (this.o.isMinibuffer) force = true;\n        var isActive = this.ymacs.getActiveFrame() === this;\n        if (!force && !isActive) return;\n        if (isActive && !this.o.isMinibuffer && this.focusInside()) this.caretMarker.setPosition(this.buffer.caretMarker.getPosition());\n        var rc = this.buffer._rowcol;\n        if (this.o.highlightCurrentLine) {\n            this._unhoverLine();\n            (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(this.getLineDivElement(rc.row), \"Ymacs-current-line\");\n            this.__hoverLine = rc.row;\n        }\n        // hide stale carets :-\\\n        // mess everywhere.\n        [\n            ...this.getElement().querySelectorAll(\".Ymacs-caret, #\" + this.__caretId)\n        ].forEach((el)=>{\n            el.id = \"\";\n            el.className = \"\";\n        });\n        // redraw the line where the caret was previously, so that it disappears from there\n        if (this.__prevCaretLine != null) this._on_bufferLineChange(this.__prevCaretLine);\n        // redraw current line if it's different\n        if (this.__prevCaretLine != rc.row) {\n            this.__prevCaretLine = rc.row;\n            this._on_bufferLineChange(rc.row);\n        }\n        this.callHooks(\"onPointChange\", rc.row, rc.col);\n        this.redrawModelineWithTimer(rc);\n    }\n    _getLineHTML(row) {\n        var html = this.buffer.formatLineHTML(row, this.caretMarker);\n        // taking advantage of the fact that a literal > entered by the user will never appear in\n        // the generated HTML, since special HTMl characters are escaped.\n        var pos = html.indexOf(\"Ymacs-caret'>\");\n        if (pos >= 0) html = html.substr(0, pos + 12) + \" id='\" + this.__caretId + \"'\" + html.substr(pos + 12);\n        return html;\n    }\n    _redrawBuffer() {\n        this.setContent(this.buffer.code.map((line, i)=>`<div class=\"line\">${this._getLineHTML(i)}</div>`).join(\"\"));\n    }\n    coordinatesToRowCol(x, y) {\n        function findLine(r1, r2) {\n            if (r1 >= r2) return r1;\n            var row = Math.floor((r1 + r2) / 2);\n            var div = self.getLineDivElement(row);\n            var y1 = div.offsetTop;\n            var y2 = y1 + div.offsetHeight;\n            if (y2 < y) return findLine(row + 1, r2);\n            if (y < y1) return findLine(r1, row - 1);\n            return row;\n        }\n        function findCol(c1, c2) {\n            if (c1 >= c2) return c1;\n            var col = Math.floor((c1 + c2) / 2);\n            var p1 = self.coordinates(row, col), p2 = self.coordinates(row, col + 1);\n            if (p2.x < x) return findCol(col + 1, c2);\n            if (x < p1.x) return findCol(c1, col - 1);\n            return col;\n        }\n        var self = this, row = findLine(0, this.buffer.code.length - 1), col = findCol(0, this.buffer.code[row].length);\n        return {\n            row: row,\n            col: col\n        };\n    }\n    coordinates(row, col) {\n        var box = this.getContentElement().getBoundingClientRect();\n        var div = this.getLineDivElement(row);\n        return {\n            x: $9526afefc19b5eea$var$textColX(div, col) - box.left,\n            y: div.offsetTop,\n            h: div.offsetHeight\n        };\n    }\n    heightInLines() {\n        return Math.floor(this.getOverlaysContainer().clientHeight / this.getContentElement().firstChild.offsetHeight);\n    }\n    redrawModeline(rc) {\n        if (!rc) rc = this.caretMarker.getRowCol();\n        var maxline = this.buffer.code.length - 1;\n        var firstline = this.firstLineVisible();\n        var lastline = this.lastLineVisible();\n        var percent = firstline == 0 ? \"Top\" : lastline == maxline ? \"Bot\" : Math.round(lastline / maxline * 100) + \"%\";\n        this.setModelineContent(this.buffer.renderModelineContent(rc, percent));\n    }\n    /* -----[ event handlers ]----- */ _on_bufferLineChange(row) {\n        var div = this.getLineDivElement(row);\n        if (div) //console.log(\"Redrawing line %d [%s]\", row, this.buffer.code[row]);\n        //console.log(new Error().stack);\n        div.innerHTML = this._getLineHTML(row);\n    }\n    _on_bufferInsertLine(row, drawIt) {\n        var div = $9526afefc19b5eea$var$LINE_DIV.cloneNode(true);\n        this.getContentElement().insertBefore(div, this.getLineDivElement(row));\n        if (drawIt) div.innerHTML = this._getLineHTML(row);\n    }\n    _on_bufferDeleteLine(row) {\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).trash(this.getLineDivElement(row));\n    }\n    _on_bufferPointChange(rc, pos) {\n        this.redrawCaret();\n    }\n    _on_bufferResetCode() {\n        this._redrawBuffer();\n    }\n    _on_bufferOverwriteMode(om) {\n        this.condClass(om, \"Ymacs-overwrite-mode\");\n    }\n    _on_bufferMessage(args) {\n        this.ymacs.popupMessage(args);\n    }\n    _on_bufferBeforeInteractiveCommand() {\n        this.__ensureCaretVisible = true;\n        this._unhoverLine();\n        this.ymacs.clearPopupMessage();\n    }\n    _on_bufferAfterInteractiveCommand() {}\n    _on_bufferProgressChange() {\n        this.redrawModelineWithTimer(null);\n    }\n    getOverlayId(name) {\n        return this.id + \"-ovl-\" + name;\n    }\n    getOverlayHTML(name, props) {\n        var str = \"\";\n        props.forEach((p)=>{\n            if (p.line1 == p.line2 && p.col1 == p.col2) return;\n            p = $9526afefc19b5eea$var$normalizeRect(p);\n            var p1 = this.coordinates(p.line1, p.col1);\n            var p2 = this.coordinates(p.line2, p.col2);\n            var p0 = p.col1 == 0 ? p1 : this.coordinates(p.line1, 0);\n            if (p.line1 == p.line2) str += `<div class=\"${name}\" style=\"\n                    top: ${p1.y}px;\n                    left: ${p1.x}px;\n                    height: ${p1.h}px;\n                    width: ${p2.x - p1.x}px;\n                \"></div>`;\n            else {\n                str += `<div class=\"${name}\" style=\"\n                    top: ${p1.y}px;\n                    left: ${p1.x}px;\n                    height: ${p.col1 > 0 ? p1.h : p2.y - p1.y}px;\n                \"></div>`;\n                if (p.col1 > 0 && p.line2 - p.line1 > 1) str += `<div class=\"${name}\" style=\"\n                        top: ${p1.y + p1.h}px;\n                        left: ${p0.x}px;\n                        height: ${p2.y - p1.y - p1.h}px;\n                    \"></div>`;\n                if (p.col2 > 0) str += `<div class=\"${name}\" style=\"\n                        top: ${p2.y}px;\n                        left: ${p0.x}px;\n                        height: ${p2.h}px;\n                        width: ${p2.x - p0.x}px;\n                    \"></div>`;\n            }\n        });\n        return str ? `<div id=\"${this.getOverlayId(name)}\" data-ymacs-overlay=\"${name}\" class=\"Ymacs_Overlay ${name}\">${str}</div>` : null;\n    }\n    getOverlaysCount() {\n        return this.getOverlaysContainer().childNodes.length - 1; // XXX: subtract the div.content; we need to revisit this if we add new elements.\n    }\n    _on_bufferOverlayChange(name, props) {\n        let html = this.getOverlayHTML(name, Array.isArray(props) ? props : [\n            props\n        ]);\n        if (html) {\n            let div = (0, $08a06a2e99accb03$export$cb0933279c36a66b).fromHTML(html);\n            let old = document.getElementById(this.getOverlayId(name));\n            old ? old.replaceWith(div) : this.getOverlaysContainer().appendChild(div);\n            this._setOverlayClasses();\n        } else this._on_bufferOverlayDelete(name);\n    }\n    _on_bufferOverlayDelete(name) {\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).trash(document.getElementById(this.getOverlayId(name)));\n        this._setOverlayClasses();\n    }\n    _setOverlayClasses() {\n        let names = [\n            ...this.getOverlaysContainer().querySelectorAll(\":scope > [data-ymacs-overlay]\")\n        ].map((el)=>el.dataset.ymacsOverlay);\n        this.condClass(names.length > 0, \"Ymacs_Frame-hasOverlays\");\n        this.getElement().dataset.ymacsOverlays = names.join(\" \");\n    }\n    /* -----[ self events ]----- */ _on_destroy() {\n        this.setBuffer(null);\n    }\n    _on_focus() {\n        this.ymacs.setActiveFrame(this, true);\n        if (!this.o.isMinibuffer) this.buffer.cmd(\"goto_char\", this.caretMarker.getPosition());\n        this.buffer.addEventListener(this._moreBufferEvents);\n    }\n    _on_blur() {\n        if (!this.o.isMinibuffer) this.caretMarker.setPosition(this.buffer.caretMarker.getPosition());\n        this.buffer.removeEventListener(this._moreBufferEvents);\n    }\n    _dragSelect_onMouseDown(ev) {\n        if (ev.ctrlKey && ev.shiftKey) return;\n        ev.stopPropagation();\n        clearTimeout($9526afefc19b5eea$var$CLICK_COUNT_TIMER);\n        $9526afefc19b5eea$var$CLICK_COUNT++;\n        $9526afefc19b5eea$var$CLICK_COUNT_TIMER = setTimeout($9526afefc19b5eea$var$CLEAR_CLICK_COUNT, $9526afefc19b5eea$var$DBL_CLICK_SPEED);\n        let pos = (0, $08a06a2e99accb03$export$cb0933279c36a66b).mousePos(ev, this.getContentElement());\n        let rc = this.coordinatesToRowCol(pos.x, pos.y);\n        let buf = this.buffer;\n        setTimeout(()=>{\n            buf.clearTransientMark();\n            buf.cmd(\"goto_char\", buf._rowColToPosition(rc.row, rc.col));\n            buf.callInteractively(\"keyboard_quit\");\n            if ($9526afefc19b5eea$var$CLICK_COUNT == 1) {\n                buf.ensureTransientMark();\n                (0, $08a06a2e99accb03$export$cb0933279c36a66b).on(window, this._dragSelectHandlers);\n            } else if ($9526afefc19b5eea$var$CLICK_COUNT == 2) {\n                buf.cmd(\"forward_word\");\n                buf.cmd(\"backward_word\");\n                buf.cmd(\"forward_word_mark\");\n            } else if ($9526afefc19b5eea$var$CLICK_COUNT == 3) {\n                buf.cmd(\"beginning_of_line\");\n                buf.cmd(\"end_of_line_mark\");\n            } else if ($9526afefc19b5eea$var$CLICK_COUNT == 4) {\n                buf.cmd(\"backward_paragraph\");\n                buf.cmd(\"forward_whitespace\");\n                buf.cmd(\"beginning_of_line\");\n                buf.cmd(\"forward_paragraph_mark\");\n            }\n        });\n    }\n    _dragSelect_onMouseMove(ev) {\n        let pos = (0, $08a06a2e99accb03$export$cb0933279c36a66b).mousePos(ev, this.getContentElement());\n        let rc = this.coordinatesToRowCol(pos.x, pos.y);\n        this.buffer.cmd(\"goto_char\", this.buffer._rowColToPosition(rc.row, rc.col));\n        this.buffer.ensureTransientMark();\n        this.ensureCaretVisible();\n    }\n    _dragSelect_onMouseUp(ev) {\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).off(window, this._dragSelectHandlers);\n    }\n    _on_keyDown(ev) {\n        if (!$9526afefc19b5eea$var$isModifier(ev.key)) {\n            if (this.ymacs.processKeyEvent(ev)) {\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        }\n    }\n    _on_keyUp(ev) {}\n    _on_scroll() {\n        this.redrawModelineWithTimer();\n    }\n    _on_mouseWheel(ev) {\n        ev.preventDefault();\n        this.buffer._handleKeyEvent(ev);\n    }\n    firstLineVisible() {\n        var div = this.getOverlaysContainer();\n        return this.coordinatesToRowCol(1, div.scrollTop + 1).row;\n    }\n    lastLineVisible() {\n        var div = this.getOverlaysContainer();\n        return this.coordinatesToRowCol(div.clientWidth - 2, div.scrollTop + div.clientHeight - 2).row;\n    }\n    scrollUp(lines) {\n        var div = this.getOverlaysContainer();\n        var line = Math.max(this.firstLineVisible() - lines, 0);\n        line = this.getLineDivElement(line);\n        div.scrollTop = line.offsetTop;\n        this.__ensureCaretVisible = false;\n    }\n    scrollDown(lines) {\n        var div = this.getOverlaysContainer();\n        var line = Math.min(this.firstLineVisible() + lines, this.buffer.code.length - 1);\n        line = this.getLineDivElement(line);\n        div.scrollTop = line.offsetTop;\n        this.__ensureCaretVisible = false;\n    }\n}\nfunction $9526afefc19b5eea$var$isModifier(key) {\n    return /^(?:Alt|AltGraph|CapsLock|Control|Fn|FnLock|Hyper|Meta|NumLock|ScrollLock|Shift|Super|Symbol|SymbolLock)$/.test(key);\n}\nclass $9526afefc19b5eea$export$7b0e4d18ade0c4c9 extends (0, $08a06a2e99accb03$export$a829527ff4e4114a) {\n    static options = {\n        horiz: false\n    };\n    #activeElement = null;\n    initClassName() {\n        return \"Ymacs_SplitCont \" + (this.o.horiz ? \"horiz\" : \"vert\");\n    }\n    createElement() {\n        super.createElement();\n        this._dragHandlers = {\n            mousemove: this._onMouseMove.bind(this),\n            mouseup: this._onMouseUp.bind(this)\n        };\n        this._rb = (0, $08a06a2e99accb03$export$cb0933279c36a66b).fromHTML(`<div class=\"bar\" tabindex=\"0\"></div>`);\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).on(this._rb, \"mousedown\", this._onMouseDown.bind(this));\n    }\n    setSplit(a, b) {\n        this.add(a);\n        this.add(this._rb);\n        this.add(b);\n    }\n    _onMouseDown(ev) {\n        this.#activeElement = document.activeElement;\n        if (ev.target === this._rb) {\n            let first = this.getContentElement().children[0];\n            this._start = this.o.horiz ? ev.clientY : ev.clientX;\n            this._orig_sz = this.o.horiz ? first.offsetHeight : first.offsetWidth;\n            this.addClass(\"dragging\");\n            ev.stopPropagation();\n            (0, $08a06a2e99accb03$export$cb0933279c36a66b).on(window, this._dragHandlers);\n            (0, $08a06a2e99accb03$export$cb0933279c36a66b).overlayOn(this.o.horiz ? \"Ymacs_Resize_horiz\" : \"Ymacs_Resize_vert\");\n        } else if (this.#activeElement) this.#activeElement.focus();\n    }\n    _onMouseUp(ev) {\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).off(window, this._dragHandlers);\n        this.delClass(\"dragging\");\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).overlayOff();\n        if (this.#activeElement) this.#activeElement.focus();\n        this.#activeElement = null;\n    }\n    _onMouseMove(ev) {\n        let cont = this.getElement();\n        let max = this.o.horiz ? cont.offsetHeight : cont.offsetWidth;\n        let diff = (this.o.horiz ? ev.clientY : ev.clientX) - this._start;\n        let target = Math.min(max, Math.max(0, this._orig_sz + diff));\n        let frac = Math.min(0.9, Math.max(0.1, target / max));\n        if (this.o.horiz) cont.style.gridTemplateRows = `${frac}fr auto ${1 - frac}fr`;\n        else cont.style.gridTemplateColumns = `${frac}fr auto ${1 - frac}fr`;\n    }\n}\n\n\n\nfunction $2f9db344d0795d0e$var$minElement(array, f, obj, remove) {\n    if (array.length == 0) return null;\n    var i = 0, minEl = array[0], minValue = f.call(obj, minEl), minIndex = 0, tmp;\n    while(++i < array.length)if ((tmp = f.call(obj, array[i])) < minValue) {\n        minValue = tmp;\n        minIndex = i;\n        minEl = array[i];\n    }\n    if (remove) array.splice(minIndex, 1);\n    return minEl;\n}\nfunction $2f9db344d0795d0e$var$selectClosestFrameX(byx, pos) {\n    if (byx.length > 0) {\n        var x = byx.at(-1).getBox().left, a = [\n            byx.pop()\n        ];\n        while(byx.length > 0 && byx.at(-1).getBox().left == x)a.push(byx.pop());\n        return $2f9db344d0795d0e$var$minElement(a, function(f) {\n            return Math.abs(pos.top - f.getBox().top - f.getBox().height / 2);\n        });\n    }\n}\nfunction $2f9db344d0795d0e$var$selectClosestFrameY(byy, pos) {\n    if (byy.length > 0) {\n        var y = byy.at(-1).getBox().top, a = [\n            byy.pop()\n        ];\n        while(byy.length > 0 && byy.at(-1).getBox().top == y)a.push(byy.pop());\n        return $2f9db344d0795d0e$var$minElement(a, function(f) {\n            return Math.abs(pos.left - f.getBox().left - f.getBox().width / 2);\n        });\n    }\n}\nfunction $2f9db344d0795d0e$var$ensureLocalStorage() {\n    if (!(window.localStorage && window.localStorage.getItem)) throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"Local storage facility not available in this browser\");\n}\nclass $2f9db344d0795d0e$export$e2cc12c8ba83ca65 extends (0, $08a06a2e99accb03$export$a829527ff4e4114a) {\n    static options = {\n        buffers: [],\n        frames: [],\n        cf_frameStyle: Object.create(null)\n    };\n    constructor(...args){\n        super(...args);\n        this.buffers = [\n            ...this.o.buffers\n        ];\n        this.frames = [\n            ...this.o.frames\n        ];\n        this.cf_frameStyle = {\n            ...this.o.cf_frameStyle\n        };\n        this.buffers.forEach((b)=>{\n            b.ymacs = this;\n            this._addBufferListeners(b);\n        });\n        /* -----[ variables ]----- */ this.killRing = [];\n        this.killMasterOfRings = [];\n        this.progress = {};\n        /* -----[ macro vars ]----- */ // If present, keystrokes are stored in this list.\n        this.__macro_recording = null;\n        // This is the macro executed by C-x e and named by\n        // name-last-kbd-macro.\n        this.__macro_finished = null;\n        // Set when any buffer does signalError.  Tells us when to abort\n        // running a macro.\n        this.__error_thrown = false;\n        // A list if we're executing a macro.\n        this.__running_macro = null;\n        // A number of times to execute the current macro.\n        this.__macro_times = 0;\n        // Macro current step\n        this.__macro_step = 0;\n        // Timer for the macro\n        this.__macro_timer = null;\n        // Unbiased active frame\n        this.__input_frame = null;\n        /* -----[ minibuffer ]----- */ this.minibuffer = new (0, $5e779a545e33325b$export$36a0d48d1b18d0fa)({\n            ymacs: this\n        });\n        this.minibuffer.cmd(\"minibuffer_mode\");\n        this.minibuffer_frame = this.createFrame({\n            isMinibuffer: true,\n            buffer: this.minibuffer,\n            hidden: true,\n            highlightCurrentLine: false\n        });\n        /* -----[ main content ]----- */ if (this.buffers.length == 0) this.createBuffer();\n        var frame = this.createFrame({\n            buffer: this.buffers[0]\n        });\n        this.add(frame);\n        this.add(this.minibuffer_frame);\n        this.setActiveFrame(frame);\n        frame.redrawCaret();\n    }\n    initClassName() {\n        return \"Ymacs Ymacs-cursor-block\";\n    }\n    _addBufferListeners(buf) {\n        buf.addEventListener(\"onDestroy\", ()=>{\n            var fr = this.getActiveFrame();\n            this.getBufferFrames(buf).forEach((f)=>{\n                if (f !== fr) this.deleteFrame(f);\n            });\n            (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.buffers, buf);\n            if (this.getActiveBuffer() === buf) this.nextHiddenBuffer(buf);\n        });\n    }\n    pushToKillRing(text, prepend) {\n        prepend ? this.killRing.unshift(text) : this.killRing.push(text);\n    }\n    killRingToMaster() {\n        if (this.killRing.length && (this.killMasterOfRings.length == 0 || this.killMasterOfRings.at(-1).join(\"\") != this.killRing.join(\"\"))) this.killMasterOfRings.push(this.killRing);\n        this.killRing = [];\n    }\n    killRingText() {\n        return this.killRing.join(\"\");\n    }\n    rotateKillRing(push) {\n        if (push) {\n            this.killMasterOfRings.push(this.killRing);\n            this.killRing = this.killMasterOfRings.shift();\n        } else {\n            this.killMasterOfRings.unshift(this.killRing);\n            this.killRing = this.killMasterOfRings.pop();\n        }\n    }\n    getBuffer(buf) {\n        if (!(buf instanceof (0, $5e779a545e33325b$export$df331bdfc76955b4))) buf = this.buffers.find((b)=>b.name == buf);\n        return buf;\n    }\n    killBuffer(buf) {\n        buf = this.getBuffer(buf);\n        this.callHooks(\"onDeleteBuffer\", buf);\n        buf.destroy();\n    }\n    renameBuffer(buf, name) {\n        buf = this.getBuffer(buf);\n        buf.name = name;\n        buf.callHooks(\"onProgressChange\");\n    }\n    _do_switchToBuffer(buf) {\n        this.getActiveFrame().setBuffer(buf);\n        this.callHooks(\"onBufferSwitch\", buf);\n    }\n    switchToBuffer(maybeName) {\n        var buf = this.getBuffer(maybeName), a = this.buffers;\n        if (!buf) // create new buffer\n        buf = this.createBuffer({\n            name: maybeName\n        });\n        (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(a, buf);\n        a.unshift(buf);\n        this._do_switchToBuffer(buf);\n        return buf;\n    }\n    nextHiddenBuffer(cur) {\n        var a = this.buffers.filter((buf)=>{\n            if (buf === cur) return false;\n            var hidden = true;\n            buf.forAllFrames(()=>hidden = false);\n            return hidden;\n        });\n        if (a.length > 0) {\n            var buf = a[0];\n            (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.buffers, buf);\n            this.buffers.push(buf);\n            this._do_switchToBuffer(buf);\n        } else this.switchToBuffer(\"*scratch*\");\n    }\n    switchToNextBuffer() {\n        var a = this.buffers;\n        if (a.length > 1) {\n            var buf = a.shift();\n            a.push(buf);\n            this._do_switchToBuffer(a[0]);\n        }\n    }\n    switchToPreviousBuffer() {\n        var a = this.buffers;\n        if (a.length > 1) {\n            var buf = a.pop();\n            a.unshift(buf);\n            this._do_switchToBuffer(buf);\n        }\n    }\n    getNextBuffer(buf, n) {\n        if (n == null) n = 1;\n        var a = this.buffers;\n        return a[(a.indexOf(buf) + n) % a.length];\n    }\n    getPrevBuffer(buf, n) {\n        if (n == null) n = 1;\n        return this.getNextBuffer(buf, -n);\n    }\n    getBufferFrames(buf) {\n        buf = this.getBuffer(buf);\n        return this.frames.filter((f)=>f.buffer === buf);\n    }\n    createBuffer(args) {\n        args = Object.assign({}, args, {\n            ymacs: this\n        });\n        var buf = new (0, $5e779a545e33325b$export$df331bdfc76955b4)(args);\n        this._addBufferListeners(buf);\n        if (!args.hidden) this.buffers.push(buf);\n        this.callHooks(\"onCreateBuffer\", buf);\n        return buf;\n    }\n    createFrame(args) {\n        args = Object.assign({}, args, {\n            ymacs: this\n        });\n        var frame = new (0, $9526afefc19b5eea$export$3230e5a51f22d844)(args);\n        if (!args.hidden) this.frames.unshift(frame);\n        frame.setStyle(this.cf_frameStyle);\n        return frame;\n    }\n    setFrameStyle(style) {\n        [\n            this.minibuffer_frame,\n            ...this.frames\n        ].forEach((frame)=>frame.setStyle(style));\n    }\n    keepOnlyFrame(frame) {\n        if (this.frames.length > 1) {\n            let el = frame.getElement();\n            while(el.parentNode != this.getContentElement())el = el.parentNode;\n            if (el !== frame) {\n                el.replaceWith(frame.getElement());\n                this.setActiveFrame(frame);\n                frame.centerOnCaret();\n                this.frames = [\n                    frame\n                ];\n            }\n        }\n    }\n    deleteFrame(frame) {\n        if (this.frames.length > 1) {\n            (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.frames, frame);\n            let parent = frame.getElement().parentNode;\n            let other = [\n                ...parent.children\n            ].find((el)=>{\n                let obj = el._ymacs_object;\n                return obj instanceof (0, $9526afefc19b5eea$export$7b0e4d18ade0c4c9) || obj instanceof (0, $9526afefc19b5eea$export$3230e5a51f22d844) && obj !== frame;\n            });\n            parent.replaceWith(other);\n            if (!(0, $08a06a2e99accb03$export$cb0933279c36a66b).hasClass(other, \"Ymacs_Frame\")) other = other.querySelector(\".Ymacs_Frame\");\n            other = other._ymacs_object;\n            this.setActiveFrame(other);\n            other.centerOnCaret();\n        }\n    }\n    focusOtherFrame() {\n        this.setActiveFrame(this.frames[0]);\n    }\n    focus() {\n        this.frames.at(-1).focus();\n    }\n    setInputFrame(frame) {\n        this.__input_frame = frame;\n    }\n    setActiveFrame(frame, nofocus) {\n        if (!frame.isMinibuffer) {\n            var old = this.getActiveFrame();\n            if (old) old.delClass(\"Ymacs_Frame-active\");\n            (0, $08a06a2e99accb03$export$cd7f480d6b8286c3)(this.frames, frame);\n            this.frames.push(frame);\n            frame.addClass(\"Ymacs_Frame-active\");\n        }\n        this.__input_frame = frame;\n        if (!nofocus) frame.focus();\n    }\n    getActiveFrame() {\n        return this.frames.at(-1);\n    }\n    getActiveBuffer() {\n        var frame = this.getActiveFrame();\n        return frame ? frame.buffer : this.buffers.at(-1);\n    }\n    setColorTheme(themeId) {\n        this.delClass(/Ymacs-Theme-[^\\s]*/g);\n        if (!(themeId instanceof Array)) themeId = [\n            themeId\n        ];\n        themeId.forEach((themeId)=>{\n            this.addClass(\"Ymacs-Theme-\" + themeId);\n        });\n    }\n    getFrameInDirection(dir) {\n        let frame = this.getActiveFrame();\n        let caret = frame.getCaretElement();\n        let box = caret.getBoundingClientRect();\n        var byx = [\n            ...this.frames\n        ].sort((a, b)=>a.getBox().left - b.getBox().left);\n        var byy = [\n            ...this.frames\n        ].sort((a, b)=>a.getBox().top - b.getBox().top);\n        return this[\"_get_frameInDir_\" + dir](byx, byy, box, frame);\n    }\n    _get_frameInDir_left(byx, byy, pos, frame) {\n        byx = byx.filter((f)=>{\n            let p = f.getBox();\n            return f !== frame && p.left < pos.left && p.top - pos.height <= pos.top && p.top + p.height > pos.top;\n        });\n        return $2f9db344d0795d0e$var$selectClosestFrameX(byx, pos);\n    }\n    _get_frameInDir_right(byx, byy, pos, frame) {\n        byx.reverse();\n        byx = byx.filter((f)=>{\n            let p = f.getBox();\n            return f !== frame && p.left > pos.left && p.top - pos.height <= pos.top && p.top + p.height > pos.top;\n        });\n        return $2f9db344d0795d0e$var$selectClosestFrameX(byx, pos);\n    }\n    _get_frameInDir_up(byx, byy, pos, frame) {\n        byy = byy.filter((f)=>{\n            let p = f.getBox();\n            return f !== frame && p.top < pos.top && p.left - pos.width <= pos.left && p.left + p.width > pos.left;\n        });\n        return $2f9db344d0795d0e$var$selectClosestFrameY(byy, pos);\n    }\n    _get_frameInDir_down(byx, byy, pos, frame) {\n        byy.reverse();\n        byy = byy.filter((f)=>{\n            let p = f.getBox();\n            return f !== frame && p.top > pos.top && p.left - pos.width <= pos.left && p.left + p.width > pos.left;\n        });\n        return $2f9db344d0795d0e$var$selectClosestFrameY(byy, pos);\n    }\n    /* -----[ local storage ]----- */ ls_get() {\n        $2f9db344d0795d0e$var$ensureLocalStorage();\n        return JSON.parse(localStorage.getItem(\".ymacs\") || \"{}\");\n    }\n    ls_set(src) {\n        $2f9db344d0795d0e$var$ensureLocalStorage();\n        localStorage.setItem(\".ymacs\", JSON.stringify(src));\n    }\n    ls_getFileContents(name, nothrow) {\n        var info = this.ls_getFileDirectory(name), other = info.other, code;\n        if (other.length == 1) code = info.dir[other[0]];\n        if (code == null && !nothrow) throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"File not found\");\n        return code;\n    }\n    ls_setFileContents(name, content) {\n        var files = this.ls_getFileDirectory(name, \"file\");\n        files.dir[files.other[0]] = content;\n        this.ls_set(files.store);\n    }\n    ls_getFileDirectory(name, create) {\n        var store, dir = store = this.ls_get(), back = [];\n        name = name.replace(/^[~\\x2f]+/, \"\").split(/\\x2f+/);\n        var path = [], other = [];\n        while(name.length > 0){\n            var part = name.shift();\n            if (part == \".\") continue;\n            if (part == \"..\") {\n                path.pop();\n                dir = back.pop();\n            } else if (part == \"~\") {\n                path = [];\n                other = [];\n                back = [];\n                dir = store;\n            } else if (dir.hasOwnProperty(part) && typeof dir[part] != \"string\") {\n                back.push(dir);\n                dir = dir[part];\n                path.push(part);\n            } else other.push(part);\n        }\n        if (create) {\n            var n = create == \"file\" ? 1 : 0;\n            while(other.length > n)dir = dir[other.shift()] = {};\n            this.ls_set(store);\n        }\n        return {\n            store: store,\n            dir: dir,\n            path: path,\n            other: other,\n            full: path.concat(other).join(\"/\")\n        };\n    }\n    ls_deleteFile(name) {\n        var info = this.ls_getFileDirectory(name);\n        delete info.dir[info.other.join(\"/\")];\n        this.ls_set(info.store);\n    }\n    /* -----[ filesystem operations ]----- */ fs_normalizePath(path) {\n        path = path.replace(/^[~\\x2f]+/, \"\").split(/\\x2f+/);\n        var ret = [];\n        while(path.length > 0){\n            var x = path.shift();\n            if (x != \".\") {\n                if (x == \"..\") ret.pop();\n                else if (x == \"~\") ret = [];\n                else ret.push(x);\n            }\n        }\n        return ret.join(\"/\");\n    }\n    fs_fileType(name, cont) {\n        try {\n            this.ls_getFileContents(name);\n            cont(true);\n        } catch (ex) {\n            cont(null);\n        }\n    }\n    fs_getFileContents(name, nothrow, cont) {\n        var code = this.ls_getFileContents(name, nothrow);\n        cont(code, code); // second parameter is file stamp, on a real fs it should be last modification time\n    }\n    fs_setFileContents(name, content, stamp, cont) {\n        if (stamp && (this.ls_getFileContents(name, true) || \"\") != stamp) cont(null); // did not change file because stamp is wrong\n        else {\n            this.ls_setFileContents(name, content);\n            cont(content);\n        }\n    }\n    fs_getDirectory(dirname, cont) {\n        var info = this.ls_getFileDirectory(dirname, false);\n        dirname = info.path.join(\"/\"); // normalized\n        if (info) {\n            var files = {};\n            for(var f in info.dir)if (Object.hasOwn(info.dir, f)) files[f] = {\n                name: f,\n                path: dirname + \"/\" + f,\n                type: typeof info.dir[f] == \"string\" ? \"regular\" : \"directory\"\n            };\n            cont(files);\n        } else cont(null);\n    }\n    fs_deleteFile(name, cont) {\n        this.ls_deleteFile(name);\n        cont();\n    }\n    fs_remapDir(dir, cont) {\n        cont(dir);\n    }\n    isRunningMacro() {\n        return !!this.__running_macro;\n    }\n    isRecordingMacro() {\n        return !!this.__macro_recording;\n    }\n    indicateError() {\n        this.__error_thrown = true;\n    }\n    startMacro(do_append) {\n        if (this.isRecordingMacro()) return false;\n        if (do_append) {\n            this.__macro_recording = this.__macro_finished || [];\n            this.__macro_finished = null;\n        } else this.__macro_recording = [];\n        return true;\n    }\n    stopMacro() {\n        if (this.__macro_recording) {\n            this.__macro_finished = this.__macro_recording;\n            this.__macro_recording = null;\n        }\n    }\n    getLastMacro() {\n        return this.__macro_finished;\n    }\n    stepMacro() {\n        while(true){\n            if (this.__macro_step >= this.__running_macro.length) {\n                this.__macro_times--;\n                this.__macro_step = 0;\n            }\n            if (this.__macro_times == 0 || this.__error_thrown) {\n                this.__macro_times = 0;\n                this.__macro_step = 0;\n                this.__running_macro = null;\n                return;\n            }\n            var ev = this.__running_macro[this.__macro_step];\n            this.processKeyEvent(ev);\n            this.__macro_step++;\n        }\n    }\n    runMacro(times, macro) {\n        if (this.isRecordingMacro()) return false;\n        this.__error_thrown = false;\n        this.__running_macro = macro;\n        this.__macro_step = 0;\n        this.__macro_times = times;\n        var self = this;\n        setTimeout(function() {\n            self.stepMacro();\n        }, 0);\n        return true;\n    }\n    processKeyEvent(ev) {\n        var frame = this.__input_frame;\n        var buffer = frame.buffer;\n        if (this.__macro_recording) this.__macro_recording.push(ev);\n        return buffer._handleKeyEvent(ev);\n    }\n    #timer_popupMessage = null;\n    popupMessage({ type: type = \"info\", text: text, isHtml: isHtml = false, atCaret: atCaret = false, timeout: timeout }) {\n        let popup = this.__popup || (this.__popup = new (0, $ec4394da1a74075f$export$731251e1d39d8621)());\n        let el = popup.getElement();\n        popup.condClass(atCaret, \"with-arrow\");\n        if (!atCaret) {\n            el.style.removeProperty(\"left\");\n            el.style.removeProperty(\"top\");\n            el.style.removeProperty(\"bottom\");\n            el.style.removeProperty(\"right\");\n            el.style.removeProperty(\"transform\");\n        }\n        if (!isHtml) text = (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(text);\n        popup.setContent(text);\n        if (atCaret) this._popupAtCaret(popup.getElement());\n        else this.add(popup);\n        clearTimeout(this.#timer_popupMessage);\n        if (timeout) this.#timer_popupMessage = setTimeout(this.clearPopupMessage.bind(this), timeout);\n    }\n    clearPopupMessage() {\n        if (this.__popup) this.__popup.getElement().remove();\n    }\n    requestFullScreen() {\n        return this.getElement().requestFullscreen();\n    }\n    _popupAtCaret(el) {\n        el.style.visibility = \"hidden\";\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).delClass(el, /ppos-[a-z-]+/ig);\n        this.add(el);\n        let mybox = this.getElement().getBoundingClientRect();\n        let caret = this.__input_frame.getCaretElement();\n        let cbox = caret.getBoundingClientRect();\n        let cbox_center = {\n            x: (cbox.left + cbox.right) / 2,\n            y: (cbox.top + cbox.bottom) / 2\n        };\n        let mybox_center = {\n            x: (mybox.left + mybox.right) / 2,\n            y: (mybox.top + mybox.bottom) / 2\n        };\n        if (cbox_center.y > mybox_center.y) {\n            if (cbox_center.x < mybox_center.x) {\n                (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(el, \"ppos-top-right\");\n                el.style.transform = `translate(0, calc(-100% - ${cbox.height / 2}px))`;\n            } else {\n                (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(el, \"ppos-top-left\");\n                el.style.transform = `translate(-100%, calc(-100% - ${cbox.height / 2}px))`;\n            }\n        } else if (cbox_center.x < mybox_center.x) {\n            (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(el, \"ppos-bot-right\");\n            el.style.transform = `translate(0, ${cbox.height / 2}px)`;\n        } else {\n            (0, $08a06a2e99accb03$export$cb0933279c36a66b).addClass(el, \"ppos-bot-left\");\n            el.style.transform = `translate(-100%, ${cbox.height / 2}px)`;\n        }\n        el.style.left = cbox_center.x - mybox.left + \"px\";\n        el.style.top = cbox_center.y - mybox.top + \"px\";\n        el.style.removeProperty(\"visibility\");\n    }\n}\n\n\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nclass $c749180882ef16eb$export$2f1022027d35d1bb {\n    constructor({ buffer: buffer = null, line: line = 0, col: col = 0 } = {}){\n        this.buffer = buffer;\n        this.line = line;\n        this.col = col;\n    }\n    nextCol() {\n        ++this.col;\n    }\n    prevCol() {\n        --this.col;\n    }\n    nextLine() {\n        ++this.line;\n        this.col = 0;\n    }\n    prevLine() {\n        --this.line;\n        this.col = 0;\n    }\n    peek(n = 0) {\n        if (this.line < this.buffer.code.length) {\n            let pos = this.col + n;\n            let line = this.buffer.code[this.line];\n            if (pos < line.length) return line.charAt(pos);\n            if (pos == line.length) return \"\\n\";\n        }\n    }\n    next() {\n        let ch = this.peek();\n        this.nextCol();\n        if (this.col > this.buffer.code[this.line].length) this.nextLine();\n        let stop = this.__stop;\n        if (stop) {\n            if (this.line > stop.line || this.line == stop.line && this.col >= stop.col) {\n                this.__stop = null;\n                throw stop.stop ?? this.EOF;\n            }\n        }\n        return ch;\n    }\n    lineText(row = this.line) {\n        return this.buffer.code[row];\n    }\n    lineIndentation(row = this.line) {\n        return /^\\s*/.exec(this.lineText(row))[0].length;\n    }\n    lookingAt(what) {\n        var line = this.buffer.code[this.line];\n        if (what instanceof RegExp) return what.exec(line.substr(this.col));\n        else return line.substr(this.col, what.length) == what;\n    }\n    textBefore(pos) {\n        if (pos == null) pos = this.buffer._rowColToPosition(this.line, this.col);\n        return this.buffer.getCode().substr(0, pos);\n    }\n    textAfter(pos) {\n        if (pos == null) pos = this.buffer._rowColToPosition(this.line, this.col);\n        return this.buffer.getCode().substr(pos);\n    }\n    substring(start, end) {\n        return this.buffer.getCode().substring(start, end);\n    }\n    substr(start, end) {\n        return this.buffer.getCode().substr(start, end);\n    }\n    eol() {\n        return this.col == this.buffer.code[this.line].length;\n    }\n    eof() {\n        var n = this.buffer.code.length, l = this.line;\n        return l >= n || l == n - 1 && this.eol();\n    }\n    stopAt(line, col, stop = this.EOF) {\n        this.__stop = {\n            line: line,\n            col: col,\n            stop: stop\n        };\n    }\n    length() {\n        return this.buffer.code.length;\n    }\n    lineLength(line) {\n        if (line == null) line = this.line;\n        return this.buffer.code[line].length;\n    }\n    save() {\n        return {\n            buffer: this.buffer,\n            line: this.line,\n            col: this.col\n        };\n    }\n    restore(state) {\n        this.buffer = state.buffer;\n        this.line = state.line;\n        this.col = state.col;\n    }\n    checkStop() {\n        if (this.eof()) throw this.EOF;\n        if (this.eol()) throw this.EOL;\n        let stop = this.__stop;\n        if (stop) {\n            if (this.line > stop.line || this.line == stop.line && this.col >= stop.col) {\n                this.__stop = null;\n                throw stop.stop ?? this.EOF;\n            }\n        }\n    }\n    skip_ws() {\n        while($c749180882ef16eb$export$825fc0b420d392c1.is_whitespace(this.peek()))this.next();\n    }\n}\n$c749180882ef16eb$export$2f1022027d35d1bb.prototype.EOL = {};\n$c749180882ef16eb$export$2f1022027d35d1bb.prototype.EOF = {};\nclass $c749180882ef16eb$export$825fc0b420d392c1 {\n    constructor({ buffer: buffer = null, line: line = 0, col: col = 0, pos: pos = null } = {}){\n        this.buffer = buffer;\n        this.line = line;\n        this.col = col;\n        this.pos = pos;\n        if (this.pos == null) this.pos = this.buffer._rowColToPosition(this.line, this.col);\n        else {\n            var rc = this.buffer._positionToRowCol(this.pos);\n            this.line = rc.row;\n            this.col = rc.col;\n        }\n    }\n    static is_whitespace(ch) {\n        switch(ch){\n            case \" \":\n            case \"\\n\":\n            case \"\t\":\n            case \"\\f\":\n            case \"\\u2028\":\n            case \"\\u2029\":\n            case \"\\xa0\":\n                return true;\n        }\n    }\n    peek() {\n        var a = this.buffer.code;\n        var line = a[this.line];\n        if (line == null) return null;\n        if (this.col == line.length) return this.line == a.length - 1 ? null : \"\\n\";\n        return line.charAt(this.col);\n    }\n    next() {\n        var ch = this.peek();\n        if (ch) {\n            ++this.pos;\n            ++this.col;\n            if (this.col > this.buffer.code[this.line].length) {\n                this.col = 0;\n                ++this.line;\n            }\n        }\n        return ch;\n    }\n    read_while(pred) {\n        var ret = \"\", ch;\n        while((ch = this.peek()) && pred(ch))ret += this.next();\n        return ret;\n    }\n    skip_ws() {\n        return this.read_while(this.is_whitespace);\n    }\n    looking_at(what) {\n        var line = this.buffer.code[this.line];\n        if (what instanceof RegExp) return what.exec(line.substr(this.col));\n        else return line.substr(this.col, what.length) == what;\n    }\n}\n$c749180882ef16eb$export$825fc0b420d392c1.prototype.is_whitespace = $c749180882ef16eb$export$825fc0b420d392c1.is_whitespace;\nlet $c749180882ef16eb$var$LANGUAGES = Object.create(null);\nclass $c749180882ef16eb$export$3964ae1c660db960 extends (0, $08a06a2e99accb03$export$76712d54f90f7348) {\n    static define(name, func) {\n        $c749180882ef16eb$var$LANGUAGES[name.toLowerCase()] = func;\n    }\n    constructor({ buffer: buffer, type: type }){\n        super();\n        if (typeof type == \"string\") type = $c749180882ef16eb$var$LANGUAGES[type.toLowerCase()];\n        this.buffer = buffer;\n        this.type = type;\n    }\n    reset() {\n        this.stream = new $c749180882ef16eb$export$2f1022027d35d1bb({\n            buffer: this.buffer\n        });\n        this.theParser = this.type(this.stream, this);\n        this.parsers = [];\n        this.parsers[-1] = this.theParser.copy();\n        this.timerUpdate = null;\n        this.start();\n    }\n    stop() {\n        clearTimeout(this.timerUpdate);\n    }\n    getLanguage(name, options) {\n        return $c749180882ef16eb$var$LANGUAGES[name](this.stream, this, options);\n    }\n    showProgress(p) {\n        if (p != null) p = Math.round(p / this.stream.length() * 100) + \"%\";\n        this.buffer.updateProgress(\"Syntax highlighting\", p);\n    }\n    start() {\n        this.stop();\n        let stream = this.stream, p, a = this.parsers;\n        stream.line = a.length;\n        while(!(p = a[stream.line]))stream.prevLine();\n        stream.nextLine();\n        p = p();\n        let doit = ()=>{\n            this.buffer.preventUpdates();\n            let n = 100;\n            // this.showProgress(this.stream.line);\n            while(true)try {\n                while(true)p.next();\n            } catch (ex) {\n                if (ex === stream.EOL) {\n                    a[stream.line] = p.copy();\n                    stream.nextLine();\n                    if (--n == 0) {\n                        this.buffer.resumeUpdates();\n                        this.timerUpdate = setTimeout(doit, 25);\n                        return;\n                    }\n                } else if (ex === stream.EOF) {\n                    a[stream.line] = p.copy();\n                    this.buffer.resumeUpdates();\n                    break;\n                } else throw ex;\n            }\n        // this.showProgress();\n        };\n        doit();\n    }\n    quickInsertLine(row) {\n        this.truncate(row);\n    }\n    quickDeleteLine(row) {\n        this.truncate(row);\n    }\n    onToken(line, c1, c2, type) {\n        this.callHooks(\"onFoundToken\", line, c1, c2, type);\n    }\n    getParserForLine(row, col) {\n        this.stop();\n        let stream = this.stream, p, a = this.parsers;\n        stream.line = row - 1;\n        while(!(p = a[stream.line]))stream.prevLine();\n        stream.nextLine();\n        if (col != null) stream.stopAt(row, col);\n        p = p();\n        try {\n            this.buffer.preventUpdates();\n            while(true){\n                if (col == null && stream.line == row) return p;\n                try {\n                    while(true)p.next();\n                } catch (ex) {\n                    if (ex === stream.EOL) {\n                        a[stream.line] = p.copy();\n                        stream.nextLine();\n                    } else if (ex === stream.EOF) return p;\n                    else throw ex;\n                }\n            }\n        } finally{\n            this.buffer.resumeUpdates();\n            if (stream.line < stream.length()) this.timerUpdate = setTimeout(this.start.bind(this, stream.line), 25);\n        }\n    }\n    reparseAll() {\n        this.truncate(0);\n        return this.finishParsing();\n    }\n    finishParsing() {\n        this.getParserForLine(this.stream.length());\n        return this.getLastParser();\n    }\n    getLastParser() {\n        return this.parsers.at(-1);\n    }\n    getIndentation(row, buffer) {\n        var p = this.getParserForLine(row);\n        if (p && p.indentation instanceof Function) return p.indentation(buffer);\n    }\n    truncate(row) {\n        if (this.parsers.length > row) this.parsers.length = row;\n    }\n}\nfunction $c749180882ef16eb$export$2b0c642afb0ae4ca(p1, p2) {\n    return (p1.row ?? p1.line) < (p2.row ?? p2.line) ? -1 : (p1.row ?? p1.line) > (p2.row ?? p2.line) ? 1 : (p1.col ?? p1.c1) - (p2.col ?? p2.c1);\n}\nfunction $c749180882ef16eb$export$af0894485b469f4e(tok) {\n    var pp = tok.context.passedParens;\n    pp = pp instanceof Function ? pp() : pp;\n    if (pp) pp = [\n        ...pp\n    ].sort($c749180882ef16eb$export$2b0c642afb0ae4ca);\n    return pp;\n}\nfunction $c749180882ef16eb$export$f6a9bcac20db9551(caret, zone) {\n    return (p)=>p.closed && zone == \"outer\" && p.outer ? $c749180882ef16eb$export$2b0c642afb0ae4ca({\n            line: p.outer.l1,\n            col: p.outer.c1\n        }, caret) < 0 && $c749180882ef16eb$export$2b0c642afb0ae4ca({\n            line: p.outer.l2,\n            col: p.outer.c2\n        }, caret) >= 0 : zone == \"inner\" && p.inner ? $c749180882ef16eb$export$2b0c642afb0ae4ca({\n            line: p.inner.l1,\n            col: p.inner.c1\n        }, caret) <= 0 && $c749180882ef16eb$export$2b0c642afb0ae4ca({\n            line: p.inner.l2,\n            col: p.inner.c2\n        }, caret) >= 0 : $c749180882ef16eb$export$2b0c642afb0ae4ca(p, caret) < 0 && $c749180882ef16eb$export$2b0c642afb0ae4ca(p.closed, caret) >= 0;\n}\n\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n\n\nfunction $c7731ae7d5abaea3$var$TMPL_CHAR_INFO({ ch: ch, code: code, codeHex: codeHex, point: point, sizeKB: sizeKB }) {\n    return `\n<table>\n  <tr><td style='text-align: right; font-weight: bold'>Char:</td><td><tt> ${ch} </tt></td></tr>\n  ${code != null ? `\n    <tr><td style='text-align: right; font-weight: bold'>Char code:</td><td> ${code} / 0x${codeHex} </td></tr>\n  ` : \"\"}\n  <tr><td style='text-align: right; font-weight: bold'>Position:</td><td> ${point} </td></tr>\n  <tr><td style='text-align: right; font-weight: bold'>Buffer size:</td><td> ${sizeKB} </td></tr>\n</table>`;\n}\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    forward_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"goto_char\", this.point() + x);\n    }),\n    backward_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"forward_char\", -x);\n    }),\n    forward_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(x) {\n        if (x == null) x = 1;\n        var rc = this._rowcol;\n        if (!/^(forward|backward)_line$/.test(this.previousCommand)) this.setq(\"line_movement_requested_col\", rc.col);\n        var ret = this.cmd(\"goto_char\", this._rowColToPosition(rc.row + x, Math.max(rc.col, this.getq(\"line_movement_requested_col\"))));\n        if (!ret) this.setq(\"line_movement_requested_col\", rc.col);\n        return ret;\n    }),\n    backward_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"forward_line\", -x);\n    }),\n    forward_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"P\", function(noLine) {\n        var re = noLine ? /[^\\x20\\t\\xA0]/g : /[^\\s]/g;\n        if (this.cmd(\"search_forward_regexp\", re)) {\n            this.cmd(\"backward_char\");\n            return true;\n        } else if (!noLine) return this.cmd(\"end_of_buffer\");\n    }),\n    backward_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"P\", function(noLine) {\n        var re = noLine ? /[^\\x20\\t\\xA0]/g : /[^\\s]/g;\n        if (this.cmd(\"search_backward_regexp\", re)) {\n            this.cmd(\"forward_char\");\n            return true;\n        } else if (!noLine) return this.cmd(\"beginning_of_buffer\");\n    }),\n    beginning_of_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        return this.cmd(\"goto_char\", this._rowColToPosition(this._rowcol.row, 0));\n    }),\n    back_to_indentation: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var rc = this._rowcol, line = this.code[rc.row], m = /\\S/.exec(line);\n        if (m) return this.cmd(\"goto_char\", this._rowColToPosition(rc.row, m.index));\n    }),\n    beginning_of_indentation_or_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        return this.cmd(\"back_to_indentation\") || this.cmd(\"beginning_of_line\");\n    }),\n    end_of_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var rc = this._rowcol;\n        return this.cmd(\"goto_char\", this._rowColToPosition(rc.row, this.code[rc.row].length));\n    }),\n    beginning_of_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        return this.cmd(\"goto_char\", 0);\n    }),\n    end_of_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        return this.cmd(\"goto_char\", this.getCodeSize());\n    }),\n    eob_p: function() {\n        return this.point() == this.getCodeSize();\n    },\n    bob_p: function() {\n        return this.point() == 0;\n    },\n    eol_p: function() {\n        var rc = this._positionToRowCol(this.point());\n        return rc.col == this.code[rc.line].length;\n    },\n    bol_p: function() {\n        return this._positionToRowCol(this.point()).col == 0;\n    },\n    backward_delete_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (!this.deleteTransientRegion()) {\n            if (n == null) n = 1;\n            var pos = this.point();\n            if (pos > 0) this._deleteText(pos - n, pos);\n        }\n    }),\n    delete_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (!this.deleteTransientRegion()) {\n            if (n == null) n = 1;\n            var pos = this.point();\n            this._deleteText(pos, pos + n);\n        }\n    }),\n    delete_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^P\", function(noLine) {\n        if (!this.deleteTransientRegion()) {\n            var p = this.point();\n            if (this.cmd(\"forward_whitespace\", noLine)) {\n                this._deleteText(p, this.point());\n                return true;\n            }\n        }\n    }),\n    backward_delete_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^P\", function(noLine) {\n        if (!this.deleteTransientRegion()) {\n            var p = this.point();\n            if (this.cmd(\"backward_whitespace\", noLine)) {\n                this._deleteText(this.point(), p);\n                return true;\n            }\n        }\n    }),\n    delete_indentation: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"P\", function(nextLine) {\n        if (nextLine) this.cmd(\"forward_line\");\n        this.cmd(\"back_to_indentation\");\n        this.cmd(\"backward_delete_whitespace\");\n        this.cmd(\"insert\", \" \");\n    }),\n    universal_argument: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        this.pushKeymap((0, $2a60837ab2b03436$export$7f1c7eed09402475));\n        if (!this.isMinibuffer) this.setMinibuffer(\"C-u\");\n    }),\n    overwrite_mode: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.resetOverwriteMode();\n    }),\n    self_insert_command: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(repeat) {\n        var ev = this.interactiveEvent();\n        var ch = ev.key;\n        var rc = this._rowcol;\n        if (ch.length == 1 && !ev.altKey && !ev.ctrlKey) {\n            this.deleteTransientRegion();\n            if (repeat != null) ch = ch.repeat(repeat);\n            if (this.overwriteMode) {\n                var line = this.code[rc.row], left = line.length - rc.col;\n                if (left > 0) this.cmd(\"delete_char\", Math.min(left, repeat || 1));\n            }\n            this.cmd(\"insert\", ch);\n            return true;\n        }\n        return false;\n    }),\n    newline: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (n == null) n = 1;\n        this.deleteTransientRegion();\n        this.cmd(\"insert\", \"\\n\".repeat(n));\n    }),\n    newline_and_indent: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (n) this.cmd(\"newline\", n);\n        else {\n            this.cmd(\"backward_delete_whitespace\", true);\n            this.cmd(\"newline\");\n            this.cmd(\"indent_line\");\n        }\n    }),\n    indent_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"P\", function(noEmpty) {\n        if (!this.tokenizer) this.cmd(\"insert\", \" \".repeat(this.getq(\"indent_line\")));\n        else {\n            let indent = this.tokenizer.getIndentation(this._rowcol.row, this);\n            if (indent != null) {\n                let line = this.getLine();\n                if (!noEmpty || /\\S/.test(line)) {\n                    let rc = this._rowcol;\n                    let pos = this.point() - rc.col;\n                    let ci = /[^\\S\\r\\n]*/.exec(line)[0].length;\n                    if (ci > indent) this._deleteText(pos, pos + ci - indent);\n                    else if (indent > ci) this._insertText(\" \".repeat(indent - ci), pos);\n                    if (rc.col <= ci) this.cmd(\"goto_char\", pos + indent);\n                }\n            }\n        }\n    }),\n    indent_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        this.cmd(\"save_excursion\", function() {\n            var m = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            while(this.point() < m.getPosition()){\n                this.cmd(\"indent_line\", true);\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\")) break;\n            }\n            m.destroy();\n        });\n    }),\n    make_marker: function(pos) {\n        return this.createMarker(pos);\n    },\n    looking_at: function() {\n        return this.looking_at.apply(this, arguments);\n    },\n    looking_back: function() {\n        return this.looking_back.apply(this, arguments);\n    },\n    search_forward: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sSearch: \", function(str, bound) {\n        var code = this.getCode(), point = this.point();\n        if (this.getq(\"case_fold_search\")) {\n            code = code.toLowerCase();\n            str = str.toLowerCase();\n        }\n        var pos = code.indexOf(str, point);\n        if (pos >= 0 && (bound == null || pos <= bound)) return this.cmd(\"goto_char\", pos + str.length);\n    }),\n    search_backward: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sSearch backward: \", function(str, bound) {\n        var code = this.getCode(), point = this.point();\n        if (this.getq(\"case_fold_search\")) {\n            code = code.toLowerCase();\n            str = str.toLowerCase();\n        }\n        var pos = code.lastIndexOf(str, point);\n        if (pos == point) pos = code.lastIndexOf(str, point - 1);\n        if (pos >= 0 && pos != point && (bound == null || pos >= bound)) return this.cmd(\"goto_char\", pos);\n    }),\n    make_regexp: function(rx) {\n        if (!(rx instanceof RegExp)) {\n            var matchCase = !this.getq(\"case_fold_search\");\n            try {\n                rx = new RegExp(rx, matchCase ? \"g\" : \"ig\");\n            } catch (ex) {\n                throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"Invalid regexp\");\n            }\n        }\n        return rx;\n    },\n    search_forward_regexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sRegExp search: \", function(rx) {\n        rx = this.cmd(\"make_regexp\", rx);\n        let pos = rx.lastIndex = this.point();\n        let m = rx.exec(this.getCode());\n        if (m && rx.lastIndex != pos) {\n            m.after = rx.lastIndex;\n            this.matchData = m;\n            this.cmd(\"goto_char\", rx.lastIndex);\n            return true;\n        }\n    }),\n    search_backward_regexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sBackward RegExp search: \", function(rx) {\n        rx = this.cmd(\"make_regexp\", rx);\n        var m = this.lastIndexOfRegexp(this.getCode(), rx, this.point());\n        if (m && m.index != this.point()) {\n            this.cmd(\"goto_char\", m.index);\n            return true;\n        }\n    }),\n    forward_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var syntax_word = this.getq(\"syntax_word\"), end = false;\n        while(!end && !syntax_word.test(this.charAt()))if (!this.cmd(\"forward_char\")) end = true;\n        while(!end && syntax_word.test(this.charAt()))if (!this.cmd(\"forward_char\")) end = true;\n    }),\n    backward_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var syntax_word = this.getq(\"syntax_word\"), end = false;\n        while(!end && !syntax_word.test(this.charAt(-1)))if (!this.cmd(\"backward_char\")) end = true;\n        while(!end && syntax_word.test(this.charAt(-1)))if (!this.cmd(\"backward_char\")) end = true;\n    }),\n    forward_paragraph: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        let rx = this.getq(\"syntax_paragraph_sep\");\n        this.cmd(\"beginning_of_line\");\n        this.cmd(\"backward_char\");\n        if (this.cmd(\"looking_at\", rx)) this.cmd(\"goto_char\", this.cmd(\"match_end\"));\n        if (this.cmd(\"search_forward_regexp\", rx)) this.cmd(\"goto_char\", this.cmd(\"match_beginning\") + 1);\n        else this.cmd(\"end_of_buffer\");\n    }),\n    backward_paragraph: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        let rx = this.getq(\"syntax_paragraph_sep\");\n        this.cmd(\"beginning_of_line\");\n        if (this.cmd(\"looking_back\", rx)) this.cmd(\"goto_char\", this.cmd(\"match_beginning\"));\n        if (this.cmd(\"search_backward_regexp\", rx)) this.cmd(\"goto_char\", this.cmd(\"match_end\"));\n        else this.cmd(\"beginning_of_buffer\");\n    }),\n    mark_paragraph: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\", function(begin, end) {\n        if (!this.transientMarker) {\n            this.cmd(\"forward_paragraph\");\n            this.setMark(this.point());\n            this.ensureTransientMark();\n            this.cmd(\"backward_paragraph\");\n        } else this.cmd(\"save_excursion\", function() {\n            if (this.transientMarker) this.cmd(\"goto_char\", end);\n            this.ensureTransientMark();\n            this.cmd(\"forward_paragraph\");\n            this.setMark(this.point());\n            this.transientMarker.swap(this.caretMarker);\n        });\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n    transpose_words: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        // if we're in the middle of a word, some\n        // weird things happen; better skip it, just\n        // like Emacs does.\n        this.cmd(\"backward_char\");\n        if (this.getq(\"syntax_word\").test(this.charAt())) this.cmd(\"forward_word\");\n        var a = [];\n        this.cmd(\"forward_word\");\n        a.push(this.point());\n        this.cmd(\"backward_word\");\n        a.push(this.point());\n        this.cmd(\"backward_word\");\n        a.push(this.point());\n        this.cmd(\"forward_word\");\n        a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a));\n    }),\n    transpose_lines: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var a = [];\n        this.cmd(\"backward_line\");\n        this.cmd(\"beginning_of_line\");\n        a.push(this.point());\n        this.cmd(\"end_of_line\");\n        a.push(this.point());\n        this.cmd(\"forward_char\");\n        a.push(this.point());\n        this.cmd(\"end_of_line\");\n        a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a) + 1);\n    }),\n    transpose_chars: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var pos = this.point();\n        if (this.cmd(\"backward_char\")) this.cmd(\"goto_char\", this._swapAreas([\n            pos - 1,\n            pos,\n            pos,\n            pos + 1\n        ]));\n    }),\n    kill_word: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(prefix) {\n        if (this.transientMarker) {\n            var r = this.getRegion();\n            this.cmd(\"kill_region\", r.begin, r.end);\n            this.clearTransientMark();\n        } else {\n            var pos = this.point();\n            this.cmd(\"forward_word\", prefix == null ? 1 : prefix);\n            var pos2 = this.point();\n            this._killingAction(pos, pos2, false);\n        }\n    }),\n    backward_kill_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var pos = this.point();\n        this.cmd(\"backward_word\");\n        var pos2 = this.point();\n        this._killingAction(pos, pos2, true);\n    }),\n    _apply_operation_on_word: function(op, cc) {\n        var pos = this.point();\n        if (this.getq(\"syntax_word\").test(this.charAt())) {\n            var pos2 = this.cmd(\"save_excursion\", function() {\n                this.cmd(\"forward_word\");\n                return this.point();\n            });\n            var word = op.call(this._bufferSubstring(pos, pos2));\n            this._deleteText(pos, pos2);\n            this._insertText(word);\n        } else {\n            this.cmd(\"forward_word\");\n            this.cmd(\"backward_word\");\n            if (pos != this.point()) this.cmd(cc);\n        }\n    },\n    capitalize_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this.cmd(\"_apply_operation_on_word\", function() {\n            return this.charAt(0).toUpperCase() + this.substr(1).toLowerCase();\n        }, \"capitalize_word\");\n    }),\n    downcase_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this.cmd(\"_apply_operation_on_word\", String.prototype.toLowerCase, \"downcase_word\");\n    }),\n    upcase_word: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this.cmd(\"_apply_operation_on_word\", String.prototype.toUpperCase, \"upcase_word\");\n    }),\n    goto_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"NGoto char: \", function(pos) {\n        return this._repositionCaret(pos);\n    }),\n    goto_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"NGoto line: \", function(row) {\n        var pos = this._rowColToPosition(row - 1, 0);\n        return this.cmd(\"goto_char\", pos);\n    }),\n    move_to_column: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"NMove to column: \", function(col, force) {\n        var rc = this._positionToRowCol(this.point());\n        var text = this.code[rc.row];\n        if (text.length < col) {\n            if (force) {\n                this.cmd(\"end_of_line\");\n                this.cmd(\"insert\", \" \".repeat(col - text.length));\n            } else this.cmd(\"end_of_line\");\n        } else this.cmd(\"goto_char\", this._rowColToPosition(rc.row, col));\n    }),\n    delete_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        this._deleteText(begin, end);\n    }),\n    insert: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sInsert text: \", function(...args) {\n        return this._insertText(args.join(\"\"));\n    }),\n    keyboard_quit: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.clearTransientMark();\n        this.setPrefixArg(undefined);\n        this.setMinibuffer(\"\");\n    }),\n    buffer_substring: function(begin, end) {\n        if (arguments.length == 0) {\n            var r = this.getRegion();\n            begin = r.begin;\n            end = r.end;\n        }\n        return this._bufferSubstring(begin, end);\n    },\n    kill_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(prefix) {\n        if (this.transientMarker) {\n            var r = this.getRegion();\n            this.cmd(\"kill_region\", r.begin, r.end);\n            this.clearTransientMark();\n        } else if (prefix != null) this._killingAction(this.point(), this.cmd(\"save_excursion\", ()=>{\n            this.cmd(\"forward_line\", prefix);\n            this.cmd(\"beginning_of_line\");\n            return this.point();\n        }));\n        else {\n            var pos = this.point(), rc = this._rowcol, line = this.code[rc.row], end = pos + line.length - rc.col;\n            if (rc.row < this.code.length - 1 && this.cmd(\"looking_at\", /\\s*$/my)) end++;\n            this._killingAction(pos, end);\n        }\n    }),\n    save_excursion: function() {\n        return this._saveExcursion.apply(this, arguments);\n    },\n    prevent_undo: function() {\n        return this._disableUndo.apply(this, arguments);\n    },\n    point: function() {\n        return this.caretMarker.getPosition();\n    },\n    kill_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        this._killingAction(begin, end);\n    }),\n    copy_region_as_kill: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        this._killingAction(begin, end, false, true);\n    }),\n    yank: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^P\", function(atStart) {\n        this.deleteTransientRegion();\n        var point = this.point();\n        this._insertText(this.ymacs.killRingText());\n        this.setMark(point);\n        if (atStart) this.caretMarker.swap(this.markMarker);\n    }),\n    yank_from_operating_system: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(async function() {\n        try {\n            let code = await navigator.clipboard.readText();\n            this._saveKilledText(code);\n            this.callInteractively(\"yank\");\n        } catch (ex) {\n            console.error(ex);\n            this.signalError(\"Cannot read the system clipboard. Error in devtools console.\");\n        }\n    }),\n    copy_for_operating_system: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", async function(begin, end) {\n        try {\n            let code = this.cmd(\"buffer_substring\", begin, end);\n            await navigator.clipboard.writeText(code);\n        } catch (ex) {\n            console.error(ex);\n            this.signalError(\"Cannot write to system clipboard. Error in devtools console.\");\n        }\n    }),\n    yank_pop: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        if (/^yank/.test(this.previousCommand)) {\n            this.ymacs.rotateKillRing(false);\n            this._deleteText(this.caretMarker, this.markMarker);\n            this.cmd(\"yank\");\n        } else this.signalError(\"Previous command was not a yank\");\n    }),\n    yank_shift: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        if (/^yank/.test(this.previousCommand)) {\n            this.ymacs.rotateKillRing(true);\n            this._deleteText(this.caretMarker, this.markMarker);\n            this.cmd(\"yank\");\n        } else this.signalError(\"Previous command was not a yank\");\n    }),\n    mark: function() {\n        return this.markMarker.getPosition();\n    },\n    set_mark_command: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"d\", function(x) {\n        this.clearTransientMark();\n        this.setMark(x);\n        if (this.currentCommand == \"set_mark_command\") {\n            this.signalInfo(\"Mark set\", null, 1000);\n            this.setq(\"sticky_mark\", true);\n        }\n    }),\n    exchange_point_and_mark: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        this.transientMarker = this.createMarker();\n        this.caretMarker.swap(this.markMarker);\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n    mark_whole_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.clearTransientMark();\n        this.cmd(\"end_of_buffer\");\n        this.ensureTransientMark();\n        this.cmd(\"beginning_of_buffer\");\n        this.ensureTransientMark();\n    }),\n    recenter_top_bottom: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenActiveFrame(function(frame) {\n            frame.recenterTopBottom();\n        });\n    }),\n    recenter: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenActiveFrame(function(frame) {\n            frame.centerOnCaret();\n        });\n    }),\n    ensure_caret_visible: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenActiveFrame(function(frame) {\n            if (frame.ensureCaretVisible()) frame.centerOnCaret();\n        });\n    }),\n    /* -----[ paragraphs ]----- */ get_fill_paragraph_region: function() {\n        let r1 = this.cmd(\"save_excursion\", ()=>{\n            if (!this.cmd(\"looking_at\", this.getq(\"syntax_paragraph_sep\"))) this.cmd(\"forward_paragraph\");\n            let end = this.point() - 1;\n            this.cmd(\"backward_paragraph\");\n            let begin = this.point();\n            return {\n                begin: begin,\n                end: end\n            };\n        });\n        let r2 = this.cmd(\"xml_get_fill_paragraph_region\");\n        if (r2) return {\n            begin: Math.max(r1.begin, r2.begin),\n            end: Math.min(r1.end, r2.end)\n        };\n        return r1;\n    },\n    fill_paragraph: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^rP\", function(begin, end, noPrefix) {\n        this.cmd(\"save_excursion\", function() {\n            if (!this.transientMarker) {\n                let r = this.cmd(\"get_fill_paragraph_region\");\n                begin = r.begin;\n                end = r.end;\n            } else this.clearTransientMark();\n            this.cmd(\"goto_char\", begin);\n            var eop = this.createMarker(end);\n            // identify the prefix to use for each line\n            var prefix = \"\", del = /\\s+/y;\n            if (this.cmd(\"looking_at\", /\\s*\\/\\/+\\s*/y)) {\n                prefix = this.matchData[0];\n                del = /\\s*\\/\\/+\\s*/y;\n            } else if (this.cmd(\"looking_at\", /\\s*\\/\\*\\s*/y)) {\n                prefix = \" \".repeat(this.matchData[0].length);\n                del = /\\s*\\**\\s*/y;\n            } else if (this.cmd(\"looking_at\", /\\s*[#>;\\s]+\\s*/y)) {\n                prefix = this.matchData[0];\n                del = /\\s*[#>;\\s]*\\s*/y;\n            } else if (this.cmd(\"looking_at\", /\\s*([-*]|[0-9]+\\.|\\(?[a-z][\\).])?\\s+/iy)) {\n                prefix = \" \".repeat(this.matchData[0].length);\n                del = /\\s*[#>;\\s]*\\s*/y;\n            }\n            if (noPrefix) {\n                this._deleteText(this.point(), this.point() + this.matchData[0].length);\n                prefix = \"\";\n            }\n            // remove newlines first\n            while(true){\n                this.cmd(\"end_of_line\");\n                this.cmd(\"backward_delete_whitespace\");\n                if (this.point() >= eop.getPosition()) break;\n                this._replaceText(this.point(), this.point() + 1, \" \");\n                if (del && this.cmd(\"looking_at\", del)) this._deleteText(this.point(), this.point() + this.matchData[0].length);\n            }\n            this.cmd(\"beginning_of_line\");\n            // main operation\n            var bol = this.point(), done = false;\n            while(!done){\n                var p = this.point();\n                if (!this.cmd(\"search_forward_regexp\", /\\s/g)) done = true;\n                if (this.point() >= eop.getPosition()) {\n                    this.cmd(\"goto_char\", eop);\n                    done = true;\n                }\n                if (this._rowcol.col > this.getq(\"fill_column\") + 1) {\n                    if (p > bol) this.cmd(\"goto_char\", p);\n                    this.cmd(\"backward_delete_whitespace\");\n                    this.cmd(\"newline\");\n                    this.cmd(\"insert\", prefix);\n                    bol = this.point();\n                }\n            }\n            eop.destroy();\n        });\n    }),\n    // this looks at the style of the current paragraph and starts\n    // a similar one, i.e. using same indentation level and prefix\n    // (list-like prefixes are incremented)\n    start_next_paragraph: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"backward_paragraph\");\n        // identify the prefix to use for each line\n        var prefix = \"\";\n        if (this.cmd(\"looking_at\", /(\\s*)([0-9]+)(\\.\\s+)/y)) prefix = this.matchData[1] + (parseInt(this.matchData[2], 10) + 1) + this.matchData[3];\n        else if (this.cmd(\"looking_at\", /(\\s*\\(?)([a-z])([\\.\\)]\\s+)/iy)) prefix = this.matchData[1] + String.fromCharCode(this.matchData[2].charCodeAt(0) + 1) + this.matchData[3];\n        else if (this.cmd(\"looking_at\", /\\s*[#>;*\\s-]+\\s*/y)) prefix = this.matchData[0];\n        this.cmd(\"forward_paragraph\");\n        if (this.cmd(\"eob_p\")) this.cmd(\"newline\");\n        this.cmd(\"insert\", \"\\n\", prefix);\n        if (!this.cmd(\"looking_at\", /\\n\\n/y)) {\n            this.cmd(\"newline\");\n            this.cmd(\"backward_char\");\n        }\n    }),\n    scroll_down_half: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this.whenActiveFrame(function(frame) {\n            var hl = frame.heightInLines();\n            this.cmd(\"forward_line\", Math.round(hl / 1.33));\n            this.cmd(\"recenter\");\n        });\n    }),\n    scroll_up_half: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this.whenActiveFrame(function(frame) {\n            var hl = frame.heightInLines();\n            this.cmd(\"backward_line\", Math.round(hl / 1.33));\n            this.cmd(\"recenter\");\n        });\n    }),\n    scroll_up: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(arg) {\n        if (arg == null) arg = 3;\n        this.whenActiveFrame(function(frame) {\n            frame.scrollUp(arg);\n        });\n    }),\n    scroll_down: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(arg) {\n        if (arg == null) arg = 3;\n        this.whenActiveFrame(function(frame) {\n            frame.scrollDown(arg);\n        });\n    }),\n    nuke_trailing_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"save_excursion\", function() {\n            this.cmd(\"goto_char\", 0);\n            while(this._rowcol.row < this.code.length){\n                var line = this.code[this._rowcol.row], m = /\\s+$/.exec(line);\n                if (m) {\n                    this.cmd(\"beginning_of_line\");\n                    this._deleteText(this.point() + m.index, this.point() + line.length);\n                }\n                if (!this.cmd(\"forward_line\")) break;\n            }\n        });\n    }),\n    match_string: function(n) {\n        return this.matchData[n];\n    },\n    match_beginning: function() {\n        return this.matchData.index;\n    },\n    match_end: function() {\n        return this.matchData.index + this.matchData[0].length;\n    },\n    undo: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        this._placeUndoBoundary();\n        if (!this._playbackUndo()) this.signalError(\"No further undo information\");\n    }),\n    center_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(n) {\n        if (n == null) n = 1;\n        for(let i = 0; i < n; ++i){\n            if (i > 0) this.cmd(\"forward_line\");\n            this.cmd(\"save_excursion\", function() {\n                this.cmd(\"end_of_line\");\n                this.cmd(\"backward_delete_whitespace\", true);\n                this.cmd(\"beginning_of_line\");\n                this.cmd(\"delete_whitespace\", true);\n                var line = this.code[this._rowcol.row];\n                var indent = Math.floor((this.getq(\"fill_column\") - line.length) / 2);\n                this.cmd(\"insert\", \" \".repeat(indent));\n            });\n        }\n    }),\n    /* -----[ dabbrev ]----- */ dabbrev_expand: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        if (this.previousCommand != \"dabbrev_expand\") this.setq(\"dabbrev_context\", null);\n        var ctx = this.getq(\"dabbrev_context\");\n        if (!ctx) {\n            ctx = this.setq(\"dabbrev_context\", {});\n            var p1 = this.cmd(\"save_excursion\", function() {\n                this.cmd(\"bind_variables\", {\n                    syntax_word: this.getq(\"syntax_word_dabbrev\")\n                }, \"backward_word\");\n                return this.point();\n            });\n            if (p1 == this.point()) return this.signalError(\"Nothing to expand\");\n            ctx.search = this.cmd(\"buffer_substring\", p1, this.point());\n            ctx.point = p1;\n            ctx.length = this.point() - p1;\n            ctx.lastSearch = p1;\n            ctx.encountered = Object.create(null);\n            ctx.forward = false;\n            ctx.buffer = this;\n            ctx.seenBuffers = [\n                this\n            ];\n            ctx.startBuffer = this;\n        }\n        var expansion;\n        // in the following excursion, *this* is ctx.buffer,\n        // not necessarily the currently active buffer.  It's\n        // purpose is to determine the next expansion and\n        // setup the context so that the next invocation would\n        // continue.\n        ctx.buffer.cmd(\"save_excursion\", function repeat() {\n            var word = this.getq(\"syntax_word_dabbrev\");\n            var p1;\n            var found = false;\n            this.cmd(\"goto_char\", ctx.lastSearch);\n            // console.log(\"last at: %d\", ctx.lastSearch);\n            if (!ctx.forward) {\n                while(this.cmd(\"search_backward\", ctx.search))if (!word.test(this.charAt(-1))) {\n                    found = true;\n                    break;\n                }\n                if (found) {\n                    p1 = this.point();\n                    ctx.lastSearch = p1;\n                    this.cmd(\"goto_char\", p1 + ctx.search.length);\n                } else {\n                    ctx.forward = true;\n                    ctx.lastSearch = ctx.point + ctx.length;\n                    repeat.call(this);\n                    return;\n                }\n            } else {\n                while(this.cmd(\"search_forward\", ctx.search))if (!word.test(this.charAt(-ctx.search.length - 1))) {\n                    found = true;\n                    break;\n                }\n                if (found) {\n                    ctx.lastSearch = this.point();\n                    p1 = this.point() - ctx.search.length;\n                } else {\n                    ctx.buffer = this.whenYmacs(\"getNextBuffer\", this);\n                    if (ctx.seenBuffers.includes(ctx.buffer)) {\n                        expansion = ctx.search;\n                        ctx.startBuffer.signalError(\"No more completions\");\n                        ctx.lastSearch = ctx.point + ctx.length;\n                        ctx.startBuffer.setq(\"dabbrev_context\", null);\n                        return;\n                    } else {\n                        ctx.seenBuffers.push(ctx.buffer);\n                        ctx.lastSearch = 0;\n                        ctx.buffer.cmd(\"save_excursion\", repeat);\n                        return;\n                    }\n                }\n            }\n            if (p1 != null) {\n                // console.log(\"%s at %d, next from %d\", ctx.search, p1, ctx.lastSearch);\n                this.cmd(\"bind_variables\", {\n                    syntax_word: this.getq(\"syntax_word_dabbrev\")\n                }, \"forward_word\");\n                expansion = this.cmd(\"buffer_substring\", p1, this.point());\n                if (ctx.encountered[expansion]) repeat.call(this);\n            }\n        });\n        if (expansion != null) {\n            this._replaceText(ctx.point, ctx.point + ctx.length, expansion);\n            ctx.length = expansion.length;\n            ctx.encountered[expansion] = true;\n        }\n    }),\n    /* -----[ frames and buffers ]----- */ split_frame_vertically: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(percent) {\n        if (percent == null) percent = \"50%\";\n        else percent += \"%\";\n        this.whenActiveFrame(\"vsplit\", percent);\n    }),\n    split_frame_horizontally: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(percent) {\n        if (percent == null) percent = \"50%\";\n        else percent += \"%\";\n        this.whenActiveFrame(\"hsplit\", percent);\n    }),\n    delete_other_frames: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenActiveFrame(\"deleteOtherFrames\");\n    }),\n    delete_frame: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenActiveFrame(\"deleteFrame\");\n    }),\n    other_frame: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenYmacs(\"focusOtherFrame\");\n    }),\n    windmove: function(dir) {\n        this.whenYmacs(function(ymacs) {\n            var f = ymacs.getFrameInDirection(dir);\n            if (f) f.focus();\n        });\n    },\n    next_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenYmacs(\"switchToNextBuffer\", this.sameCommandCount() + 1);\n    }),\n    previous_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.whenYmacs(\"switchToPreviousBuffer\", this.sameCommandCount() + 1);\n    }),\n    switch_to_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"BSwitch to buffer: \", function(buffer) {\n        this.whenYmacs(function(ymacs) {\n            if (!/\\S/.test(buffer)) {\n                if (ymacs.buffers.length < 2) return;\n                buffer = ymacs.buffers[1];\n            }\n            ymacs.switchToBuffer(buffer);\n        });\n    }),\n    kill_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var self = this;\n        function kill() {\n            self.whenYmacs(function(ymacs) {\n                ymacs.killBuffer(self);\n            });\n        }\n        if (self.dirty()) {\n            var msg = \"Buffer \" + self.name + \" modified; kill anyway?\";\n            self.cmd(\"minibuffer_yn\", msg, function(yes) {\n                if (yes) kill();\n            });\n        } else kill();\n    }),\n    rename_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"sRename current buffer to: \", function(name) {\n        this.whenYmacs(function(ymacs) {\n            ymacs.renameBuffer(this, name);\n        });\n    }),\n    /* -----[ other ]----- */ delete_region_or_line: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        if (!this.deleteTransientRegion()) {\n            this.cmd(\"beginning_of_line\");\n            var pos = this.point();\n            this.cmd(\"end_of_line\");\n            this.cmd(\"forward_char\");\n            if (this.point() != pos) {\n                this._deleteText(pos, this.point());\n                return true;\n            }\n        }\n    }),\n    // http://mihai.bazon.net/blog/close-last-xml-tag-emacs\n    close_last_xml_tag: (0, $92bab0a532b3076f$export$8c34793404b3efcb)(function() {\n        var tag, quote;\n        this.cmd(\"save_excursion\", function() {\n            var skip = 1;\n            while(skip != 0 && this.cmd(\"search_backward_regexp\", /<\\x2f?([a-zA-Z0-9:_-]+)/g)){\n                tag = this.cmd(\"match_string\", 1);\n                if (this.cmd(\"looking_at\", /<\\x2f/y)) ++skip;\n                else if (!this.cmd(\"looking_at\", /<[^\\x2f][^>]*?\\x2f>/y)) --skip;\n            }\n            if (skip != 0) tag = null;\n        });\n        if (tag) this.cmd(\"insert\", \"</\", tag, \">\");\n        else throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"Couldn't find a tag to close\");\n    }),\n    bind_variables: function() {\n        return this.withVariables.apply(this, arguments);\n    },\n    for_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\\nCExecute command within region: \", function(begin, end, func) {\n        if (end < begin) {\n            var tmp = begin;\n            begin = end;\n            end = tmp;\n        } // MACROS!  I WANT MACROS!  EVAL SUCKS. x-(\n        if (!(func instanceof Function)) func = this.COMMANDS[func];\n        this.clearTransientMark();\n        this.cmd(\"goto_char\", begin);\n        begin = this.createMarker(begin, true);\n        end = this.createMarker(end);\n        this.withCommands({\n            goto_char: function(pos) {\n                if (pos >= begin.getPosition() && pos <= end.getPosition()) return this._repositionCaret(pos);\n                throw \"YMACS_RESTRICT\";\n            }\n        }, function() {\n            try {\n                while(true){\n                    var tmp = this.point();\n                    func.call(this);\n                    if (this.point() == tmp && !this.cmd(\"forward_line\")) break;\n                }\n            } catch (ex) {\n                if (ex !== \"YMACS_RESTRICT\") throw ex;\n            } finally{\n                begin.destroy();\n                end.destroy();\n            }\n        });\n    }),\n    comment_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\", function(begin, end) {\n        var cmmt = this.getq(\"syntax_comment_line\") || this.getq(\"syntax_comment_multi\");\n        if (!cmmt) return;\n        this.clearTransientMark();\n        this.cmd(\"save_excursion\", function() {\n            end = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            var min = 100000;\n            out: while(this.point() < end.getPosition()){\n                while(this.cmd(\"looking_at\", /\\s*$/my)){\n                    if (!this.cmd(\"forward_line\")) break out;\n                }\n                var col = this._rowcol.col;\n                while(this.cmd(\"looking_at\", /\\s/y) && col < min){\n                    if (!this.cmd(\"forward_char\")) break out;\n                    ++col;\n                }\n                if (col < min) min = col;\n                if (Array.isArray(cmmt.ch)) {\n                    this.cmd(\"insert\", cmmt.ch[0], \" \");\n                    this.cmd(\"end_of_line\");\n                    this.cmd(\"insert\", \" \", cmmt.ch[1]);\n                } else this.cmd(\"insert\", cmmt.ch, \" \");\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\")) break out;\n            }\n            this.cmd(\"goto_char\", end);\n            if (this._rowcol.col > 0 && !this.cmd(\"looking_at\", /\\s*$/my)) this.cmd(\"newline_and_indent\");\n        });\n    }),\n    uncomment_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        var cmmt1 = this.getq(\"syntax_comment_line\");\n        var cmmt2 = this.getq(\"syntax_comment_multi\");\n        if (!cmmt1 && !cmmt2) return;\n        this.clearTransientMark();\n        this.cmd(\"save_excursion\", function() {\n            end = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            while(this.point() < end.getPosition()){\n                this.cmd(\"forward_whitespace\");\n                if (cmmt1 && this.cmd(\"looking_at\", cmmt1.rx)) this.cmd(\"delete_char\", this.matchData[0].length);\n                else if (cmmt2 && this.cmd(\"looking_at\", cmmt2.rx)) this._replaceText(this.point(), this.point() + this.matchData[0].length, this.matchData[1]);\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\")) break;\n            }\n        });\n    }),\n    comment_dwim: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\", function(begin, end) {\n        var cmmt1 = this.getq(\"syntax_comment_line\");\n        var cmmt2 = this.getq(\"syntax_comment_multi\");\n        if (!cmmt1 && !cmmt2) return;\n        if (this.transientMarker) this.cmd(\"save_excursion\", function() {\n            this.cmd(\"goto_char\", begin);\n            var already_comment = cmmt1 && this.cmd(\"looking_at\", cmmt1.rx) || cmmt2 && this.cmd(\"looking_at\", cmmt2.rx);\n            if (already_comment) this.cmd(\"uncomment_region\", begin, end);\n            else this.cmd(\"comment_region\", begin, end);\n        });\n        else {\n            this.cmd(\"end_of_line\");\n            if (cmmt1) this.cmd(\"insert\", \" \", cmmt1.ch, \" \");\n            else {\n                this.cmd(\"insert\", \" \", cmmt2.ch[0], cmmt2.ch[1]);\n                this.cmd(\"backward_char\", cmmt2.ch[1].length);\n            }\n            this.cmd(\"indent_line\");\n        }\n    }),\n    what_cursor_position: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        var ch = this.charAt(), chname = ch;\n        if (ch == null) chname = \"EOF\";\n        else if (ch == \" \") chname = \"Space\";\n        else if (ch == \"\\n\") chname = \"Newline\";\n        this.popupMessage({\n            isHtml: true,\n            atCaret: true,\n            text: $c7731ae7d5abaea3$var$TMPL_CHAR_INFO({\n                ch: (0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(chname),\n                code: ch ? ch.charCodeAt(0) : null,\n                codeHex: ch ? ch.charCodeAt().toString(16).toUpperCase() : null,\n                point: this.point(),\n                size: this.getCodeSize(),\n                sizeKB: (0, $08a06a2e99accb03$export$e1a3971de07c83b5)(this.getCodeSize(), 2)\n            })\n        });\n    }),\n    set_fill_column: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(value) {\n        let next = (value)=>{\n            let prev = this.getq(\"fill_column\");\n            this.setq(\"fill_column\", +value);\n            this.signalInfo(`Fill column set to ${value} (was ${prev})`, false, 5000);\n        };\n        if (value == null) this.whenMinibuffer((mb)=>{\n            this.cmd(\"minibuffer_prompt\", \"Set fill column to: \");\n            mb.setMark();\n            mb.transientMarker = mb.createMarker(mb.point(), true);\n            mb.cmd(\"insert\", String(this._rowcol.col));\n            mb.ensureTransientMark();\n            this.cmd(\"minibuffer_read_number\", next);\n        });\n        else next(value);\n    })\n});\n/* -----[ rectangle functions (vertical editing) ]----- */ (function() {\n    function apply_on_rectangle(buffer, begin, end, func) {\n        buffer.cmd(\"save_excursion\", function() {\n            var p1 = this._positionToRowCol(begin), p2 = this._positionToRowCol(end), width = Math.abs(p2.col - p1.col);\n            for(var line = p1.row; line <= p2.row; ++line){\n                this.cmd(\"goto_char\", this._rowColToPosition(line, 0));\n                var text = this.code[line], c1 = p1.col, c2 = p2.col, p = this.point(), ws = 0;\n                if (c1 > c2) {\n                    var tmp = c1;\n                    c1 = c2;\n                    c2 = tmp;\n                }\n                if (c1 > text.length) {\n                    ws = c1 - text.length;\n                    c1 = text.length;\n                }\n                if (c2 > text.length) c2 = text.length;\n                func.call(this, p + c1, p + c2, ws, width);\n            }\n        }, begin == buffer.point());\n    }\n    (0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n        string_rectangle: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\\nsString rectangle: \", function(begin, end, string) {\n            apply_on_rectangle(this, begin, end, function(c1, c2, ws) {\n                if (ws > 0) this._insertText(\" \".repeat(ws), c1);\n                else this._deleteText(c1, c2);\n                this._insertText(string, c1 + ws);\n            });\n        }),\n        kill_rectangle: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n            var text = [];\n            apply_on_rectangle(this, begin, end, function(c1, c2, ws, width) {\n                var str = this._bufferSubstring(c1, c2);\n                if (c2 - c1 < width) str += \" \".repeat(width - c2 + c1);\n                text.push(str);\n                this._deleteText(c1, c2);\n            });\n            this.setq(\"killed_rectangle\", text);\n        }),\n        clear_rectangle: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n            this.cmd(\"string_rectangle\", begin, end, \" \".repeat(Math.abs(this._positionToRowCol(end).col - this._positionToRowCol(begin).col)));\n        }),\n        insert_rectangle: function(point, rect) {\n            var col = this._positionToRowCol(point).col;\n            this.setMark(point);\n            rect.forEach((text, i)=>{\n                if (i > 0) {\n                    if (!this.cmd(\"forward_line\")) {\n                        this.cmd(\"end_of_line\");\n                        this.cmd(\"newline\");\n                    }\n                    this.cmd(\"move_to_column\", col, true);\n                }\n                this.cmd(\"insert\", text);\n            });\n        },\n        yank_rectangle: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"d\", function(point) {\n            var kr = this.getq(\"killed_rectangle\");\n            if (kr == null) throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"No killed rectangle\");\n            this.cmd(\"insert_rectangle\", point, kr);\n        }),\n        _next_is_meta: function() {\n            if (!this.__nextIsMeta) {\n                this.__nextIsMeta = true;\n                this.currentKeys.pop();\n            }\n        }\n    });\n})();\n(function() {\n    (0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n        kmacro_start_macro: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(arg) {\n            if (this.ymacs.isRunningMacro()) return;\n            if (this.ymacs.isRecordingMacro()) {\n                this.signalError(\"Already defining keyboard macro.\");\n                return;\n            }\n            this.signalInfo(\"Defining keyboard macro\");\n            this.ymacs.startMacro(arg !== null);\n        }),\n        kmacro_end_macro: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            if (this.ymacs.isRunningMacro()) return;\n            if (!this.ymacs.isRecordingMacro()) {\n                this.signalInfo(\"Not defining kbd macro\");\n                return;\n            }\n            this.signalInfo(\"Keyboard macro defined\");\n            this.ymacs.stopMacro();\n        }),\n        kmacro_end_and_call_macro: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"p\", function(arg) {\n            this.ymacs.stopMacro();\n            if (arg === null) arg = 1;\n            var macro = this.ymacs.getLastMacro();\n            this.interactiveEvent(null);\n            this.ymacs.runMacro(arg, macro);\n        })\n    });\n})();\n/* -----[ transient mark extension commands ]----- */ [\n    \"forward_char\",\n    \"forward_word\",\n    \"forward_line\",\n    \"forward_paragraph\",\n    \"forward_sexp\",\n    \"beginning_of_line\",\n    \"beginning_of_indentation_or_line\",\n    \"beginning_of_buffer\",\n    \"backward_char\",\n    \"backward_word\",\n    \"backward_line\",\n    \"backward_paragraph\",\n    \"backward_sexp\",\n    \"end_of_line\",\n    \"end_of_buffer\"\n].forEach(function(cmd) {\n    (0, $5e779a545e33325b$export$df331bdfc76955b4).COMMANDS[cmd + \"_mark\"] = (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        this.ensureTransientMark();\n        this.cmdApply(cmd, arguments);\n        this.ensureTransientMark();\n    });\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n\n\nvar $64ad30bda24c420e$var$$menu = null, $64ad30bda24c420e$var$$selectedIndex = null, $64ad30bda24c420e$var$$selectedItem = null;\nfunction $64ad30bda24c420e$var$popupCompletionMenu(frame, list) {\n    let activeElement = document.activeElement;\n    let ymacs = this.ymacs; // `this` is the minibuffer\n    $64ad30bda24c420e$var$$menu = new (0, $ec4394da1a74075f$export$731251e1d39d8621)();\n    $64ad30bda24c420e$var$$menu.addClass(\"with-arrow\");\n    list.forEach((label, index)=>{\n        let value = label;\n        if (typeof label != \"string\") {\n            value = label.value;\n            label = label.label;\n        }\n        let el = (0, $08a06a2e99accb03$export$cb0933279c36a66b).fromHTML(`<div class=\"Ymacs_Menu_Item\" data-value=\"${(0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(value)}\"\n                                          data-index=\"${index}\">${(0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(label)}</div>`);\n        $64ad30bda24c420e$var$$menu.add(el);\n    });\n    (0, $08a06a2e99accb03$export$cb0933279c36a66b).on($64ad30bda24c420e$var$$menu.getContentElement(), {\n        click: (ev)=>{\n            activeElement.focus();\n            let item = ev.target;\n            if (!(0, $08a06a2e99accb03$export$cb0933279c36a66b).hasClass(item, \"Ymacs_Menu_Item\")) return;\n            $64ad30bda24c420e$var$select(+item.dataset.index);\n            $64ad30bda24c420e$var$handle_enter.call(this);\n            $64ad30bda24c420e$var$handle_enter.call(this);\n        }\n    });\n    ymacs._popupAtCaret($64ad30bda24c420e$var$$menu.getElement());\n    $64ad30bda24c420e$var$select(0);\n    this.pushKeymap($64ad30bda24c420e$var$KEYMAP_POPUP_ACTIVE);\n    $64ad30bda24c420e$var$$menu.addEventListener(\"onDestroy\", ()=>this.popKeymap($64ad30bda24c420e$var$KEYMAP_POPUP_ACTIVE));\n}\nfunction $64ad30bda24c420e$var$killMenu() {\n    if ($64ad30bda24c420e$var$$menu) $64ad30bda24c420e$var$$menu.destroy();\n    $64ad30bda24c420e$var$$menu = null;\n    $64ad30bda24c420e$var$$selectedItem = null;\n    $64ad30bda24c420e$var$$selectedIndex = null;\n}\nfunction $64ad30bda24c420e$var$select(idx) {\n    let cont = $64ad30bda24c420e$var$$menu.getContentElement();\n    let items = [\n        ...cont.querySelectorAll(\".Ymacs_Menu_Item\")\n    ];\n    let n = items.length;\n    $64ad30bda24c420e$var$$selectedIndex = (idx % n + n) % n;\n    items.forEach((el)=>{\n        let current = el.dataset.index == $64ad30bda24c420e$var$$selectedIndex;\n        if (current) $64ad30bda24c420e$var$$selectedItem = el;\n        (0, $08a06a2e99accb03$export$cb0933279c36a66b).condClass(el, current, \"selected\");\n    });\n    $64ad30bda24c420e$var$$selectedItem.scrollIntoView({\n        block: \"nearest\"\n    });\n}\nfunction $64ad30bda24c420e$export$9cb120f8f6032a76(completions, cont, validate) {\n    this.whenMinibuffer(function(mb) {\n        var changed_vars = mb.setq({\n            completion_list: completions,\n            minibuffer_validation: (what, cont2)=>{\n                if (what == null) what = mb.cmd(\"minibuffer_contents\");\n                if (validate) validate.call(this, mb, what, cont2);\n                else cont2(true); // accept anything by default\n            },\n            minibuffer_continuation: (what)=>{\n                mb.setq(changed_vars);\n                if (cont) cont.call(this, what);\n            }\n        });\n    });\n}\nfunction $64ad30bda24c420e$var$filename_completion(mb, str, re, cont) {\n    var self = this;\n    var lastslash = str.lastIndexOf(\"/\");\n    var dir = str.slice(0, lastslash + 1);\n    var partial = str.slice(lastslash + 1);\n    self.ymacs.fs_getDirectory(dir, function(files) {\n        function add_trailing_slash_to_dir(name) {\n            if (files[name].type == \"directory\") return name + \"/\";\n            else return name;\n        }\n        if (!files) {\n            mb.signalError(\"Not found\");\n            cont(null);\n        } else {\n            var completions = [];\n            for(var f in files)if (f.indexOf(partial) == 0) completions.push(add_trailing_slash_to_dir(f));\n            if (completions.length == 0) cont([]);\n            else {\n                var prefix = (0, $08a06a2e99accb03$export$b43564a9f178c38c)(completions);\n                if (prefix != partial) {\n                    mb.cmd(\"minibuffer_replace_input\", dir + prefix);\n                    cont(null);\n                } else if (completions.length == 1) cont([\n                    str\n                ]);\n                else {\n                    completions = completions.map(function(name) {\n                        return {\n                            label: name,\n                            value: dir + name\n                        };\n                    });\n                    console.log(completions);\n                    $64ad30bda24c420e$var$popupCompletionMenu.call(mb, self.getMinibufferFrame(), completions);\n                    cont(null);\n                }\n            }\n        }\n    });\n}\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    minibuffer_prompt: function(prompt, nofocus) {\n        this.whenMinibuffer(function(mb) {\n            var f = this.getMinibufferFrame();\n            this.ymacs.setInputFrame(f);\n            mb.prompt(prompt);\n            if (!nofocus) f.focus();\n        });\n    },\n    minibuffer_yn: function(prompt, cont) {\n        this.cmd(\"minibuffer_prompt\", prompt + \" (yes or no) \");\n        this.cmd(\"minibuffer_read_yn\", function(text) {\n            cont(text == \"yes\");\n        });\n    },\n    minibuffer_read_yn: function(cont) {\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, [\n            \"yes\",\n            \"no\"\n        ], cont, function(mb, text, cont2) {\n            if (text == \"yes\" || text == \"no\") cont2(true);\n            else mb.signalError(\"Please enter yes or no\");\n        });\n    },\n    minibuffer_read_number: function(cont) {\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, null, cont, function(mb, text, cont2) {\n            var n = parseInt(text, 10);\n            if (isNaN(n)) mb.signalError(\"Please enter a number\");\n            cont2(!isNaN(n));\n        });\n    },\n    minibuffer_read_command: function(cont) {\n        var completions = Object.keys(this.COMMANDS).filter((cmd)=>this.COMMANDS[cmd].ymacsInteractive).sort();\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, completions, cont, function(mb, name, cont2) {\n            var cmd = this.COMMANDS[name], ret = cmd && cmd.ymacsInteractive;\n            if (!ret) mb.signalError(\"No such command: \" + name);\n            cont2(ret);\n        });\n    },\n    minibuffer_read_function: function(cont) {\n        var commandNames = Array.hashKeys((0, $5e779a545e33325b$export$df331bdfc76955b4).COMMANDS).sort();\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, commandNames, cont, function(mb, name, cont2) {\n            var cmd = this.COMMANDS[name], ret = !!cmd;\n            if (!ret) mb.signalError(\"No such function: \" + name);\n            cont2(ret);\n        });\n    },\n    minibuffer_read_buffer: function(cont) {\n        this.whenYmacs(function(ymacs) {\n            var bufferNames = ymacs.buffers.map((b)=>b.name);\n            bufferNames.push(bufferNames.shift());\n            $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, bufferNames, cont);\n        //handle_tab.call(this);\n        });\n    },\n    minibuffer_read_string: function(completions, cont, validate) {\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, completions, cont, validate);\n    },\n    minibuffer_read_variable: function(cont) {\n        var tmp = Object.assign({}, this.globalVariables, this.variables);\n        var completions = Object.keys(tmp).filter((name)=>!/^\\*/.test(name)).sort();\n        $64ad30bda24c420e$export$9cb120f8f6032a76.call(this, completions, function(name) {\n            let val = this.getq(name);\n            this.signalInfo(`Current value of <b>${(0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(name)}</b> = <b>${(0, $08a06a2e99accb03$export$cb0933279c36a66b).htmlEscape(val)}</b>`, true, 3000);\n            return cont.apply(this, arguments);\n        });\n    },\n    minibuffer_read_existing_file: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function() {\n            $64ad30bda24c420e$export$9cb120f8f6032a76.call(self, $64ad30bda24c420e$var$filename_completion, cont, function(mb, name, cont2) {\n                self.ymacs.fs_fileType(name, function(type) {\n                    if (type == null) {\n                        mb.signalError(\"No such file: \" + name);\n                        cont2(false);\n                    } else cont2(true);\n                });\n            });\n        });\n    },\n    minibuffer_read_file: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function() {\n            $64ad30bda24c420e$export$9cb120f8f6032a76.call(self, $64ad30bda24c420e$var$filename_completion, cont);\n        });\n    },\n    minibuffer_read_file_or_directory: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function() {\n            $64ad30bda24c420e$export$9cb120f8f6032a76.call(self, $64ad30bda24c420e$var$filename_completion, cont);\n        });\n    },\n    minibuffer_read_directory: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function() {\n            $64ad30bda24c420e$export$9cb120f8f6032a76.call(self, $64ad30bda24c420e$var$filename_completion, cont);\n        });\n    },\n    minibuffer_prompt_end: function() {\n        return this.whenMinibuffer(function(mb) {\n            return mb.promptMarker.getPosition();\n        });\n    },\n    minibuffer_contents: function() {\n        return this.whenMinibuffer(function(mb) {\n            return mb._bufferSubstring(mb.promptMarker);\n        });\n    },\n    minibuffer_replace_input: function(value) {\n        this.whenMinibuffer(function(mb) {\n            mb._replaceText(mb.promptMarker, mb.getCodeSize(), value);\n            this.getMinibufferFrame().redrawCaret(true);\n        });\n    },\n    minibuffer_replace_input_by_current_dir: function(cont) {\n        this.whenYmacs(function(ymacs) {\n            var self = this;\n            var name = ymacs.getActiveBuffer().name;\n            var dir = name.slice(0, name.lastIndexOf(\"/\") + 1);\n            ymacs.fs_remapDir(dir, function(dir) {\n                self.cmd(\"minibuffer_replace_input\", dir);\n                cont();\n            });\n        });\n    },\n    minibuffer_complete: function() {\n        var self = this;\n        self.whenMinibuffer(function(mb) {\n            function complete(a) {\n                if (!a || a.length == 0) mb.signalError(\"No completions\");\n                else {\n                    var prefix = (0, $08a06a2e99accb03$export$b43564a9f178c38c)(a);\n                    if (prefix != str) mb.cmd(\"minibuffer_replace_input\", prefix);\n                    else if (a.length == 1) mb.signalError(\"Sole completion\");\n                    else $64ad30bda24c420e$var$popupCompletionMenu.call(mb, self.getMinibufferFrame(), a);\n                }\n            }\n            var a = mb.getq(\"completion_list\"), str = mb.cmd(\"minibuffer_contents\"), re = str.replace(/([\\[\\]\\(\\)\\{\\}\\.\\*\\+\\?\\|\\\\])/g, \"\\\\$1\").replace(/([_-])/g, \"[^_-]*[_-]\");\n            re = new RegExp(\"^\" + re, \"i\");\n            if (a instanceof Function) a.call(self, mb, str, re, function(a) {\n                if (a) complete(a);\n            });\n            else if (a && a.length > 0) {\n                a = a.filter((cmd)=>re.test(cmd));\n                complete(a);\n            } else complete(a);\n        });\n    },\n    minibuffer_complete_and_exit: function() {\n        this.whenMinibuffer((mb)=>{\n            mb.getq(\"minibuffer_validation\").call(mb, null, (valid)=>{\n                if (valid) mb.cmd(\"minibuffer_keyboard_quit\", this.getq(\"minibuffer_continuation\"));\n            });\n        });\n    },\n    minibuffer_keyboard_quit: function(cont) {\n        this.whenMinibuffer(function(mb) {\n            var text = this.cmd(\"minibuffer_contents\");\n            mb.setCode(\"\");\n            this.ymacs.setInputFrame(this.ymacs.getActiveFrame());\n            this.ymacs.getActiveFrame().focus();\n            if (!cont) mb.callHooks(\"abort\");\n            setTimeout(()=>{\n                if (cont) cont.call(this, text);\n                this.getPrefixArg();\n            }, 1);\n        });\n        $64ad30bda24c420e$var$killMenu();\n    }\n});\nfunction $64ad30bda24c420e$var$handle_arrow_down() {\n    if ($64ad30bda24c420e$var$$menu) $64ad30bda24c420e$var$select($64ad30bda24c420e$var$$selectedIndex + 1);\n}\nfunction $64ad30bda24c420e$var$handle_arrow_up() {\n    if ($64ad30bda24c420e$var$$menu) $64ad30bda24c420e$var$select($64ad30bda24c420e$var$$selectedIndex - 1);\n}\nfunction $64ad30bda24c420e$var$handle_popup_home() {\n    if ($64ad30bda24c420e$var$$menu) $64ad30bda24c420e$var$select(0);\n}\nfunction $64ad30bda24c420e$var$handle_popup_end() {\n    if ($64ad30bda24c420e$var$$menu) $64ad30bda24c420e$var$select(-1);\n}\nfunction $64ad30bda24c420e$var$handle_enter() {\n    if ($64ad30bda24c420e$var$$menu) {\n        if ($64ad30bda24c420e$var$$selectedItem) {\n            this.cmd(\"minibuffer_replace_input\", $64ad30bda24c420e$var$$selectedItem.dataset.value);\n            $64ad30bda24c420e$var$killMenu();\n        } else this.signalError(\"Select something...\");\n    } else this.cmd(\"minibuffer_complete_and_exit\");\n}\nfunction $64ad30bda24c420e$var$handle_tab() {\n    if (!$64ad30bda24c420e$var$$menu) this.cmd(\"minibuffer_complete\");\n    else $64ad30bda24c420e$var$handle_arrow_down.call(this);\n}\nfunction $64ad30bda24c420e$var$handle_s_tab() {\n    $64ad30bda24c420e$var$handle_arrow_up.call(this);\n}\nfunction $64ad30bda24c420e$var$handle_home() {\n    this.cmd(\"goto_char\", this.promptMarker);\n}\nfunction $64ad30bda24c420e$var$handle_home_mark() {\n    this.ensureTransientMark();\n    this.cmd(\"goto_char\", this.promptMarker);\n    this.ensureTransientMark();\n}\nvar $64ad30bda24c420e$var$DEFAULT_KEYS = {\n    \"Tab\": $64ad30bda24c420e$var$handle_tab,\n    \"Enter\": $64ad30bda24c420e$var$handle_enter,\n    \"Home && C-a\": $64ad30bda24c420e$var$handle_home,\n    \"S-Home && S-C-a\": (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", $64ad30bda24c420e$var$handle_home_mark)\n};\nvar $64ad30bda24c420e$var$KEYMAP_MB_ACTIVE = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(null, Object.assign({\n    \"C-g && Escape\": \"minibuffer_keyboard_quit\"\n}, $64ad30bda24c420e$var$DEFAULT_KEYS));\nvar $64ad30bda24c420e$var$KEYMAP_POPUP_ACTIVE = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(null, Object.assign({\n    \"S-Tab\": $64ad30bda24c420e$var$handle_s_tab,\n    \"ArrowDown && ArrowRight && C-n && C-f\": $64ad30bda24c420e$var$handle_arrow_down,\n    \"ArrowUp && ArrowLeft && C-p && C-b\": $64ad30bda24c420e$var$handle_arrow_up,\n    \"PageDown\": $64ad30bda24c420e$var$handle_arrow_down,\n    \"PageUp\": $64ad30bda24c420e$var$handle_arrow_up,\n    \"C-End && M->\": $64ad30bda24c420e$var$handle_popup_end,\n    \"C-Home && M-<\": $64ad30bda24c420e$var$handle_popup_home,\n    \"Escape\": function() {\n        $64ad30bda24c420e$var$killMenu();\n    }\n}, $64ad30bda24c420e$var$DEFAULT_KEYS));\n$64ad30bda24c420e$var$KEYMAP_POPUP_ACTIVE.defaultHandler = [\n    function() {\n        $64ad30bda24c420e$var$killMenu();\n        return false; // say it's not handled though\n    }\n];\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"minibuffer_mode\", function() {\n    this.pushKeymap($64ad30bda24c420e$var$KEYMAP_MB_ACTIVE);\n    return function() {\n        this.popKeymap($64ad30bda24c420e$var$KEYMAP_MB_ACTIVE);\n    };\n});\n\n\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    get_region: function() {\n        return this.getRegion();\n    },\n    figure_out_mode: function(code) {\n        if (!code) code = this.getCode();\n        var lines = code.split(/\\n/);\n        if (lines.length > 4) lines.splice(2, lines.length - 4);\n        for (let line of lines){\n            let m = /-\\*-\\s*(.*?)\\s*-\\*-/i.exec(line);\n            if (m) return m[1];\n        }\n    },\n    // TODO: the mapping from extension to mode should be defined\n    // with each mode.\n    mode_from_name: function(name) {\n        if (!name) name = this.name;\n        var ext = (/\\.[^.]+$/.exec(name) || [\n            \"\"\n        ])[0];\n        switch(ext){\n            case \".css\":\n                return \"css\";\n            case \".js\":\n                return \"javascript\";\n            case \".lisp\":\n            case \".scm\":\n            case \".el\":\n                return \"lisp\";\n            case \".md\":\n                return \"markdown\";\n            case \".xml\":\n                return \"xml\";\n            case \".html\":\n                return \"html\";\n        }\n        return null;\n    },\n    set_buffer_mode: function(mode) {\n        if (!mode) mode = this.cmd(\"figure_out_mode\") || this.cmd(\"mode_from_name\");\n        if (mode) {\n            if (this.COMMANDS[mode]) this.cmd(mode, true);\n            else if (this.COMMANDS[mode + \"_mode\"]) this.cmd(mode + \"_mode\", true);\n        }\n    },\n    cperl_lineup: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\", function(begin, end) {\n        this.cmd(\"save_excursion\", function() {\n            var rcend = this._positionToRowCol(end), max = 0, lines = [];\n            this.cmd(\"goto_char\", begin);\n            this.cmd(\"forward_whitespace\", true);\n            var ch = this.charAt();\n            if (ch.toLowerCase() != ch.toUpperCase()) {\n                this.signalError(\"Cannot lineup here\");\n                return;\n            }\n            while(this._rowcol.row <= rcend.row){\n                var pos = this.getLine().indexOf(ch);\n                if (pos >= 0) {\n                    if (pos > max) max = pos;\n                    lines.push([\n                        this._rowcol.row,\n                        pos\n                    ]);\n                }\n                if (!this.cmd(\"forward_line\")) break;\n            }\n            ++max;\n            lines.forEach((l)=>{\n                this.cmd(\"goto_char\", this._rowColToPosition(l[0], l[1]));\n                this.cmd(\"insert\", \" \".repeat(max - l[1]));\n            });\n        });\n    }),\n    htmlize_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"r\\nP\", function(begin, end, lineNum) {\n        this.tokenizer.finishParsing();\n        var row = this._positionToRowCol(begin).row;\n        var html = \"\";\n        var line = row;\n        var pad;\n        if (lineNum && !lineNum.empty) line = parseInt(lineNum, 10);\n        end = this._positionToRowCol(end).row;\n        pad = String(end).length;\n        while(row <= end){\n            html += \"<div class='line'>\";\n            if (lineNum) html += \"<span class='line-number'>\" + (0, $08a06a2e99accb03$export$3cdc770bf8b2ed3d)(line, pad, \" \") + \"</span>\";\n            ++line;\n            html += this._textProperties.getLineHTML(row, this.code[row], null) + \"</div>\\n\";\n            ++row;\n        }\n        var tmp = this.ymacs.switchToBuffer(\"*Htmlize*\");\n        tmp.setCode(html);\n        tmp.cmd(\"xml_mode\", true);\n    }),\n    execute_extended_command: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^CM-x \", function(cmd) {\n        this.callInteractively(cmd);\n    }),\n    set_variable: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"vSet variable: \\nsTo value: \", function(variable, value) {\n        var tmp = parseFloat(value);\n        if (!isNaN(tmp)) value = tmp;\n        this.setq(variable, value);\n    }),\n    eval_string: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^MEval string: \", function(code) {\n        try {\n            var variables = [\n                this,\n                this.ymacs // ymacs\n            ];\n            code = new Function(\"buffer\", \"ymacs\", code);\n            code.apply(this, variables);\n            this.clearTransientMark();\n        } catch (ex) {\n            this.signalError(ex.type + \": \" + ex.message);\n            if (window.console) console.log(ex);\n        }\n    }),\n    eval_region: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\", function(begin, end) {\n        this.cmd(\"eval_string\", this.cmd(\"buffer_substring\", begin, end));\n    }),\n    eval_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"eval_string\", this.getCode());\n    }),\n    toggle_line_numbers: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function() {\n        this.ymacs.toggleClass(\"Ymacs-line-numbers\");\n    }),\n    save_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"FWrite file: \", function(name) {\n        this.ymacs.ls_setFileContents(name, this.getCode());\n        this.signalInfo(\"Saved in local storage\");\n    }),\n    load_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"fFind file: \", function(name) {\n        var code = this.ymacs.ls_getFileContents(name);\n        var buffer = this.ymacs.createBuffer({\n            name: name\n        });\n        buffer.setCode(code);\n        buffer.cmd(\"set_buffer_mode\");\n        buffer.cmd(\"switch_to_buffer\", name);\n    }),\n    find_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"FFind file: \", function(name) {\n        var self = this;\n        name = self.ymacs.fs_normalizePath(name);\n        self.ymacs.fs_fileType(name, function(type) {\n            if (type === \"directory\") self.signalInfo(\"Can't open directory\");\n            else self.ymacs.fs_getFileContents(name, true, function(code, stamp) {\n                var buffer = self.ymacs.getBuffer(name);\n                function find_file() {\n                    buffer.setCode(code || \"\");\n                    buffer.stamp = stamp;\n                    buffer.dirty(false);\n                    buffer.cmd(\"set_buffer_mode\");\n                    buffer.cmd(\"switch_to_buffer\", name);\n                }\n                if (buffer) {\n                    if (stamp == null) find_file();\n                    else if (buffer.stamp == stamp) buffer.cmd(\"switch_to_buffer\", name);\n                    else {\n                        var msg = \"File \" + name + \" changed on disk.  \" + (buffer.dirty() ? \"Discard your edits?\" : \"Reread from disk?\");\n                        buffer.cmd(\"minibuffer_yn\", msg, function(yes) {\n                            if (yes) find_file();\n                        });\n                    }\n                } else {\n                    buffer = self.ymacs.createBuffer({\n                        name: name,\n                        stamp: stamp\n                    });\n                    if (code == null) self.signalInfo(\"New file\");\n                    find_file();\n                }\n            });\n        });\n    }),\n    write_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"FWrite file: \", function(name) {\n        var self = this;\n        function write_file() {\n            self.ymacs.fs_setFileContents(name, self.getCode(), null, function(stamp) {\n                self.cmd(\"rename_buffer\", name);\n                self.dirty(false);\n                self.stamp = stamp; // refresh stamp\n                self.signalInfo(\"Wrote \" + name);\n            });\n        }\n        var buffer = self.ymacs.getBuffer(name);\n        if (!buffer) write_file();\n        else {\n            var msg = \"A buffer is visiting \" + name + \"; proceed?\";\n            buffer.cmd(\"minibuffer_yn\", msg, function(yes) {\n                if (yes) {\n                    self.ymacs.killBuffer(buffer);\n                    write_file();\n                }\n            });\n        }\n    }),\n    save_some_buffers: function() {\n        this.cmd(\"save_some_buffers_with_continuation\", true, function() {});\n    },\n    save_some_buffers_with_continuation: function(ask, cont) {\n        var bufs = this.ymacs.buffers.slice(); // get copy of buffers\n        function loop(saved) {\n            if (bufs.length > 0) bufs.shift().cmd(\"save_buffer_with_continuation\", ask, loop);\n            else cont();\n        }\n        loop(false);\n    },\n    save_buffer_with_continuation: function(ask, cont) {\n        var self = this;\n        function did_save(stamp) {\n            self.dirty(false);\n            self.stamp = stamp; // refresh stamp\n            cont(true);\n        }\n        function do_save() {\n            self.ymacs.fs_setFileContents(self.name, self.getCode(), self.stamp, function(stamp) {\n                if (stamp != null) did_save(stamp);\n                else self.cmd(\"minibuffer_yn\", self.name + \" has changed since visited or saved.  Save anyway?\", function(yes) {\n                    if (!yes) cont(false);\n                    else self.ymacs.fs_setFileContents(self.name, self.getCode(), null, function(stamp) {\n                        did_save(stamp);\n                    });\n                });\n            });\n        }\n        if (!self.dirty() || ask && self.name.match(/^\\*.*\\*$/)) cont(false);\n        else if (!ask) do_save();\n        else self.cmd(\"minibuffer_yn\", \"Save file \" + self.name + \"?\", function(yes) {\n            if (!yes) cont(false);\n            else do_save();\n        });\n    },\n    save_buffer: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"\", function() {\n        var self = this;\n        if (self.dirty()) self.cmd(\"save_buffer_with_continuation\", false, function(saved) {\n            if (saved) self.signalInfo(\"Wrote \" + self.name);\n        });\n        else self.signalInfo(\"No changes need to be saved\");\n    }),\n    delete_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"fDelete file: \", function(name) {\n        var self = this;\n        self.ymacs.fs_deleteFile(name, function() {\n            self.signalInfo(\"Deleted \" + name);\n        });\n    }),\n    eval_file: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"fEval file: \", function(name) {\n        var self = this;\n        self.ymacs.fs_getFileContents(name, false, function(code, stamp) {\n            self.cmd(\"eval_string\", code);\n        });\n    }),\n    request_full_screen: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(async function() {\n        try {\n            this.ymacs.requestFullScreen();\n        } catch (ex) {\n            console.error(ex);\n            this.signalError(\"Full-screen denied\", false, 3000);\n        }\n    }),\n    set_color_theme: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function(theme) {\n        if (theme) this.ymacs.setColorTheme(theme);\n        else {\n            let names = (0, $08a06a2e99accb03$export$2ceef881d0b4a563)().sort();\n            this.cmd(\"minibuffer_prompt\", \"Color theme: \");\n            (0, $64ad30bda24c420e$export$9cb120f8f6032a76).call(this, names, (theme)=>{\n                this.ymacs.setColorTheme(theme);\n            }, (mb, theme, cont)=>{\n                theme = theme.trim();\n                if (!theme) mb.cmd(\"minibuffer_complete\");\n                else if (names.indexOf(theme) < 0) {\n                    mb.signalError(\"No such theme\");\n                    return cont(false);\n                } else return cont(true);\n            });\n        }\n    })\n});\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\nlet $f129722536e13624$var$Ymacs_Keymap_ISearch = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"isearch\", {\n    \"Escape\": [\n        \"isearch_abort\",\n        true\n    ],\n    \"C-g\": \"isearch_reset_or_abort\",\n    \"C-w && C-S-s\": \"isearch_yank_word_or_char\",\n    \"C-s\": \"isearch_forward\",\n    \"C-r\": \"isearch_backward\",\n    \"M-%\": \"query_replace\",\n    \"C-M-%\": \"query_replace_regexp\",\n    \"M-s w && M-w\": \"isearch_toggle_word\",\n    \"M-s c && M-c\": \"isearch_toggle_case_fold\",\n    \"M-s Space && M-Space\": \"isearch_toggle_lax_whitespace\",\n    \"Enter\": \"isearch_abort\",\n    \"C-l\": \"recenter_top_bottom\",\n    \"Backspace\": function() {\n        if (this.getMinibuffer().point() > this._isearchContext.mbMark.getPosition()) {\n            this.getMinibuffer().cmd(\"backward_delete_char\");\n            this.cmd(\"goto_char\", this._isearchContext.livepoint);\n            $f129722536e13624$var$isearchText.call(this);\n            $f129722536e13624$var$updateIsearch.call(this);\n        }\n    }\n});\n$f129722536e13624$var$Ymacs_Keymap_ISearch.defaultHandler = [\n    \"isearch_printing_char\"\n];\nfunction $f129722536e13624$var$initIsearch({ forward: forward = true, regexp: regexp = false, lax: lax = true, word: word = false, case_fold: case_fold = this.getq(\"case_fold_search\"), case_replace: case_replace = this.getq(\"case_replace\"), qreplace: qreplace = false, region: region = null } = {}) {\n    if (!this._isearchContext) {\n        this._isearchContext = {\n            forward: forward,\n            regexp: regexp,\n            lax: lax,\n            word: word,\n            case_fold: case_fold,\n            case_replace: case_replace,\n            livepoint: this.point(),\n            origpoint: this.point(),\n            current: {\n                begin: this.point(),\n                end: this.point()\n            },\n            mbMark: this.getMinibuffer().promptMarker,\n            query: \"\",\n            qreplace: qreplace,\n            region: region\n        };\n        if (!qreplace) {\n            this.pushKeymap($f129722536e13624$var$Ymacs_Keymap_ISearch);\n            $f129722536e13624$var$resetPrompt.call(this);\n        }\n        return true;\n    }\n}\nfunction $f129722536e13624$var$isearchText() {\n    return this._isearchContext.query = this.getMinibuffer()._bufferSubstring(this._isearchContext.mbMark);\n}\nfunction $f129722536e13624$var$updateIsearch({ forward: forward } = {}) {\n    var query = this._isearchContext.query;\n    if (!/\\S/.test(query) && this.getq(\"isearch_last_context\")) {\n        this._isearchContext = this.getq(\"isearch_last_context\");\n        query = this._isearchContext.query;\n        this.getMinibuffer()._placeUndoBoundary();\n        this.getMinibuffer().cmd(\"insert\", query);\n        this._isearchContext.origpoint = this.point();\n        this._isearchContext.current = {\n            begin: this.point(),\n            end: this.point()\n        };\n    }\n    this._isearchContext.livepoint = this.point();\n    if (forward != null) this._isearchContext.forward = forward;\n    return $f129722536e13624$var$doSearch.call(this);\n}\nfunction $f129722536e13624$var$caseFold() {\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    return ctx.case_fold ?? (ctx.regexp ? query = query.replace(/\\\\./g, \"\") : query) == query.toLowerCase();\n}\nfunction $f129722536e13624$var$lazyHighlight(qrx, prompt) {\n    let cursor = this._rowcol;\n    let minpos = this._rowColToPosition(cursor.row - 50, 0);\n    let maxpos = this._rowColToPosition(cursor.row + 50, Infinity);\n    let code = this.getCode();\n    let hl = [];\n    let ctx = this._isearchContext;\n    let point = this.point();\n    let count = 0;\n    let crnt = 0;\n    qrx.lastIndex = ctx.region?.begin || 0;\n    while(true){\n        let m = qrx.exec(code);\n        if (m && m[0].length) {\n            if (ctx.region && qrx.lastIndex > ctx.region.end) break;\n            count++;\n            if (m.index >= minpos && m.index <= maxpos) {\n                let p1 = this._positionToRowCol(m.index);\n                let p2 = this._positionToRowCol(qrx.lastIndex);\n                hl.push({\n                    line1: p1.row,\n                    col1: p1.col,\n                    line2: p2.row,\n                    col2: p2.col\n                });\n            }\n            if (point >= m.index && point < qrx.lastIndex || point == qrx.lastIndex && ctx.forward) crnt = count;\n        } else break;\n    }\n    $f129722536e13624$var$resetPrompt.call(this, count, crnt, prompt);\n    this.setOverlay(\"isearch-lazy\", hl);\n}\nfunction $f129722536e13624$var$resetPrompt(count, crnt, prompt) {\n    let ctx = this._isearchContext;\n    this.whenMinibuffer((mb)=>{\n        if (prompt) mb.prompt(prompt.call(this, count, crnt, ctx));\n        else {\n            let pos = ctx.qreplace && count ? `[${count}] ` : count && crnt ? `[${crnt}/${count}] ` : \"\";\n            mb.prompt(`${pos}${ctx.qreplace ? \"Query replace\" : \"I-search\"}${ctx.regexp ? \" regexp\" : ctx.word ? \" word\" : \"\"}${ctx.forward ? \"\" : \" backward\"}:`);\n        }\n        let start = ctx.mbMark;\n        let mid = start + ctx.lastFoundQuery?.length;\n        if (mid != null) {\n            mb.forEachLine((line, c1, c2)=>{\n                mb._textProperties.removeLineProps(line, c1, c2, \"css\");\n            }, start, mid);\n            mb.forEachLine((line, c1, c2)=>{\n                mb._textProperties.addLineProps(line, c1, c2, \"css\", \"isearch-fail\");\n            }, mid);\n        }\n    });\n}\nfunction $f129722536e13624$var$doSearch({ forward: forward } = this._isearchContext) {\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    let found = false;\n    try {\n        let rx = $f129722536e13624$var$searchRegExp.call(this);\n        found = this.cmd(forward ? \"search_forward_regexp\" : \"search_backward_regexp\", rx);\n        if (found) {\n            ctx.lastFoundQuery = query;\n            this.cmd(\"ensure_caret_visible\");\n            let p1 = this.point();\n            let p2 = p1 + (forward ? -1 : 1) * this.matchData[0].length;\n            if (forward) [p1, p2] = [\n                p2,\n                p1\n            ];\n            ctx.current = {\n                begin: p1,\n                end: p2\n            };\n            let p1rc = this._positionToRowCol(p1);\n            let p2rc = this._positionToRowCol(p2);\n            this.setOverlay(\"isearch\", {\n                line1: p1rc.row,\n                col1: p1rc.col,\n                line2: p2rc.row,\n                col2: p2rc.col\n            });\n        }\n        $f129722536e13624$var$lazyHighlight.call(this, rx);\n    } catch  {}\n    return found;\n}\nfunction $f129722536e13624$var$searchRegExp({ query: query = null, regexp: regexp = false, lax: lax = true, case_fold: case_fold = true, word: word = false } = this._isearchContext || {}) {\n    let searchRX = query;\n    if (!regexp) {\n        searchRX = query.replace(/[\\]\\[\\}\\{\\)\\(\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n        if (word) // XXX: I guess it would be nice to use syntax_word / syntax_word_dabbrev\n        searchRX = \"\\\\b\" + searchRX + \"\\\\b\";\n    }\n    if (lax) searchRX = searchRX.replace(/\\s+/g, \"\\\\s+\");\n    return new RegExp(searchRX, $f129722536e13624$var$caseFold.call(this) ? \"ugi\" : \"ug\");\n}\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    isearch_forward: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let arg = {\n            forward: true\n        };\n        if (!$f129722536e13624$var$initIsearch.call(this, arg)) {\n            if (!$f129722536e13624$var$updateIsearch.call(this, arg)) this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n    isearch_backward: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let arg = {\n            forward: false\n        };\n        if (!$f129722536e13624$var$initIsearch.call(this, arg)) {\n            if (!$f129722536e13624$var$updateIsearch.call(this, arg)) this.signalError(\"No more backward occurrences of the search text\");\n        }\n    }),\n    isearch_forward_regexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let arg = {\n            forward: true,\n            regexp: true\n        };\n        if (!$f129722536e13624$var$initIsearch.call(this, arg)) {\n            if (!$f129722536e13624$var$updateIsearch.call(this, arg)) this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n    isearch_backward_regexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let arg = {\n            forward: false,\n            regexp: true\n        };\n        if (!$f129722536e13624$var$initIsearch.call(this, arg)) {\n            if (!$f129722536e13624$var$updateIsearch.call(this, arg)) this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n    isearch_yank_word_or_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        if (!this._isearchContext) $f129722536e13624$var$initIsearch.call(this, {\n            forward: true\n        });\n        let ctx = this._isearchContext;\n        var pos = ctx.current.end;\n        var pos2 = this.cmd(\"save_excursion\", function() {\n            this.cmd(\"goto_char\", pos);\n            this.cmd(\"forward_word\");\n            return this.point();\n        });\n        if (pos2 != pos) {\n            var word = this._bufferSubstring(pos, pos2);\n            this.getMinibuffer()._placeUndoBoundary();\n            this.getMinibuffer().cmd(\"insert\", word.toLowerCase());\n            word = $f129722536e13624$var$isearchText.call(this);\n            this.cmd(\"goto_char\", ctx.current.begin);\n            $f129722536e13624$var$doSearch.call(this, {\n                forward: true\n            });\n        }\n    }),\n    isearch_toggle_word: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let ctx = this._isearchContext;\n        ctx.word = !ctx.word;\n        if (ctx.word) ctx.regexp = false;\n        this.signalInfo(`Search word: ${ctx.word ? \"ON\" : \"OFF\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        $f129722536e13624$var$doSearch.call(this);\n    }),\n    isearch_toggle_case_fold: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let ctx = this._isearchContext;\n        if (ctx.case_fold == null) ctx.case_fold = false;\n        else if (ctx.case_fold === false) ctx.case_fold = true;\n        else if (ctx.case_fold === true) ctx.case_fold = null;\n        this.signalInfo(`Case sensitive: ${ctx.case_fold == null ? \"AUTO\" : ctx.case_fold ? \"OFF\" : \"ON\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        $f129722536e13624$var$doSearch.call(this);\n    }),\n    isearch_toggle_lax_whitespace: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let ctx = this._isearchContext;\n        ctx.lax = !ctx.lax;\n        this.signalInfo(`Loose whitespace: ${ctx.lax ? \"ON\" : \"OFF\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        $f129722536e13624$var$doSearch.call(this);\n    }),\n    isearch_printing_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let ctx = this._isearchContext;\n        var ev = this.interactiveEvent();\n        if (ev?.key?.length == 1 && !ev.ctrlKey && !ev.altKey) {\n            this.whenMinibuffer((mb)=>{\n                mb.cmd(\"self_insert_command\");\n                this.cmd(\"goto_char\", ctx.livepoint);\n                $f129722536e13624$var$isearchText.call(this);\n                $f129722536e13624$var$doSearch.call(this);\n            });\n            return true;\n        } else {\n            this.cmd(\"isearch_abort\");\n            return false;\n        }\n    }),\n    isearch_abort: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function(cancelled) {\n        if (!cancelled) this.setGlobal(\"isearch_last_context\", this._isearchContext);\n        this.setMinibuffer(\"\");\n        this.popKeymap($f129722536e13624$var$Ymacs_Keymap_ISearch);\n        if (cancelled) this.cmd(\"goto_char\", this._isearchContext.origpoint);\n        else this.markMarker.setPosition(this._isearchContext.origpoint);\n        this._isearchContext = null;\n        this.deleteOverlay(\"isearch\");\n        this.deleteOverlay(\"isearch-lazy\");\n        return true;\n    }),\n    isearch_reset_or_abort: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let ctx = this._isearchContext;\n        if (!ctx.lastFoundQuery || ctx.query == ctx.lastFoundQuery) this.cmd(\"isearch_abort\", true);\n        else this.whenMinibuffer((mb)=>{\n            mb._replaceText(ctx.mbMark, mb.getCode().length, ctx.lastFoundQuery);\n            ctx.query = ctx.lastFoundQuery;\n            $f129722536e13624$var$doSearch.call(this);\n        });\n    })\n});\n/* -----[ query-replace ]----- */ let $f129722536e13624$var$Ymacs_Keymap_Query_Replace = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"query_replace\", {\n    \"y && Space\": \"query_replace_yes_this_occurrence\",\n    \".\": \"query_replace_yes_this_occurrence_and_stop\",\n    \"n && Delete && Backspace\": \"query_replace_no_this_occurrence\",\n    \"u\": \"query_replace_undo_previous\",\n    \"!\": \"query_replace_yes_all_occurrences\",\n    \"q && Enter\": [\n        \"query_replace_abort\",\n        true\n    ],\n    \"C-l\": \"recenter_top_bottom\"\n});\n$f129722536e13624$var$Ymacs_Keymap_Query_Replace.defaultHandler = [\n    \"query_replace_abort\"\n];\nfunction $f129722536e13624$var$query_replace_1(args = {}) {\n    this.whenMinibuffer((mb)=>{\n        $f129722536e13624$var$initIsearch.call(this, {\n            ...args,\n            qreplace: true\n        });\n        let ctx = this._isearchContext;\n        this.cmd(\"minibuffer_prompt\", `Query replace${ctx.regexp ? \" regexp\" : ctx.word ? \" word\" : \"\"}: `);\n        let hlOrig = ()=>{\n            $f129722536e13624$var$isearchText.call(this);\n            try {\n                $f129722536e13624$var$lazyHighlight.call(this, $f129722536e13624$var$searchRegExp.call(this));\n            } catch  {}\n        };\n        mb.addEventListener(\"afterInteractiveCommand\", hlOrig);\n        let onQuit = (continued)=>{\n            mb.removeEventListener(\"afterInteractiveCommand\", hlOrig);\n            mb.removeEventListener(\"abort\", onQuit);\n            if (!continued) {\n                this.deleteOverlay(\"isearch\");\n                this.deleteOverlay(\"isearch-lazy\");\n                this._isearchContext = null;\n            }\n        };\n        mb.addEventListener(\"abort\", onQuit);\n        this.cmd(\"minibuffer_read_string\", null, (orig)=>{\n            this._isearchContext.query = orig;\n            $f129722536e13624$var$query_replace_2.call(this);\n            onQuit(true);\n        }, (buf, query, cont)=>{\n            ctx.query = query;\n            try {\n                $f129722536e13624$var$lazyHighlight.call(this, $f129722536e13624$var$searchRegExp.call(this));\n                cont(query);\n            } catch  {\n                buf.popupMessage({\n                    type: \"error\",\n                    text: \"Incomplete regexp\",\n                    atCaret: true\n                });\n            }\n        });\n    });\n}\nfunction $f129722536e13624$var$query_replace_2() {\n    let mb = this.getMinibuffer();\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    let rxorig = $f129722536e13624$var$searchRegExp.call(this);\n    $f129722536e13624$var$lazyHighlight.call(this, rxorig);\n    if (rxorig) {\n        this.cmd(\"minibuffer_prompt\", `Replace ${ctx.regexp ? \"regexp \" : \"\"}\\u{201C}${query}\\u{201D} with: `);\n        let onQuit = ()=>{\n            this.deleteOverlay(\"isearch\");\n            this.deleteOverlay(\"isearch-lazy\");\n            this._isearchContext = null;\n            mb.removeEventListener(\"abort\", onQuit);\n        };\n        mb.addEventListener(\"abort\", onQuit);\n        this.cmd(\"minibuffer_read_string\", null, (replacement)=>{\n            this.clearTransientMark();\n            $f129722536e13624$var$query_replace_3.call(this, mb, rxorig, replacement);\n        });\n    }\n}\nfunction $f129722536e13624$var$similarCase(rplc) {\n    let ctx = this._isearchContext;\n    if (ctx.case_replace && rplc == rplc.toLowerCase()) {\n        let orig = this.matchData[0];\n        if (orig == orig.toUpperCase()) return rplc.toUpperCase();\n        if (orig == this.capitalize(orig)) return this.capitalize(rplc);\n    }\n    return rplc;\n}\nfunction $f129722536e13624$var$query_replace_3(mb, rxorig, replacement) {\n    let ctx = this._isearchContext;\n    this.pushKeymap($f129722536e13624$var$Ymacs_Keymap_Query_Replace);\n    let cmds, stop, curr, count = 0;\n    let queue = [];\n    let end = ctx.region && this.createMarker(ctx.region.end);\n    this.cmd(\"goto_char\", ctx.region ? ctx.region.begin : ctx.current.begin);\n    let domatch = (replacement)=>{\n        if (ctx.regexp) // look ma, I can write code like this.\n        replacement = replacement.replace(/(?:\\\\([\\\\\\&\\#]|\\d+|<.+?>))/g, (s, p)=>p == \"\\\\\" ? \"\\\\\" : p == \"#\" ? count : p == \"&\" ? this.matchData[0] : p[0] == \"<\" ? this.matchData.groups[p.substr(1, p.length - 2)] : this.matchData[+p]);\n        return $f129722536e13624$var$similarCase.call(this, replacement);\n    };\n    let gotoNext = (all)=>{\n        let point = this.point();\n        let found = this.cmd(\"search_forward_regexp\", rxorig);\n        if (found) {\n            let m = this.matchData;\n            if (ctx.region && (m.index < ctx.region.begin || m.after > end)) {\n                if (!all) this.cmd(\"goto_char\", point);\n                return null;\n            }\n            let begin = this.matchData.index;\n            found = {\n                begin: begin,\n                end: this.point()\n            };\n            if (!all) {\n                this.cmd(\"ensure_caret_visible\");\n                let rc_begin = this._positionToRowCol(begin);\n                this.setOverlay(\"isearch\", {\n                    line1: rc_begin.row,\n                    col1: rc_begin.col,\n                    line2: this._rowcol.row,\n                    col2: this._rowcol.col\n                });\n            }\n        }\n        if (!all) $f129722536e13624$var$lazyHighlight.call(this, rxorig, (count, crnt)=>`[${count}] Replace with \\u{201C}${domatch(replacement)}\\u{201D}? (y/n/u/!)`);\n        return found;\n    };\n    cmds = this.replaceCommands({\n        query_replace_yes_this_occurrence: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(()=>{\n            queue.push(curr);\n            this._replaceText(curr.begin, curr.end, domatch(replacement));\n            count++;\n            curr = gotoNext();\n            if (!curr) stop();\n        }),\n        query_replace_yes_this_occurrence_and_stop: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(()=>{\n            queue.push(curr);\n            this._replaceText(curr.begin, curr.end, domatch(replacement));\n            count++;\n            stop();\n        }),\n        query_replace_no_this_occurrence: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(()=>{\n            curr = gotoNext();\n            if (!curr) stop();\n        }),\n        query_replace_yes_all_occurrences: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(()=>{\n            let last;\n            while(curr){\n                last = curr;\n                this._replaceText(curr.begin, curr.end, domatch(replacement));\n                count++;\n                curr = gotoNext(true);\n            }\n            if (last) {\n                this.cmd(\"goto_char\", last.begin);\n                this.cmd(\"ensure_caret_visible\");\n            }\n            stop();\n        }),\n        query_replace_undo_previous: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(()=>{\n            let prev = queue.pop();\n            if (prev) {\n                count--;\n                this.cmd(\"undo\");\n                // XXX: this is ugly, but oh well.. We'd like to\n                // pretend this edit/undo operation never exist.\n                let uptr = this.__undoPointer;\n                let uq = this.__undoQueue.slice(0, uptr);\n                setTimeout(()=>{\n                    this.__undoPointer = uptr;\n                    this.__undoQueue = uq;\n                });\n                this.cmd(\"goto_char\", prev.begin);\n                curr = gotoNext();\n            } else this.signalError(\"No more undo\");\n        }),\n        query_replace_abort: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)((enter)=>{\n            stop();\n            return enter;\n        })\n    });\n    stop = ()=>{\n        if (end) end.destroy();\n        mb.removeEventListener(\"abort\", stop);\n        this.newCommands(cmds);\n        this.deleteOverlay(\"isearch\");\n        this.deleteOverlay(\"isearch-lazy\");\n        this._isearchContext = null;\n        this.popKeymap($f129722536e13624$var$Ymacs_Keymap_Query_Replace);\n        mb.cmd(\"minibuffer_keyboard_quit\");\n        this.signalInfo(`Replaced ${count} occurrences`);\n    };\n    curr = gotoNext();\n    if (!curr) stop();\n    else mb.addEventListener(\"abort\", stop);\n}\nfunction $f129722536e13624$var$query_replace(regexp) {\n    return (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^P\", function(word) {\n        let ctx = this._isearchContext;\n        let args = {\n            qreplace: true,\n            regexp: regexp == null && ctx ? ctx.regexp : !!regexp,\n            word: !!word,\n            region: this.transientMarker && this.getRegion()\n        };\n        if (ctx) {\n            this.cmd(\"isearch_abort\");\n            this._isearchContext = Object.assign({}, ctx, args);\n            $f129722536e13624$var$query_replace_2.call(this);\n        } else $f129722536e13624$var$query_replace_1.call(this, args);\n    });\n}\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    query_replace: $f129722536e13624$var$query_replace(null),\n    query_replace_regexp: $f129722536e13624$var$query_replace(true)\n});\n\n\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n(0, $c749180882ef16eb$export$3964ae1c660db960).define(\"css\", function(stream, tok) {\n    var PARSER = {\n        next: next,\n        copy: copy,\n        indentation: indentation\n    };\n    var $parens = [];\n    var $passedParens = [];\n    var $cont = [];\n    var $inString = null;\n    var $inComment = null;\n    function copy() {\n        var c = resume.context = {\n            parens: $parens.slice(0),\n            passedParens: $passedParens.slice(0),\n            cont: $cont.slice(0),\n            inString: $inString,\n            inComment: $inComment\n        };\n        function resume() {\n            $parens = c.parens.slice(0);\n            $passedParens = c.passedParens.slice(0);\n            $cont = c.cont.slice(0);\n            $inString = c.inString;\n            $inComment = c.inComment;\n            return PARSER;\n        }\n        return resume;\n    }\n    function INDENT_LEVEL() {\n        return tok.buffer.getq(\"indent_level\");\n    }\n    var OPEN_PAREN = {\n        \"(\": \")\",\n        \"{\": \"}\",\n        \"[\": \"]\"\n    };\n    var CLOSE_PAREN = {\n        \")\": \"(\",\n        \"}\": \"{\",\n        \"]\": \"[\"\n    };\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n    function foundToken(c1, c2, type) {\n        tok.onToken(stream.line, c1, c2, type);\n    }\n    function readComment() {\n        var line = stream.lineText(), pos = line.indexOf(\"*/\", stream.col);\n        var m = /^\\s*\\*+/.exec(line.substr(stream.col));\n        if (m) foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n        if (pos >= 0) {\n            $cont.pop();\n            $inComment = null;\n            foundToken(stream.col, pos, \"mcomment\");\n            foundToken(pos, pos += 2, \"mcomment-stopper\");\n            stream.col = pos;\n        } else {\n            foundToken(stream.col, line.length, \"mcomment\");\n            stream.col = line.length;\n        }\n    }\n    function readString(end, type) {\n        var ch, esc = false, start = stream.col;\n        while(!stream.eol()){\n            ch = stream.peek();\n            if (!esc && ch === end) {\n                $cont.pop();\n                $inString = null;\n                foundToken(start, stream.col, type);\n                var p = $parens.at(-1);\n                if (p && p.type == ch) {\n                    $parens.pop();\n                    p.closed = {\n                        line: stream.line,\n                        col: stream.col,\n                        opened: p\n                    };\n                    $passedParens.push(p);\n                }\n                foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                return;\n            }\n            esc = !esc && ch === \"\\\\\";\n            stream.nextCol();\n        }\n        foundToken(start, stream.col, type);\n    }\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0) return $cont.at(-1)();\n        var ch = stream.peek(), tmp;\n        if (stream.lookingAt(\"/*\")) {\n            $inComment = {\n                line: stream.line,\n                c1: stream.col\n            };\n            foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n            $cont.push(readComment);\n        } else if (stream.lookingAt(\"//\")) {\n            foundToken(stream.col, stream.col += 2, \"comment-starter\");\n            foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n        } else if (ch === '\"' || ch === \"'\") {\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            $inString = {\n                line: stream.line,\n                c1: stream.col\n            };\n            foundToken(stream.col, ++stream.col, \"string-starter\");\n            $cont.push(readString.bind(null, ch, \"string\"));\n        } else if (tmp = isOpenParen(ch)) {\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            foundToken(stream.col, ++stream.col, \"open-paren\");\n        } else if (tmp = isCloseParen(ch)) {\n            var p = $parens.pop();\n            if (!p || p.type != tmp) foundToken(stream.col, ++stream.col, \"error\");\n            else {\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col,\n                    opened: p\n                };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\");\n            }\n        } else if (tmp = stream.lookingAt(/^(--+|\\$)?([\\p{L}\\p{N}-]+):/u)) {\n            foundToken(stream.col, stream.col += tmp[0].length - 1, tmp[1] ? \"variable-name\" : \"keyword\");\n            foundToken(stream.col, ++stream.col, \"operator\");\n        } else if (tmp = stream.lookingAt(/^((?:\\d*\\.)?\\d+)(px|pt|em|ex|in|cm|mm|rem|vw|vh|fr|s|%)?/)) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"number\");\n            if (tmp[2]) foundToken(stream.col, stream.col += tmp[2].length, \"type\");\n        } else if (tmp = stream.lookingAt(/^(\\.[\\p{L}\\p{N}_:-]+)/u)) foundToken(stream.col, stream.col += tmp[1].length, \"function-name\");\n        else if (tmp = stream.lookingAt(/^(#[\\p{L}\\p{N}_:-]+)/u)) foundToken(stream.col, stream.col += tmp[1].length, \"constant\");\n        else if (tmp = stream.lookingAt(/^(@[\\p{L}\\p{N}_:-]+)/u)) foundToken(stream.col, stream.col += tmp[1].length, \"builtin\");\n        else if (tmp = stream.lookingAt(/^(url|none|auto|bold|italic|normal|inherit|print|screen|all|important|calc|var)/)) foundToken(stream.col, stream.col += tmp[1].length, \"builtin\");\n        else foundToken(stream.col, ++stream.col, null);\n    }\n    function indentation() {\n        // no indentation for continued strings\n        if ($inString) return 0;\n        var row = stream.line;\n        var currentLine = stream.lineText();\n        var indent = 0;\n        if ($inComment) {\n            var commentStartLine = stream.lineText($inComment.line);\n            indent = $inComment.c1 + 1;\n            if (!/^\\s*\\*/.test(currentLine)) {\n                // align with the first non-whitespace and non-asterisk character in the comment\n                var re = /[^\\s*]/g;\n                re.lastIndex = $inComment.c1 + 1;\n                var m = re.exec(commentStartLine);\n                if (m) indent = m.index;\n            }\n            return indent;\n        }\n        var p = $parens.at(-1);\n        if (p) {\n            // check if the current line closes the paren\n            var re = new RegExp(\"^\\\\s*\\\\\" + OPEN_PAREN[p.type]);\n            var thisLineCloses = re.test(currentLine);\n            // Check if there is text after the opening paren.  If so, indent to that column.\n            var line = stream.lineText(p.line);\n            re = /\\S/g;\n            re.lastIndex = p.col + 1;\n            var m = re.exec(line);\n            if (m) // but if this line closes the paren, better use the column of the open paren\n            indent = thisLineCloses ? p.col : m.index;\n            else {\n                // Otherwise we should indent to one level more than the indentation of the line\n                // containing the opening paren.\n                indent = stream.lineIndentation(p.line) + INDENT_LEVEL();\n                // but if this line closes the paren, then back one level\n                if (thisLineCloses) indent -= INDENT_LEVEL();\n            }\n        } else {\n            let i = row, m;\n            while(i-- > 0)if (m = /\\S/.exec(stream.lineText(i))) break;\n            if (m) indent = m.index;\n        }\n        return indent;\n    }\n    return PARSER;\n});\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"css_mode\", function() {\n    var tok = this.tokenizer;\n    this.setTokenizer(new (0, $c749180882ef16eb$export$3964ae1c660db960)({\n        buffer: this,\n        type: \"css\"\n    }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    var changed_vars = this.setq({\n        syntax_paragraph_sep: /\\n(?:[ \\t\\/\\*]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*\\/\\/+ ?/ygu,\n            ch: \"//\"\n        },\n        syntax_comment_multi: {\n            rx: /[^\\S\\r\\n]*\\/\\*+(.*?)\\*+\\//ygu,\n            ch: [\n                \"/*\",\n                \"*/\"\n            ]\n        }\n    });\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match) this.cmd(\"paren_match_mode\", false);\n        this.setq(changed_vars);\n    };\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n/* -----[ This defines the tokenizer ]----- */ (function() {\n    function qw(str) {\n        return str.trim().split(/\\s+/);\n    }\n    function toHash(a) {\n        return a.reduce((a, key, i)=>(a[key] = i + 1, a), Object.create(null));\n    }\n    var KEYWORDS = qw(\"abstract break case catch class const continue debugger default delete do else enum export extends final finally for function goto if implements import in instanceof interface native new package private protected public return static switch synchronized throw throws transient try typeof var void let yield volatile while with\");\n    var KEYWORDS_TYPE = qw(\"boolean byte char double float int long short void Array Date Function Math Number Object RegExp String\");\n    var KEYWORDS_CONST = qw(\"false null undefined Infinity NaN true arguments\");\n    var KEYWORDS_BUILTIN = qw(\"Infinity NaN Packages decodeURI decodeURIComponent encodeURI encodeURIComponent eval isFinite isNaN parseFloat parseInt undefined window document alert prototype constructor super this\");\n    var ALLOW_REGEXP_AFTER = /[\\[({,;+\\-*=?&|!:][\\x20\\t\\n\\xa0]*$|return\\s+$|typeof\\s+$/;\n    function isLetter(ch) {\n        return ch.toLowerCase() != ch.toUpperCase();\n    }\n    function isNameStart(ch) {\n        return ch && (isLetter(ch) || /^[_$]$/.test(ch));\n    }\n    function isNameChar(ch) {\n        return ch && (isLetter(ch) || /^[0-9_$]$/.test(ch));\n    }\n    var OPEN_PAREN = {\n        \"(\": \")\",\n        \"{\": \"}\",\n        \"[\": \"]\"\n    };\n    var CLOSE_PAREN = {\n        \")\": \"(\",\n        \"}\": \"{\",\n        \"]\": \"[\"\n    };\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n    function JS_PARSER(KEYWORDS, KEYWORDS_TYPE, KEYWORDS_CONST, KEYWORDS_BUILTIN, stream, tok) {\n        var $cont = [];\n        var $parens = [];\n        var $passedParens = [];\n        var $inComment = null;\n        var $inString = false;\n        var PARSER = {\n            next: next,\n            copy: copy,\n            indentation: indentation\n        };\n        function INDENT_LEVEL() {\n            return stream.buffer.getq(\"indent_level\");\n        }\n        function copy() {\n            var context = restore.context = {\n                cont: $cont.slice(0),\n                inComment: $inComment,\n                inString: $inString,\n                parens: $parens.slice(0),\n                passedParens: $passedParens.slice(0)\n            };\n            function restore() {\n                $cont = context.cont.slice(0);\n                $inComment = context.inComment;\n                $inString = context.inString;\n                $parens = context.parens.slice(0);\n                $passedParens = context.passedParens.slice(0);\n                return PARSER;\n            }\n            return restore;\n        }\n        function foundToken(c1, c2, type) {\n            tok.onToken(stream.line, c1, c2, type);\n        }\n        function readName() {\n            var col = stream.col, ch = stream.next(), name = ch;\n            while(!stream.eol()){\n                ch = stream.peek();\n                if (!isNameChar(ch)) break;\n                name += ch;\n                stream.nextCol();\n            }\n            return ch && {\n                line: stream.line,\n                c1: col,\n                c2: stream.col,\n                id: name\n            };\n        }\n        function readComment() {\n            var line = stream.lineText(), pos = line.indexOf(\"*/\", stream.col);\n            var m = /^\\s*\\*+/.exec(line.substr(stream.col));\n            if (m) foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n            if (pos >= 0) {\n                $cont.pop();\n                $inComment = null;\n                foundToken(stream.col, pos, \"mcomment\");\n                foundToken(pos, pos += 2, \"mcomment-stopper\");\n                stream.col = pos;\n            } else {\n                foundToken(stream.col, line.length, \"mcomment\");\n                stream.col = line.length;\n            }\n        }\n        function readString(end, type) {\n            $inString = true;\n            var ch, esc = false, start = stream.col;\n            while(!stream.eol()){\n                ch = stream.peek();\n                if (!esc && ch === end) {\n                    $cont.pop();\n                    $inString = false;\n                    foundToken(start, stream.col, type);\n                    var p = $parens.at(-1);\n                    if (p && p.type == ch) {\n                        $parens.pop();\n                        p.closed = {\n                            line: stream.line,\n                            col: stream.col,\n                            opened: p\n                        };\n                        $passedParens.push(p);\n                    }\n                    foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                    return;\n                }\n                if (!esc && end == \"`\" && stream.lookingAt(\"${\")) {\n                    $inString = false;\n                    $parens.push({\n                        line: stream.line,\n                        col: stream.col,\n                        type: \"${\"\n                    });\n                    foundToken(start, stream.col, type);\n                    foundToken(stream.col, stream.col += 2, \"open-paren\");\n                    $cont.push(readToken);\n                    return;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, type);\n        }\n        function readLiteralRegexp() {\n            var ch, esc = false, inset = 0, start = stream.col;\n            while(!stream.eol()){\n                ch = stream.peek();\n                if (isOpenParen(ch) && !esc && !inset) inset++;\n                if (isCloseParen(ch) && !esc) {\n                    inset--;\n                    if (inset < 0) inset = 0;\n                }\n                if (ch === \"/\" && !esc && !inset) {\n                    $cont.pop();\n                    foundToken(start, stream.col, \"regexp\");\n                    foundToken(stream.col, ++stream.col, \"regexp-stopper\");\n                    var m = stream.lookingAt(/^[gmsiyu]+/);\n                    if (m) foundToken(stream.col, stream.col += m[0].length, \"regexp-modifier\");\n                    return true;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, \"regexp\");\n        }\n        function readToken() {\n            var ch = stream.peek(), m, tmp;\n            if (stream.lookingAt(\"/*\")) {\n                $inComment = {\n                    line: stream.line,\n                    c1: stream.col\n                };\n                foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n                $cont.push(readComment);\n            } else if (stream.lookingAt(\"//\")) {\n                foundToken(stream.col, stream.col += 2, \"comment-starter\");\n                foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n            } else if (ch === '\"' || ch === \"'\" || ch === \"`\") {\n                $parens.push({\n                    line: stream.line,\n                    col: stream.col,\n                    type: ch\n                });\n                foundToken(stream.col, ++stream.col, \"string-starter\");\n                $cont.push(readString.bind(null, ch, \"string\"));\n            } else if (m = stream.lookingAt(/^0x[0-9a-f]+|^[0-9]*\\.?[0-9]+/)) foundToken(stream.col, stream.col += m[0].length, \"number\");\n            else if (isNameStart(ch) && (tmp = readName())) {\n                var type = tmp.id in KEYWORDS ? \"keyword\" : tmp.id in KEYWORDS_TYPE ? \"type\" : tmp.id in KEYWORDS_CONST ? \"constant\" : tmp.id in KEYWORDS_BUILTIN ? \"builtin\" : null;\n                foundToken(tmp.c1, tmp.c2, type);\n            } else if (tmp = isOpenParen(ch)) {\n                $parens.push({\n                    line: stream.line,\n                    col: stream.col,\n                    type: ch\n                });\n                foundToken(stream.col, ++stream.col, \"open-paren\");\n            } else if (tmp = isCloseParen(ch)) {\n                var p = $parens.pop();\n                if (ch == \"}\" && p && p.type == \"${\") {\n                    p.closed = {\n                        line: stream.line,\n                        col: stream.col,\n                        opened: p\n                    };\n                    $passedParens.push(p);\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                    $cont.pop();\n                } else if (!p || p.type != tmp) foundToken(stream.col, ++stream.col, \"error\");\n                else {\n                    p.closed = {\n                        line: stream.line,\n                        col: stream.col,\n                        opened: p\n                    };\n                    $passedParens.push(p);\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                }\n            } else if (ch === \"/\" && ALLOW_REGEXP_AFTER.test(stream.textBefore())) {\n                foundToken(stream.col, ++stream.col, \"regexp-starter\");\n                $cont.push(readLiteralRegexp);\n            } else if (m = stream.lookingAt(/^\\s+$/)) foundToken(stream.col, stream.col += m[0].length, \"trailing-whitespace\");\n            else foundToken(stream.col, ++stream.col, null);\n        }\n        function next() {\n            stream.checkStop();\n            if ($cont.length > 0) return $cont.at(-1)();\n            readToken();\n        }\n        function indentation() {\n            var row = stream.line;\n            var currentLine = stream.lineText();\n            var indent = 0;\n            if ($inString) {\n                // inside string literal\n                if (row > 0 && !/\\S/.test(currentLine)) // on an empty line, set indentation from previous line\n                return stream.lineIndentation(row - 1);\n                // otherwise keep existing indentation\n                return null;\n            }\n            if ($inComment) {\n                var commentStartLine = stream.lineText($inComment.line);\n                indent = $inComment.c1 + 1;\n                if (!/^\\s*\\*/.test(currentLine)) {\n                    // align with the first non-whitespace and non-asterisk character in the comment\n                    var re = /[^\\s*]/g;\n                    re.lastIndex = $inComment.c1 + 1;\n                    var m = re.exec(commentStartLine);\n                    if (m) indent = m.index;\n                }\n                return indent;\n            }\n            var p = $parens.at(-1);\n            if (p) {\n                // check if the current line closes the paren\n                var re = new RegExp(\"^\\\\s*\\\\\" + OPEN_PAREN[p.type]);\n                var thisLineCloses = re.test(currentLine);\n                // Check if there is text after the opening paren.  If so, indent to that column.\n                var line = stream.lineText(p.line);\n                re = /\\S/g;\n                re.lastIndex = p.col + 1;\n                var m = re.exec(line);\n                if (m) // but if this line closes the paren, better use the column of the open paren\n                indent = thisLineCloses ? p.col : m.index;\n                else {\n                    // Otherwise we should indent to one level more than the indentation of the line\n                    // containing the opening paren.\n                    indent = stream.lineIndentation(p.line) + INDENT_LEVEL();\n                    // but if this line closes the paren, then back one level\n                    if (thisLineCloses) indent -= INDENT_LEVEL();\n                }\n            } else {\n                let i = row, m;\n                while(i-- > 0)if (m = /\\S/.exec(stream.lineText(i))) break;\n                if (m) indent = m.index;\n            }\n            // Some more adjustments for continued statements.  Since we don't really have a\n            // rigorous parser, we have to rely on other regexps here, which sucks but will do for\n            // now.\n            if (row > 0) {\n                var before = stream.textBefore();\n                if (/\\)\\s*$/.test(before) && $passedParens.length > 0) {\n                    // Ends in a paren, could be an if, while or for which demands smart\n                    // indentation on the current line, let's check it out.\n                    // Note that the passedParen saved for that close paren is actually\n                    // the opening one, which suits us greatly.\n                    p = $passedParens.at(-1);\n                    var stmtLine = stream.lineText(p.line);\n                    if (/^\\s*(if|for|while)\\W/.test(stmtLine)) indent += INDENT_LEVEL();\n                } else if (/\\Welse\\s*$/.test(before)) indent += INDENT_LEVEL();\n            }\n            // switch labels use half the indent level, which is my favorite\n            if (/^\\s*(case|default)\\W/.test(currentLine)) indent -= INDENT_LEVEL() / 2;\n            return indent;\n        }\n        return PARSER;\n    }\n    (0, $c749180882ef16eb$export$3964ae1c660db960).define(\"js\", JS_PARSER.bind(null, toHash(KEYWORDS), toHash(KEYWORDS_TYPE), toHash(KEYWORDS_CONST), toHash(KEYWORDS_BUILTIN)));\n})();\n/* -----[ Keymap for C-like language mode ]----- */ let $8e1bdec65509308b$var$Ymacs_Keymap_JS = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"js\", {\n    \"`\": [\n        \"paredit_open_pair\",\n        \"`\",\n        \"`\",\n        /[\\`\\\\]/g\n    ],\n    \"'\": [\n        \"paredit_open_pair\",\n        \"'\",\n        \"'\",\n        /[\\'\\\\]/g\n    ],\n    \"M-`\": [\n        \"paredit_wrap_round\",\n        \"`\",\n        \"`\",\n        /[\\`\\\\]/g\n    ],\n    \"M-'\": [\n        \"paredit_wrap_round\",\n        \"'\",\n        \"'\",\n        /[\\'\\\\]/g\n    ]\n});\n/* -----[ Mode entry point ]----- */ (0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"javascript_mode\", function() {\n    var tok = this.tokenizer;\n    this.setTokenizer(new (0, $c749180882ef16eb$export$3964ae1c660db960)({\n        buffer: this,\n        type: \"js\"\n    }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    this.pushKeymap($8e1bdec65509308b$var$Ymacs_Keymap_JS);\n    var changed_vars = this.setq({\n        syntax_paragraph_sep: /\\n(?:[ \\t\\/\\*]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*\\/\\/+ ?/ygu,\n            ch: \"//\"\n        },\n        syntax_comment_multi: {\n            rx: /[^\\S\\r\\n]*\\/\\*+(.*?)\\*+\\//ygu,\n            ch: [\n                \"/*\",\n                \"*/\"\n            ]\n        }\n    });\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match) this.cmd(\"paren_match_mode\", false);\n        this.popKeymap($8e1bdec65509308b$var$Ymacs_Keymap_JS);\n        this.setq(changed_vars);\n    };\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n\n(function() {\n    function Partial(value) {\n        this.value = value;\n    }\n    function QuickParser(buffer, pos) {\n        var input = new (0, $c749180882ef16eb$export$825fc0b420d392c1)({\n            buffer: buffer,\n            pos: pos\n        });\n        function peek() {\n            return input.peek();\n        }\n        function next() {\n            return input.next();\n        }\n        function skip_ws() {\n            return input.read_while(function(ch) {\n                if (!caret_token && caret != null && input.pos == caret) return false;\n                return input.is_whitespace(ch);\n            });\n        }\n        function skip(ch) {\n            next();\n        }\n        function read_while(pred) {\n            return input.read_while(pred);\n        }\n        function read_escaped(start, end, inces) {\n            skip(start);\n            var escaped = false;\n            var str = \"\";\n            while(true){\n                var ch = next();\n                if (!ch) throw new Partial(str);\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == \"\\\\\") {\n                    if (inces) str += ch;\n                    escaped = true;\n                } else if (ch == end) break;\n                else str += ch;\n            }\n            return str;\n        }\n        function read_comment() {\n            return read_while(function(ch) {\n                return ch && ch != \"\\n\";\n            });\n        }\n        function read_multiline_comment() {\n            var comment = read_while(function() {\n                return !input.looking_at(\"|#\");\n            });\n            skip();\n            skip();\n            return comment;\n        }\n        function read_string() {\n            return read_escaped('\"', '\"');\n        }\n        function read_list(beg, end) {\n            var save_list_index = list_index;\n            list_index = 0;\n            try {\n                var ret = [], p;\n                skip(beg);\n                out: while(true){\n                    skip_ws();\n                    switch(peek()){\n                        case end:\n                            break out;\n                        case null:\n                            throw new Partial(ret);\n                        default:\n                            ret.push(read_token());\n                            ++list_index;\n                    }\n                }\n                skip(end);\n                return ret;\n            } finally{\n                list_index = save_list_index;\n            }\n        }\n        function read_regexp() {\n            var str = read_escaped(\"/\", \"/\", true);\n            var mods = read_while(function(ch) {\n                if (ch) switch(ch.toLowerCase()){\n                    case \"y\":\n                    case \"m\":\n                    case \"g\":\n                    case \"i\":\n                        return true;\n                }\n            }).toLowerCase();\n            return {\n                pattern: str,\n                modifiers: mods\n            };\n        }\n        function read_symbol() {\n            return read_while(function(ch) {\n                switch(ch){\n                    case null:\n                    case \"(\":\n                    case \")\":\n                    case \"{\":\n                    case \"}\":\n                    case \"[\":\n                    case \"]\":\n                    case \"#\":\n                    case \";\":\n                    case \"`\":\n                    case \"'\":\n                    case '\"':\n                    case \"|\":\n                    case \" \":\n                    case \"\\n\":\n                    case \"\t\":\n                    case \"\\f\":\n                    case \"\\u2028\":\n                    case \"\\u2029\":\n                    case \"\\xa0\":\n                        return false;\n                }\n                return true;\n            });\n        }\n        function read_char() {\n            return next() + read_while(function(ch) {\n                return ch >= \"a\" && ch <= \"z\" || ch >= \"A\" && ch <= \"z\" || ch >= \"0\" && ch <= \"9\" || ch == \"-\" || ch == \"_\";\n            });\n        }\n        function read_sharp() {\n            skip(\"#\");\n            switch(peek()){\n                case \"\\\\\":\n                    next();\n                    return token(\"char\", read_char);\n                case \"/\":\n                    return token(\"regexp\", read_regexp);\n                case \"(\":\n                    return token(\"vector\", read_list.bind(null, \"(\", \")\"));\n                case \"'\":\n                    next();\n                    return token(\"function\", read_symbol);\n                case \"|\":\n                    next();\n                    return token(\"comment\", read_multiline_comment);\n                default:\n                    return token(\"unknown\", read_token);\n            }\n        }\n        function read_token() {\n            skip_ws();\n            if (!caret_token && caret != null && input.pos == caret && (!parent || parent.type == \"list\")) return caret_token = token(\"caret\");\n            switch(peek()){\n                case \";\":\n                    return token(\"comment\", read_comment);\n                case '\"':\n                    return token(\"string\", read_string);\n                case \"(\":\n                    return token(\"list\", read_list.bind(null, \"(\", \")\"));\n                case \"{\":\n                    return token(\"list\", read_list.bind(null, \"{\", \"}\"));\n                case \"[\":\n                    return token(\"list\", read_list.bind(null, \"[\", \"]\"));\n                case \"#\":\n                    return token(\"sharp\", read_sharp);\n                case \"`\":\n                    next();\n                    return token(\"qq\", read_token, -1);\n                case \",\":\n                    next();\n                    if (peek() == \"@\") {\n                        next();\n                        return token(\"splice\", read_token, -2);\n                    }\n                    return token(\"unquote\", read_token, -1);\n                case \"'\":\n                    next();\n                    return token(\"quote\", read_token, -1);\n                case \")\":\n                    return null;\n                case null:\n                    return null; // EOF\n            }\n            return token(\"symbol\", read_symbol);\n        }\n        function read_all() {\n            var ret = [];\n            while(peek() != null){\n                var tok = read_token();\n                if (tok == null) break;\n                ret.push(tok);\n                ++list_index;\n            }\n            return ret;\n        }\n        var caret_token = null;\n        var list_index = 0;\n        var caret = null;\n        var parent = null;\n        var cont_exp = null;\n        function token(type, reader, adjust_start) {\n            if (adjust_start == null) adjust_start = 0;\n            var save_parent = parent;\n            try {\n                var tok = {\n                    value: null,\n                    index: list_index,\n                    type: type,\n                    start: input.pos + adjust_start,\n                    parent: parent,\n                    depth: parent ? parent.depth + 1 : 0,\n                    partial: false\n                };\n                if (type == \"list\") parent = tok;\n                try {\n                    if (reader) {\n                        tok.value = reader();\n                        if (tok.value === \"\") // couldn't figure this out, but let's not crash the browser.\n                        next();\n                    }\n                } catch (ex) {\n                    if (ex instanceof Partial) {\n                        tok.value = ex.value;\n                        tok.partial = true;\n                    } else throw ex;\n                }\n                tok.end = input.pos;\n                if (caret != null) {\n                    if (tok.start <= caret && tok.end >= caret) {\n                        if (!cont_exp) cont_exp = tok;\n                    }\n                }\n                return tok;\n            } finally{\n                parent = save_parent;\n            }\n        }\n        return {\n            parse: function(pos) {\n                caret = pos;\n                return token(\"list\", read_all);\n            },\n            read: function() {\n                return read_token();\n            },\n            prev_exp: function() {\n                if (caret_token) return caret_token.parent.value[caret_token.index - 1];\n                else if (cont_exp) {\n                    if (cont_exp.type == \"list\" && cont_exp.end == caret + 1) return cont_exp.value.at(-1);\n                    return cont_exp.parent.value[cont_exp.index];\n                }\n            },\n            caret_token: function() {\n                return caret_token;\n            },\n            cont_exp: function() {\n                return cont_exp;\n            },\n            sexp: function() {\n                var tok = cont_exp;\n                while(tok && (!/^(?:list|string)$/.test(tok.type) || tok.end == caret))tok = tok.parent;\n                return tok;\n            }\n        };\n    }\n    (0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n        test_lisp_parse: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            try {\n                var p = QuickParser(this);\n                var ast = p.parse(this.point());\n                console.log(ast);\n                console.log(p.caret_token());\n                console.log(p.cont_exp());\n                console.log(p.prev_exp());\n            } catch (ex) {\n                console.log(ex);\n            }\n        }),\n        lisp_make_quick_parser: function() {\n            return QuickParser.apply(this, [\n                this,\n                ...arguments\n            ]);\n        },\n        lisp_forward_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            var p = QuickParser(this, this.point());\n            var tok = p.read();\n            if (tok) this.cmd(\"goto_char\", tok.end);\n        }),\n        lisp_backward_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var tok = p.prev_exp();\n            if (tok) this.cmd(\"goto_char\", tok.start);\n        }),\n        lisp_backward_up_list: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var list = p.sexp();\n            if (list && list.parent) this.cmd(\"goto_char\", list.start);\n        }),\n        lisp_handle_string_quote: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var tok = p.prev_exp();\n            if (tok && tok.type == \"string\" && this.point() < tok.end) {\n                if (this.cmd(\"looking_at\", /\\\"/y)) this.cmd(\"forward_char\");\n                else if (!this.cmd(\"looking_back\", /\\\\/g)) this.cmd(\"insert\", '\\\\\"');\n                else this.cmd(\"insert\", '\"');\n            } else {\n                this.cmd(\"insert\", '\"\"');\n                this.cmd(\"backward_char\");\n            }\n        })\n    });\n    // XXX: much of the parser is actually copied from ymacs-mode-js.js.  I should somehow unify\n    // the duplicate code.\n    function qw(str) {\n        return str.trim().split(/\\s+/);\n    }\n    function toHash(str) {\n        return qw(str).reduce((a, key, i)=>(a[key] = i + 1, a), Object.create(null));\n    }\n    function regexp_opt(x, mods) {\n        if (typeof x == \"string\") x = qw(x);\n        return new RegExp(\"^(\" + x.join(\"|\") + \")$\", mods);\n    }\n    var SPECIAL_FORMS = regexp_opt(\"define defvar defparameter defconstant deftype defstruct defclass defsetf destructuring-bind defmacro defun defmethod defgeneric defpackage in-package defreadtable in-readtable when cond unless etypecase typecase ctypecase lambda \\u03BB let load-time-value quote macrolet progn begin prog1 prog2 progv go flet the if throw eval-when multiple-value-prog1 multiple-value-bind unwind-protect let\\\\* ignore-errors handler-case handler-bind invoke-restart restart-case restart-bind case labels function symbol-macrolet block tagbody catch locally inc! dec! cons c[ad]{1,4}r list and or not null null\\\\? loop do while dotimes return return-from setq set! set-car! set-cdr! setf multiple-value-call values\", \"i\");\n    var ERROR_FORMS = toHash(\"error warn\");\n    var CONSTANTS = toHash(\"t nil\");\n    var OPEN_PAREN = {\n        \"(\": \")\",\n        \"{\": \"}\",\n        \"[\": \"]\",\n        \"\\u2770\": \"\\u2771\",\n        \"\\xab\": \"\\xbb\"\n    };\n    var CLOSE_PAREN = {\n        \")\": \"(\",\n        \"}\": \"{\",\n        \"]\": \"[\",\n        \"\\u2771\": \"\\u2770\",\n        \"\\xbb\": \"\\xab\"\n    };\n    var DEFINES_FUNCTION = toHash(\"defun defmacro defgeneric defmethod\");\n    var DEFINES_TYPE = toHash(\"deftype defclass defstruct\");\n    var FORM_ARGS = {\n        \"if\": \"3+\",\n        \"aif\": \"3+\",\n        \"when\": \"1*\",\n        \"awhen\": \"1*\",\n        \"once-only\": \"1*\",\n        \"lambda\": \"1*\",\n        \"unless\": \"1*\",\n        \"defun\": \"2*\",\n        \"defpackage\": \"1*\",\n        \"defgeneric\": \"2*\",\n        \"defmethod\": \"2*\",\n        \"defclass\": \"2*\",\n        \"defstruct\": \"1*\",\n        \"defmacro\": \"2*\",\n        \"progn\": \"0+\",\n        \"begin\": \"0+\",\n        \"prog1\": \"1*\",\n        \"prog2\": \"2*\",\n        \"let\": \"1*\",\n        \"labels\": \"1*\",\n        \"flet\": \"1*\",\n        \"macrolet\": \"1*\",\n        \"symbol-macrolet\": \"1*\",\n        \"destructuring-bind\": \"2*\",\n        \"unwind-protect\": \"1*\",\n        \"catch\": \"1*\",\n        \"case\": \"1*\",\n        \"ecase\": \"1*\",\n        \"cond\": \"0+\",\n        \"handler-bind\": \"1*\",\n        \"handler-case\": \"1*\",\n        \"restart-bind\": \"1*\",\n        \"restart-case\": \"1*\",\n        \"return-from\": \"1*\",\n        \"block\": \"1*\",\n        \"dotimes\": \"1*\",\n        \"dolist\": \"1*\",\n        \"multiple-value-bind\": \"2*\",\n        \":method\": \"1*\",\n        \"eval-when\": \"1*\"\n    };\n    var LOCAL_BODYDEF = toHash(\"labels flet macrolet\");\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n    // the tokenizer function\n    (0, $c749180882ef16eb$export$3964ae1c660db960).define(\"lisp\", function(stream, tok, options) {\n        if (!options) options = {};\n        function isConstituent(ch) {\n            if (options.rx_special && options.rx_special.test(ch)) return false;\n            return ch.toLowerCase() != ch.toUpperCase() || /^[-|0-9!#$%&*+./:<=>?@\\^_~]$/i.test(ch);\n        }\n        function isConstituentStart(ch) {\n            //return ch != \"#\" && isConstituent(ch);\n            return isConstituent(ch);\n        }\n        var $cont = [], $inString = false, $inComment = false, $quote = null, $parens = [], $passedParens = [], $backList = [], $list = [], PARSER = {\n            next: next,\n            copy: copy,\n            indentation: indentation\n        };\n        function copy() {\n            var context = restore.context = {\n                cont: $cont.slice(0),\n                quote: $quote,\n                inString: $inString,\n                inComment: $inComment,\n                parens: $parens.slice(0),\n                passedParens: $passedParens.slice(0),\n                backList: $backList.slice(0),\n                list: $list.slice(0)\n            };\n            function restore() {\n                $cont = context.cont.slice(0);\n                $inString = context.inString;\n                $quote = context.quote;\n                $inComment = context.inComment;\n                $parens = context.parens.slice(0);\n                $passedParens = context.passedParens.slice(0);\n                $backList = context.backList.slice(0), $list = context.list.slice(0);\n                return PARSER;\n            }\n            return restore;\n        }\n        function foundToken(c1, c2, type) {\n            tok.onToken(stream.line, c1, c2, type);\n        }\n        function newArg(what) {\n            if (what == null) what = {\n                c1: stream.col\n            };\n            $list.push(what);\n        }\n        function INDENT_LEVEL() {\n            return stream.buffer.getq(\"indent_level\");\n        }\n        function readName() {\n            var col = stream.col, ch = stream.next(), name = ch;\n            while(!stream.eol()){\n                ch = stream.peek();\n                if (!isConstituent(ch)) break;\n                name += ch;\n                stream.nextCol();\n            }\n            var tok = ch && {\n                line: stream.line,\n                c1: col,\n                c2: stream.col,\n                id: name.toLowerCase()\n            };\n            if (tok.c2 > tok.c1) return tok;\n        }\n        function readString(end, type) {\n            var ch, esc = false, start = stream.col;\n            while(!stream.eol()){\n                ch = stream.peek();\n                if (!esc && ch === end) {\n                    $cont.pop();\n                    $inString = null;\n                    foundToken(start, stream.col, type);\n                    var p = $parens.at(-1);\n                    if (p && p.type == ch) {\n                        $parens.pop();\n                        p.closed = {\n                            line: stream.line,\n                            col: stream.col,\n                            opened: p\n                        };\n                        $passedParens.push(p);\n                    }\n                    foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                    return true;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, type);\n        }\n        function readComment() {\n            var line = stream.lineText(), pos = line.indexOf(\"|#\", stream.col);\n            var m = /^\\s*\\|+/.exec(line.substr(stream.col));\n            if (m) foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n            if (pos >= 0) {\n                $cont.pop();\n                $inComment = null;\n                foundToken(stream.col, pos, \"mcomment\");\n                foundToken(pos, pos += 2, \"mcomment-stopper\");\n                stream.col = pos;\n            } else {\n                foundToken(stream.col, line.length, \"mcomment\");\n                stream.col = line.length;\n            }\n        }\n        function isForm(form, list = $list) {\n            var f = list && list.length > 0 && list[0].id;\n            if (f) {\n                f = f.toLowerCase();\n                if (form == null) return f;\n                return typeof form == \"string\" ? f == form : f in form;\n            }\n        }\n        function next() {\n            stream.checkStop();\n            if ($cont.length > 0) return $cont.at(-1)();\n            var ch = stream.peek(), tmp;\n            if (tmp = stream.lookingAt(/^#\\\\.[a-z0-9_-]*/i)) {\n                newArg();\n                foundToken(stream.col, stream.col += tmp[0].length, \"constant\");\n            } else if (tmp = stream.lookingAt(/^#\\x2f((\\\\.|[^\\x2f])*)\\x2f([igsm]*)/)) {\n                newArg();\n                foundToken(stream.col, stream.col += 2, \"regexp-starter\");\n                foundToken(stream.col, stream.col += tmp[1].length, \"regexp\");\n                foundToken(stream.col, stream.col += 1, \"regexp-stopper\");\n                if (tmp[3]) foundToken(stream.col, stream.col += tmp[3].length, \"regexp-modifier\");\n            } else if (stream.lookingAt(/^#\\x27[^(]/)) {\n                newArg();\n                stream.col += 2;\n                tmp = readName();\n                foundToken(tmp.c1, tmp.c2, \"function-name\");\n            } else if (stream.lookingAt(\"#|\")) {\n                $inComment = {\n                    line: stream.line,\n                    c1: stream.col\n                };\n                foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n                $cont.push(readComment);\n            } else if (tmp = stream.lookingAt(/^;+/)) {\n                foundToken(stream.col, stream.col += tmp[0].length, \"comment-starter\");\n                foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n            } else if (ch === '\"') {\n                newArg();\n                $inString = {\n                    line: stream.line,\n                    c1: stream.col\n                };\n                $parens.push({\n                    line: stream.line,\n                    col: stream.col,\n                    type: ch\n                });\n                foundToken(stream.col, ++stream.col, \"string-starter\");\n                $cont.push(readString.bind(null, ch, \"string\"));\n            } else if (tmp = stream.lookingAt(/^[+-]?(#x[0-9a-fA-F]+|#o[0-7]+|#b[01]+|[0-9]*\\.?[0-9]+e?[0-9]*)(\\x2f(#x[0-9a-fA-F]+|#o[0-7]+|#b[01]+|[0-9]*\\.?[0-9]+e?[0-9]*))?/)) {\n                newArg();\n                foundToken(stream.col, stream.col += tmp[0].length, \"number\");\n            } else if (tmp = isOpenParen(ch)) {\n                newArg();\n                $backList.push($list);\n                $list = [];\n                $parens.push({\n                    line: stream.line,\n                    col: stream.col,\n                    type: ch\n                });\n                foundToken(stream.col, ++stream.col, \"open-paren\");\n            } else if (tmp = isCloseParen(ch)) {\n                var p = $parens.pop();\n                if (!p || p.type != tmp) foundToken(stream.col, ++stream.col, \"error\");\n                else {\n                    p.closed = {\n                        line: stream.line,\n                        col: stream.col,\n                        opened: p\n                    };\n                    $passedParens.push(p);\n                    $list = $backList.pop();\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                }\n            } else if (isConstituentStart(ch) && (tmp = readName())) {\n                var type = ch == \":\" ? \"lisp-keyword\" : ch == \"&\" ? \"type\" : /^#:/.test(tmp.id) ? \"lisp-keyword\" : SPECIAL_FORMS.test(tmp.id) ? \"keyword\" : tmp.id in ERROR_FORMS ? \"error\" : tmp.id in CONSTANTS ? \"constant\" : null;\n                if (!type) {\n                    // perhaps function name?\n                    if (isForm(DEFINES_FUNCTION) && $list.length == 1) type = \"function-name\";\n                    else if (isForm(DEFINES_TYPE) && $list.length == 1) type = \"type\";\n                    else if (/^with(out)?[-\\x2f]|:with(out)?[-\\x2f]/i.test(tmp.id)) type = \"builtin\";\n                }\n                newArg(tmp);\n                foundToken(tmp.c1, tmp.c2, type);\n            } else foundToken(stream.col, ++stream.col, null);\n        }\n        function indentation() {\n            var currentLine = stream.lineText();\n            if ($inString) return Math.max(0, currentLine.search(/[^\\s\\t\\n]/));\n            var indent = 0;\n            // XXX: rewrite this mess.\n            var p = $parens.at(-1);\n            if (p) {\n                var line = stream.lineText(p.line);\n                indent = p.col + 1;\n                if (/[\\#\\']/.test(line.charAt(p.col - 1))) return indent;\n                var nextNonSpace;\n                if (isConstituentStart(line.charAt(indent))) {\n                    var re = /\\s\\S/g;\n                    re.lastIndex = p.col;\n                    nextNonSpace = re.exec(line);\n                    if (nextNonSpace) indent = nextNonSpace = nextNonSpace.index + 1;\n                }\n                if ($list && $list.length) {\n                    var currentForm = isForm();\n                    if (currentForm) {\n                        currentForm = currentForm.replace(/\\*$/, \"\");\n                        var formArgs = FORM_ARGS[currentForm];\n                        if (!formArgs && /^with|:with/.test(currentForm)) // \"with\" macros usually take one argument, then &body\n                        formArgs = \"0*\";\n                        if (!formArgs && /^def/.test(currentForm)) {\n                            // definitions usually take two arguments, then &body\n                            if (nextNonSpace && /[\\(\\[\\{]/.test(line.charAt(nextNonSpace))) formArgs = \"1*\";\n                            else formArgs = \"2*\";\n                        }\n                        if (!formArgs) try {\n                            if (Object.hasOwn(LOCAL_BODYDEF, $backList[$backList.length - 2][0].id)) formArgs = \"1*\";\n                        } catch (ex) {}\n                        if (formArgs) {\n                            var n = parseInt(formArgs, 10);\n                            var hasRest = /\\+/.test(formArgs);\n                            var hasBody = /\\*/.test(formArgs);\n                            indent = p.col + INDENT_LEVEL();\n                            if (hasRest && nextNonSpace) indent = nextNonSpace;\n                            else if (n > 0 && $list.length - 1 < n) {\n                                // still in the arguments\n                                if (nextNonSpace) indent = nextNonSpace;\n                                else indent += INDENT_LEVEL();\n                            }\n                        }\n                    }\n                }\n            }\n            return indent;\n        }\n        return PARSER;\n    });\n})();\nlet $cd9400013ca46db2$var$Ymacs_Keymap_LispMode = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"lisp\", {\n    '\"': [\n        \"lisp_handle_string_quote\"\n    ]\n});\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"lisp_mode\", function() {\n    var tok = this.tokenizer;\n    this.setTokenizer(new (0, $c749180882ef16eb$export$3964ae1c660db960)({\n        buffer: this,\n        type: \"lisp\"\n    }));\n    var changed_vars = this.setq({\n        indent_level: 2,\n        syntax_paragraph_sep: /\\n(?:[ \\t;]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*;+ ?/gu,\n            ch: \";;\"\n        },\n        syntax_word_dabbrev: /^[-0-9_*%+/@&$.=~\\p{L}]$/u\n    });\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    this.pushKeymap($cd9400013ca46db2$var$Ymacs_Keymap_LispMode);\n    var changed_commands = this.replaceCommands({\n        \"forward_sexp\": \"lisp_forward_sexp\",\n        \"backward_sexp\": \"lisp_backward_sexp\",\n        \"backward_up_list\": \"lisp_backward_up_list\"\n    });\n    return function() {\n        this.setTokenizer(tok);\n        this.setq(changed_vars);\n        this.newCommands(changed_commands);\n        if (!was_paren_match) this.cmd(\"paren_match_mode\", false);\n        this.popKeymap($cd9400013ca46db2$var$Ymacs_Keymap_LispMode);\n    };\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n(0, $c749180882ef16eb$export$3964ae1c660db960).define(\"markdown\", function(stream, tok) {\n    let PARSER = {\n        next: next,\n        copy: copy\n    };\n    let $inline = [];\n    let $parens = [];\n    let $cont = [];\n    let $passedParens = [];\n    function copy() {\n        let context = restore.context = {\n            cont: [\n                ...$cont\n            ],\n            inline: [\n                ...$inline\n            ],\n            parens: [\n                ...$parens\n            ],\n            passedParens: [\n                ...$passedParens\n            ]\n        };\n        function restore() {\n            $cont = [\n                ...context.cont\n            ];\n            $inline = [\n                ...context.inline\n            ];\n            $parens = [\n                ...context.parens\n            ];\n            $passedParens = [\n                ...context.passedParens\n            ];\n            return PARSER;\n        }\n        return restore;\n    }\n    let OPEN_PAREN = {\n        \"(\": \")\",\n        \"{\": \"}\",\n        \"[\": \"]\",\n        \"\\xab\": \"\\xbb\",\n        \"\\u2770\": \"\\u2771\",\n        \"\\u201C\": \"\\u201D\"\n    };\n    let CLOSE_PAREN = {\n        \")\": \"(\",\n        \"}\": \"{\",\n        \"]\": \"[\",\n        \"\\xbb\": \"\\xab\",\n        \"\\u2771\": \"\\u2770\",\n        \"\\u201D\": \"\\u201C\"\n    };\n    function foundToken(c1, c2, type) {\n        tok.onToken(stream.line, c1, c2, type);\n    }\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0) return $cont.at(-1)();\n        readToken();\n    }\n    function readToken() {\n        let ch = stream.peek(), tmp;\n        if (stream.col == 0 && (tmp = stream.lookingAt(/^(#+)/))) foundToken(0, stream.col = stream.lineLength(), \"markdown-heading\" + tmp[0].length);\n        else if (stream.line > 0 && stream.col == 0 && (tmp = stream.lookingAt(/^[=-]+$/)) && /\\S/.test(stream.lineText(stream.line - 1))) {\n            tmp = tmp[0].charAt(0) == \"=\" ? 1 : 2;\n            tmp = \"markdown-heading\" + tmp;\n            tok.onToken(stream.line - 1, 0, stream.lineLength(stream.line - 1), tmp);\n            foundToken(0, stream.col = stream.lineLength(), tmp);\n        } else if (stream.col == 0 && (tmp = stream.lookingAt(/^>\\s*[>\\s]*/))) {\n            tmp = tmp[0].replace(/\\s+/g, \"\").length;\n            if (tmp > 3) tmp = \"\";\n            tmp = \"markdown-blockquote\" + tmp;\n            foundToken(0, stream.col = stream.lineLength(), tmp);\n        } else if (tmp = isOpenParen(ch)) {\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            foundToken(stream.col, ++stream.col, \"open-paren\");\n        } else if (tmp = isCloseParen(ch)) {\n            let p = $parens.pop();\n            if (!p || p.type != tmp) foundToken(stream.col, ++stream.col, \"error\");\n            else {\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col,\n                    opened: p\n                };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\");\n            }\n        } else foundToken(stream.col, ++stream.col, null);\n    }\n    return PARSER;\n});\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"markdown_mode\", function() {\n    var tok = this.tokenizer;\n    this.setTokenizer(new (0, $c749180882ef16eb$export$3964ae1c660db960)({\n        buffer: this,\n        type: \"markdown\"\n    }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match) this.cmd(\"paren_match_mode\", false);\n    };\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n\n\n\nlet $0d1e4b05bb7aaeb3$var$Ymacs_Keymap_ParenMatch = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"parenmatch\", {\n    \"C-M-x\": \"goto_matching_paren\",\n    \"C-M-q\": \"indent_sexp\",\n    \"C-M-f && C-M-n\": \"forward_sexp\",\n    \"C-M-b && C-M-p\": \"backward_sexp\",\n    \"C-M-u && M-a && C-M-ArrowUp\": \"backward_up_list\",\n    \"C-M-a\": \"beginning_of_defun\",\n    \"C-M-e\": \"end_of_defun\",\n    \"M-e\": \"up_list\",\n    \"C-M-ArrowDown\": \"down_list\",\n    \"M-C-k\": \"kill_sexp\",\n    \"M-C-Space\": \"mark_sexp\",\n    \"M-C-t\": \"transpose_sexps\",\n    \"(\": [\n        \"paredit_open_pair\",\n        \"(\",\n        \")\"\n    ],\n    \"[\": [\n        \"paredit_open_pair\",\n        \"[\",\n        \"]\"\n    ],\n    \"{\": [\n        \"paredit_open_pair\",\n        \"{\",\n        \"}\"\n    ],\n    \"\\u2770\": [\n        \"paredit_open_pair\",\n        \"\\u2770\",\n        \"\\u2771\"\n    ],\n    \"\\xab\": [\n        \"paredit_open_pair\",\n        \"\\xab\",\n        \"\\xbb\"\n    ],\n    \"\\u201C\": [\n        \"paredit_open_pair\",\n        \"\\u201C\",\n        \"\\u201D\"\n    ],\n    '\"': [\n        \"paredit_open_pair\",\n        '\"',\n        '\"',\n        /[\\\"\\\\]/g\n    ],\n    \")\": [\n        \"paredit_close_pair\",\n        \"(\",\n        \")\"\n    ],\n    \"]\": [\n        \"paredit_close_pair\",\n        \"[\",\n        \"]\"\n    ],\n    \"}\": [\n        \"paredit_close_pair\",\n        \"{\",\n        \"}\"\n    ],\n    \"\\u2771\": [\n        \"paredit_close_pair\",\n        \"\\u2770\",\n        \"\\u2771\"\n    ],\n    \"\\xbb\": [\n        \"paredit_close_pair\",\n        \"\\xab\",\n        \"\\xbb\"\n    ],\n    \"\\u201D\": [\n        \"paredit_close_pair\",\n        \"\\u201C\",\n        \"\\u201D\"\n    ],\n    \"M-(\": [\n        \"paredit_wrap_round\",\n        \"(\",\n        \")\"\n    ],\n    \"M-[\": [\n        \"paredit_wrap_round\",\n        \"[\",\n        \"]\"\n    ],\n    \"M-{\": [\n        \"paredit_wrap_round\",\n        \"{\",\n        \"}\"\n    ],\n    \"M-\\u2770\": [\n        \"paredit_wrap_round\",\n        \"\\u2770\",\n        \"\\u2771\"\n    ],\n    \"M-\\xab\": [\n        \"paredit_wrap_round\",\n        \"\\xab\",\n        \"\\xbb\"\n    ],\n    \"M-\\u201C\": [\n        \"paredit_wrap_round\",\n        \"\\u201C\",\n        \"\\u201D\"\n    ],\n    'M-\"': [\n        \"paredit_wrap_round\",\n        '\"',\n        '\"',\n        /[\\\"\\\\]/g\n    ],\n    \"M-r\": \"paredit_raise_sexp\",\n    \"M-s\": \"paredit_splice_sexp\",\n    \"Backspace\": \"paredit_backward_delete_char\",\n    //\"Delete && C-d\"                : \"paredit_delete_char\",\n    \"Enter\": \"paredit_newline_and_indent\",\n    \"; && : && , && .\": \"paredit_electric_char\"\n});\nvar $0d1e4b05bb7aaeb3$var$PARENS = {\n    \"(\": \")\",\n    \"[\": \"]\",\n    \"{\": \"}\",\n    \"\\u2770\": \"\\u2771\",\n    \"\\xab\": \"\\xbb\",\n    \"\\u201C\": \"\\u201D\",\n    '\"': '\"',\n    \"'\": \"'\",\n    \"`\": \"`\"\n};\nvar $0d1e4b05bb7aaeb3$var$R_PARENS = {\n    \")\": \"(\",\n    \"]\": \"[\",\n    \"}\": \"{\",\n    \"\\u2771\": \"\\u2770\",\n    \"\\xbb\": \"\\xab\",\n    \"\\u201D\": \"\\u201C\",\n    '\"': '\"',\n    \"'\": \"'\",\n    \"`\": \"`\"\n};\nfunction $0d1e4b05bb7aaeb3$var$ERROR(o) {\n    throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"Balanced expression not found\");\n}\nfunction $0d1e4b05bb7aaeb3$var$caretInOP(caret, paren) {\n    if (caret.row == paren.line) {\n        if (paren.col != null) return caret.col == paren.col;\n        else return paren.c1 <= caret.col && caret.col <= paren.c2;\n    }\n}\nfunction $0d1e4b05bb7aaeb3$var$caretInCP(caret, paren) {\n    if (caret.row == paren.line) {\n        if (paren.col != null) return caret.col == paren.col + 1;\n        else return paren.c1 <= caret.col && caret.col <= paren.c2;\n    }\n}\nfunction $0d1e4b05bb7aaeb3$var$startOf(paren) {\n    return paren.c1 ?? paren.col;\n}\nfunction $0d1e4b05bb7aaeb3$var$endOf(paren) {\n    return paren.c2 ?? paren.col + 1;\n}\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    matching_paren: function() {\n        let parser = this.tokenizer.getLastParser();\n        if (parser) {\n            let rc = this._rowcol;\n            let parens = (0, $c749180882ef16eb$export$af0894485b469f4e)(parser);\n            for (let op of parens){\n                let cp = op.closed;\n                if ($0d1e4b05bb7aaeb3$var$caretInOP(rc, op)) return this._rowColToPosition(cp.line, $0d1e4b05bb7aaeb3$var$endOf(cp));\n                else if ($0d1e4b05bb7aaeb3$var$caretInCP(rc, cp)) return this._rowColToPosition(op.line, $0d1e4b05bb7aaeb3$var$startOf(op));\n            }\n        }\n    },\n    indent_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var pos = this.cmd(\"matching_paren\");\n        if (pos != null) this.cmd(\"indent_region\", this.point(), pos);\n        else $0d1e4b05bb7aaeb3$var$ERROR(this);\n    }),\n    goto_matching_paren: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var pos = this.cmd(\"matching_paren\");\n        if (pos != null) {\n            this.cmd(\"goto_char\", pos);\n            return true;\n        }\n    }),\n    forward_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let parser = this.tokenizer.finishParsing(), next;\n        if (parser) {\n            // find next paren\n            let rc = this._rowcol;\n            let parens = (0, $c749180882ef16eb$export$af0894485b469f4e)(parser);\n            for(let i = 0; i < parens.length; ++i){\n                let p = parens[i];\n                if (p.line > rc.row || p.line == rc.row && $0d1e4b05bb7aaeb3$var$startOf(p) >= rc.col) {\n                    next = p;\n                    break;\n                }\n            }\n        }\n        this.withVariables({\n            syntax_word: this.getq(\"syntax_word_sexp\")\n        }, \"forward_word\");\n        if (next && next.closed && (0, $c749180882ef16eb$export$2b0c642afb0ae4ca)(this._rowcol, next) > 0) this.cmd(\"goto_char\", this._rowColToPosition(next.closed.line, $0d1e4b05bb7aaeb3$var$endOf(next.closed)));\n    }),\n    backward_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let parser = this.tokenizer.finishParsing(), prev;\n        if (parser) {\n            // find next paren\n            let rc = this._rowcol;\n            let parens = (0, $c749180882ef16eb$export$af0894485b469f4e)(parser).filter((p)=>p.closed).map((p)=>p.closed).sort((0, $c749180882ef16eb$export$2b0c642afb0ae4ca));\n            for(let i = parens.length; --i >= 0;){\n                let p = parens[i];\n                if (p.line < rc.row || p.line == rc.row && $0d1e4b05bb7aaeb3$var$startOf(p) < rc.col) {\n                    prev = p;\n                    break;\n                }\n            }\n        }\n        this.withVariables({\n            syntax_word: this.getq(\"syntax_word_sexp\")\n        }, \"backward_word\");\n        if (prev && prev.opened && (0, $c749180882ef16eb$export$2b0c642afb0ae4ca)(this._rowcol, {\n            line: prev.line,\n            col: $0d1e4b05bb7aaeb3$var$endOf(prev)\n        }) < 0) this.cmd(\"goto_char\", this._rowColToPosition(prev.opened.line, $0d1e4b05bb7aaeb3$var$startOf(prev.opened)));\n    }),\n    mark_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^r\", function(begin, end) {\n        this.cmd(\"save_excursion\", function() {\n            if (this.transientMarker) this.cmd(\"goto_char\", end);\n            this.ensureTransientMark();\n            this.cmd(\"forward_sexp\");\n            this.setMark(this.point());\n            this.transientMarker.swap(this.caretMarker);\n        });\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n    kill_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this._killingAction(this.point(), this.cmd(\"save_excursion\", function() {\n            this.cmd(\"forward_sexp\");\n            return this.point();\n        }));\n    }),\n    transpose_sexps: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var a = [];\n        this.cmd(\"forward_sexp\");\n        a.push(this.point());\n        this.cmd(\"backward_sexp\");\n        a.push(this.point());\n        this.cmd(\"backward_sexp\");\n        a.push(this.point());\n        this.cmd(\"forward_sexp\");\n        a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a));\n    }),\n    down_list: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let lc = {\n                line: rc.row,\n                col: rc.col\n            };\n            let p = (0, $c749180882ef16eb$export$af0894485b469f4e)(tok).filter((p)=>p.closed).find((p)=>(0, $c749180882ef16eb$export$2b0c642afb0ae4ca)(p, lc) >= 0);\n            if (p != null) this.cmd(\"goto_char\", this._rowColToPosition(p.line, $0d1e4b05bb7aaeb3$var$endOf(p)));\n            else $0d1e4b05bb7aaeb3$var$ERROR(this);\n        }\n    }),\n    backward_up_list: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = (0, $c749180882ef16eb$export$af0894485b469f4e)(tok).filter((0, $c749180882ef16eb$export$f6a9bcac20db9551)(rc)).at(-1);\n            if (p != null) this.cmd(\"goto_char\", this._rowColToPosition(p.line, $0d1e4b05bb7aaeb3$var$startOf(p)));\n            else $0d1e4b05bb7aaeb3$var$ERROR(this);\n        }\n    }),\n    up_list: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"backward_up_list\");\n        this.cmd(\"forward_sexp\");\n    }),\n    beginning_of_defun: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = (0, $c749180882ef16eb$export$af0894485b469f4e)(tok).filter((0, $c749180882ef16eb$export$f6a9bcac20db9551)(rc))[0];\n            if (p != null) {\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, $0d1e4b05bb7aaeb3$var$startOf(p)));\n                this.cmd(\"back_to_indentation\");\n            } else this.cmd(\"backward_sexp\");\n        }\n    }),\n    end_of_defun: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = (0, $c749180882ef16eb$export$af0894485b469f4e)(tok).filter((0, $c749180882ef16eb$export$f6a9bcac20db9551)(rc))[0];\n            if (p != null) {\n                p = p.closed;\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, $0d1e4b05bb7aaeb3$var$endOf(p)));\n            } else this.cmd(\"forward_sexp\");\n        }\n    }),\n    paredit_raise_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"forward_sexp\");\n        this.cmd(\"backward_sexp\");\n        var start = this.point();\n        this.cmd(\"forward_sexp\");\n        var end = this.point();\n        this.cmd(\"backward_up_list\");\n        var kstart = this.point();\n        this.cmd(\"forward_sexp\");\n        var kend = this.point();\n        var sexp = this.cmd(\"buffer_substring\", start, end);\n        this._replaceText(kstart, kend, sexp);\n        this.cmd(\"goto_char\", kstart);\n        this.cmd(\"indent_region\", kstart, kstart + sexp.length);\n    }),\n    paredit_splice_sexp: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        let p = (0, $c749180882ef16eb$export$af0894485b469f4e)(this.tokenizer.finishParsing()).filter((0, $c749180882ef16eb$export$f6a9bcac20db9551)(this._rowcol, \"inner\")).at(-1);\n        if (p.inner && p.outer) this.cmd(\"save_excursion\", function() {\n            let outer_begin = this._rowColToPosition(p.outer.l1, p.outer.c1);\n            let outer_end = this._rowColToPosition(p.outer.l2, p.outer.c2);\n            let inner_begin = this._rowColToPosition(p.inner.l1, p.inner.c1);\n            let inner_end = this._rowColToPosition(p.inner.l2, p.inner.c2);\n            this.withMarkers((m1, m2)=>{\n                this._deleteText(inner_end, outer_end);\n                this._deleteText(outer_begin, inner_begin);\n                this.cmd(\"indent_region\", m1, m2);\n            }, inner_begin, inner_end);\n        });\n        else this.cmd(\"save_excursion\", function() {\n            this.cmd(\"backward_up_list\");\n            var start = this.point();\n            this.cmd(\"forward_sexp\");\n            this.cmd(\"backward_delete_char\");\n            var end = this.point();\n            this.cmd(\"goto_char\", start);\n            this.cmd(\"delete_char\");\n            this.cmd(\"indent_region\", start, end - 1);\n        });\n    }),\n    paredit_backward_delete_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (n != null) return this.cmd(\"backward_delete_char\", n);\n        if (!this.deleteTransientRegion()) {\n            if (this.cmd(\"looking_back\", /[\\(\\[\\{\\\"\\\\\\`\\']/g)) {\n                var close = $0d1e4b05bb7aaeb3$var$PARENS[this.matchData[0]];\n                if (close) {\n                    var rx = new RegExp(\"\\\\s*\\\\\" + close, \"my\");\n                    if (this.cmd(\"looking_at\", rx)) this.cmd(\"save_excursion\", function() {\n                        this.cmd(\"delete_whitespace\");\n                        this.cmd(\"delete_char\");\n                    });\n                }\n            }\n            this.cmd(\"backward_delete_char\");\n        }\n    }),\n    paredit_delete_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^p\", function(n) {\n        if (n != null) return this.cmd(\"delete_char\", n);\n        if (!this.deleteTransientRegion()) {\n            if (this.cmd(\"looking_at\", /[\\]\\}\\)\\\"\\\\\\`\\']/y)) {\n                var open = $0d1e4b05bb7aaeb3$var$R_PARENS[this.matchData[0]];\n                if (open) {\n                    var rx = new RegExp(\"\\\\\" + open + \"\\\\s*\", \"mg\");\n                    if (this.cmd(\"looking_back\", rx)) this.cmd(\"save_excursion\", function() {\n                        this.cmd(\"backward_delete_whitespace\");\n                        this.cmd(\"backward_delete_char\");\n                    });\n                }\n            }\n            this.cmd(\"delete_char\");\n        }\n    }),\n    paredit_open_pair: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function(pair_a, pair_b, backslash) {\n        if (this.transientMarker) {\n            this.cmd(\"paredit_wrap_round\", pair_a, pair_b, backslash);\n            return;\n        }\n        if (pair_a == pair_b && this.looking_at(pair_a)) // presumably close; it's already there, just skip it\n        this.cmd(\"forward_char\");\n        else {\n            this.cmd(\"insert\", pair_a);\n            this.cmd(\"insert\", pair_b);\n            this.cmd(\"backward_char\", pair_b.length);\n        }\n        this.cmd(\"paredit_maybe_indent\");\n    }),\n    paredit_close_pair: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function(pair_a, pair_b) {\n        if (this.transientMarker) {\n            this.cmd(\"paredit_wrap_round\", pair_a, pair_b);\n            return;\n        }\n        var re = new RegExp(\"\\\\s*\\\\\" + pair_b, \"iy\");\n        if (this.cmd(\"looking_at\", re)) this._deleteText(this.point(), this.matchData.after);\n        this.cmd(\"insert\", pair_b);\n        this.cmd(\"paredit_maybe_indent\");\n    }),\n    paredit_wrap_round: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(\"^\", function(paren, closing, backslash) {\n        var r = this.transientMarker ? this.getRegion() : this.cmd(\"save_excursion\", function() {\n            var begin = this.point();\n            this.cmd(\"forward_sexp\");\n            return {\n                begin: begin,\n                end: this.point()\n            };\n        }), txt = this._bufferSubstring(r.begin, r.end), before = this.point() < r.end;\n        if (backslash) txt = txt.replace(backslash, (s)=>\"\\\\\" + s);\n        var m = this.createMarker(r.end);\n        this.cmd(\"save_excursion\", function() {\n            this._replaceText(r.begin, r.end, paren + txt + closing);\n        }, before);\n        if (before) this.cmd(\"forward_char\");\n        this.clearTransientMark();\n        this.cmd(\"indent_region\", r.begin, m.getPosition());\n        m.destroy();\n    }),\n    paredit_newline_and_indent: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        var inparens = this.looking_at(/[ \\t]*([\\]\\}])/y) && this.looking_back(new RegExp(\"\\\\\" + $0d1e4b05bb7aaeb3$var$R_PARENS[this.matchData[1]] + \"[ \\\\t]*\", \"g\"));\n        this.cmd(\"newline_and_indent\");\n        if (inparens) {\n            this.cmd(\"newline_and_indent\");\n            this.cmd(\"backward_line\");\n            this.cmd(\"indent_line\");\n        }\n    }),\n    paredit_maybe_indent: function() {\n        if (this.getq(\"electric_indent\")) this.cmd(\"indent_line\");\n    },\n    paredit_electric_char: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n        this.cmd(\"self_insert_command\");\n        this.cmd(\"paredit_maybe_indent\");\n    })\n});\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"paren_match_mode\", function() {\n    this.pushKeymap($0d1e4b05bb7aaeb3$var$Ymacs_Keymap_ParenMatch);\n    var clearOvl = (function() {\n        this.deleteOverlay(\"match-paren\");\n    }).bind(this);\n    function inside(a, b, c) {\n        return b >= a && b < c;\n    }\n    let events = {\n        beforeInteractiveCommand: function() {\n            clearOvl();\n        },\n        afterInteractiveCommand: (0, $08a06a2e99accb03$export$ad41d882ec94ba04)(()=>{\n            let p = this.tokenizer.getLastParser(), rc = this._rowcol;\n            let hl = [];\n            if (p) for (let par_a of (0, $c749180882ef16eb$export$af0894485b469f4e)(p)){\n                let par_b = par_a.closed;\n                let ac1 = par_a.c1 ?? par_a.col, ac2 = par_a.c2 ?? par_a.col + par_a.type.length;\n                let bc1 = par_b.c1 ?? par_b.col, bc2 = par_b.c2 ?? par_b.col + 1;\n                if ($0d1e4b05bb7aaeb3$var$caretInOP(rc, par_a) || $0d1e4b05bb7aaeb3$var$caretInCP(rc, par_b)) {\n                    hl.push({\n                        line1: par_a.line,\n                        col1: ac1,\n                        line2: par_a.line,\n                        col2: ac2\n                    }, {\n                        line1: par_b.line,\n                        col1: bc1,\n                        line2: par_b.line,\n                        col2: bc2\n                    });\n                    break;\n                }\n            }\n            this.setOverlay(\"match-paren\", hl);\n        }, 100)\n    };\n    this.addEventListener(events);\n    if (this.getq(\"electric_indent\") == null) this.setq(\"electric_indent\", true);\n    return function() {\n        clearOvl();\n        this.popKeymap($0d1e4b05bb7aaeb3$var$Ymacs_Keymap_ParenMatch);\n        this.removeEventListener(events);\n    };\n});\n\n\n/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\n\n\n\n\nconst $3aa295d5c8d5089e$var$RX_EMPTY_TAG = /^(?:area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/i;\nconst $3aa295d5c8d5089e$var$RX_BLOCK_TAG = /^(?:article|aside|blockquote|body|button|caption|col|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h[1-6]|header|hgroup|li|ol|p|pre|section|table|tbody|textarea|tfoot|th|thead|td|tr|ul)$/i;\n(0, $c749180882ef16eb$export$3964ae1c660db960).define(\"xml\", $3aa295d5c8d5089e$var$xml_tokenizer);\n(0, $c749180882ef16eb$export$3964ae1c660db960).define(\"html\", $3aa295d5c8d5089e$var$html_tokenizer);\nlet $3aa295d5c8d5089e$var$Ymacs_Keymap_XML = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"xml\", {\n    \"C-c /\": \"xml_close_tag\",\n    \"/\": \"xml_slash_complete_tag\",\n    \">\": \"xml_gt_complete_tag\",\n    \"C-Enter\": \"xml_zen_expand\",\n    \"Enter\": \"xml_newline_and_indent\"\n});\nlet $3aa295d5c8d5089e$var$markup_mode = (tok_type)=>function() {\n        var tok = this.tokenizer;\n        this.setTokenizer(new (0, $c749180882ef16eb$export$3964ae1c660db960)({\n            buffer: this,\n            type: tok_type\n        }));\n        var was_paren_match = this.cmd(\"paren_match_mode\", true);\n        this.pushKeymap($3aa295d5c8d5089e$var$Ymacs_Keymap_XML);\n        var changed_vars = this.setq({\n            indent_level: 2,\n            syntax_comment_multi: {\n                rx: /[^\\S\\r\\n]*<!--+[^\\S\\r\\n]*(.*?)[^\\S\\r\\n]*-->/ygu,\n                ch: [\n                    \"<!--\",\n                    \"-->\"\n                ]\n            },\n            syntax_word_dabbrev: /^[\\p{N}_$\\p{L}:#-]$/u,\n            syntax_word_sexp: /^[\\p{N}_$\\p{L}:#-]$/u\n        });\n        return function() {\n            this.setTokenizer(tok);\n            if (!was_paren_match) this.cmd(\"paren_match_mode\", false);\n            this.popKeymap($3aa295d5c8d5089e$var$Ymacs_Keymap_XML);\n            this.setq(changed_vars);\n        };\n    };\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"xml_mode\", $3aa295d5c8d5089e$var$markup_mode(\"xml\"));\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newMode(\"html_mode\", $3aa295d5c8d5089e$var$markup_mode(\"html\"));\n(0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n    xml_get_fill_paragraph_region: function() {\n        let blk = (0, $c749180882ef16eb$export$af0894485b469f4e)(this.tokenizer.finishParsing()).filter((0, $c749180882ef16eb$export$f6a9bcac20db9551)(this._rowcol, \"outer\")).findLast((p)=>$3aa295d5c8d5089e$var$RX_BLOCK_TAG.test(p.type));\n        if (blk) {\n            let r = {\n                begin: this._rowColToPosition(blk.inner.l1, blk.inner.c1),\n                end: this._rowColToPosition(blk.inner.l2, blk.inner.c2)\n            };\n            this.cmd(\"save_excursion\", ()=>{\n                this.cmd(\"goto_char\", r.begin);\n                if (this.cmd(\"looking_at\", /[^\\S\\r\\n]*\\n/gy)) {\n                    this.cmd(\"goto_char\", this.matchData.after);\n                    r.begin = this.point();\n                }\n                this.cmd(\"goto_char\", r.end);\n                if (this.cmd(\"looking_back\", /\\n[^\\S\\r\\n]*/g)) {\n                    this.cmd(\"backward_whitespace\");\n                    r.end = this.point();\n                }\n            });\n            return r;\n        }\n    }\n});\nfunction $3aa295d5c8d5089e$var$xml_tokenizer(stream, tok, { emptyTags: emptyTags, inline: inline } = {}) {\n    var $tags = [];\n    var $cont = [];\n    var $parens = [];\n    var $passedParens = [];\n    var $inTag = null;\n    var $inComment = null;\n    var $inString = false;\n    var $inline = 0;\n    var PARSER = {\n        next: next,\n        copy: copy,\n        indentation: indentation,\n        get tags () {\n            return $tags;\n        }\n    };\n    function copy() {\n        let context = resume.context = {\n            tags: $tags.slice(0),\n            cont: $cont.slice(0),\n            parens: $parens.slice(0),\n            passedParens: $passedParens.slice(0),\n            inTag: $inTag,\n            inComment: $inComment,\n            inString: $inString,\n            inline: $inline\n        };\n        function resume() {\n            $cont = context.cont.slice(0);\n            $tags = context.tags.slice(0);\n            $parens = context.parens.slice(0);\n            $passedParens = context.passedParens.slice(0);\n            $inTag = context.inTag;\n            $inComment = context.inComment;\n            $inString = context.inString;\n            $inline = context.inline;\n            return PARSER;\n        }\n        return resume;\n    }\n    function INDENT_LEVEL() {\n        return stream.buffer.getq(\"indent_level\");\n    }\n    function foundToken(c1, c2, type, addInline) {\n        if (addInline && inline) {\n            let cls = inline && inline.cls($inline) || \"\";\n            if (type) cls += \" \" + type;\n            tok.onToken(stream.line, c1, c2, cls || null);\n        } else tok.onToken(stream.line, c1, c2, type);\n    }\n    function isLetter(ch) {\n        return ch.toLowerCase() != ch.toUpperCase();\n    }\n    function isNameStart(ch) {\n        return ch && (isLetter(ch) || /^[:_-]$/.test(ch));\n    }\n    function isNameChar(ch) {\n        return ch && (isLetter(ch) || /^[0-9:_-]$/.test(ch));\n    }\n    function readName() {\n        var col = stream.col, ch = stream.next(), name = ch;\n        while(!stream.eol()){\n            ch = stream.peek();\n            if (!isNameChar(ch)) break;\n            name += ch;\n            stream.nextCol();\n        }\n        return ch && {\n            line: stream.line,\n            c1: col,\n            c2: stream.col,\n            id: name\n        };\n    }\n    function readString(end) {\n        $inString = true;\n        var ch, esc = false, start = stream.col;\n        while(!stream.eol()){\n            ch = stream.peek();\n            if (!esc && ch === end) {\n                $cont.pop();\n                $inString = false;\n                foundToken(start, stream.col, \"string\");\n                var p = $parens.at(-1);\n                if (p && p.type == ch) {\n                    $parens.pop();\n                    p.closed = {\n                        line: stream.line,\n                        col: stream.col,\n                        opened: p\n                    };\n                    $passedParens.push(p);\n                }\n                foundToken(stream.col, ++stream.col, \"string-stopper\");\n                return;\n            }\n            esc = !esc && ch === \"\\\\\";\n            stream.nextCol();\n        }\n        foundToken(start, stream.col, \"string\");\n    }\n    function readTag() {\n        var ch = stream.peek(), name;\n        if (stream.lookingAt(\"/>\")) {\n            let p = $parens.at(-1);\n            if (p && p.type == \"<\") {\n                $parens.pop();\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col + 1,\n                    opened: p\n                };\n                $passedParens.push(p);\n            }\n            $cont.pop();\n            $inTag = null;\n            foundToken(stream.col, ++stream.col, \"xml-closetag-slash\");\n            foundToken(stream.col, ++stream.col, \"xml-close-bracket\");\n        } else if (ch === \">\") {\n            let p = $parens.at(-1);\n            if (p && p.type == \"<\") {\n                $parens.pop();\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col,\n                    opened: p\n                };\n                $passedParens.push(p);\n            }\n            $cont.pop();\n            foundToken(stream.col, ++stream.col, \"xml-close-bracket\");\n            if (!emptyTags?.test($inTag.id)) {\n                $inTag.inner = {\n                    l1: stream.line,\n                    c1: stream.col\n                };\n                $tags.push($inTag);\n                if (inline) $inline ^= inline.code($inTag.id);\n            }\n            $inTag = null;\n        } else if (isNameStart(ch) && (name = readName())) foundToken(name.c1, name.c2, \"xml-attribute\");\n        else if (ch === '\"' || ch === \"'\") {\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            foundToken(stream.col, ++stream.col, \"string-starter\");\n            $cont.push(readString.bind(null, ch));\n        } else foundToken(stream.col, ++stream.col, null);\n    }\n    function readComment(type, end, op) {\n        var line = stream.lineText(), pos = line.indexOf(end, stream.col);\n        if (pos >= 0) {\n            $cont.pop();\n            foundToken(stream.col, pos, type);\n            $inComment = null;\n            op.closed = {\n                line: stream.line,\n                c1: pos,\n                c2: pos + end.length,\n                opened: op\n            };\n            $passedParens.push(op);\n            foundToken(pos, pos += end.length, type + \"-stopper\");\n            stream.col = pos;\n        } else {\n            foundToken(stream.col, line.length, type);\n            stream.col = line.length;\n        }\n    }\n    function readCloseBracket(tag) {\n        var m = stream.lookingAt(/^([\\s\\xA0]*)(>?)/);\n        if (m && m[0]) {\n            if (m[1]) foundToken(stream.col, stream.col += m[1].length, null);\n            if (m[2]) {\n                let p = $parens.pop();\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col,\n                    opened: p\n                };\n                $passedParens.push(p);\n                foundToken(stream.col, stream.col += m[2].length, \"xml-close-bracket\");\n                $cont.pop();\n                if (tag) {\n                    tag.outer.l2 = stream.line;\n                    tag.outer.c2 = stream.col;\n                }\n            }\n        } else foundToken(stream.col, ++stream.col, \"error\");\n    }\n    let OPEN_PAREN = {\n        \"(\": \")\",\n        \"{\": \"}\",\n        \"[\": \"]\",\n        \"\\xab\": \"\\xbb\",\n        \"\\u2770\": \"\\u2771\",\n        \"\\u201C\": \"\\u201D\"\n    };\n    let CLOSE_PAREN = {\n        \")\": \"(\",\n        \"}\": \"{\",\n        \"]\": \"[\",\n        \"\\xbb\": \"\\xab\",\n        \"\\u2771\": \"\\u2770\",\n        \"\\u201D\": \"\\u201C\"\n    };\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0) return $cont.at(-1)();\n        let ch = stream.peek(), m;\n        if (stream.lookingAt(\"<![CDATA[\")) {\n            let op = {\n                line: stream.line,\n                c1: stream.col,\n                c2: stream.col + 9,\n                type: \"<![CDATA[\"\n            };\n            $parens.push(op);\n            foundToken(stream.col, stream.col += 9, \"xml-cdata-starter\");\n            $inComment = {\n                line: stream.line,\n                c1: stream.col\n            };\n            $cont.push(readComment.bind(null, \"xml-cdata\", \"]]>\", op));\n        } else if (stream.lookingAt(\"<!--\")) {\n            let op = {\n                line: stream.line,\n                c1: stream.col,\n                c2: stream.col + 4,\n                type: \"<!--\"\n            };\n            $parens.push(op);\n            foundToken(stream.col, stream.col += 4, \"mcomment-starter\");\n            $inComment = {\n                line: stream.line,\n                c1: stream.col\n            };\n            $cont.push(readComment.bind(null, \"mcomment\", \"-->\", op));\n        } else if (m = stream.lookingAt(/^<!.*?>/)) foundToken(stream.col, stream.col += m[0].length, \"directive\");\n        else if (stream.lookingAt(\"</\") && isNameStart(stream.peek(2))) {\n            let otag = $tags.pop();\n            if (otag) {\n                otag.inner.l2 = stream.line;\n                otag.inner.c2 = stream.col;\n                if (inline) $inline ^= inline.code(otag.id);\n            }\n            $parens.push({\n                line: stream.line,\n                c1: stream.col,\n                c2: stream.col + 2,\n                type: \"</\"\n            });\n            foundToken(stream.col, ++stream.col, \"xml-open-bracket\");\n            foundToken(stream.col, ++stream.col, \"xml-closetag-slash\");\n            let ctag = readName();\n            foundToken(ctag.c1, ctag.c2, otag && otag.id == ctag.id ? \"xml-close-tag\" : \"error\");\n            if (otag) {\n                let popen = {\n                    line: otag.line,\n                    c1: otag.c1,\n                    c2: otag.c2,\n                    type: otag.id,\n                    inner: otag.inner,\n                    outer: otag.outer\n                };\n                let pclose = {\n                    line: ctag.line,\n                    c1: ctag.c1,\n                    c2: ctag.c2,\n                    opened: popen\n                };\n                popen.closed = pclose;\n                $passedParens.push(popen);\n            }\n            $cont.push(readCloseBracket.bind(null, otag));\n        } else if (ch === \"<\" && isNameStart(stream.peek(1))) {\n            let outer = {\n                l1: stream.line,\n                c1: stream.col\n            };\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            foundToken(stream.col, ++stream.col, \"xml-open-bracket\");\n            let tag = readName();\n            tag.outer = outer;\n            foundToken(tag.c1, tag.c2, \"xml-open-tag\");\n            $inTag = tag;\n            $cont.push(readTag);\n        } else if (m = stream.lookingAt(/^&.*?;/)) {\n            foundToken(stream.col, ++stream.col, \"xml-entity-starter\");\n            foundToken(stream.col, stream.col += m[0].length - 2, \"xml-entity\");\n            foundToken(stream.col, ++stream.col, \"xml-entity-stopper\");\n        } else if (ch === \"&\") foundToken(stream.col, ++stream.col, \"error\");\n        else if (m = isOpenParen(ch)) {\n            $parens.push({\n                line: stream.line,\n                col: stream.col,\n                type: ch\n            });\n            foundToken(stream.col, ++stream.col, \"open-paren\", true);\n        } else if (m = isCloseParen(ch)) {\n            let p = $parens.pop();\n            if (!p || p.type != m) foundToken(stream.col, ++stream.col, \"error\");\n            else {\n                p.closed = {\n                    line: stream.line,\n                    col: stream.col,\n                    opened: p\n                };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\", true);\n            }\n        } else foundToken(stream.col, ++stream.col, null, ch != \" \");\n    }\n    function indentation() {\n        var indent, lastTag;\n        if ($inComment) indent = stream.lineIndentation($inComment.line) + INDENT_LEVEL();\n        else if ($inTag) {\n            var txt = stream.lineText($inTag.line);\n            if (/^\\s*$/.test(txt.substr(0, $inTag.c1 - 1))) indent = $inTag.c1 + $inTag.id.length + 1;\n            else indent = stream.lineIndentation($inTag.line);\n        } else if (lastTag = $tags.at(-1)) {\n            indent = stream.lineIndentation(lastTag.line) + INDENT_LEVEL();\n            // if current line begins with a closing tag, back one level\n            if (/^\\s*<\\x2f/.test(stream.lineText())) indent -= INDENT_LEVEL();\n        }\n        if (indent == null) {\n            let line = stream.line;\n            while(line > 0 && !/\\S/.test(stream.lineText(line)))line--;\n            indent = stream.lineIndentation(line);\n        }\n        return indent;\n    }\n    return PARSER;\n}\nfunction $3aa295d5c8d5089e$var$inlineCode(tag) {\n    return tag == \"i\" || tag == \"em\" ? 1 : tag == \"b\" || tag == \"strong\" ? 2 : tag == \"a\" ? 4 : tag == \"h1\" ? 8 : tag == \"h2\" ? 16 : tag == \"h3\" ? 32 : tag == \"h4\" ? 64 : 0;\n}\nfunction $3aa295d5c8d5089e$var$inlineCls(inline) {\n    let out = \"\";\n    if (inline & 1) out += \" italic\";\n    if (inline & 2) out += \" bold\";\n    if (inline & 4) out += \" link\";\n    if (inline & 8) out += \" heading1\";\n    if (inline & 16) out += \" heading2\";\n    if (inline & 32) out += \" heading3\";\n    if (inline & 64) out += \" heading4\";\n    return out.trim() || null;\n}\nfunction $3aa295d5c8d5089e$var$html_tokenizer(stream, tok) {\n    let $cont = [];\n    let $xml = tok.getLanguage(\"xml\", {\n        emptyTags: $3aa295d5c8d5089e$var$RX_EMPTY_TAG,\n        inline: {\n            code: $3aa295d5c8d5089e$var$inlineCode,\n            cls: $3aa295d5c8d5089e$var$inlineCls\n        }\n    });\n    let $js = tok.getLanguage(\"js\");\n    let $css = tok.getLanguage(\"css\");\n    let $mode = $xml;\n    let PARSER = {\n        next: next,\n        copy: copy,\n        get mode () {\n            return $mode === $xml ? \"markup\" : $mode === $css ? \"css\" : $mode === $js ? \"js\" : null;\n        },\n        get tags () {\n            return $xml.tags;\n        },\n        indentation: indentation\n    };\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0) return $cont.at(-1)();\n        if ($mode === $xml) {\n            let tag = $xml.tags.at(-1);\n            if (tag?.id == \"script\") $mode = $js;\n            else if (tag?.id == \"style\") $mode = $css;\n        }\n        if ($mode === $js) {\n            if (stream.lookingAt(\"</script\")) $mode = $xml;\n        }\n        if ($mode === $css) {\n            if (stream.lookingAt(\"</style\")) $mode = $xml;\n        }\n        $mode.next();\n    }\n    function copy() {\n        let _cont = [\n            ...$cont\n        ];\n        let _main = $xml.copy();\n        let _js = $js.copy();\n        let _css = $css.copy();\n        let _mode = $mode;\n        function resume() {\n            $cont = [\n                ..._cont\n            ];\n            $xml = _main();\n            $js = _js();\n            $css = _css();\n            $mode = _mode;\n            return PARSER;\n        }\n        resume.context = {\n            get passedParens () {\n                return [\n                    ..._main.context.passedParens,\n                    ..._js.context.passedParens,\n                    ..._css.context.passedParens\n                ];\n            },\n            get tags () {\n                return _main.context.tags;\n            }\n        };\n        return resume;\n    }\n    function indentation() {\n        if (/^\\s*<\\//.test(stream.lineText())) return $xml.indentation();\n        return $mode.indentation();\n    }\n    return PARSER;\n}\n(function() {\n    let Ymacs_Keymap_XML_Zen = (0, $d9a61832b63ddf79$export$6b6e17e3540cb3d2).define(\"xml_zen\", {\n        \"Tab\": \"xml_zen_next_poi\",\n        \"S-Tab\": \"xml_zen_prev_poi\",\n        \"C-g\": \"xml_zen_stop\"\n    });\n    var MODE_TYPE = 1, MODE_CLASS = 2, MODE_ID = 3, MODE_REPEAT = 4, MODE_ATTR = 5;\n    function zen_render(el, html) {\n        var n = el.repeat || 1;\n        for(var i = 1; i <= n; ++i){\n            if (i > 1) html(\"\\n\");\n            html(\"<\", el.type);\n            if (el.id) html(' id=\"', el.id.replace(/\\$/g, i), '\"');\n            if (el.klass) html(' class=\"', el.klass.replace(/\\$/g, i), '\"');\n            if (el.attributes) el.attributes.forEach((attr)=>html(\" \", attr, '=\"|\"'));\n            html(\">\");\n            if (el.child) {\n                html(\"\\n\");\n                zen_render(el.child, html);\n                html(\"\\n\");\n            } else html(\"|\");\n            html(\"</\", el.type, \">\");\n            if (el.next) {\n                html(\"\\n\");\n                zen_render(el.next, html);\n            }\n        }\n    }\n    function zen_parse(str, i) {\n        var el = {\n            type: \"\"\n        }, mode = MODE_TYPE;\n        OUTER: while(i < str.length){\n            var ch = str.charAt(i++);\n            switch(ch){\n                case \"#\":\n                    mode = MODE_ID;\n                    el.id = \"\";\n                    break;\n                case \".\":\n                    mode = MODE_CLASS;\n                    if (el.klass != null) el.klass += \" \";\n                    else el.klass = \"\";\n                    break;\n                case \":\":\n                    mode = MODE_ATTR;\n                    if (el.attributes == null) el.attributes = [];\n                    el.attributes.push(\"\");\n                    break;\n                case \"*\":\n                    mode = MODE_REPEAT;\n                    el.repeat = \"\";\n                    break;\n                case \">\":\n                    el.child = zen_parse(str, i);\n                    i = el.child.i;\n                    break OUTER;\n                case \"(\":\n                    el.child = zen_parse(str, i);\n                    i = el.child.i;\n                    break;\n                case \")\":\n                    break OUTER;\n                case \"+\":\n                    el.next = zen_parse(str, i);\n                    i = el.next.i;\n                    break OUTER;\n                default:\n                    switch(mode){\n                        case MODE_TYPE:\n                            el.type += ch;\n                            break;\n                        case MODE_CLASS:\n                            el.klass += ch;\n                            break;\n                        case MODE_ID:\n                            el.id += ch;\n                            break;\n                        case MODE_REPEAT:\n                            el.repeat = parseInt(String(el.repeat) + ch, 10);\n                            break;\n                        case MODE_ATTR:\n                            el.attributes.push(el.attributes.pop() + ch);\n                            break;\n                    }\n            }\n        }\n        el.i = i;\n        return el;\n    }\n    function maybe_stop_zen() {\n        var point = this.point(), a = this.getq(\"xml_zen_markers\"), start = a[0], end = a.at(-1);\n        if (point < start.getPosition() || point > end.getPosition() || end.getPosition() == a.at(-2).getPosition()) this.cmd(\"xml_zen_stop\");\n    }\n    (0, $5e779a545e33325b$export$df331bdfc76955b4).newCommands({\n        xml_close_tag: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            this.cmd(\"close_last_xml_tag\");\n            this.cmd(\"indent_line\");\n        }),\n        xml_slash_complete_tag: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            this.cmd(\"self_insert_command\");\n            if (this.looking_back(\"</\")) {\n                let rc = this._rowcol;\n                let parser = this.tokenizer.getParserForLine(rc.row, rc.col);\n                let ctx = parser.copy().context;\n                let tag = ctx.tags.at(-1);\n                if (tag) {\n                    this._placeUndoBoundary();\n                    this.cmd(\"insert\", tag.id, \">\");\n                    this.cmd(\"indent_line\");\n                }\n            }\n        }),\n        xml_gt_complete_tag: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            this.cmd(\"self_insert_command\");\n            let rc = this._rowcol;\n            let parser = this.tokenizer.getParserForLine(rc.row, rc.col);\n            let ctx = parser.copy().context;\n            let tag = ctx.tags.at(-1);\n            if (tag?.inner?.l1 == rc.row && tag.inner.c1 == rc.col) {\n                this._placeUndoBoundary();\n                let pos = this.point();\n                this.cmd(\"insert\", \"</\", tag.id, \">\");\n                this.cmd(\"goto_char\", pos);\n            }\n        }),\n        xml_zen_expand: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            this.cmd(\"xml_zen_stop\");\n            var html = \"\";\n            var start = this.cmd(\"save_excursion\", function() {\n                this.cmd(\"backward_whitespace\");\n                while(!this.cmd(\"looking_back\", /[\\x20\\xa0\\s\\t\\n;&]/g))if (!this.cmd(\"backward_char\")) break;\n                return this.point();\n            });\n            var point = this.point();\n            try {\n                zen_render(zen_parse(this.cmd(\"buffer_substring\", start, point).trim(), 0), (...args)=>html += args.join(\"\"));\n            } catch (ex) {\n                throw new (0, $541ef653595620bf$export$c411e7bd03572a3a)(\"The Zen is not strong today :-/\");\n            }\n            this.cmd(\"delete_region\", start, point);\n            this.cmd(\"insert\", html);\n            start = this.createMarker(start, false, \"xml_zen\");\n            // locate points of interest\n            var end = this.createMarker(this.point(), true, \"xml_zen\"), markers = [];\n            this.cmd(\"goto_char\", start.getPosition());\n            while(this.cmd(\"search_forward\", \"|\", end.getPosition())){\n                this.cmd(\"backward_delete_char\");\n                markers.push(this.createMarker(this.point(), true, \"xml_zen_start\"));\n                markers.push(this.createMarker(this.point(), false, \"xml_zen_end\"));\n            }\n            this.cmd(\"indent_region\", start.getPosition(), end.getPosition());\n            var count = markers.length;\n            if (count > 0) {\n                // move to first POI\n                this.cmd(\"goto_char\", markers[0]);\n                markers.unshift(start);\n                markers.push(end);\n                this.setq(\"xml_zen_markers\", markers);\n                this.pushKeymap(Ymacs_Keymap_XML_Zen);\n                this.addEventListener(\"afterInteractiveCommand\", maybe_stop_zen);\n            } else {\n                start.destroy();\n                end.destroy();\n            }\n        }),\n        xml_zen_stop: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            var tmp = this.getq(\"xml_zen_markers\");\n            if (tmp) {\n                tmp.map((m)=>m.destroy());\n                this.setq(\"xml_zen_markers\", null);\n            }\n            this.popKeymap(Ymacs_Keymap_XML_Zen);\n            this.removeEventListener(\"afterInteractiveCommand\", maybe_stop_zen);\n        }),\n        xml_zen_next_poi: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            let markers = this.getq(\"xml_zen_markers\"), pos = this.point();\n            for(let i = 0; i < markers.length; ++i){\n                let m = markers[i];\n                if (m.getPosition() > pos) {\n                    this.cmd(\"goto_char\", m.getPosition());\n                    break;\n                }\n            }\n        }),\n        xml_zen_prev_poi: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            let markers = this.getq(\"xml_zen_markers\"), pos = this.point();\n            for(let i = markers.length; --i >= 0;){\n                let m = markers[i];\n                if (m.getPosition() < pos) {\n                    this.cmd(\"goto_char\", m.getPosition());\n                    break;\n                }\n            }\n        }),\n        xml_newline_and_indent: (0, $92bab0a532b3076f$export$1c2a1b3d78098030)(function() {\n            let inparens = this.looking_at(\"</\") && this.looking_back(\">\");\n            this.cmd(\"newline_and_indent\");\n            if (inparens) {\n                this.cmd(\"newline_and_indent\");\n                this.cmd(\"backward_line\");\n                this.cmd(\"indent_line\");\n            }\n        })\n    });\n})();\n\n\n\n\n\n\n\nexport {$2f9db344d0795d0e$export$e2cc12c8ba83ca65 as Ymacs, $5e779a545e33325b$export$df331bdfc76955b4 as Ymacs_Buffer, $d9a61832b63ddf79$export$6b6e17e3540cb3d2 as Ymacs_Keymap, $2a60837ab2b03436$export$e144e07a20daa9d as Ymacs_Keymap_Emacs, $c749180882ef16eb$export$3964ae1c660db960 as Ymacs_Tokenizer, $92bab0a532b3076f$export$1c2a1b3d78098030 as Ymacs_Interactive, $541ef653595620bf$export$c411e7bd03572a3a as Ymacs_Exception};\n//# sourceMappingURL=ymacs.mjs.map\n","import { Ymacs } from \"./js/ymacs.js\";\nimport { Ymacs_Buffer } from \"./js/ymacs-buffer.js\";\nimport { Ymacs_Keymap } from \"./js/ymacs-keymap.js\";\nimport { Ymacs_Keymap_Emacs } from \"./js/ymacs-keymap-emacs.js\";\nimport { Ymacs_Tokenizer } from \"./js/ymacs-tokenizer.js\";\nimport { Ymacs_Interactive } from \"./js/ymacs-interactive.js\";\nimport { Ymacs_Exception } from \"./js/ymacs-exception.js\";\n\nimport \"./js/ymacs-commands.js\";\nimport \"./js/ymacs-commands-utils.js\";\nimport \"./js/ymacs-frame.js\";\nimport \"./js/ymacs-isearch.js\";\nimport \"./js/ymacs-marker.js\";\nimport \"./js/ymacs-minibuffer.js\";\nimport \"./js/ymacs-mode-css.js\";\nimport \"./js/ymacs-mode-js.js\";\nimport \"./js/ymacs-mode-lisp.js\";\nimport \"./js/ymacs-mode-markdown.js\";\nimport \"./js/ymacs-mode-paren-match.js\";\nimport \"./js/ymacs-mode-xml.js\";\nimport \"./js/ymacs-popup.js\";\nimport \"./js/ymacs-textprop.js\";\nimport \"./js/ymacs-utils.js\";\n\nexport { Ymacs, Ymacs_Buffer, Ymacs_Keymap,\n         Ymacs_Keymap_Emacs, Ymacs_Tokenizer,\n         Ymacs_Interactive, Ymacs_Exception };\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { DOM, Widget, remove } from \"./ymacs-utils.js\";\nimport { Ymacs_Buffer, Ymacs_Minibuffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Popup } from \"./ymacs-popup.js\";\nimport { Ymacs_Frame, Ymacs_SplitCont } from \"./ymacs-frame.js\";\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\n\nfunction minElement(array, f, obj, remove) {\n    if (array.length == 0)\n        return null;\n    var i = 0, minEl = array[0], minValue = f.call(obj, minEl), minIndex = 0, tmp;\n    while (++i < array.length) if ((tmp = f.call(obj, array[i])) < minValue) {\n        minValue = tmp;\n        minIndex = i;\n        minEl = array[i];\n    }\n    if (remove)\n        array.splice(minIndex, 1);\n    return minEl;\n}\n\nfunction selectClosestFrameX(byx, pos) {\n    if (byx.length > 0) {\n        var x = byx.at(-1).getBox().left, a = [ byx.pop() ];\n        while (byx.length > 0 && byx.at(-1).getBox().left == x)\n            a.push(byx.pop());\n        return minElement(a, function(f){\n            return Math.abs(pos.top - f.getBox().top - f.getBox().height/2);\n        });\n    }\n}\n\nfunction selectClosestFrameY(byy, pos) {\n    if (byy.length > 0) {\n        var y = byy.at(-1).getBox().top, a = [ byy.pop() ];\n        while (byy.length > 0 && byy.at(-1).getBox().top == y)\n            a.push(byy.pop());\n        return minElement(a, function(f){\n            return Math.abs(pos.left - f.getBox().left - f.getBox().width/2);\n        });\n    }\n}\n\nfunction ensureLocalStorage() {\n    if (!(window.localStorage && window.localStorage.getItem))\n        throw new Ymacs_Exception(\"Local storage facility not available in this browser\");\n}\n\nexport class Ymacs extends Widget {\n\n    static options = {\n        buffers       : [],\n        frames        : [],\n        cf_frameStyle : Object.create(null),\n    };\n\n    constructor(...args) {\n        super(...args);\n\n        this.buffers = [...this.o.buffers];\n        this.frames = [...this.o.frames];\n        this.cf_frameStyle = {...this.o.cf_frameStyle};\n\n        this.buffers.forEach(b => {\n            b.ymacs = this;\n            this._addBufferListeners(b);\n        });\n\n        /* -----[ variables ]----- */\n        this.killRing = [];\n        this.killMasterOfRings = [];\n        this.progress = {};\n\n        /* -----[ macro vars ]----- */\n        // If present, keystrokes are stored in this list.\n        this.__macro_recording = null;\n        // This is the macro executed by C-x e and named by\n        // name-last-kbd-macro.\n        this.__macro_finished = null;\n        // Set when any buffer does signalError.  Tells us when to abort\n        // running a macro.\n        this.__error_thrown = false;\n        // A list if we're executing a macro.\n        this.__running_macro = null;\n        // A number of times to execute the current macro.\n        this.__macro_times = 0;\n        // Macro current step\n        this.__macro_step = 0;\n        // Timer for the macro\n        this.__macro_timer = null;\n        // Unbiased active frame\n        this.__input_frame = null;\n\n        /* -----[ minibuffer ]----- */\n        this.minibuffer = new Ymacs_Minibuffer({ ymacs: this });\n        this.minibuffer.cmd(\"minibuffer_mode\");\n        this.minibuffer_frame = this.createFrame({\n            isMinibuffer         : true,\n            buffer               : this.minibuffer,\n            hidden               : true,\n            highlightCurrentLine : false,\n        });\n\n        /* -----[ main content ]----- */\n        if (this.buffers.length == 0)\n            this.createBuffer();\n\n        var frame = this.createFrame({ buffer: this.buffers[0] });\n\n        this.add(frame);\n        this.add(this.minibuffer_frame);\n\n        this.setActiveFrame(frame);\n        frame.redrawCaret();\n    }\n\n    initClassName() {\n        return \"Ymacs Ymacs-cursor-block\";\n    }\n\n    _addBufferListeners(buf) {\n        buf.addEventListener(\"onDestroy\", () => {\n            var fr = this.getActiveFrame();\n            this.getBufferFrames(buf).forEach(f => {\n                if (f !== fr) {\n                    this.deleteFrame(f);\n                }\n            });\n            remove(this.buffers, buf);\n            if (this.getActiveBuffer() === buf)\n                this.nextHiddenBuffer(buf);\n        });\n    }\n\n    pushToKillRing(text, prepend) {\n        prepend ? this.killRing.unshift(text)\n            : this.killRing.push(text);\n    }\n\n    killRingToMaster() {\n        if (this.killRing.length && (this.killMasterOfRings.length == 0 ||\n                                     this.killMasterOfRings.at(-1).join(\"\") != this.killRing.join(\"\")))\n            this.killMasterOfRings.push(this.killRing);\n        this.killRing = [];\n    }\n\n    killRingText() {\n        return this.killRing.join(\"\");\n    }\n\n    rotateKillRing(push) {\n        if (push) {\n            this.killMasterOfRings.push(this.killRing);\n            this.killRing = this.killMasterOfRings.shift();\n        } else {\n            this.killMasterOfRings.unshift(this.killRing);\n            this.killRing = this.killMasterOfRings.pop();\n        }\n    }\n\n    getBuffer(buf) {\n        if (!(buf instanceof Ymacs_Buffer)) {\n            buf = this.buffers.find(b => b.name == buf);\n        }\n        return buf;\n    }\n\n    killBuffer(buf) {\n        buf = this.getBuffer(buf);\n        this.callHooks(\"onDeleteBuffer\", buf);\n        buf.destroy();\n    }\n\n    renameBuffer(buf, name) {\n        buf = this.getBuffer(buf);\n        buf.name = name;\n        buf.callHooks(\"onProgressChange\");\n    }\n\n    _do_switchToBuffer(buf) {\n        this.getActiveFrame().setBuffer(buf);\n        this.callHooks(\"onBufferSwitch\", buf);\n    }\n\n    switchToBuffer(maybeName) {\n        var buf = this.getBuffer(maybeName), a = this.buffers;\n        if (!buf) {\n            // create new buffer\n            buf = this.createBuffer({ name: maybeName });\n        }\n        remove(a, buf);\n        a.unshift(buf);\n        this._do_switchToBuffer(buf);\n        return buf;\n    }\n\n    nextHiddenBuffer(cur) {\n        var a = this.buffers.filter(buf => {\n            if (buf === cur) return false;\n            var hidden = true;\n            buf.forAllFrames(() => hidden = false);\n            return hidden;\n        });\n        if (a.length > 0) {\n            var buf = a[0];\n            remove(this.buffers, buf);\n            this.buffers.push(buf);\n            this._do_switchToBuffer(buf);\n        } else {\n            this.switchToBuffer(\"*scratch*\");\n        }\n    }\n\n    switchToNextBuffer() {\n        var a = this.buffers;\n        if (a.length > 1) {\n            var buf = a.shift();\n            a.push(buf);\n            this._do_switchToBuffer(a[0]);\n        }\n    }\n\n    switchToPreviousBuffer() {\n        var a = this.buffers;\n        if (a.length > 1) {\n            var buf = a.pop();\n            a.unshift(buf);\n            this._do_switchToBuffer(buf);\n        }\n    }\n\n    getNextBuffer(buf, n) {\n        if (n == null) n = 1;\n        var a = this.buffers;\n        return a[(a.indexOf(buf) + n) % a.length];\n    }\n\n    getPrevBuffer(buf, n) {\n        if (n == null) n = 1;\n        return this.getNextBuffer(buf, -n);\n    }\n\n    getBufferFrames(buf) {\n        buf = this.getBuffer(buf);\n        return this.frames.filter(f => f.buffer === buf);\n    }\n\n    createBuffer(args) {\n        args = Object.assign({}, args, { ymacs: this });\n        var buf = new Ymacs_Buffer(args);\n        this._addBufferListeners(buf);\n        if (!args.hidden)\n            this.buffers.push(buf);\n        this.callHooks(\"onCreateBuffer\", buf);\n        return buf;\n    }\n\n    createFrame(args) {\n        args = Object.assign({}, args, { ymacs: this });\n        var frame = new Ymacs_Frame(args);\n        if (!args.hidden)\n            this.frames.unshift(frame);\n        frame.setStyle(this.cf_frameStyle);\n        return frame;\n    }\n\n    setFrameStyle(style) {\n        [ this.minibuffer_frame, ...this.frames ].forEach(frame => frame.setStyle(style));\n    }\n\n    keepOnlyFrame(frame) {\n        if (this.frames.length > 1) {\n            let el = frame.getElement();\n            while (el.parentNode != this.getContentElement())\n                el = el.parentNode;\n            if (el !== frame) {\n                el.replaceWith(frame.getElement());\n                this.setActiveFrame(frame);\n                frame.centerOnCaret();\n                this.frames = [ frame ];\n            }\n        }\n    }\n\n    deleteFrame(frame) {\n        if (this.frames.length > 1) {\n            remove(this.frames, frame);\n            let parent = frame.getElement().parentNode;\n            let other = [...parent.children].find(el => {\n                let obj = el._ymacs_object;\n                return obj instanceof Ymacs_SplitCont\n                    || (obj instanceof Ymacs_Frame && obj !== frame);\n            });\n            parent.replaceWith(other);\n            if (!DOM.hasClass(other, \"Ymacs_Frame\")) {\n                other = other.querySelector(\".Ymacs_Frame\");\n            }\n            other = other._ymacs_object;\n            this.setActiveFrame(other);\n            other.centerOnCaret();\n        }\n    }\n\n    focusOtherFrame() {\n        this.setActiveFrame(this.frames[0]);\n    }\n\n    focus() {\n        this.frames.at(-1).focus();\n    }\n\n    setInputFrame(frame) {\n        this.__input_frame = frame;\n    }\n\n    setActiveFrame(frame, nofocus) {\n        if (!frame.isMinibuffer) {\n            var old = this.getActiveFrame();\n            if (old) {\n                old.delClass(\"Ymacs_Frame-active\");\n            }\n            remove(this.frames, frame);\n            this.frames.push(frame);\n            frame.addClass(\"Ymacs_Frame-active\");\n        }\n        this.__input_frame = frame;\n        if (!nofocus)\n            frame.focus();\n    }\n\n    getActiveFrame() {\n        return this.frames.at(-1);\n    }\n\n    getActiveBuffer() {\n        var frame = this.getActiveFrame();\n        return frame ? frame.buffer : this.buffers.at(-1);\n    }\n\n    setColorTheme(themeId) {\n        this.delClass(/Ymacs-Theme-[^\\s]*/g);\n        if (!(themeId instanceof Array))\n            themeId = [ themeId ];\n        themeId.forEach(themeId => {\n            this.addClass(\"Ymacs-Theme-\" + themeId);\n        });\n    }\n\n    getFrameInDirection(dir) {\n        let frame = this.getActiveFrame();\n        let caret = frame.getCaretElement();\n        let box = caret.getBoundingClientRect();\n        var byx = [...this.frames].sort((a, b) => a.getBox().left - b.getBox().left);\n        var byy = [...this.frames].sort((a, b) => a.getBox().top - b.getBox().top);\n        return this[\"_get_frameInDir_\" + dir](byx, byy, box, frame);\n    }\n\n    _get_frameInDir_left(byx, byy, pos, frame) {\n        byx = byx.filter(f => {\n            let p = f.getBox();\n            return (f !== frame) && (p.left < pos.left) && (p.top - pos.height <= pos.top) && (p.top + p.height > pos.top);\n        });\n        return selectClosestFrameX(byx, pos);\n    }\n\n    _get_frameInDir_right(byx, byy, pos, frame) {\n        byx.reverse();\n        byx = byx.filter(f => {\n            let p = f.getBox();\n            return (f !== frame) && (p.left > pos.left) && (p.top - pos.height <= pos.top) && (p.top + p.height > pos.top);\n        });\n        return selectClosestFrameX(byx, pos);\n    }\n\n    _get_frameInDir_up(byx, byy, pos, frame) {\n        byy = byy.filter(f => {\n            let p = f.getBox();\n            return (f !== frame) && (p.top < pos.top) && (p.left - pos.width <= pos.left) && (p.left + p.width > pos.left);\n        });\n        return selectClosestFrameY(byy, pos);\n    }\n\n    _get_frameInDir_down(byx, byy, pos, frame) {\n        byy.reverse();\n        byy = byy.filter(f => {\n            let p = f.getBox();\n            return (f !== frame) && (p.top > pos.top) && (p.left - pos.width <= pos.left) && (p.left + p.width > pos.left);\n        });\n        return selectClosestFrameY(byy, pos);\n    }\n\n    /* -----[ local storage ]----- */\n\n    ls_get() {\n        ensureLocalStorage();\n        return JSON.parse(localStorage.getItem(\".ymacs\") || \"{}\");\n    }\n\n    ls_set(src) {\n        ensureLocalStorage();\n        localStorage.setItem(\".ymacs\", JSON.stringify(src));\n    }\n\n    ls_getFileContents(name, nothrow) {\n        var info = this.ls_getFileDirectory(name), other = info.other, code;\n        if (other.length == 1) {\n            code = info.dir[other[0]];\n        }\n        if (code == null && !nothrow) {\n            throw new Ymacs_Exception(\"File not found\");\n        }\n        return code;\n    }\n\n    ls_setFileContents(name, content) {\n        var files = this.ls_getFileDirectory(name, \"file\");\n        files.dir[files.other[0]] = content;\n        this.ls_set(files.store);\n    }\n\n    ls_getFileDirectory(name, create) {\n        var store, dir = store = this.ls_get(), back = [];\n        name = name.replace(/^[~\\x2f]+/, \"\").split(/\\x2f+/);\n        var path = [], other = [];\n        while (name.length > 0) {\n            var part = name.shift();\n            if (part == \".\") continue;\n            if (part == \"..\") {\n                path.pop();\n                dir = back.pop();\n            }\n            else if (part == \"~\") {\n                path = [];\n                other = [];\n                back = [];\n                dir = store;\n            }\n            else if (dir.hasOwnProperty(part) && (typeof dir[part] != \"string\")) {\n                back.push(dir);\n                dir = dir[part];\n                path.push(part);\n            }\n            else {\n                other.push(part);\n            }\n        }\n        if (create) {\n            var n = create == \"file\" ? 1 : 0;\n            while (other.length > n) {\n                dir = dir[other.shift()] = {};\n            }\n            this.ls_set(store);\n        }\n        return {\n            store : store,\n            dir   : dir,\n            path  : path,\n            other : other,\n            full  : path.concat(other).join(\"/\")\n        };\n    }\n\n    ls_deleteFile(name) {\n        var info = this.ls_getFileDirectory(name);\n        delete info.dir[info.other.join(\"/\")];\n        this.ls_set(info.store);\n    }\n\n    /* -----[ filesystem operations ]----- */\n\n    fs_normalizePath(path) {\n        path = path.replace(/^[~\\x2f]+/, \"\").split(/\\x2f+/);\n        var ret = [];\n        while (path.length > 0) {\n            var x = path.shift();\n            if (x != \".\") {\n                if (x == \"..\") {\n                    ret.pop();\n                } else if (x == \"~\") {\n                    ret = [];\n                } else {\n                    ret.push(x);\n                }\n            }\n        }\n        return ret.join(\"/\");\n    }\n\n    fs_fileType(name, cont) {\n        try {\n            this.ls_getFileContents(name);\n            cont(true);\n        } catch(ex) {\n            cont(null);\n        }\n    }\n\n    fs_getFileContents(name, nothrow, cont) {\n        var code = this.ls_getFileContents(name, nothrow);\n        cont(code, code); // second parameter is file stamp, on a real fs it should be last modification time\n    }\n\n    fs_setFileContents(name, content, stamp, cont) {\n        if (stamp && (this.ls_getFileContents(name, true) || \"\") != stamp) {\n            cont(null); // did not change file because stamp is wrong\n        } else {\n            this.ls_setFileContents(name, content);\n            cont(content);\n        }\n    }\n\n    fs_getDirectory(dirname, cont) {\n        var info = this.ls_getFileDirectory(dirname, false);\n        dirname = info.path.join(\"/\"); // normalized\n        if (info) {\n            var files = {};\n            for (var f in info.dir) {\n                if (Object.hasOwn(info.dir, f)) {\n                    files[f] = {\n                        name : f,\n                        path : dirname + \"/\" + f,\n                        type : typeof info.dir[f] == \"string\" ? \"regular\" : \"directory\"\n                    };\n                }\n            }\n            cont(files);\n        } else {\n            cont(null);\n        }\n    }\n\n    fs_deleteFile(name, cont) {\n        this.ls_deleteFile(name);\n        cont();\n    }\n\n    fs_remapDir(dir, cont) {\n        cont(dir);\n    }\n\n    isRunningMacro() {\n        return !!this.__running_macro;\n    }\n\n    isRecordingMacro() {\n        return !!this.__macro_recording;\n    }\n\n    indicateError() {\n        this.__error_thrown = true;\n    }\n\n    startMacro(do_append) {\n        if (this.isRecordingMacro())\n            return false;\n        if (do_append) {\n            this.__macro_recording = this.__macro_finished || [];\n            this.__macro_finished = null;\n        } else\n            this.__macro_recording = [];\n        return true;\n    }\n\n    stopMacro() {\n        if (this.__macro_recording) {\n            this.__macro_finished = this.__macro_recording;\n            this.__macro_recording = null;\n        }\n    }\n\n    getLastMacro() {\n        return this.__macro_finished;\n    }\n\n    stepMacro() {\n        while (true) {\n            if (this.__macro_step >= this.__running_macro.length) {\n                this.__macro_times--;\n                this.__macro_step = 0;\n            }\n            if (this.__macro_times == 0 || this.__error_thrown) {\n                this.__macro_times = 0;\n                this.__macro_step = 0;\n                this.__running_macro = null;\n                return;\n            }\n            var ev = this.__running_macro[this.__macro_step];\n            this.processKeyEvent(ev);\n            this.__macro_step++;\n        }\n    }\n\n    runMacro(times, macro) {\n        if (this.isRecordingMacro())\n            return false;\n        this.__error_thrown = false;\n        this.__running_macro = macro;\n        this.__macro_step = 0;\n        this.__macro_times = times;\n        var self = this;\n        setTimeout(function() { self.stepMacro(); }, 0);\n        return true;\n    }\n\n    processKeyEvent(ev) {\n        var frame = this.__input_frame;\n        var buffer = frame.buffer;\n\n        if (this.__macro_recording) {\n            this.__macro_recording.push(ev);\n        }\n        return buffer._handleKeyEvent(ev);\n    }\n\n    #timer_popupMessage = null;\n    popupMessage({\n        type = \"info\",\n        text,\n        isHtml = false,\n        atCaret = false,\n        timeout\n    }) {\n        let popup = this.__popup || (this.__popup = new Ymacs_Popup());\n        let el = popup.getElement();\n        popup.condClass(atCaret, \"with-arrow\");\n        if (!atCaret) {\n            el.style.removeProperty(\"left\");\n            el.style.removeProperty(\"top\");\n            el.style.removeProperty(\"bottom\");\n            el.style.removeProperty(\"right\");\n            el.style.removeProperty(\"transform\");\n        }\n        if (!isHtml) {\n            text = DOM.htmlEscape(text);\n        }\n        popup.setContent(text);\n        if (atCaret) {\n            this._popupAtCaret(popup.getElement());\n        } else {\n            this.add(popup);\n        }\n        clearTimeout(this.#timer_popupMessage);\n        if (timeout) {\n            this.#timer_popupMessage = setTimeout(this.clearPopupMessage.bind(this), timeout);\n        }\n    }\n\n    clearPopupMessage() {\n        if (this.__popup) {\n            this.__popup.getElement().remove();\n        }\n    }\n\n    requestFullScreen() {\n        return this.getElement().requestFullscreen();\n    }\n\n    _popupAtCaret(el) {\n        el.style.visibility = \"hidden\";\n        DOM.delClass(el, /ppos-[a-z-]+/ig);\n        this.add(el);\n        let mybox = this.getElement().getBoundingClientRect();\n        let caret = this.__input_frame.getCaretElement();\n        let cbox = caret.getBoundingClientRect();\n        let cbox_center = { x: (cbox.left + cbox.right) / 2,\n                            y: (cbox.top + cbox.bottom) / 2 };\n        let mybox_center = { x: (mybox.left + mybox.right) / 2,\n                             y: (mybox.top + mybox.bottom) / 2 };\n        if (cbox_center.y > mybox_center.y) {\n            if (cbox_center.x < mybox_center.x) {\n                DOM.addClass(el, \"ppos-top-right\");\n                el.style.transform = `translate(0, calc(-100% - ${cbox.height / 2}px))`;\n            } else {\n                DOM.addClass(el, \"ppos-top-left\");\n                el.style.transform = `translate(-100%, calc(-100% - ${cbox.height / 2}px))`;\n            }\n        } else {\n            if (cbox_center.x < mybox_center.x) {\n                DOM.addClass(el, \"ppos-bot-right\");\n                el.style.transform = `translate(0, ${cbox.height / 2}px)`;\n            } else {\n                DOM.addClass(el, \"ppos-bot-left\");\n                el.style.transform = `translate(-100%, ${cbox.height / 2}px)`;\n            }\n        }\n        el.style.left = (cbox_center.x - mybox.left) + \"px\";\n        el.style.top = (cbox_center.y - mybox.top) + \"px\";\n        el.style.removeProperty(\"visibility\");\n    }\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nlet TEMPLATE = document.createElement(\"template\");\nlet OVERLAY;\n\nexport let DOM = {\n    fromHTML(html) {\n        TEMPLATE.innerHTML = html.trim();\n        let cont = TEMPLATE.content;\n        return cont.children.length > 1 ? cont : cont.children[0];\n    },\n    addClass(el, cls) {\n        el.classList.add(cls);\n    },\n    delClass(el, cls) {\n        if (cls instanceof RegExp) {\n            el.className = el.className.replace(cls, \"\");\n        } else {\n            el.classList.remove(cls);\n        }\n    },\n    hasClass(el, cls) {\n        return el.classList.contains(cls);\n    },\n    condClass(el, cond, clsTrue, clsFalse) {\n        el.classList.toggle(clsTrue, !!cond);\n        if (clsFalse) {\n            el.classList.toggle(clsFalse, !cond);\n        }\n    },\n    toggleClass(el, ...args) {\n        el.classList.toggle(...args);\n    },\n    trash(el) {\n        el && el.remove();\n    },\n    on(element, event, handler, options) {\n        if (typeof event == \"string\") {\n            element.addEventListener(event, handler, options || {});\n        } else {\n            Object.keys(event).forEach(ev => DOM.on(element, ev, event[ev], handler || {}));\n        }\n    },\n    off(element, event, handler, options) {\n        if (typeof event == \"string\") {\n            element.removeEventListener(event, handler, options || {});\n        } else {\n            Object.keys(event).forEach(ev => DOM.off(element, ev, event[ev], handler || {}));\n        }\n    },\n    overlayOn(cls) {\n        document.body.appendChild(OVERLAY);\n        if (cls) {\n            OVERLAY.className = cls;\n        }\n        return OVERLAY;\n    },\n    overlayOff() {\n        OVERLAY.remove();\n    },\n    mousePos(ev, el) {\n        let box = el.getBoundingClientRect();\n        return {\n            x: ev.clientX - box.left,\n            y: ev.clientY - box.top\n        };\n    },\n    htmlEscape: function(str) {\n        return (str+\"\").replace(/&/g, \"&amp;\")\n            .replace(/\\x22/g, \"&quot;\")\n            .replace(/\\x27/g, \"&#x27;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\")\n            .replace(/\\u00A0/g, \"&#xa0;\");\n    },\n};\n\nOVERLAY = DOM.fromHTML(`<div style=\"position: fixed; z-index: 20000; left: 0; top: 0; right: 0; bottom: 0\"></div>`);\n\nexport class EventProxy {\n    constructor(options) {\n        this._ev_handlers = Object.create(null);\n        this.o = Object.assign(Object.create(this.constructor.options || null), options);\n    }\n    addEventListener(event, handler) {\n        if (typeof event == \"string\") {\n            let a = this._getHandlers(event);\n            remove(a, handler);\n            a.push(handler);\n        } else {\n            Object.keys(event).forEach(ev => this.addEventListener(ev, event[ev]));\n        }\n    }\n    removeEventListener(event, handler) {\n        if (typeof event == \"string\") {\n            remove(this._getHandlers(event), handler);\n        } else {\n            Object.keys(event).forEach(ev => this.removeEventListener(ev, event[ev]));\n        }\n    }\n    listenOnce(event, handler) {\n        this.addEventListener(event, function fn(...args) {\n            this.removeEventListener(event, fn);\n            return handler.apply(this, args);\n        });\n    }\n    callHooks(ev, ...args) {\n        this._getHandlers(ev).forEach(f => f.apply(this, args));\n    }\n    destroy() {\n        this.callHooks(\"onDestroy\");\n    }\n    _getHandlers(ev) {\n        return this._ev_handlers[ev] || (this._ev_handlers[ev] = []);\n    }\n}\n\nexport class Widget extends EventProxy {\n    constructor(...args) {\n        super(...args);\n        this.createElement();\n    }\n    createElement() {\n        let el = document.createElement(\"div\");\n        el.className = this.initClassName();\n        el._ymacs_object = this;\n        this.el = el;\n        return el;\n    }\n    initClassName() {\n        return this.constructor.name; // XXX: fail after minification\n    }\n    getContentElement() {\n        return this.el;\n    }\n    getElement() {\n        return this.el;\n    }\n    add(thing) {\n        if (thing instanceof Widget) {\n            thing = thing.getElement();\n        }\n        this.getContentElement().appendChild(thing);\n    }\n    addClass(cls) {\n        DOM.addClass(this.getElement(), cls);\n    }\n    delClass(cls) {\n        DOM.delClass(this.getElement(), cls);\n    }\n    hasClass(cls) {\n        return DOM.hasClass(this.getElement(), cls);\n    }\n    condClass(cond, clsTrue, clsFalse) {\n        DOM.condClass(this.getElement(), cond, clsTrue, clsFalse);\n    }\n    toggleClass(...args) {\n        DOM.toggleClass(this.getElement(), ...args);\n    }\n    setContent(cont) {\n        this.getContentElement().innerHTML = cont;\n    }\n    setStyle(prop, val) {\n        let style = this.getElement().style;\n        if (typeof prop == \"string\") {\n            style[prop] = val;\n        } else {\n            Object.assign(style, prop);\n        }\n    }\n    getBox() {\n        return this.getElement().getBoundingClientRect();\n    }\n    destroy() {\n        DOM.trash(this.getElement());\n        super.destroy(...arguments);\n    }\n}\n\nexport function remove(array, element) {\n    let pos = 0;\n    while ((pos = array.indexOf(element, pos)) >= 0) {\n        array.splice(pos, 1);\n    }\n}\n\nexport function delayed(fn, timeout = 0, obj, ...args) {\n    if (arguments.length > 2) {\n        fn = fn.bind(obj, ...args);\n    }\n    let timer = null;\n    return function() {\n        clearTimeout(timer);\n        timer = setTimeout(fn, timeout);\n    };\n}\n\nvar $1K = 1024, $1M = $1K * 1024, $1G = $1M * 1024, $1T = $1G * 1024;\nexport function formatBytes(number, fixed) {\n    var sz = number, spec, r;\n    if (sz < $1K) {\n        spec = \"B\";\n    } else if (sz < $1M) {\n        sz /= $1K;\n        spec = \"K\";\n    } else if (sz < $1G) {\n        sz /= $1M;\n        spec = \"M\";\n    } else if (sz < $1T) {\n        sz /= $1G;\n        spec = \"G\";\n    }\n    // spec = \"\" + spec;\n    r = Math.round(sz);\n    if (fixed && sz != r)\n        return sz.toFixed(fixed) + spec;\n    else\n        return r + spec;\n}\n\nexport function zeroPad(thing, width, zero = \"0\") {\n    if (typeof thing == \"number\") {\n        thing = Math.round(thing);\n    }\n    var s = \"\" + thing;\n    while (s.length < width)\n        s = zero + s;\n    return s;\n}\n\nexport function common_prefix(strings) {\n    switch (strings.length) {\n      case 0:\n        return \"\";\n      case 1:\n        return strings[0];\n      case 2:\n        let a = strings[0];\n        let b = strings[1];\n        let n = Math.min(a.length, b.length);\n        let i = 0;\n        while (i < n && a.charAt(i) === b.charAt(i)) ++i;\n        return a.substring(0, i);\n      default:\n        return common_prefix([ strings[0], common_prefix(strings.slice(1)) ]);\n    }\n}\n\nexport function getYmacsThemes() {\n    let themes = [];\n    for (let st of document.styleSheets) digStyle(st);\n    return themes;\n\n    function digStyle(st) {\n        for (let rule of st.cssRules) digRule(rule);\n    }\n\n    function digRule(rule) {\n        if (rule instanceof CSSImportRule) {\n            digStyle(rule.styleSheet);\n        } else {\n            let m = /\\.Ymacs-Theme-([\\p{L}0-9_-]+)/u.exec(rule.selectorText);\n            if (m) {\n                if (themes.indexOf(m[1]) < 0) {\n                    themes.push(m[1]);\n                }\n            }\n        }\n    }\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Marker } from \"./ymacs-marker.js\";\nimport { DOM, EventProxy, remove, delayed, formatBytes } from \"./ymacs-utils.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { Ymacs_Keymap_Emacs, Ymacs_Keymap_Minibuffer } from \"./ymacs-keymap-emacs.js\";\nimport { Ymacs_Text_Properties } from \"./ymacs-textprop.js\";\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\nlet GLOBAL_VARS = {\n    case_fold_search            : null,\n    case_replace                : true,\n    line_movement_requested_col : 0,\n    fill_column                 : 78,\n    tab_width                   : 8,\n    indent_level                : 4,\n    sticky_mark                 : false,\n\n    // syntax variables\n    syntax_word                 : /^[\\p{N}\\p{L}]$/u,\n    syntax_capitalize_word      : /([\\p{N}\\p{L}])([\\p{N}\\p{L}]*)/ug,\n    syntax_word_dabbrev         : /^[\\p{N}_$\\p{L}]$/u,\n    syntax_word_sexp            : /^[\\p{N}_$\\p{L}]$/u,\n    syntax_paragraph_sep        : /\\n(?:[^\\S\\r\\n]*\\n)+/g,\n};\n\nconst MAX_UNDO_RECORDS = 50000; // XXX: should we not limit?\n\nfunction setq(key, val) {\n    if (typeof key == \"string\") {\n        if (val === undefined)\n            delete this[key];\n        else\n            this[key] = val;\n        if (val instanceof Function)\n            val.ymacsCommand = key;\n        return val;\n    } else {\n        var changed = Object.create(null);\n        for (var i in key) {\n            changed[i] = this[i];\n            setq.call(this, i, key[i]);\n        }\n        return changed;\n    }\n}\n\nfunction MRK(x) {\n    return x instanceof Ymacs_Marker ? x.getPosition() : x;\n}\n\nexport class Ymacs_Buffer extends EventProxy {\n\n    static options = {\n        name         : \"*scratch*\",\n        code         : \"\",\n        ymacs        : null,\n        tokenizer    : null,\n    };\n\n    static COMMANDS = Object.create(null);\n\n    static newCommands(...args) {\n        return setq.apply(this.COMMANDS, args);\n    }\n\n    static replaceCommands(cmds) {\n        this.COMMANDS = Object.assign(Object.create(null), this.COMMANDS);\n        let replacements = Object.create(null);\n        Object.keys(cmds).forEach(oldcmd => {\n            let newcmd = cmds[oldcmd];\n            if (typeof newcmd == \"string\") {\n                newcmd = this.COMMANDS[newcmd];\n            }\n            replacements[oldcmd] = newcmd;\n        });\n        return this.newCommands(replacements);\n    }\n\n    static newMode(name, activate) {\n        let modevar = \"*\" + name + \"*\", hookvar = modevar + \"hooks\";\n        Ymacs_Buffer.setGlobal(hookvar, []);\n        this.COMMANDS[name] = Ymacs_Interactive(\"P\", function(force){\n            let status = this.getq(modevar);\n            if (status) {\n                // currently active\n                if (force !== true) {\n                    // deactivate\n                    this.getq(hookvar).forEach(hook => hook.call(this, false));\n                    if (status instanceof Function) {\n                        // clean-up\n                        status.call(this);\n                    }\n                    this.setq(modevar, null);\n                    remove(this.modes, name);\n                }\n            }\n            else {\n                // inactive\n                if (force !== false) {\n                    let off = activate.apply(this, arguments);\n                    if (!(off instanceof Function))\n                        off = true;\n                    this.setq(modevar, off);\n                    this.modes.push(name);\n                    this.getq(hookvar).forEach(hook => hook.call(this, true));\n                }\n            }\n            return status;\n        });\n    }\n\n    static getVariable(key) {\n        return GLOBAL_VARS[key];\n    }\n\n    static setVariable() {\n        return setq.apply(GLOBAL_VARS, arguments);\n    }\n\n    constructor(...args) {\n        super(...args);\n\n        this.isMinibuffer = this instanceof Ymacs_Minibuffer;\n        this.COMMANDS = Object.assign(Object.create(null), this.COMMANDS);\n        this.name = this.o.name;\n        this.ymacs = this.o.ymacs;\n        this.tokenizer = this.o.tokenizer;\n\n        this.__savingExcursion = 0;\n        this.__preventUpdates = 0;\n        this.__preventUndo = 0;\n        this.__undoInProgress = 0;\n        this.__dirtyLines = [];\n        this.__undoQueue = [];\n        this.__undoPointer = 0;\n\n        this.markers = [];\n        this.caretMarker = this.createMarker(0, false, \"point\");\n        this.markMarker = this.createMarker(0, true, \"mark\");\n        this.matchData = [];\n        this.previousCommand = null;\n        this.currentCommand = null;\n        this.currentKeys = [];\n        this.progress = Object.create(null);\n\n        this.variables = Object.create(null);\n        this.globalVariables = GLOBAL_VARS;\n        this.modes = [];\n\n        this.caretMarker.onChange.push(function(pos) {\n            this._rowcol = this.caretMarker.getRowCol();\n            // XXX: this shouldn't be needed\n            if (!this.__preventUpdates) {\n                this.callHooks(\"onPointChange\", this._rowcol, this.point());\n            }\n        });\n\n        this._tokenizerEvents = {\n            \"onFoundToken\": this._on_tokenizerFoundToken.bind(this)\n        };\n\n        this._textProperties = new Ymacs_Text_Properties({ buffer: this });\n        this._textProperties.addEventListener(\"onChange\", this._on_textPropertiesChange.bind(this));\n\n        this.keymap = [];\n        this.pushKeymap(this.makeDefaultKeymap());\n        this.setCode(this.o.code);\n        this._lastCommandWasKill = 0;\n    }\n\n    addModeHook(name, func) {\n        if (typeof func == \"string\")\n            func = this.COMMANDS[func];\n        let hookvar = \"*\" + name + \"*hooks\";\n        this.getq(hookvar).pushUnique(func);\n    }\n\n    removeModeHook(name, func) {\n        if (typeof func == \"string\")\n            func = this.COMMANDS[func];\n        let hookvar = \"*\" + name + \"*hooks\";\n        remove(this.getq(hookvar), func);\n    }\n\n    withVariables(vars, cont) {\n        var saved = this.variables;\n        this.variables = Object.assign(Object.create(this.variables), vars);\n        try {\n            if (cont instanceof Function) {\n                return cont.apply(this, [...arguments].slice(2));\n            } else {\n                return this.cmdApply(cont, [...arguments].slice(2));\n            }\n        } finally {\n            this.variables = saved;\n        }\n    }\n\n    withCommands(cmds, cont) {\n        var saved = this.COMMANDS;\n        this.COMMANDS = Object.assign(Object.create(this.COMMANDS), cmds);\n        try {\n            if (cont instanceof Function) {\n                return cont.apply(this, [...arguments].slice(2));\n            } else {\n                return this.cmdApply(cont, [...arguments].slice(2));\n            }\n        } finally {\n            this.COMMANDS = saved;\n        }\n    }\n\n    getVariable(name) {\n        return (name in this.variables)\n            ? this.variables[name]\n            : GLOBAL_VARS[name];\n    }\n\n    setVariable() {\n        return setq.apply(this.variables, arguments);\n    }\n\n    /* -----[ public API ]----- */\n\n    lastIndexOfRegexp(str, rx, caret, bound = 0) {\n        if (!rx.global) rx = new RegExp(rx.source, rx.flags + \"g\");\n        rx.lastIndex = bound;\n        let match;\n        while (true) {\n            let pos = rx.lastIndex;\n            let m = rx.exec(str);\n            if (!m || rx.lastIndex > caret) break;\n            match = m;\n            match.after = rx.lastIndex;\n            if (rx.lastIndex <= pos) {\n                // this can happer when rx matches the empty string in the middle of an unicode\n                // surrogate pair (which we don't properly support for now). the browser will rewind\n                // lastIndex to the proper start of the code point (:-o I'm impressed!), so let's\n                // skip it to avoid an endless loop.\n                let skipOne = /[^]/ug;\n                skipOne.lastIndex = rx.lastIndex;\n                skipOne.exec(str);\n                rx.lastIndex = skipOne.lastIndex;\n            }\n        }\n        if (match) {\n            return this.matchData = match;\n        }\n    }\n\n    pushKeymap(keymap) {\n        if (keymap instanceof Array) {\n            keymap.forEach(this.pushKeymap, this);\n        } else {\n            this.popKeymap(keymap);\n            this.keymap.push(keymap);\n            keymap.attached(this);\n        }\n    }\n\n    popKeymap(keymap) {\n        remove(this.keymap, keymap);\n        keymap.detached(this);\n    }\n\n    makeDefaultKeymap() {\n        return this.isMinibuffer ? Ymacs_Keymap_Minibuffer : Ymacs_Keymap_Emacs;\n    }\n\n    signalError(text, isHtml, timeout) {\n        // Terminates a running macro\n        this.ymacs.indicateError();\n        this.callHooks(\"onMessage\", { type: \"error\", text, isHtml, timeout });\n    }\n\n    signalInfo(text, isHtml, timeout) {\n        this.callHooks(\"onMessage\", { type: \"info\", text, isHtml, timeout });\n    }\n\n    popupMessage(args) {\n        this.callHooks(\"onMessage\", args);\n    }\n\n    createMarker(pos, before, name) {\n        if (pos == null)\n            pos = this.point();\n        return new Ymacs_Marker({ editor: this, pos: pos, name: name, before: before });\n    }\n\n    point() {\n        return this.caretMarker.getPosition();\n    }\n\n    dirty(dirty) {\n        if (arguments.length > 0) {\n            this.__isDirty = dirty;\n            this.__undoQueue.forEach(x => {\n                if (x.type !== 3) x.dirty = true;\n            });\n            this.updateModeline();\n        }\n        return this.__isDirty;\n    }\n\n    setCode(code) {\n        // this.__code = code = code.replace(/\\t/g, \" \".repeat(this.getq(\"tab_width\")));\n        this.__isDirty = false;\n        this.__code = code;\n        this.__size = code.length;\n        this.__undoQueue = [];\n        this.__undoPointer = 0;\n        this.markers.map(m => m.setPosition(0, true, true));\n        this.code = code.split(/\\n/);\n        this._textProperties.reset();\n        if (this.tokenizer) {\n            this.tokenizer.reset();\n        }\n        this.callHooks(\"onResetCode\", this.code);\n        this.caretMarker.setPosition(0, false, true);\n        this.markMarker.setPosition(0, true);\n        this.forAllFrames(frame => {\n            frame.ensureCaretVisible();\n            frame.redrawModelineWithTimer();\n        });\n    }\n\n    setTokenizer(tok) {\n        if (this.tokenizer != null) {\n            this.tokenizer.removeEventListener(this._tokenizerEvents);\n        }\n        this.tokenizer = tok;\n        if (tok) {\n            tok.addEventListener(this._tokenizerEvents);\n            tok.reset();\n        } else {\n            this._textProperties.reset();\n            this.callHooks(\"onResetCode\", this.code);\n        }\n    }\n\n    getCode() {\n        return this.__code || (this.__code = this.code.join(\"\\n\"));\n    }\n\n    getCodeSize() {\n        if (this.__size)\n            return this.__size;\n        var i = this.code.length, size = i > 0 ? -1 : 0;\n        while (--i >= 0)\n            size += this.code[i].length + 1;\n        return this.__size = size;\n    }\n\n    getLine(row) {\n        if (row == null)\n            row = this._rowcol.row;\n        return this.code[row];\n    }\n\n    charAtRowCol(row, col) {\n        let n = this.code.length;\n        if (row >= n--) return null;\n        var line = this.code[row];\n        if (col == line.length)\n            return row == n ? null : \"\\n\";\n        return line.charAt(col);\n    }\n\n    charAt(point) {\n        if (point == null)\n            point = this.point();\n        else {\n            point = MRK(point);\n            if (point < 0)\n                point += this.point();\n        }\n        var rc = this._positionToRowCol(point);\n        return this.charAtRowCol(rc.row, rc.col);\n    }\n\n    callInteractively(func, args, finalArgs) {\n        if (!args) args = [];\n        var cmd;\n        if (!(func instanceof Function)) {\n            cmd = func;\n            func = this.COMMANDS[func];\n        } else {\n            cmd = func.ymacsCommand || null;\n        }\n        if (func.ymacsCallInteractively && !finalArgs) {\n            // after prompting for eventual\n            // arguments, ymacsCallInteractively\n            // will actually call back again\n            // buffer's callInteractively, so we\n            // should STOP here.\n            return func.ymacsCallInteractively.apply(this, args);\n        }\n        this.currentCommand = cmd;\n        if (this.previousCommand != cmd) {\n            this.sameCommandCount(0);\n            if (cmd != \"undo\") {\n                this._placeUndoBoundary();\n            }\n        } else if (cmd != \"self_insert_command\" || this.sameCommandCount() % 20 == 0) {\n            if (cmd != \"undo\") {\n                this._placeUndoBoundary();\n            }\n        }\n        this.preventUpdates();\n        try {\n            this.callHooks(\"beforeInteractiveCommand\", cmd, func);\n            if (!func.ymacsMarkExtend && !this.getq(\"sticky_mark\")) {\n                this.clearTransientMark();\n            }\n            return func.apply(this, args);\n        } catch(ex) {\n            if (ex instanceof Ymacs_Exception) {\n                this.signalError(ex.message);\n            } else {\n                throw ex;\n            }\n        } finally {\n            if (this.getq(\"sticky_mark\")) {\n                this.ensureTransientMark();\n            }\n            if (cmd != \"undo\") {\n                this.__undoPointer = this.__undoQueue.length;\n            }\n            this.resumeUpdates();\n            this.callHooks(\"afterInteractiveCommand\", cmd, func);\n            this.previousCommand = cmd;\n            this.sameCommandCount(+1);\n            if (this.tokenizer) {\n                this.tokenizer.start();\n            }\n        }\n    }\n\n    resetOverwriteMode(om) {\n        if (arguments.length == 0)\n            om = this.overwriteMode;\n        this.callHooks(\"onOverwriteMode\", this.overwriteMode = !om);\n        this.signalInfo(om ? \"Insert mode\" : \"Overwrite mode\");\n    }\n\n    getMinibuffer() {\n        return this.whenYmacs(function(ymacs) { return ymacs.minibuffer; });\n    }\n\n    getMinibufferFrame() {\n        return this.whenYmacs(function(ymacs) { return ymacs.minibuffer_frame; });\n    }\n\n    setMinibuffer(text) {\n        this.whenMinibuffer(function(mb){\n            mb.setCode(text);\n            mb.cmd(\"end_of_buffer\");\n        });\n    }\n\n    cmd(cmd, ...args) {\n        return this.COMMANDS[cmd].apply(this, args);\n    }\n\n    cmdApply(cmd, args) {\n        return this.COMMANDS[cmd].apply(this, args);\n    }\n\n    forEachLine(func, begin = this.markMarker(), end = this.point()) {\n        begin = MRK(begin);\n        end = MRK(end);\n        if (end < begin) { let tmp = begin; begin = end; end = tmp; }\n        begin = this._positionToRowCol(begin);\n        end = this._positionToRowCol(end);\n        for (let i = begin.row; i <= end.row; ++i) {\n            let c1 = i == begin.row ? begin.col : 0;\n            let c2 = i == end.row ? end.col : this.getLine(i).length;\n            func(i, c1, c2);\n        }\n    }\n\n    getActiveFrame() {\n        return this.whenYmacs(\"getActiveFrame\");\n    }\n\n    // This function receives a string and a continuation.  If\n    // there is an object property or variable named $what, then\n    // $cont is called in the context of this object and given the\n    // value of $what as first argument.  The returned value is\n    // passed back to caller.\n    //\n    // The continuation can also be a string, in which case it's\n    // assumed to be a method in the value of $what, thus called\n    // on it.\n    //\n    // This is a bit messy, but should work well as long as we\n    // don't use the same name for both an object property and a\n    // variable in this.variables.  Otherwise, the property takes\n    // precedence.\n    when(what, cont, ...args) {\n        what = this[what] || this.getq(what);\n        if (what != null) {\n            if (cont instanceof Function)\n                return cont.call(this, what);\n            else {\n                return what[cont].apply(what, args);\n            }\n        }\n    }\n\n    // XXX: this is way too ugly. (15 years later: Oh Yeah.)\n    whenActiveFrame() {\n        var fr = this.getActiveFrame(); // miserable hack\n        if (fr.buffer === this) {\n            this.activeFrame = fr;\n            var a = [\"activeFrame\", ...arguments];\n            return this.when.apply(this, a);\n        } else {\n            this.activeFrame = null;\n        }\n    }\n\n    forAllFrames(cont) {\n        if (this.ymacs)\n            this.ymacs.getBufferFrames(this).forEach(cont);\n    }\n\n    whenYmacs() {\n        var a = [\"ymacs\", ...arguments];\n        return this.when.apply(this, a);\n    }\n\n    whenMinibuffer(cont) {\n        // In fact, we should move when() into some base\n        // object... but which one?  JS doesn't have multiple\n        // inheritance, though we could easily \"invent\" it.\n        return this.whenYmacs(function(ymacs){\n            if (ymacs.minibuffer)\n                return cont.call(this, ymacs.minibuffer);\n        });\n    }\n\n    withMarkers(cont, ...args) {\n        let a = args.map(arg => this.createMarker(arg));\n        try {\n            return cont.apply(this, a);\n        } finally {\n            a.forEach(m => m.destroy());\n        }\n    }\n\n    preventUpdates() {\n        ++this.__preventUpdates;\n    }\n\n    resumeUpdates() {\n        if ((this.__preventUpdates = Math.max(this.__preventUpdates - 1, 0)) == 0) {\n            this.redrawDirtyLines();\n        }\n    }\n\n    getRegion(begin = this.caretMarker, end = this.markMarker) {\n        begin = MRK(begin);\n        end = MRK(end);\n        if (end < begin) { var tmp = begin; begin = end; end = tmp; }\n        return { begin: begin, end: end };\n    }\n\n    redrawDirtyLines() {\n        this.callHooks(\"beforeRedraw\");\n        this.__dirtyLines.forEach((draw, row) => {\n            if (draw) {\n                this.callHooks(\"onLineChange\", row);\n            }\n        });\n        this.__dirtyLines = [];\n        this.callHooks(\"afterRedraw\");\n    }\n\n    setOverlay(name, props) {\n        this.callHooks(\"onOverlayChange\", name, props);\n    }\n\n    deleteOverlay(name) {\n        this.callHooks(\"onOverlayDelete\", name);\n    }\n\n    setMark(pos = this.point()) {\n        this.markMarker.setPosition(pos);\n    }\n\n    ensureTransientMark() {\n        var rc = this._rowcol, tm;\n        if (!this.transientMarker) {\n            this.transientMarker = this.createMarker();\n            this.markMarker.setPosition(this.point());\n            tm = rc;\n        }\n        if (!tm)\n            tm = this.transientMarker.getRowCol();\n        this.setOverlay(\"selection\", {\n            line1 : tm.row,\n            col1  : tm.col,\n            line2 : rc.row,\n            col2  : rc.col\n        });\n    }\n\n    clearTransientMark() {\n        if (this.transientMarker) {\n            this.transientMarker.destroy();\n            this.transientMarker = null;\n            this.deleteOverlay(\"selection\");\n            this.setq(\"sticky_mark\", false);\n        }\n    }\n\n    deleteTransientRegion() {\n        if (this.transientMarker) {\n            this._deleteText(this.caretMarker, this.transientMarker);\n            this.clearTransientMark();\n            this._placeUndoBoundary();\n            return true;\n        }\n    }\n\n    static #sameCommandCount = 0;\n    sameCommandCount(diff) {\n        if (diff == null) return Ymacs_Buffer.#sameCommandCount;\n        if (diff == 0) return Ymacs_Buffer.#sameCommandCount = 0;\n        return Ymacs_Buffer.#sameCommandCount += diff;\n    }\n\n    static #lastKeyEvent = null;\n    interactiveEvent(ev) {\n        if (arguments.length == 0)\n            return Ymacs_Buffer.#lastKeyEvent;\n        return Ymacs_Buffer.#lastKeyEvent = ev;\n    }\n\n    getPrefixArg(noDiscard) {\n        var ret = this.getq(\"universal_prefix\");\n        if (!noDiscard && ret !== undefined) {\n            this.setq(\"universal_prefix\", undefined);\n            if (!this.isMinibuffer)\n                this.setMinibuffer(\"\");\n        }\n        return ret;\n    }\n\n    setPrefixArg(val) {\n        return this.setq(\"universal_prefix\", val);\n    }\n\n    updateProgress(name, val) {\n        if (val == null)\n            delete this.progress[name];\n        else\n            this.progress[name] = val;\n        this.callHooks(\"onProgressChange\");\n    }\n\n    updateModeline() {\n        this.callHooks(\"onProgressChange\");\n    }\n\n    renderModelineContent(rc, percent) {\n        var ml = (this.__isDirty ? \"**\" : \"--\") +\n            ` <span class=\"mode-line-buffer-id\">${DOM.htmlEscape(this.name)}</span>` +\n            \"\" + percent + \" of \" + formatBytes(this.getCodeSize(), 2).toLowerCase() + \"\" +\n            \"(\" + (rc.row + 1) + \",\" + rc.col + \") \";\n        var custom = this.getq(\"modeline_custom_handler\");\n        if (custom) {\n            custom = custom.call(this, this, rc);\n            if (custom) ml += \"[\" + custom + \"] \";\n        }\n        var pr = [];\n        for (var i in this.progress) {\n            pr.push(i + \": \" + this.progress[i]);\n        }\n        if (pr.length > 0) {\n            ml += \"{\" + pr.join(\", \") + \"}\";\n        }\n        return ml;\n    }\n\n    /* -----[ not-so-public API ]----- */\n\n    // BEGIN: undo queue\n\n    _recordChange(type, pos, len, text) {\n        if (len > 0) {\n            var q = this.__undoQueue;\n            q.push({\n                type  : type,\n                pos   : pos,\n                len   : len,\n                text  : text,\n                dirty : this.__isDirty\n            });\n            this.__isDirty = true;\n            if (q.length > MAX_UNDO_RECORDS)\n                q.shift();\n        }\n    }\n\n    _placeUndoBoundary() {\n        var q = this.__undoQueue;\n        var m = this.markers.map(m => [ m, m.getPosition() ]);\n        var last = q.at(-1);\n        if (!last || last.type != 3) {\n            q.push({ type: 3, markers: m });\n        } else {\n            last.markers = m;\n        }\n    }\n\n    _playbackUndo() {\n        var q = this.__undoQueue;\n        if (q.length == 0) return false;\n        ++this.__undoInProgress;\n        var didit = false, action;\n        while (--this.__undoPointer >= 0) {\n            action = q[this.__undoPointer];\n            if (action.type == 3) { // boundary\n                // restore markers\n                action.markers.forEach(m => m[0].setPosition(m[1]));\n                if (!didit) continue;\n                break;\n            }\n            didit = true;\n            var pos = action.pos;\n            switch (action.type) {\n              case 1: // insert\n                this._deleteText(pos, pos + action.len);\n                break;\n              case 2: // delete\n                this._insertText(action.text, pos);\n                break;\n            }\n            this.__isDirty = action.dirty;\n        }\n        --this.__undoInProgress;\n        return didit;\n    }\n\n    // END: undo\n\n    _replaceLine(row, text) {\n        this.code[row] = text;\n        this._textProperties.replaceLine(row, text);\n        if (!this.__preventUpdates) {\n            this.callHooks(\"onLineChange\", row);\n        } else {\n            this.__dirtyLines[row] = true;\n        }\n    }\n\n    _deleteLine(row) {\n        this.code.splice(row, 1);\n        this._textProperties.deleteLine(row);\n        if (this.tokenizer)\n            this.tokenizer.quickDeleteLine(row);\n        this.__dirtyLines.splice(row, 1);\n        this.callHooks(\"onDeleteLine\", row);\n    }\n\n    _insertLine(row, text) {\n        this.code.splice(row, 0, text);\n        this._textProperties.insertLine(row);\n        if (this.tokenizer)\n            this.tokenizer.quickInsertLine(row);\n        var drawIt = !this.__preventUpdates;\n        this.callHooks(\"onInsertLine\", row, drawIt);\n        if (!drawIt) {\n            if (this.__dirtyLines.length <= row)\n                this.__dirtyLines[row] = true;\n            else\n                this.__dirtyLines.splice(row, 0, true);\n        }\n    }\n\n    _insertText(text, pos) {\n        if (text.length == 0)\n            return;\n        if (pos == null)\n            pos = this.caretMarker.getPosition();\n        pos = MRK(pos);\n        // *** UNDO RECORDING\n        if (!this.__preventUndo)\n            this._recordChange(1, pos, text.length);\n        var rc = pos == this.point() ? this._rowcol : this._positionToRowCol(pos),\n            i = rc.row;\n        if (/^\\n+$/.test(text) && rc.col == 0) {\n            // handle this case separately, since it's so\n            // frequently used (ENTER pressed) and the\n            // default algorithm messes up colorization\n            // for a fraction of a second, flashing badly.\n            for (let j = 0; j < text.length; ++j) {\n                this._insertLine(i + j, \"\");\n            }\n        } else {\n            var lines = text.split(\"\\n\"), ln = this.code[i], rest = ln.substr(rc.col);\n            if (lines.length > 1) {\n                this._replaceLine(i, ln.substr(0, rc.col) + lines.shift());\n                lines.forEach(text => this._insertLine(++i, text));\n                this._replaceLine(i, this.code[i] + rest);\n            } else {\n                this._replaceLine(i, ln.substr(0, rc.col) + lines[0] + ln.substr(rc.col));\n            }\n        }\n        this._updateMarkers(pos, text.length);\n        this.callHooks(\"onTextInsert\", pos, text);\n    }\n\n    _deleteText(begin, end) {\n        begin = this._boundPosition(MRK(begin));\n        end = this._boundPosition(MRK(end));\n        if (begin == end)\n            return;\n        if (end < begin) { var tmp = begin; begin = end; end = tmp; }\n        // *** UNDO RECORDING\n        if (!this.__preventUndo)\n            this._recordChange(2, begin, end - begin, this._bufferSubstring(begin, end));\n        var brc = this._positionToRowCol(begin),\n            erc = this._positionToRowCol(end);\n        var line = this.code[brc.row];\n        if (brc.row == erc.row) {\n            // same line, that's easy\n            line = line.substr(0, brc.col) + line.substr(erc.col);\n            this._replaceLine(brc.row, line);\n        } else {\n            // fix first line\n            line = line.substr(0, brc.col) + this.code[erc.row].substr(erc.col);\n            this._replaceLine(brc.row, line);\n            // delete lines in between\n            line = brc.row + 1;\n            for (let n = erc.row - brc.row; n-- > 0;) this._deleteLine(line);\n        }\n        this._updateMarkers(begin, begin - end, begin);\n        this.callHooks(\"onTextDelete\", begin, end);\n    }\n\n    _replaceText(begin, end, text) {\n        this._deleteText(begin, end);\n        this._insertText(text, begin);\n    }\n\n    _swapAreas(a) {\n        a = a.map(MRK).sort();\n        var b1 = a[0];\n        var e1 = a[1];\n        var b2 = a[2];\n        var e2 = a[3];\n        var t1 = this._bufferSubstring(b1, e1);\n        var t2 = this._bufferSubstring(b2, e2);\n        this._replaceText(b2, e2, t1);\n        this._replaceText(b1, e1, t2);\n        return e2;\n    }\n\n    _bufferSubstring(begin, end) {\n        if (begin == null) begin = this.point();\n        else begin = MRK(begin);\n\n        if (end == null) end = this.getCodeSize();\n        else end = MRK(end);\n\n        if (end < begin) { var tmp = begin; begin = end; end = tmp; }\n        // var brc = this._positionToRowCol(begin),\n        //     erc = this._positionToRowCol(end);\n        // if (brc.row == erc.row) {\n        //         return this.code[brc.row].substring(brc.col, erc.col);\n        // } else return [ this.code[brc.row].substr(brc.col) ].\n        //         concat(this.code.slice(brc.row + 1, erc.row)).\n        //         concat(this.code[erc.row].substr(0, erc.col)).\n        //         join(\"\\n\");\n        return this.getCode().substring(begin, end);\n    }\n\n    _killingAction(p1, p2, prepend, noDelete) {\n        p1 = MRK(p1);\n        p2 = MRK(p2);\n        var text = this._bufferSubstring(p1, p2);\n        this._saveKilledText(text, prepend);\n        if (!noDelete)\n            this._deleteText(p1, p2);\n        this.clearTransientMark();\n    }\n\n    _saveKilledText(text, prepend) {\n        if (!this._lastCommandWasKill)\n            this.ymacs.killRingToMaster();\n        this.ymacs.pushToKillRing(text, prepend);\n        this._lastCommandWasKill++;\n        if (this.interactiveEvent()) try {\n            navigator.clipboard.writeText(this.ymacs.killRingText());\n        } catch {}\n    }\n\n    _positionToRowCol(pos) {\n        var line = 0, a = this.code, n = a.length;\n        while (pos > 0 && line < n) {\n            var len = a[line].length;\n            if (len >= pos)\n                break;\n            pos -= len + 1; // one for the newline\n            line++;\n        }\n        return { row: line, col: pos };\n    }\n\n    _rowColToPosition(row, col) {\n        var pos = 0, a = this.code, i = Math.min(row, a.length - 1), n = i;\n        if (i < 0)\n            return 0;\n        while (--i >= 0)\n            pos += a[i].length + 1; // one for the newline\n        return pos + Math.min(col, a[n].length);\n    }\n\n    _boundPosition(pos) {\n        if (pos < 0)\n            return 0;\n        return Math.min(pos, this.getCodeSize());\n    }\n\n    _repositionCaret(pos) {\n        var p = this.caretMarker.getPosition();\n        if (pos == null)\n            pos = p;\n        pos = MRK(pos);\n        pos = this._boundPosition(pos);\n        this.caretMarker.setPosition(pos);\n        return pos != p;\n    }\n\n    _updateMarkers(offset, delta, min = 0) {\n        this.__size = null;\n        this.__code = null;\n        // if (this.__undoInProgress == 0) {\n        this.markers.map(m => m.editorChange(offset, delta, min));\n        // }\n        if (this.tokenizer) {\n            let row = this._positionToRowCol(Math.min(offset, offset + delta)).row;\n            this.tokenizer.truncate(row);\n        }\n    }\n\n    _saveExcursion(cont, markerBefore) {\n        var tmp = this.createMarker(null, markerBefore);\n        ++this.__savingExcursion;\n        try {\n            return cont.call(this);\n        } finally {\n            --this.__savingExcursion;\n            this.caretMarker.swap(tmp, false, true);\n            tmp.destroy();\n        }\n    }\n\n    _disableUndo(cont) {\n        ++this.__preventUndo;\n        try {\n            return cont.call(this);\n        } finally {\n            --this.__preventUndo;\n        }\n    }\n\n    _handleKeyEvent(ev) {\n        var handled = false;\n        this.interactiveEvent(ev);\n        var lcwk = this._lastCommandWasKill;\n\n        if (this.__nextIsMeta)\n            ev.ymacsMeta = true;\n        this.__nextIsMeta = false;\n\n        var key = Ymacs_Keymap.unparseKey(ev);\n        var cc = this.currentKeys;\n        var foundPrefix = false;\n        cc.push(key);\n\n        for (let i = this.keymap.length; --i >= 0;) {\n            let km = this.keymap[i];\n            let h = km.getHandler(cc);\n            if (h instanceof Array) {\n                this.callInteractively(h[0], h[1]);\n                handled = true;\n            }\n            else if (h) {\n                handled = foundPrefix = true;\n            }\n            else if (km.defaultHandler && cc.length == 1) {\n                handled = this.callInteractively(km.defaultHandler[0], km.defaultHandler[1]);\n            }\n            if (handled)\n                break;\n        }\n\n        if (!foundPrefix) {\n            if (!handled) {\n                if (cc.length > 1) {\n                    this.signalError(cc.join(\" \").bold() + \" is undefined\", true);\n                    handled = true;\n                }\n            }\n            cc.splice(0, cc.length);\n        }\n\n        if (this._lastCommandWasKill == lcwk && typeof handled != \"object\" && !this.__nextIsMeta) {\n            // selecting a prefix keymap shouldn't clear the killRing\n            this._lastCommandWasKill = 0;\n        }\n\n        this.callHooks(\"finishedEvent\", handled);\n        this.interactiveEvent(null);\n\n        // XXX: always preventDefault() in minibuffer (return true\n        // here); seems good, objections?\n        return handled || this.isMinibuffer;\n    }\n\n    _on_tokenizerFoundToken(row, c1, c2, what) {\n        if (what) {\n            this._textProperties.addLineProps(row, c1, c2, \"css\", what);\n        } else {\n            this._textProperties.removeLineProps(row, c1, c2, \"css\");\n        }\n    }\n\n    _on_textPropertiesChange(row) {\n        if (!this.__preventUpdates) {\n            this.callHooks(\"onLineChange\", row);\n        } else {\n            this.__dirtyLines[row] = true;\n        }\n    }\n\n    formatLineHTML(row, caret) {\n        var rc = this._rowcol;\n        if (caret instanceof Ymacs_Marker)\n            rc = caret.getRowCol();\n        caret = row == rc.row ? rc.col : null;\n        return this._textProperties.getLineHTML(row, this.code[row], caret);\n    }\n\n    looking_at(needle) {\n        var haystack = this.getCode();\n        if (needle instanceof RegExp) {\n            var pos = needle.lastIndex = this.point();\n            var ret = needle.exec(haystack);\n            if (ret && ret.index == pos) {\n                ret.after = needle.lastIndex;\n                return this.matchData = ret;\n            }\n        } else if (typeof needle == \"string\") {\n            // XXX: account for case_fold_search here?\n            return haystack.substr(this.point(), needle.length) == needle;\n        }\n    }\n\n    looking_back(needle) {\n        var haystack = this.getCode();\n        if (needle instanceof RegExp) {\n            var m = this.lastIndexOfRegexp(haystack, needle, this.point());\n            if (m && m.after == this.point())\n                return m;\n        } else if (typeof needle == \"string\") {\n            // XXX: account for case_fold_search here?\n            return haystack.substr(this.point() - needle.length, needle.length) == needle;\n        }\n    }\n\n    capitalize(str) {\n        return str.replace(this.getq(\"syntax_capitalize_word\"),\n                           (_, a, b) => a.toUpperCase() + b.toLowerCase());\n    }\n}\n\n// XXX: what a mess..\nYmacs_Buffer.prototype.COMMANDS = Ymacs_Buffer.COMMANDS;\nYmacs_Buffer.prototype.newCommands = Ymacs_Buffer.newCommands;\nYmacs_Buffer.prototype.replaceCommands = Ymacs_Buffer.replaceCommands;\nYmacs_Buffer.prototype.newMode = Ymacs_Buffer.newMode;\nYmacs_Buffer.prototype.addModeHook = Ymacs_Buffer.addModeHook;\nYmacs_Buffer.prototype.removeModeHook = Ymacs_Buffer.removeModeHook;\nYmacs_Buffer.setq =\n    Ymacs_Buffer.setGlobal =\n    Ymacs_Buffer.prototype.setGlobal = Ymacs_Buffer.setVariable;\nYmacs_Buffer.prototype.setq = Ymacs_Buffer.prototype.setVariable;\nYmacs_Buffer.prototype.getq = Ymacs_Buffer.prototype.getVariable;\nYmacs_Buffer.getq = Ymacs_Buffer.getVariable;\n\nexport class Ymacs_Minibuffer extends Ymacs_Buffer {\n    constructor(...args) {\n        super(...args);\n        this.promptMarker = this.createMarker(0, true, \"prompt\");\n        this.setq(\"minibuffer_validation\", whatever => true);\n    }\n\n    // prompt(text) {\n    //     text = text.trim() + \" \";\n    //     this._disableUndo(() => {\n    //         this.setCode(text);\n    //         this._textProperties.addLineProps(0, 0, text.length - 1, \"css\", \"minibuffer-prompt\");\n    //         this._repositionCaret(text.length);\n    //         this.promptMarker.setPosition(text.length, true, true);\n    //     });\n    // }\n\n    prompt(text) {\n        text = text.trim() + \" \";\n        this._disableUndo(() => {\n            let pos = this.promptMarker.getPosition();\n            this.promptMarker.setPosition(0, true, true);\n            this._replaceText(0, pos, text);\n            this.promptMarker.setPosition(text.length, true, true);\n            this._textProperties.spliceLineProps(0, 0, text.length - pos);\n            this._textProperties.addLineProps(0, 0, text.length - 1, \"css\", \"minibuffer-prompt\");\n        });\n    }\n\n    _boundPosition(pos) {\n        return Math.max(MRK(this.promptMarker),\n                        Math.min(pos, this.getCodeSize()));\n    }\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { EventProxy, remove } from \"./ymacs-utils.js\";\n\n/* markers are objects that hold a position which is automatically\n   maintained as text is inserted or removed */\n\nexport class Ymacs_Marker {\n\n    constructor({\n        pos = null,\n        editor = null,\n        before = false,\n        name = null\n    } = {}) {\n        this.position = pos;\n        this.editor = editor;\n        this.before = before;\n        this.name = name;\n\n        this.editor.markers.push(this);\n        this.rowcol = null;\n        this.onChange = [];\n    };\n\n    destroy() {\n        remove(this.editor.markers, this);\n        this.editor = null;\n    }\n\n    editorChange(pos, diff, min) {\n        var p = this.position;\n        if (this.before)\n            --p;\n        if (diff != 0 && pos <= p) {\n            this.rowcol = null;\n            this.position += diff;\n            if (this.position < min)\n                this.position = min;\n            this.callHooks(this.onChange, this.position);\n        }\n    }\n\n    callHooks(a, arg) {\n        for (var i = a.length; --i >= 0;)\n            a[i].call(this.editor, arg);\n    }\n\n    getPosition() {\n        return this.position;\n    }\n\n    valueOf() {\n        return this.position;\n    }\n\n    setPosition(pos, noHooks, force) {\n        if (force || this.position != pos) {\n            this.rowcol = null;\n            this.position = pos;\n            if (!noHooks)\n                this.callHooks(this.onChange, this.position);\n        }\n    }\n\n    getRowCol() {\n        return this.rowcol || (this.rowcol = this.editor._positionToRowCol(this.position));\n    }\n\n    swap(other, noHooks, force) {\n        var tmp = this.getPosition();\n        this.setPosition(other.getPosition(), noHooks, force);\n        other.setPosition(tmp, noHooks, force);\n    }\n\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nlet KEYMAPS = Object.create(null);\n\nexport class Ymacs_Keymap {\n\n    constructor(keys) {\n        this.definitions = Object.create(null);\n        this.defineKeys(keys);\n    }\n\n    static define(name, keys) {\n        let obj = name && KEYMAPS[name];\n        if (!obj) {\n            obj = keys instanceof this ? keys : new this(keys);\n            if (name) {\n                KEYMAPS[name] = obj;\n            }\n        }\n        return obj;\n    }\n\n    static get(name) {\n        return KEYMAPS[name];\n    }\n\n    static parseKey(str) {\n        var key = {};\n        var a = str.split(/-/);\n        a.reverse();\n        a.forEach((c, i) => {\n            if (i == 0) {\n                key.key = c == \"Space\" ? \" \" : c.length == 1 ? c.toLowerCase() : c;\n            } else switch(c) {\n                case \"C\": key.ctrlKey = true; break;\n                case \"M\": key.metaKey = true; break;\n                case \"S\": key.shiftKey = true; break;\n            }\n        });\n        a.reverse();\n        var c = a.pop();\n        key.str = a.sort().join(\"-\");\n        if (key.str)\n            key.str += \"-\";\n        key.str += c;\n        return key;\n    }\n\n    static unparseKey(ev) {\n        var key, a = [];\n        if (\"wheelDelta\" in ev) {\n            key = ev.wheelDelta > 0 ? \"WheelUp\" : \"WheelDown\";\n        } else {\n            key = ev.key;\n            if (key == \" \") key = \"Space\";\n            if (key.length == 1) key = key.toLowerCase();\n        }\n        if (ev.ctrlKey)\n            a.push(\"C\");\n        if (ev.altKey || ev.ymacsMeta)\n            a.push(\"M\");\n        if (ev.shiftKey && (key.length > 1 || key.toLowerCase() != key.toUpperCase()))\n            a.push(\"S\");\n        a.sort();\n        a.push(key);\n        return a.join(\"-\");\n    }\n\n    defineKey(key, func, args) {\n        if (func instanceof Array) {\n            args = func.slice(1);\n            func = func[0];\n        }\n        key = key.trim().split(/\\s*&&\\s*/);\n        if (key.length > 1) {\n            key.forEach(key => this.defineKey(key, func, args));\n        } else {\n            key = key[0].trim();\n            var dfn = this.definitions;\n            if (key.indexOf(\" \") >= 0) {\n                var a = key.split(/\\s+/);\n                key = a.pop();\n                a.forEach(key => {\n                    key = this.parseKey(key).str;\n                    if (!dfn[key])\n                        dfn[key] = {};\n                    dfn = dfn[key];\n                });\n            }\n            key = this.parseKey(key);\n            dfn[key.str] = [ func, args ];\n        }\n    }\n\n    defineKeys(map) {\n        Object.keys(map).forEach(key => this.defineKey(key, map[key]));\n    }\n\n    getHandler(keys) {\n        let handler = null, def = this.definitions;\n        for (let key of keys) {\n            let tmp = handler ? handler[key] : def[key];\n            if (tmp) {\n                handler = tmp;\n                if (Array.isArray(handler)) {\n                    break;\n                }\n            } else {\n                handler = null;\n                break;\n            }\n        }\n        return handler;\n    }\n\n    attached(){}\n    detached(){}\n\n}\n\nYmacs_Keymap.prototype.parseKey = Ymacs_Keymap.parseKey;\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\n// This is the default keymap, as configured in\n// Ymacs_Buffer::makeDefaultKeymap.  It follows closely the standard\n// Emacs keybindings, with some small deviations that match my taste\n// (search for \"my stuff\" below).\n\n// It would be nice to have more options, such as an Eclipse keymap,\n// or Visual Studio -- but I'm not familiar with any of them.\n// Contributions welcome.\n\n// A keymap inherits from Ymacs_Keymap and should define its bindings\n// in D.KEYS.  They can also define a defaultHandler property to take\n// whatever action they consider necessary -- for example the Isearch\n// keymap will, by default, print the entered character in the\n// minibuffer and trigger a search action.  Isearch mode is almost\n// completely defined in a keymap -- with the minor note that\n// isearch_forward and isearch_backward are assigned below to key\n// combinations; once pressed, they will push the Isearch keymap onto\n// the buffer's keymap stack, and it will be used until isearch is\n// ended.\n\n/* KEY DEFINITIONS.  A key is generally defined in standard Emacs\n   notation, with the following notes:\n\n   - it is possible to define multiple keys at once for the same\n     operation, by using the \"&&\" combination (separate with spaces\n     from the actual keys)\n\n   - some special characters are named literally (see event.key\n     https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key)\n\n   Normally you would define commands using Ymacs_Buffer.newCommands\n   (see ymacs-commands.js) and specify the command name for key\n   bindings, but you can directly use a function as well:\n\n   \"C-8\": function() {\n     alert(\"You pressed CTRL-8\");\n   }\n\n   It is advised to define commands for more than simple cases, for\n   two reasons:\n\n   1. they can be used for \"non-interactive\" calls too\n\n   2. the command name is saved in this.currentCommand /\n      this.previousCommand, which is useful in a number of cases.\n\n*/\n\nlet minibuffer_keys = {\n    // movement\n    \"ArrowLeft   && C-b\"                      : \"backward_char\",\n    \"ArrowRight  && C-f\"                      : \"forward_char\",\n    \"Home\"                                    : \"beginning_of_indentation_or_line\",\n    \"End && C-e\"                              : \"end_of_line\",\n    \"C-a\"                                     : \"beginning_of_line\",\n    \"C-Home && M-<\"                           : \"beginning_of_buffer\",\n    \"C-End && M->\"                            : \"end_of_buffer\",\n    \"C-ArrowRight && M-f\"                     : \"forward_word\",\n    \"C-ArrowLeft && M-b\"                      : \"backward_word\",\n\n    // transient mark\n    \"S-ArrowLeft     && S-C-b\"                : \"backward_char_mark\",\n    \"S-ArrowRight    && S-C-f\"                : \"forward_char_mark\",\n    \"S-C-ArrowRight  && S-M-f\"                : \"forward_word_mark\",\n    \"S-C-ArrowLeft   && S-M-b\"                : \"backward_word_mark\",\n    \"S-Home\"                                  : \"beginning_of_indentation_or_line_mark\",\n    \"S-C-a\"                                   : \"beginning_of_line_mark\",\n    \"S-End && S-C-e\"                          : \"end_of_line_mark\",\n    \"S-C-Home\"                                : \"beginning_of_buffer_mark\",\n    \"S-C-End\"                                 : \"end_of_buffer_mark\",\n\n    // basic editing\n    \"Backspace\"                               : \"backward_delete_char\",\n    \"Delete && C-d\"                           : \"delete_char\",\n    \"M-d && C-Delete\"                         : \"kill_word\",\n    \"C-Backspace && M-Backspace && M-Delete\"  : \"backward_kill_word\",\n    \"C-k\"                                     : \"kill_line\",\n    \"C-y && S-Insert\"                         : \"yank\",\n    \"M-y\"                                     : \"yank_pop\",\n    \"C-Space\"                                 : \"set_mark_command\",\n    \"C-x C-x\"                                 : \"exchange_point_and_mark\",\n    \"C-w\"                                     : \"kill_region\",\n    \"M-t\"                                     : \"transpose_words\",\n    \"C-t\"                                     : \"transpose_chars\",\n    \"M-w\"                                     : \"copy_region_as_kill\",\n    \"M-c\"                                     : \"capitalize_word\",\n    \"M-u\"                                     : \"upcase_word\",\n    \"M-l\"                                     : \"downcase_word\",\n    \"F11\"                                     : \"nuke_trailing_whitespace\",\n    \"C-/ && C-x u && C-_ && C-z\"              : \"undo\",\n    \"Insert\"                                  : \"overwrite_mode\",\n    \"M-/\"                                     : \"dabbrev_expand\",\n    \"C-g\"                                     : \"keyboard_quit\",\n    \"Escape\"                                  : \"keyboard_quit\",\n\n    // \"Escape\"                                  : \"_next_is_meta\",\n    // \"M-Escape Escape\"                         : \"keyboard_quit\",\n\n    \"C-S-y && C-v\"                            : \"yank_from_operating_system\",\n    \"M-S-w\"                                   : \"copy_for_operating_system\",\n\n    \"C-c /\"                                   : \"close_last_xml_tag\",\n    \"S-Backspace\"                             : \"backward_delete_whitespace\",\n    \"S-Delete\"                                : \"delete_whitespace\",\n\n    \"C-x =\"                                   : \"what_cursor_position\",\n};\n\nlet emacs_keys = Object.assign({}, minibuffer_keys, {\n    // movement\n    \"ArrowUp     && C-p\"                      : \"backward_line\",\n    \"ArrowDown   && C-n\"                      : \"forward_line\",\n    \"ArrowLeft   && C-b\"                      : \"backward_char\",\n    \"ArrowRight  && C-f\"                      : \"forward_char\",\n    \"Home\"                                    : \"beginning_of_indentation_or_line\",\n    \"End && C-e\"                              : \"end_of_line\",\n    \"C-a\"                                     : \"beginning_of_line\",\n    \"C-Home && M-<\"                           : \"beginning_of_buffer\",\n    \"C-End && M->\"                            : \"end_of_buffer\",\n    \"C-ArrowRight && M-f\"                     : \"forward_word\",\n    \"C-ArrowLeft && M-b\"                      : \"backward_word\",\n    \"C-ArrowDown\"                             : \"forward_paragraph\",\n    \"C-ArrowUp\"                               : \"backward_paragraph\",\n    \"M-h\"                                     : \"mark_paragraph\",\n    \"C-l\"                                     : \"recenter_top_bottom\",\n    \"PageUp\"                                  : \"scroll_up_half\",\n    \"PageDown\"                                : \"scroll_down_half\",\n    \"WheelUp\"                                 : \"scroll_up\",\n    \"WheelDown\"                               : \"scroll_down\",\n\n    // transient mark\n    \"S-ArrowUp       && S-C-p\"                : \"backward_line_mark\",\n    \"S-ArrowDown     && S-C-n\"                : \"forward_line_mark\",\n    \"S-ArrowLeft     && S-C-b\"                : \"backward_char_mark\",\n    \"S-ArrowRight    && S-C-f\"                : \"forward_char_mark\",\n    \"S-C-ArrowRight  && S-M-f\"                : \"forward_word_mark\",\n    \"S-C-ArrowLeft   && S-M-b\"                : \"backward_word_mark\",\n    \"S-C-ArrowDown\"                           : \"forward_paragraph_mark\",\n    \"S-C-ArrowUp\"                             : \"backward_paragraph_mark\",\n    \"S-Home\"                                  : \"beginning_of_indentation_or_line_mark\",\n    \"S-C-a\"                                   : \"beginning_of_line_mark\",\n    \"S-End && S-C-e\"                          : \"end_of_line_mark\",\n    \"S-C-Home\"                                : \"beginning_of_buffer_mark\",\n    \"S-C-End\"                                 : \"end_of_buffer_mark\",\n\n    // basic editing\n    \"Backspace\"                               : \"backward_delete_char\",\n    \"Delete && C-d\"                           : \"delete_char\",\n    \"Enter && C-m\"                            : \"newline\",\n    \"M-d && C-Delete\"                         : \"kill_word\",\n    \"C-Backspace && M-Backspace && M-Delete\"  : \"backward_kill_word\",\n    \"C-k\"                                     : \"kill_line\",\n    \"C-y && S-Insert\"                         : \"yank\",\n    \"M-y\"                                     : \"yank_pop\",\n    \"C-Space\"                                 : \"set_mark_command\",\n    \"C-x C-x\"                                 : \"exchange_point_and_mark\",\n    \"C-w\"                                     : \"kill_region\",\n    \"M-t\"                                     : \"transpose_words\",\n    \"C-t\"                                     : \"transpose_chars\",\n    \"C-x C-t\"                                 : \"transpose_lines\",\n    \"M-w\"                                     : \"copy_region_as_kill\",\n    \"M-c\"                                     : \"capitalize_word\",\n    \"M-u\"                                     : \"upcase_word\",\n    \"M-l\"                                     : \"downcase_word\",\n    \"F11\"                                     : \"nuke_trailing_whitespace\",\n    \"Tab\"                                     : \"indent_line\",\n    \"C-M-\\\\\"                                  : \"indent_region\",\n    \"M-q\"                                     : \"fill_paragraph\",\n    \"C-/ && C-x u && C-_ && C-z\"              : \"undo\",\n    \"Insert\"                                  : \"overwrite_mode\",\n    \"M-s\"                                     : \"center_line\",\n    \"M-/\"                                     : \"dabbrev_expand\",\n    \"C-s\"                                     : \"isearch_forward\",\n    \"C-r\"                                     : \"isearch_backward\",\n    \"C-S-s\"                                   : \"isearch_yank_word_or_char\",\n    \"M-C-s\"                                   : \"isearch_forward_regexp\",\n    \"M-C-r\"                                   : \"isearch_backward_regexp\",\n    \"M-%\"                                     : \"query_replace\",\n    \"C-M-%\"                                   : \"query_replace_regexp\",\n    \"C-u\"                                     : \"universal_argument\",\n    \"M-g\"                                     : \"goto_line\",\n    \"C-x h\"                                   : \"mark_whole_buffer\",\n    \"C-g\"                                     : \"keyboard_quit\",\n    \"M-^\"                                     : \"delete_indentation\",\n    \"M-;\"                                     : \"comment_dwim\",\n    \"C-x =\"                                   : \"what_cursor_position\",\n    \"C-x f\"                                   : \"set_fill_column\",\n\n    // vertical editing\n    \"C-x r t\"                                 : \"string_rectangle\",\n    \"C-x r c\"                                 : \"clear_rectangle\",\n    \"C-x r k\"                                 : \"kill_rectangle\",\n    \"C-x r y\"                                 : \"yank_rectangle\",\n\n    // buffers\n    \"C-x C-ArrowRight && C-x ArrowRight && C-Tab\"    : \"next_buffer\",\n    \"C-x C-ArrowLeft && C-x ArrowLeft && C-S-Tab\"    : \"previous_buffer\",\n    \"C-x b\"                                          : \"switch_to_buffer\",\n    \"C-x k\"                                          : \"kill_buffer\",\n\n    // frames\n    \"C-x 0\"                                   : \"delete_frame\",\n    \"C-x 1\"                                   : \"delete_other_frames\",\n    \"C-x 2\"                                   : \"split_frame_vertically\",\n    \"C-x 3\"                                   : \"split_frame_horizontally\",\n    \"C-x o\"                                   : \"other_frame\",\n    \"C-x l\"                                   : \"toggle_line_numbers\",\n\n    // eval\n    \"M-x\"                                     : \"execute_extended_command\",\n\n    \"C-S-y && C-v\"                            : \"yank_from_operating_system\",\n    \"M-S-w\"                                   : \"copy_for_operating_system\",\n\n    // my stuff, sorry if these have different meanings in the standard Emacs keys\n    \"M-S-y\"                                   : \"yank_shift\", // that's the reverse of yank_shift\n    \"C-c /\"                                   : \"close_last_xml_tag\",\n    \"S-Backspace\"                             : \"backward_delete_whitespace\",\n    \"S-Delete\"                                : \"delete_whitespace\",\n    \"C-M-d\"                                   : \"delete_region_or_line\",\n    \"M-Enter\"                                 : \"start_next_paragraph\",\n    \"C-M-|\"                                   : \"cperl_lineup\",\n    \"C-F4\"                                    : \"kill_buffer\",\n    \"M-ArrowLeft\"                             : [ \"windmove\", \"left\" ],\n    \"M-ArrowRight\"                            : [ \"windmove\", \"right\" ],\n    \"M-ArrowUp\"                               : [ \"windmove\", \"up\" ],\n    \"M-ArrowDown\"                             : [ \"windmove\", \"down\" ],\n\n    \"C-x e\"                                   : \"kmacro_end_and_call_macro\",\n    \"C-x (\"                                   : \"kmacro_start_macro\",\n    \"C-x )\"                                   : \"kmacro_end_macro\",\n\n    // file system commands\n    \"C-x C-f\"                                 : \"find_file\",\n    \"C-x C-w\"                                 : \"write_file\",\n    \"C-x C-s\"                                 : \"save_buffer\",\n    \"C-x s\"                                   : \"save_some_buffers\",\n});\n\nlet minibuffer_keymap = Ymacs_Keymap.define(\"emacs_mb\", minibuffer_keys);\nminibuffer_keymap.defaultHandler = [ \"self_insert_command\" ];\n\nlet emacs_keymap = Ymacs_Keymap.define(\"emacs\", emacs_keys);\nemacs_keymap.defaultHandler = [ \"self_insert_command\" ];\n\nlet keymap_universal_arg = Ymacs_Keymap.define(\"universal_arg\", {});\nkeymap_universal_arg.defaultHandler = [ Ymacs_Interactive(\"^\", function(){\n    var ev = this.interactiveEvent();\n    var ch = ev.key;\n    var prefix = this.getPrefixArg(true);\n    if ((/^[0-9]$/.test(ch) || (ch === \"-\" && prefix === \"\")) && !ev.altKey && !ev.ctrlKey) {\n        prefix += ch;\n        this.setPrefixArg(prefix);\n        if (!this.isMinibuffer) {\n            this.whenMinibuffer(function(mb){\n                mb.cmd(\"insert\", \" \", ch);\n            });\n        }\n        return true;\n    }\n    this.popKeymap(keymap_universal_arg);\n    return false;\n}) ];\nkeymap_universal_arg.attached = buffer => buffer.setPrefixArg(\"\");\n\nexport {\n    emacs_keymap as Ymacs_Keymap_Emacs,\n    minibuffer_keymap as Ymacs_Keymap_Minibuffer,\n    keymap_universal_arg as Ymacs_Keymap_UniversalArgument,\n};\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\n\n/*\n * Ymacs_Interactive(args_description, function_reference)\n *\n * This is a wrapper that makes it easy to define \"interactive\" commands.  Pass two arguments: arguments\n * description (args), and a function (func).  args can be null, or a string, an array or a function.  When null\n * it is assumed that the function should not receive any arguments.  When an array or a string, it contains\n * some argument descriptions similar to Emacs:\n *\n *    http://www.gnu.org/s/emacs/manual/html_node/elisp/Interactive-Codes.html#Interactive-Codes\n *\n * (note that Emacs does not take a list for this argument).\n *\n * Ymacs_Interactive returns func.  When not called interactively, the code should supply all the required\n * arguments and the function is called with no performance penalty.  To call it interactively, use\n * func.ymacsCallInteractively(), which will read arguments from the minibuffer according to their description.\n */\n\nexport function Ymacs_Interactive(args, func) {\n    if (arguments.length == 1) {\n        func = args;\n        args = null;\n    } else {\n        let documentation;\n        if (!(func instanceof Function)) {\n            documentation = func;\n            func = arguments[2];\n            func.ymacsDoc = documentation;\n        }\n    }\n    func.ymacsInteractive = true;\n    if (args != null) {\n        if (!Array.isArray(args)) {\n            var m = /^[\\^\\@\\*]+/.exec(args);\n            if (m) {\n                m = m[0];\n                args = args.substr(m.length);\n                if (m.indexOf(\"^\") >= 0) {\n                    func.ymacsMarkExtend = true;\n                }\n                if (m.indexOf(\"*\") >= 0) {\n                    func.ymacsWarnReadonly = true;\n                }\n                if (m.indexOf(\"@\") >= 0) {\n                    func.ymacsSelectFrame = true;\n                }\n            }\n            if (args)\n                args = args.split(/\\n+/);\n        }\n        if (args) {\n            let collect;\n            let execute = function(...rest) {\n                collect = collect.concat(rest);\n                return this.callInteractively(func, collect, true);\n            };\n            while (args.length > 0) {\n                let next = execute;\n                execute = createArgumentFunction(args.pop(), function(...rest) {\n                    collect = collect.concat(rest);\n                    return next.call(this);\n                });\n            }\n            func.ymacsCallInteractively = function(){\n                collect = [];\n                return execute.call(this);\n            };\n        }\n    }\n    return func;\n}\n\nexport function Ymacs_Interactive_X(func) {\n    return Ymacs_Interactive(\"p\", function(n){\n        if (n == null) n = 1;\n        while (n-- > 0) func.call(this);\n    });\n}\n\nvar $TRUE = (function(){});\n$TRUE.toString = function() { return \"\" };\n$TRUE.empty = true;\n\n/* -----[ argument reader functions ]----- */\n\nfunction prompt(arg) {\n    var pr = this.getPrefixArg(true /* noDiscard */);\n    if (pr) {\n        arg = pr + \" \" + arg;\n    }\n    return this.cmd(\"minibuffer_prompt\", arg);\n}\n\nfunction read_function_name(arg, cont) {\n    console.log(\"read_function_name\", arg);\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_function\", cont);\n    // XXX: enforce it!\n}\n\nfunction read_existing_buffer_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_buffer\", cont);\n    // XXX: enforce it!\n}\n\nfunction read_buffer_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_buffer\", cont);\n}\n\nfunction read_character(arg, cont) {\n\n}\n\nfunction read_command_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_command\", cont);\n    // XXX: enforce it!\n}\n\nfunction get_point(arg, cont) {\n    return cont.call(this, this.point());\n}\n\nfunction get_mouse_event(arg, cont) {\n\n}\n\nfunction irrelevant(arg, cont) {\n    return cont.call(this, null);\n}\n\nfunction read_key_sequence(arg, cont) {\n\n}\n\nfunction read_key_sequence2(arg, cont) {\n\n}\n\nfunction get_mark(arg, cont) {\n    return cont.call(this, this.markMarker.getPosition());\n}\n\nfunction read_arbitrary_text(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_string\", null, cont);\n}\n\nfunction read_number(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_number\", cont);\n}\n\nfunction read_number_or_prefix(arg, cont) {\n    var n = parseInt(this.getPrefixArg(), 10);\n    if (!isNaN(n))\n        return cont.call(this, n);\n    else\n        return read_number.call(this, arg, cont);\n}\n\nfunction get_numeric_prefix(arg, cont) {\n    var n = parseInt(this.getPrefixArg(), 10);\n    if (isNaN(n))\n        n = null;\n    return cont.call(this, n);\n}\n\nfunction get_raw_prefix(arg, cont) {\n    arg = this.getPrefixArg();\n    if (arg === \"\")\n        arg = $TRUE;\n    return cont.call(this, arg);\n}\n\nfunction get_point_and_mark(arg, cont) {\n    var r = this.getRegion();\n    return cont.call(this, r.begin, r.end);\n}\n\nfunction read_key_sequence3(arg, cont) {\n\n}\n\nfunction read_variable_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_variable\", cont);\n}\n\nfunction read_existing_file_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_existing_file\", cont);\n}\n\nfunction read_file_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_file\", cont);\n}\n\nfunction read_file_or_directory_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_file_or_directory\", cont);\n}\n\nfunction read_existing_directory_name(arg, cont) {\n    prompt.call(this, arg);\n    return this.cmd(\"minibuffer_read_directory\", cont);\n}\n\nvar ARG_READERS = {\n    a: read_function_name,\n    b: read_existing_buffer_name,\n    B: read_buffer_name,\n    c: read_character,\n    C: read_command_name,\n    d: get_point,\n    e: get_mouse_event,\n    i: irrelevant,\n    k: read_key_sequence,\n    K: read_key_sequence2,\n    m: get_mark,\n    M: read_arbitrary_text,\n    n: read_number,\n    N: read_number_or_prefix,\n    p: get_numeric_prefix,\n    P: get_raw_prefix,\n    r: get_point_and_mark,\n    s: read_arbitrary_text,\n    U: read_key_sequence3,\n    v: read_variable_name,\n\n    f: read_existing_file_name,\n    F: read_file_name,\n    G: read_file_or_directory_name,\n    D: read_existing_directory_name\n\n    // S: no reader for interned symbols in Ymacs\n    // no x, X, z and Z either\n};\n\nfunction createArgumentFunction(arg, cont) {\n    let reader = ARG_READERS[arg.charAt(0)];\n    arg = arg.substr(1);\n    return function() {\n        return reader.call(this, arg, cont);\n    };\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nexport function Ymacs_Exception(why) {\n    this.message = why;\n};\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { DOM, EventProxy } from \"./ymacs-utils.js\";\n\nexport class Ymacs_Text_Properties extends EventProxy {\n\n    constructor({ buffer }) {\n        super(...arguments);\n        this.buffer = buffer;\n        this.reset();\n    }\n\n    reset() {\n        this.props = [];\n    }\n\n    insertLine(row) {\n        if (this.props.length < row)\n            this.props[row] = null;\n        else {\n            this.props.splice(row, 0, null);\n        }\n    }\n\n    deleteLine(row) {\n        this.props.splice(row, 1);\n    }\n\n    replaceLine(row, text) {\n        var p = this.props[row];\n        if (p && p.length > text.length) {\n            // remove extra-properties\n            p.splice(text.length);\n        }\n    }\n\n    addLineProps(row, i, j, prop, val) {\n        var p = this.props, o, changed = false;\n        if (i < j) {\n            p = p[row] || (p[row] = []);\n            while (i < j) {\n                o = p[i] || (p[i] = {});\n                if (o[prop] != val)\n                    changed = true;\n                o[prop] = val;\n                ++i;\n            }\n            if (changed)\n                this.callHooks(\"onChange\", row);\n        }\n        return changed;\n    }\n\n    removeLineProps(row, i, j, prop) {\n        var p = this.props[row], o, changed = false;\n        if (p && i < j) {\n            while (i < j) {\n                o = p[i];\n                if (o && prop in o) {\n                    changed = true;\n                    delete o[prop];\n                }\n                ++i;\n            }\n            if (changed)\n                this.callHooks(\"onChange\", row);\n        }\n        return changed;\n    }\n\n    spliceLineProps(row, i, diff) {\n        let p = this.props[row];\n        if (p) {\n            if (diff > 0) {\n                p.splice(i, 0, ...new Array(diff));\n            } else if (diff < 0) {\n                p.splice(i, -diff);\n            }\n        }\n    }\n\n    // this uses the \"css\" text property to intercalate <span class=\"$css\"> ... </span> tags in the given text.\n    // \"css\" properties are added as the tokenizer parses the code and sends onFoundToken events.\n    //\n    // XXX: this function will be called a lot of times; seems complicated for what it does. Figure out if it can be\n    // optimized.\n    //\n    // Update: the mess got bigger once I decided to embed the caret in the text, rather than have it absolutely\n    // positioned (which seems to be the only practical way to position the cursor at the correct location).  It is\n    // ESSENTIAL that the start tag of the element that defines the caret ends with \"Ymacs-caret'>\", so that the\n    // frame widget can find it.\n    getLineHTML(row, text, caret) {\n        var p = this.props[row];\n        if (caret === null) {\n            if (text == \"\")\n                return \"<br/>\";\n            if (!p || p.length == 0) {\n                return DOM.htmlEscape(text);\n            }\n        } else {\n            if (text == \"\")\n                return \"<span class='Ymacs-caret'>&nbsp;</span>\";\n            if (!p || p.length == 0) {\n                if (caret === text.length)\n                    return DOM.htmlEscape(text) + \"<span class='Ymacs-caret'>&nbsp;</span>\";\n                return DOM.htmlEscape(text.substr(0, caret)) +\n                    \"<span class='Ymacs-caret'>\" +\n                    DOM.htmlEscape(text.charAt(caret)) +\n                    \"</span>\" +\n                    DOM.htmlEscape(text.substr(caret + 1));\n            }\n        }\n        var i = 0, n = text.length, last = null, o, ret = \"\", ch;\n        while (i < n) {\n            o = p[i];\n            o = o && o.css;\n            if (i === caret) {\n                o = o ? o + \" Ymacs-caret\" : \"Ymacs-caret\";\n            }\n            if (o && o != last) {\n                if (last)\n                    ret += \"</span>\";\n                ret += \"<span class='\" + o + \"'>\";\n            }\n            else if (!o && last) {\n                ret += \"</span>\";\n            }\n            last = o;\n            // XXX: Should have used a hash rather than a\n            // switch statement?  I'm not sure but I have\n            // a feeling that switch is faster.\n            ch = text.charAt(i);\n            switch (ch) {\n              case \"<\" : ret += \"&lt;\"; break;\n              case \">\" : ret += \"&gt;\"; break;\n              case \"&\" : ret += \"&amp;\"; break;\n              default  : ret += ch; break;\n            }\n            ++i;\n        }\n        if (last)\n            ret += \"</span>\";\n        if (i === caret) {\n            // caret is at EOL\n            ret += \"<span class='Ymacs-caret'>&nbsp;</span>\";\n        }\n        return ret;\n    }\n\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { DOM, Widget } from \"./ymacs-utils.js\";\n\nexport class Ymacs_Popup extends Widget {\n    static options = {};\n\n    constructor(...args) {\n        super(...args);\n        this._cont = DOM.fromHTML(`<div class=\"Ymacs_Menu\"></div>`);\n        this.getElement().appendChild(this._cont);\n    }\n\n    getContentElement() {\n        return this._cont;\n    }\n\n    initClassName() {\n        return \"Ymacs_Popup\";\n    }\n\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { DOM, Widget, delayed } from \"./ymacs-utils.js\";\n\nfunction textColX(div, col) {\n    let range = document.createRange();\n    range.selectNodeContents(div);\n    let treeWalker = document.createTreeWalker(div, NodeFilter.SHOW_TEXT);\n    let len = 0;\n    while (treeWalker.nextNode()) {\n        let node = treeWalker.currentNode;\n        let clen = node.nodeValue.length;\n        if (len + clen >= col) {\n            range.setStart(node, col - len);\n            range.setEnd(node, col - len);\n            break;\n        }\n        len += clen;\n    }\n    return range.getBoundingClientRect().right;\n}\n\nfunction normalizeRect(p) {\n    return p.line1 > p.line2 || (p.line1 == p.line2 && p.col1 > p.col2) ?\n        { line1: p.line2, col1: p.col2, line2: p.line1, col2: p.col1 } : p;\n}\n\nvar DBL_CLICK_SPEED = 300;\nvar CLICK_COUNT = 0, CLICK_COUNT_TIMER = null, CLICK_LAST_TIME = null;\nfunction CLEAR_CLICK_COUNT() { CLICK_COUNT = null };\n\nvar LINE_DIV = DOM.fromHTML(`<div class=\"line\"><br/></div>`);\n\nvar COUNT = 0;\n\nexport class Ymacs_Frame extends Widget {\n\n    static options = {\n        highlightCurrentLine : true,\n        buffer               : null,\n        ymacs                : null,\n        isMinibuffer         : false,\n    };\n\n    constructor(...args) {\n        super(...args);\n\n        this.buffer = this.o.buffer;\n        this.ymacs = this.o.ymacs;\n        this.isMinibuffer = this.o.isMinibuffer;\n\n        // <XXX> // during transition\n        this.el = this.getElement();\n        this.el._ymacs_object = this;\n        // </XXX>\n\n        this.id = `ymacs-frame-${++COUNT}`;\n        this.__caretId = `ymacs-caret-${COUNT}`;\n        this.redrawModelineWithTimer = delayed(this.redrawModeline.bind(this));\n\n        this.getElement().tabIndex = 0;\n        this.getElement().innerHTML = \"<div class='Ymacs-frame-overlays'>\"\n            + \"<div class='Ymacs-frame-content'></div>\"\n            + \"</div>\"\n            + \"<div class='Ymacs_Modeline'></div>\";\n\n        this.addEventListener({\n            onDestroy    : this._on_destroy,\n        });\n\n        this._dragSelectHandlers = {\n            mousemove : this._dragSelect_onMouseMove.bind(this),\n            mouseup   : this._dragSelect_onMouseUp.bind(this)\n        };\n\n        this._bufferEvents = {\n            onLineChange             : this._on_bufferLineChange.bind(this),\n            onInsertLine             : this._on_bufferInsertLine.bind(this),\n            onDeleteLine             : this._on_bufferDeleteLine.bind(this),\n            onPointChange            : this._on_bufferPointChange.bind(this),\n            onResetCode              : this._on_bufferResetCode.bind(this),\n            onOverwriteMode          : this._on_bufferOverwriteMode.bind(this),\n            onProgressChange         : this._on_bufferProgressChange.bind(this),\n            beforeInteractiveCommand : this._on_bufferBeforeInteractiveCommand.bind(this),\n            afterInteractiveCommand  : this._on_bufferAfterInteractiveCommand.bind(this),\n            onOverlayChange          : this._on_bufferOverlayChange.bind(this),\n            onOverlayDelete          : this._on_bufferOverlayDelete.bind(this),\n        };\n\n        this._moreBufferEvents = {\n            onMessage               : this._on_bufferMessage.bind(this),\n            afterInteractiveCommand : function(){\n                if (this.__ensureCaretVisible)\n                    this.ensureCaretVisible();\n            }.bind(this)\n        };\n\n        var buffer = this.buffer;\n        this.buffer = null;\n        if (buffer)\n            this.setBuffer(buffer);\n\n        DOM.on(this.getOverlaysContainer(), \"scroll\", this._on_scroll.bind(this));\n        DOM.on(this.getElement(), {\n            mousedown   : this._dragSelect_onMouseDown.bind(this),\n            focus       : this._on_focus.bind(this),\n            blur        : this._on_blur.bind(this),\n            keydown     : this._on_keyDown.bind(this),\n            keyup       : this._on_keyUp.bind(this),\n            wheel       : this._on_mouseWheel.bind(this),\n        });\n    }\n\n    initClassName() {\n        return `Ymacs_Frame${this.o.isMinibuffer ? ' Ymacs_Minibuffer' : ''}`;\n    }\n\n    focus(exitAllowed) {\n        this.getElement().focus();\n        // if (exitAllowed instanceof Function) {\n        //     this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n        //     this.addEventListener(\"onBlur\", this.__exitFocusHandler = function(){\n        //         if (exitAllowed.call(this.buffer)) {\n        //             this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n        //         } else {\n        //             this.focus.delayed(2, this, null);\n        //         }\n        //     });\n        // }\n    }\n\n    blur(force) {\n        // if (force)\n        //     this.removeEventListener(\"onBlur\", this.__exitFocusHandler);\n    }\n\n    getOverlaysContainer() {\n        return this.getElement().firstChild;\n    }\n\n    getModelineElement() {\n        return this.getElement().childNodes[1];\n    }\n\n    getContentElement() {\n        return this.getElement().firstChild.firstChild;\n    }\n\n    getCaretElement() {\n        return document.getElementById(this.__caretId);\n    }\n\n    getLineDivElement(row) {\n        return this.getContentElement().childNodes[row] || null;\n    }\n\n    ensureCaretVisible() {\n        // return true if the scroll position has changed\n        let div = this.getOverlaysContainer();\n        let st = div.scrollTop;\n        this.redrawCaret();\n        let caret = this.getCaretElement();\n        if (caret) {\n            caret.scrollIntoView({ block: \"nearest\", inline: \"nearest\" });\n            if (caret.offsetLeft < div.clientWidth / 2) {\n                div.scrollLeft = 0;\n            }\n        }\n        return st != div.scrollTop;\n    }\n\n    focusInside() {\n        return document.activeElement === this.getElement();\n    }\n\n    setBuffer(buffer) {\n        if (this.buffer) {\n            if (this.caretMarker && !this.o.isMinibuffer) {\n                this.caretMarker.destroy();\n                this.caretMarker = null;\n            }\n            this.buffer.removeEventListener(this._bufferEvents);\n            this.buffer.removeEventListener(this._moreBufferEvents);\n        }\n        this.buffer = buffer;\n        if (buffer) {\n            buffer.addEventListener(this._bufferEvents);\n            if (this.focusInside()) {\n                buffer.addEventListener(this._moreBufferEvents);\n            }\n            if (this.o.isMinibuffer) {\n                this.caretMarker = buffer.caretMarker;\n            } else {\n                this.caretMarker = buffer.createMarker(buffer.caretMarker.getPosition(), false, \"framecaret\");\n            }\n            this._redrawBuffer();\n            this.redrawCaret(true);\n            this.centerOnCaret();\n        }\n    }\n\n    recenterTopBottom() {\n        let row = this.buffer._rowcol.row;\n        let line = this.getLineDivElement(row);\n        let div = this.getOverlaysContainer();\n        let st = div.scrollTop;\n        let center = Math.round(line.offsetTop - div.clientHeight / 2 + line.offsetHeight / 2);\n        let top = Math.round(line.offsetTop) - 1;\n        let bottom = Math.round(line.offsetTop - div.clientHeight + line.offsetHeight) + 1;\n        if (st == top) div.scrollTop = bottom;\n        else if (st == center) div.scrollTop = top;\n        else div.scrollTop = center;\n    }\n\n    centerOnCaret() {\n        this.centerOnLine(this.buffer._rowcol.row);\n    }\n\n    centerOnLine(row) {\n        var line = this.getLineDivElement(row), div = this.getOverlaysContainer();\n        div.scrollTop = Math.round(line.offsetTop - div.clientHeight / 2 + line.offsetHeight / 2);\n        // this._redrawBuffer();\n    }\n\n    setModelineContent(html) {\n        this.getModelineElement().innerHTML = html;\n    }\n\n    deleteOtherFrames() {\n        this.ymacs.keepOnlyFrame(this);\n    }\n\n    deleteFrame() {\n        this.ymacs.deleteFrame(this);\n    }\n\n    _split(horiz) {\n        let ovdiv = this.getOverlaysContainer();\n        let scroll = ovdiv.scrollTop;\n        let fr = this.ymacs.createFrame({ buffer: this.buffer });\n        let sc = new Ymacs_SplitCont({ horiz: horiz });\n        this.getElement().replaceWith(sc.getElement());\n        sc.setSplit(this, fr);\n        ovdiv.scrollTop = scroll;\n        fr.getOverlaysContainer().scrollTop = scroll;\n        this.focus(); // XXX: only if necessary\n        return fr;\n    }\n\n    vsplit() {\n        return this._split(true);\n    }\n\n    hsplit(percent) {\n        return this._split(false);\n    }\n\n    __showCaret() {\n        DOM.addClass(this.getCaretElement(), \"Ymacs-caret\");\n    }\n\n    _unhoverLine() {\n        let el = this.__hoverLine != null && this.getLineDivElement(this.__hoverLine);\n        if (el) DOM.delClass(el, \"Ymacs-current-line\");\n        this.__hoverLine = null;\n    }\n\n    redrawCaret(force) {\n        if (this.o.isMinibuffer) force = true;\n        var isActive = this.ymacs.getActiveFrame() === this;\n        if (!force && !isActive)\n            return;\n\n        if (isActive && !this.o.isMinibuffer && this.focusInside())\n            this.caretMarker.setPosition(this.buffer.caretMarker.getPosition());\n\n        var rc = this.buffer._rowcol;\n\n        if (this.o.highlightCurrentLine) {\n            this._unhoverLine();\n            DOM.addClass(this.getLineDivElement(rc.row), \"Ymacs-current-line\");\n            this.__hoverLine = rc.row;\n        }\n\n        // hide stale carets :-\\\n        // mess everywhere.\n        [...this.getElement().querySelectorAll(\".Ymacs-caret, #\" + this.__caretId)].forEach(el => {\n            el.id = \"\";\n            el.className = \"\";\n        });\n\n        // redraw the line where the caret was previously, so that it disappears from there\n        if (this.__prevCaretLine != null) {\n            this._on_bufferLineChange(this.__prevCaretLine);\n        }\n\n        // redraw current line if it's different\n        if (this.__prevCaretLine != rc.row) {\n            this.__prevCaretLine = rc.row;\n            this._on_bufferLineChange(rc.row);\n        }\n\n        this.callHooks(\"onPointChange\", rc.row, rc.col);\n        this.redrawModelineWithTimer(rc);\n    }\n\n    _getLineHTML(row) {\n        var html = this.buffer.formatLineHTML(row, this.caretMarker);\n        // taking advantage of the fact that a literal > entered by the user will never appear in\n        // the generated HTML, since special HTMl characters are escaped.\n        var pos = html.indexOf(\"Ymacs-caret'>\");\n        if (pos >= 0) {\n            html = html.substr(0, pos + 12)\n                + \" id='\" + this.__caretId + \"'\"\n                + html.substr(pos + 12);\n        }\n        return html;\n    }\n\n    _redrawBuffer() {\n        this.setContent(this.buffer.code.map((line, i) =>\n            `<div class=\"line\">${this._getLineHTML(i)}</div>`\n        ).join(\"\"));\n    }\n\n    coordinatesToRowCol(x, y) {\n        function findLine(r1, r2) {\n            if (r1 >= r2)\n                return r1;\n            var row = Math.floor((r1 + r2) / 2);\n            var div = self.getLineDivElement(row);\n            var y1  = div.offsetTop;\n            var y2  = y1 + div.offsetHeight;\n            if (y2 < y)\n                return findLine(row + 1, r2);\n            if (y < y1)\n                return findLine(r1, row - 1);\n            return row;\n        };\n        function findCol(c1, c2) {\n            if (c1 >= c2)\n                return c1;\n            var col = Math.floor((c1 + c2) / 2);\n            var p1 = self.coordinates(row, col),\n                p2 = self.coordinates(row, col + 1);\n            if (p2.x < x)\n                return findCol(col + 1, c2);\n            if (x < p1.x)\n                return findCol(c1, col - 1);\n            return col;\n        };\n        var self = this,\n            row = findLine(0, this.buffer.code.length - 1),\n            col = findCol(0, this.buffer.code[row].length);\n        return { row: row, col: col };\n    }\n\n    coordinates(row, col) {\n        var box = this.getContentElement().getBoundingClientRect();\n        var div = this.getLineDivElement(row);\n        return {\n            x: textColX(div, col) - box.left,\n            y: div.offsetTop,\n            h: div.offsetHeight\n        };\n    }\n\n    heightInLines() {\n        return Math.floor(this.getOverlaysContainer().clientHeight / this.getContentElement().firstChild.offsetHeight);\n    }\n\n    redrawModeline(rc) {\n        if (!rc) rc = this.caretMarker.getRowCol();\n        var maxline = this.buffer.code.length - 1;\n        var firstline = this.firstLineVisible();\n        var lastline = this.lastLineVisible();\n        var percent = firstline == 0\n            ? \"Top\"\n            : lastline == maxline\n            ? \"Bot\"\n            : Math.round(lastline / maxline * 100) + \"%\";\n        this.setModelineContent(this.buffer.renderModelineContent(rc, percent));\n    }\n\n    /* -----[ event handlers ]----- */\n\n    _on_bufferLineChange(row) {\n        var div = this.getLineDivElement(row);\n        if (div) {\n            //console.log(\"Redrawing line %d [%s]\", row, this.buffer.code[row]);\n            //console.log(new Error().stack);\n            div.innerHTML = this._getLineHTML(row);\n        }\n    }\n\n    _on_bufferInsertLine(row, drawIt) {\n        var div = LINE_DIV.cloneNode(true);\n        this.getContentElement().insertBefore(div, this.getLineDivElement(row));\n        if (drawIt) {\n            div.innerHTML = this._getLineHTML(row);\n        }\n    }\n\n    _on_bufferDeleteLine(row) {\n        DOM.trash(this.getLineDivElement(row));\n    }\n\n    _on_bufferPointChange(rc, pos) {\n        this.redrawCaret();\n    }\n\n    _on_bufferResetCode() {\n        this._redrawBuffer();\n    }\n\n    _on_bufferOverwriteMode(om) {\n        this.condClass(om, \"Ymacs-overwrite-mode\");\n    }\n\n    _on_bufferMessage(args) {\n        this.ymacs.popupMessage(args);\n    }\n\n    _on_bufferBeforeInteractiveCommand() {\n        this.__ensureCaretVisible = true;\n        this._unhoverLine();\n        this.ymacs.clearPopupMessage();\n    }\n\n    _on_bufferAfterInteractiveCommand() {}\n\n    _on_bufferProgressChange() {\n        this.redrawModelineWithTimer(null);\n    }\n\n    getOverlayId(name) {\n        return this.id + \"-ovl-\" + name;\n    }\n\n    getOverlayHTML(name, props) {\n        var str = \"\";\n        props.forEach(p => {\n            if (p.line1 == p.line2 && p.col1 == p.col2) {\n                return;\n            }\n            p = normalizeRect(p);\n            var p1 = this.coordinates(p.line1, p.col1);\n            var p2 = this.coordinates(p.line2, p.col2);\n            var p0 = p.col1 == 0 ? p1 : this.coordinates(p.line1, 0);\n            if (p.line1 == p.line2) {\n                str += `<div class=\"${name}\" style=\"\n                    top: ${p1.y}px;\n                    left: ${p1.x}px;\n                    height: ${p1.h}px;\n                    width: ${p2.x - p1.x}px;\n                \"></div>`;\n            } else {\n                str += `<div class=\"${name}\" style=\"\n                    top: ${p1.y}px;\n                    left: ${p1.x}px;\n                    height: ${p.col1 > 0 ? p1.h : p2.y - p1.y}px;\n                \"></div>`;\n                if (p.col1 > 0 && p.line2 - p.line1 > 1) {\n                    str += `<div class=\"${name}\" style=\"\n                        top: ${p1.y + p1.h}px;\n                        left: ${p0.x}px;\n                        height: ${p2.y - p1.y - p1.h}px;\n                    \"></div>`;\n                }\n                if (p.col2 > 0) {\n                    str += `<div class=\"${name}\" style=\"\n                        top: ${p2.y}px;\n                        left: ${p0.x}px;\n                        height: ${p2.h}px;\n                        width: ${p2.x - p0.x}px;\n                    \"></div>`;\n                }\n            }\n        });\n        return str ? `<div id=\"${this.getOverlayId(name)}\" data-ymacs-overlay=\"${name}\" class=\"Ymacs_Overlay ${name}\">${str}</div>` : null;\n    }\n\n    getOverlaysCount() {\n        return this.getOverlaysContainer().childNodes.length - 1; // XXX: subtract the div.content; we need to revisit this if we add new elements.\n    }\n\n    _on_bufferOverlayChange(name, props) {\n        let html = this.getOverlayHTML(name, Array.isArray(props) ? props : [ props ]);\n        if (html) {\n            let div = DOM.fromHTML(html);\n            let old = document.getElementById(this.getOverlayId(name));\n            old ? old.replaceWith(div) : this.getOverlaysContainer().appendChild(div);\n            this._setOverlayClasses();\n        } else {\n            this._on_bufferOverlayDelete(name);\n        }\n    }\n\n    _on_bufferOverlayDelete(name) {\n        DOM.trash(document.getElementById(this.getOverlayId(name)));\n        this._setOverlayClasses();\n    }\n\n    _setOverlayClasses() {\n        let names = [\n            ...this.getOverlaysContainer().querySelectorAll(\":scope > [data-ymacs-overlay]\")\n        ].map(el => el.dataset.ymacsOverlay);\n        this.condClass(names.length > 0, \"Ymacs_Frame-hasOverlays\");\n        this.getElement().dataset.ymacsOverlays = names.join(\" \");\n    }\n\n    /* -----[ self events ]----- */\n\n    _on_destroy() {\n        this.setBuffer(null);\n    }\n\n    _on_focus() {\n        this.ymacs.setActiveFrame(this, true);\n        if (!this.o.isMinibuffer) {\n            this.buffer.cmd(\"goto_char\", this.caretMarker.getPosition());\n        }\n        this.buffer.addEventListener(this._moreBufferEvents);\n    }\n\n    _on_blur() {\n        if (!this.o.isMinibuffer) {\n            this.caretMarker.setPosition(this.buffer.caretMarker.getPosition());\n        }\n        this.buffer.removeEventListener(this._moreBufferEvents);\n    }\n\n    _dragSelect_onMouseDown(ev) {\n        if (ev.ctrlKey && ev.shiftKey)\n            return;\n        ev.stopPropagation();\n\n        clearTimeout(CLICK_COUNT_TIMER);\n        CLICK_COUNT++;\n        CLICK_COUNT_TIMER = setTimeout(CLEAR_CLICK_COUNT, DBL_CLICK_SPEED);\n\n        let pos = DOM.mousePos(ev, this.getContentElement());\n        let rc = this.coordinatesToRowCol(pos.x, pos.y);\n        let buf = this.buffer;\n\n        setTimeout(() => {\n            buf.clearTransientMark();\n            buf.cmd(\"goto_char\", buf._rowColToPosition(rc.row, rc.col));\n            buf.callInteractively(\"keyboard_quit\");\n            if (CLICK_COUNT == 1) {\n                buf.ensureTransientMark();\n                DOM.on(window, this._dragSelectHandlers);\n            }\n            else if (CLICK_COUNT == 2) {\n                buf.cmd(\"forward_word\");\n                buf.cmd(\"backward_word\");\n                buf.cmd(\"forward_word_mark\");\n            }\n            else if (CLICK_COUNT == 3) {\n                buf.cmd(\"beginning_of_line\");\n                buf.cmd(\"end_of_line_mark\");\n            }\n            else if (CLICK_COUNT == 4) {\n                buf.cmd(\"backward_paragraph\");\n                buf.cmd(\"forward_whitespace\");\n                buf.cmd(\"beginning_of_line\");\n                buf.cmd(\"forward_paragraph_mark\");\n            }\n        });\n    }\n\n    _dragSelect_onMouseMove(ev) {\n        let pos = DOM.mousePos(ev, this.getContentElement());\n        let rc = this.coordinatesToRowCol(pos.x, pos.y);\n        this.buffer.cmd(\"goto_char\", this.buffer._rowColToPosition(rc.row, rc.col));\n        this.buffer.ensureTransientMark();\n        this.ensureCaretVisible();\n    }\n\n    _dragSelect_onMouseUp(ev) {\n        DOM.off(window, this._dragSelectHandlers);\n    }\n\n    _on_keyDown(ev) {\n        if (!isModifier(ev.key)) {\n            if (this.ymacs.processKeyEvent(ev)) {\n                ev.preventDefault();\n                ev.stopPropagation();\n            }\n        }\n    }\n\n    _on_keyUp(ev) {\n    }\n\n    _on_scroll() {\n        this.redrawModelineWithTimer();\n    }\n\n    _on_mouseWheel(ev) {\n        ev.preventDefault();\n        this.buffer._handleKeyEvent(ev);\n    }\n\n    firstLineVisible() {\n        var div = this.getOverlaysContainer();\n        return this.coordinatesToRowCol(1, div.scrollTop + 1).row;\n    }\n\n    lastLineVisible() {\n        var div = this.getOverlaysContainer();\n        return this.coordinatesToRowCol(div.clientWidth - 2, div.scrollTop + div.clientHeight - 2).row;\n    }\n\n    scrollUp(lines) {\n        var div = this.getOverlaysContainer();\n        var line = Math.max(this.firstLineVisible() - lines, 0);\n        line = this.getLineDivElement(line);\n        div.scrollTop = line.offsetTop;\n        this.__ensureCaretVisible = false;\n    }\n\n    scrollDown(lines) {\n        var div = this.getOverlaysContainer();\n        var line = Math.min(this.firstLineVisible() + lines, this.buffer.code.length - 1);\n        line = this.getLineDivElement(line);\n        div.scrollTop = line.offsetTop;\n        this.__ensureCaretVisible = false;\n    }\n}\n\nfunction isModifier(key) {\n    return /^(?:Alt|AltGraph|CapsLock|Control|Fn|FnLock|Hyper|Meta|NumLock|ScrollLock|Shift|Super|Symbol|SymbolLock)$/.test(key);\n}\n\nexport class Ymacs_SplitCont extends Widget {\n    static options = {\n        horiz: false\n    };\n    #activeElement = null;\n    initClassName() {\n        return \"Ymacs_SplitCont \" + (this.o.horiz ? \"horiz\" : \"vert\");\n    }\n    createElement() {\n        super.createElement();\n        this._dragHandlers = {\n            mousemove : this._onMouseMove.bind(this),\n            mouseup   : this._onMouseUp.bind(this),\n        };\n        this._rb = DOM.fromHTML(`<div class=\"bar\" tabindex=\"0\"></div>`);\n        DOM.on(this._rb, \"mousedown\", this._onMouseDown.bind(this));\n    }\n    setSplit(a, b) {\n        this.add(a);\n        this.add(this._rb);\n        this.add(b);\n    }\n    _onMouseDown(ev) {\n        this.#activeElement = document.activeElement;\n        if (ev.target === this._rb) {\n            let first = this.getContentElement().children[0];\n            this._start = this.o.horiz ? ev.clientY : ev.clientX;\n            this._orig_sz = this.o.horiz ? first.offsetHeight : first.offsetWidth;\n            this.addClass(\"dragging\");\n            ev.stopPropagation();\n            DOM.on(window, this._dragHandlers);\n            DOM.overlayOn(this.o.horiz ? \"Ymacs_Resize_horiz\" : \"Ymacs_Resize_vert\");\n        } else if (this.#activeElement) {\n            this.#activeElement.focus();\n        }\n    }\n    _onMouseUp(ev) {\n        DOM.off(window, this._dragHandlers);\n        this.delClass(\"dragging\");\n        DOM.overlayOff();\n        if (this.#activeElement) {\n            this.#activeElement.focus();\n        }\n        this.#activeElement = null;\n    }\n    _onMouseMove(ev) {\n        let cont = this.getElement();\n        let max = this.o.horiz ? cont.offsetHeight : cont.offsetWidth;\n        let diff = (this.o.horiz ? ev.clientY : ev.clientX) - this._start;\n        let target = Math.min(max, Math.max(0, this._orig_sz + diff));\n        let frac = Math.min(0.9, Math.max(0.1, target / max));\n        if (this.o.horiz) {\n            cont.style.gridTemplateRows = `${frac}fr auto ${1-frac}fr`;\n        } else {\n            cont.style.gridTemplateColumns = `${frac}fr auto ${1-frac}fr`;\n        }\n    }\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { delayed, EventProxy } from \"./ymacs-utils.js\";\n\nexport class Ymacs_Stream {\n\n    constructor({\n        buffer = null,\n        line = 0,\n        col = 0\n    } = {}) {\n        this.buffer = buffer;\n        this.line = line;\n        this.col = col;\n    }\n\n    nextCol() {\n        ++this.col;\n    }\n\n    prevCol() {\n        --this.col;\n    }\n\n    nextLine() {\n        ++this.line;\n        this.col = 0;\n    }\n\n    prevLine() {\n        --this.line;\n        this.col = 0;\n    }\n\n    peek(n = 0) {\n        if (this.line < this.buffer.code.length) {\n            let pos = this.col + n;\n            let line = this.buffer.code[this.line];\n            if (pos < line.length) return line.charAt(pos);\n            if (pos == line.length) return \"\\n\";\n        }\n    }\n\n    next() {\n        let ch = this.peek();\n        this.nextCol();\n        if (this.col > this.buffer.code[this.line].length)\n            this.nextLine();\n        let stop = this.__stop;\n        if (stop) {\n            if (this.line > stop.line\n                || (this.line == stop.line && this.col >= stop.col)) {\n                this.__stop = null;\n                throw stop.stop ?? this.EOF;\n            }\n        }\n        return ch;\n    }\n\n    lineText(row = this.line) {\n        return this.buffer.code[row];\n    }\n\n    lineIndentation(row = this.line) {\n        return /^\\s*/.exec(this.lineText(row))[0].length;\n    }\n\n    lookingAt(what) {\n        var line = this.buffer.code[this.line];\n        if (what instanceof RegExp) {\n            return what.exec(line.substr(this.col));\n        } else {\n            return line.substr(this.col, what.length) == what;\n        }\n    }\n\n    textBefore(pos) {\n        if (pos == null)\n            pos = this.buffer._rowColToPosition(this.line, this.col);\n        return this.buffer.getCode().substr(0, pos);\n    }\n\n    textAfter(pos) {\n        if (pos == null)\n            pos = this.buffer._rowColToPosition(this.line, this.col);\n        return this.buffer.getCode().substr(pos);\n    }\n\n    substring(start, end) {\n        return this.buffer.getCode().substring(start, end);\n    }\n\n    substr(start, end) {\n        return this.buffer.getCode().substr(start, end);\n    }\n\n    eol() {\n        return this.col == this.buffer.code[this.line].length;\n    }\n\n    eof() {\n        var n = this.buffer.code.length, l = this.line;\n        return l >= n || l == n - 1 && this.eol();\n    }\n\n    stopAt(line, col, stop = this.EOF) {\n        this.__stop = { line, col, stop };\n    }\n\n    length() {\n        return this.buffer.code.length;\n    }\n\n    lineLength(line) {\n        if (line == null)\n            line = this.line;\n        return this.buffer.code[line].length;\n    }\n\n    save() {\n        return { buffer: this.buffer, line: this.line, col: this.col };\n    }\n\n    restore(state) {\n        this.buffer = state.buffer;\n        this.line = state.line;\n        this.col = state.col;\n    }\n\n    checkStop() {\n        if (this.eof()) throw this.EOF;\n        if (this.eol()) throw this.EOL;\n        let stop = this.__stop;\n        if (stop) {\n            if (this.line > stop.line\n                || (this.line == stop.line && this.col >= stop.col)) {\n                this.__stop = null;\n                throw stop.stop ?? this.EOF;\n            }\n        }\n    }\n\n    skip_ws() {\n        while (Ymacs_Simple_Stream.is_whitespace(this.peek()))\n            this.next();\n    }\n\n}\n\nYmacs_Stream.prototype.EOL = {};\nYmacs_Stream.prototype.EOF = {};\n\nexport class Ymacs_Simple_Stream {\n\n    constructor({\n        buffer = null,\n        line = 0,\n        col = 0,\n        pos = null\n    } = {}) {\n        this.buffer = buffer;\n        this.line = line;\n        this.col = col;\n        this.pos = pos;\n\n        if (this.pos == null) {\n            this.pos = this.buffer._rowColToPosition(this.line, this.col);\n        } else {\n            var rc = this.buffer._positionToRowCol(this.pos);\n            this.line = rc.row;\n            this.col = rc.col;\n        }\n    }\n\n    static is_whitespace(ch) {\n        switch (ch) {\n          case \" \":\n          case \"\\n\":\n          case \"\\t\":\n          case \"\\x0C\":\n          case \"\\u2028\":\n          case \"\\u2029\":\n          case \"\\xA0\":\n            return true;\n        }\n    }\n\n    peek() {\n        var a = this.buffer.code;\n        var line = a[this.line];\n        if (line == null) return null;\n        if (this.col == line.length)\n            return this.line == a.length - 1 ? null : \"\\n\";\n        return line.charAt(this.col);\n    }\n\n    next() {\n        var ch = this.peek();\n        if (ch) {\n            ++this.pos;\n            ++this.col;\n            if (this.col > this.buffer.code[this.line].length) {\n                this.col = 0;\n                ++this.line;\n            }\n        }\n        return ch;\n    }\n\n    read_while(pred) {\n        var ret = \"\", ch;\n        while ((ch = this.peek()) && pred(ch))\n            ret += this.next();\n        return ret;\n    }\n\n    skip_ws() {\n        return this.read_while(this.is_whitespace);\n    }\n\n    looking_at(what) {\n        var line = this.buffer.code[this.line];\n        if (what instanceof RegExp) {\n            return what.exec(line.substr(this.col));\n        } else {\n            return line.substr(this.col, what.length) == what;\n        }\n    }\n\n}\n\nYmacs_Simple_Stream.prototype.is_whitespace = Ymacs_Simple_Stream.is_whitespace;\n\nlet LANGUAGES = Object.create(null);\n\nexport class Ymacs_Tokenizer extends EventProxy {\n\n    static define(name, func) {\n        LANGUAGES[name.toLowerCase()] = func;\n    }\n\n    constructor({ buffer, type }) {\n        super();\n\n        if (typeof type == \"string\") {\n            type = LANGUAGES[type.toLowerCase()];\n        }\n\n        this.buffer = buffer;\n        this.type = type;\n    }\n\n    reset() {\n        this.stream = new Ymacs_Stream({ buffer: this.buffer });\n        this.theParser = this.type(this.stream, this);\n        this.parsers = [];\n        this.parsers[-1] = this.theParser.copy();\n        this.timerUpdate = null;\n        this.start();\n    }\n\n    stop() {\n        clearTimeout(this.timerUpdate);\n    }\n\n    getLanguage(name, options) {\n        return LANGUAGES[name](this.stream, this, options);\n    }\n\n    showProgress(p) {\n        if (p != null) {\n            p = Math.round(p / this.stream.length() * 100) + \"%\";\n        }\n        this.buffer.updateProgress(\"Syntax highlighting\", p);\n    }\n\n    start() {\n        this.stop();\n        let stream = this.stream, p, a = this.parsers;\n        stream.line = a.length;\n        while (!(p = a[stream.line]))\n            stream.prevLine();\n        stream.nextLine();\n        p = p();\n        let doit = () => {\n            this.buffer.preventUpdates();\n            let n = 100;\n            // this.showProgress(this.stream.line);\n            while (true) {\n                try {\n                    while (true) p.next();\n                }\n                catch(ex) {\n                    if (ex === stream.EOL) {\n                        a[stream.line] = p.copy();\n                        stream.nextLine();\n                        if  (--n == 0) {\n                            this.buffer.resumeUpdates();\n                            this.timerUpdate = setTimeout(doit, 25);\n                            return;\n                        }\n                    }\n                    else if (ex === stream.EOF) {\n                        a[stream.line] = p.copy();\n                        this.buffer.resumeUpdates();\n                        break;\n                    }\n                    else throw ex;\n                }\n            }\n            // this.showProgress();\n        };\n        doit();\n    }\n\n    quickInsertLine(row) {\n        this.truncate(row);\n    }\n\n    quickDeleteLine(row) {\n        this.truncate(row);\n    }\n\n    onToken(line, c1, c2, type) {\n        this.callHooks(\"onFoundToken\", line, c1, c2, type);\n    }\n\n    getParserForLine(row, col) {\n        this.stop();\n        let stream = this.stream, p, a = this.parsers;\n        stream.line = row - 1;\n        while (!(p = a[stream.line]))\n            stream.prevLine();\n        stream.nextLine();\n        if (col != null) {\n            stream.stopAt(row, col);\n        }\n        p = p();\n        try {\n            this.buffer.preventUpdates();\n            while (true) {\n                if (col == null && stream.line == row) {\n                    return p;\n                }\n                try {\n                    while (true) p.next();\n                } catch(ex) {\n                    if (ex === stream.EOL) {\n                        a[stream.line] = p.copy();\n                        stream.nextLine();\n                    }\n                    else if (ex === stream.EOF) {\n                        return p;\n                    }\n                    else {\n                        throw ex;\n                    }\n                }\n            }\n        } finally {\n            this.buffer.resumeUpdates();\n            if (stream.line < stream.length())\n                this.timerUpdate = setTimeout(this.start.bind(this, stream.line), 25);\n        }\n    }\n\n    reparseAll() {\n        this.truncate(0);\n        return this.finishParsing();\n    }\n\n    finishParsing() {\n        this.getParserForLine(this.stream.length());\n        return this.getLastParser();\n    }\n\n    getLastParser() {\n        return this.parsers.at(-1);\n    }\n\n    getIndentation(row, buffer) {\n        var p = this.getParserForLine(row);\n        if (p && p.indentation instanceof Function)\n            return p.indentation(buffer);\n    }\n\n    truncate(row) {\n        if (this.parsers.length > row) this.parsers.length = row;\n    }\n\n}\n\nexport function compareRowCol(p1, p2) {\n    return ((p1.row ?? p1.line) < (p2.row ?? p2.line))\n        ? -1\n        : (p1.row ?? p1.line) > (p2.row ?? p2.line)\n        ? 1\n        : (p1.col ?? p1.c1) - (p2.col ?? p2.c1);\n}\n\nexport function getPP(tok) {\n    var pp = tok.context.passedParens;\n    pp = pp instanceof Function ? pp() : pp;\n    if (pp) pp = [...pp].sort(compareRowCol);\n    return pp;\n}\n\nexport function caretInside(caret, zone) {\n    return p => (p.closed &&\n                 zone == \"outer\" && p.outer ? (\n                     compareRowCol({ line: p.outer.l1, col: p.outer.c1 }, caret) < 0\n                         && compareRowCol({ line: p.outer.l2, col: p.outer.c2 }, caret) >= 0\n                 )\n                 : zone == \"inner\" && p.inner ? (\n                     compareRowCol({ line: p.inner.l1, col: p.inner.c1 }, caret) <= 0\n                         && compareRowCol({ line: p.inner.l2, col: p.inner.c2 }, caret) >= 0\n                 )\n                 : (\n                     compareRowCol(p, caret) < 0\n                         && compareRowCol(p.closed, caret) >= 0\n                 ));\n}\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { DOM, delayed, formatBytes } from \"./ymacs-utils.js\";\nimport { Ymacs_Keymap_UniversalArgument } from \"./ymacs-keymap-emacs.js\";\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\nimport { Ymacs_Interactive, Ymacs_Interactive_X } from \"./ymacs-interactive.js\";\n\nfunction TMPL_CHAR_INFO({\n    ch, code, codeHex, point, sizeKB\n}) {\n    return `\n<table>\n  <tr><td style='text-align: right; font-weight: bold'>Char:</td><td><tt> ${ch} </tt></td></tr>\n  ${code != null ? `\n    <tr><td style='text-align: right; font-weight: bold'>Char code:</td><td> ${code} / 0x${codeHex} </td></tr>\n  ` : \"\"}\n  <tr><td style='text-align: right; font-weight: bold'>Position:</td><td> ${point} </td></tr>\n  <tr><td style='text-align: right; font-weight: bold'>Buffer size:</td><td> ${sizeKB} </td></tr>\n</table>`;\n}\n\nYmacs_Buffer.newCommands({\n\n    forward_char: Ymacs_Interactive(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"goto_char\", this.point() + x);\n    }),\n\n    backward_char: Ymacs_Interactive(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"forward_char\", -x);\n    }),\n\n    forward_line: Ymacs_Interactive(\"p\", function(x) {\n        if (x == null) x = 1;\n        var rc = this._rowcol;\n        if (!/^(forward|backward)_line$/.test(this.previousCommand)) {\n            this.setq(\"line_movement_requested_col\", rc.col);\n        }\n        var ret = this.cmd(\"goto_char\",\n                           this._rowColToPosition(rc.row + x,\n                                                  Math.max(rc.col,\n                                                           this.getq(\"line_movement_requested_col\"))));\n        if (!ret)\n            this.setq(\"line_movement_requested_col\", rc.col);\n        return ret;\n    }),\n\n    backward_line: Ymacs_Interactive(\"p\", function(x) {\n        if (x == null) x = 1;\n        return this.cmd(\"forward_line\", -x);\n    }),\n\n    forward_whitespace: Ymacs_Interactive(\"P\", function(noLine) {\n        var re = noLine ? /[^\\x20\\t\\xA0]/g : /[^\\s]/g;\n        if (this.cmd(\"search_forward_regexp\", re)) {\n            this.cmd(\"backward_char\");\n            return true;\n        } else if (!noLine)\n            return this.cmd(\"end_of_buffer\");\n    }),\n\n    backward_whitespace: Ymacs_Interactive(\"P\", function(noLine) {\n        var re = noLine ? /[^\\x20\\t\\xA0]/g : /[^\\s]/g;\n        if (this.cmd(\"search_backward_regexp\", re)) {\n            this.cmd(\"forward_char\");\n            return true;\n        } else if (!noLine)\n            return this.cmd(\"beginning_of_buffer\");\n    }),\n\n    beginning_of_line: Ymacs_Interactive(function() {\n        return this.cmd(\"goto_char\", this._rowColToPosition(this._rowcol.row, 0));\n    }),\n\n    back_to_indentation: Ymacs_Interactive(function() {\n        var rc = this._rowcol, line = this.code[rc.row], m = /\\S/.exec(line);\n        if (m)\n            return this.cmd(\"goto_char\", this._rowColToPosition(rc.row, m.index));\n    }),\n\n    beginning_of_indentation_or_line: Ymacs_Interactive(function() {\n        return this.cmd(\"back_to_indentation\") || this.cmd(\"beginning_of_line\");\n    }),\n\n    end_of_line: Ymacs_Interactive(function() {\n        var rc = this._rowcol;\n        return this.cmd(\"goto_char\", this._rowColToPosition(rc.row, this.code[rc.row].length));\n    }),\n\n    beginning_of_buffer: Ymacs_Interactive(function() {\n        return this.cmd(\"goto_char\", 0);\n    }),\n\n    end_of_buffer: Ymacs_Interactive(function() {\n        return this.cmd(\"goto_char\", this.getCodeSize());\n    }),\n\n    eob_p: function() {\n        return this.point() == this.getCodeSize();\n    },\n\n    bob_p: function() {\n        return this.point() == 0;\n    },\n\n    eol_p: function() {\n        var rc = this._positionToRowCol(this.point());\n        return rc.col == this.code[rc.line].length;\n    },\n\n    bol_p: function() {\n        return this._positionToRowCol(this.point()).col == 0;\n    },\n\n    backward_delete_char: Ymacs_Interactive(\"^p\", function(n){\n        if (!this.deleteTransientRegion()) {\n            if (n == null) n = 1;\n            var pos = this.point();\n            if (pos > 0)\n                this._deleteText(pos - n, pos);\n        }\n    }),\n\n    delete_char: Ymacs_Interactive(\"^p\", function(n){\n        if (!this.deleteTransientRegion()) {\n            if (n == null) n = 1;\n            var pos = this.point();\n            this._deleteText(pos, pos + n);\n        }\n    }),\n\n    delete_whitespace: Ymacs_Interactive(\"^P\", function(noLine) {\n        if (!this.deleteTransientRegion()) {\n            var p = this.point();\n            if (this.cmd(\"forward_whitespace\", noLine)) {\n                this._deleteText(p, this.point());\n                return true;\n            }\n        }\n    }),\n\n    backward_delete_whitespace: Ymacs_Interactive(\"^P\", function(noLine) {\n        if (!this.deleteTransientRegion()) {\n            var p = this.point();\n            if (this.cmd(\"backward_whitespace\", noLine)) {\n                this._deleteText(this.point(), p);\n                return true;\n            }\n        }\n    }),\n\n    delete_indentation: Ymacs_Interactive(\"P\", function(nextLine) {\n        if (nextLine)\n            this.cmd(\"forward_line\");\n        this.cmd(\"back_to_indentation\");\n        this.cmd(\"backward_delete_whitespace\");\n        this.cmd(\"insert\", \" \");\n    }),\n\n    universal_argument: Ymacs_Interactive(\"^\", function(){\n        this.pushKeymap(Ymacs_Keymap_UniversalArgument);\n        if (!this.isMinibuffer)\n            this.setMinibuffer(\"C-u\");\n    }),\n\n    overwrite_mode: Ymacs_Interactive(function() {\n        this.resetOverwriteMode();\n    }),\n\n    self_insert_command: Ymacs_Interactive(\"^p\", function(repeat) {\n        var ev = this.interactiveEvent();\n        var ch = ev.key;\n        var rc = this._rowcol;\n        if (ch.length == 1 && !ev.altKey && !ev.ctrlKey) {\n            this.deleteTransientRegion();\n            if (repeat != null)\n                ch = ch.repeat(repeat);\n            if (this.overwriteMode) {\n                var line = this.code[rc.row], left = line.length - rc.col;\n                if (left > 0)\n                    this.cmd(\"delete_char\", Math.min(left, repeat || 1));\n            }\n            this.cmd(\"insert\", ch);\n            return true;\n        }\n        return false;\n    }),\n\n    newline: Ymacs_Interactive(\"^p\", function(n){\n        if (n == null) n = 1;\n        this.deleteTransientRegion();\n        this.cmd(\"insert\", \"\\n\".repeat(n));\n    }),\n\n    newline_and_indent: Ymacs_Interactive(\"^p\", function(n){\n        if (n) {\n            this.cmd(\"newline\", n);\n        } else {\n            this.cmd(\"backward_delete_whitespace\", true);\n            this.cmd(\"newline\");\n            this.cmd(\"indent_line\");\n        }\n    }),\n\n    indent_line: Ymacs_Interactive(\"P\", function(noEmpty) {\n        if (!this.tokenizer) {\n            this.cmd(\"insert\", \" \".repeat(this.getq(\"indent_line\")));\n        } else {\n            let indent = this.tokenizer.getIndentation(this._rowcol.row, this);\n            if (indent != null) {\n                let line = this.getLine();\n                if (!noEmpty || /\\S/.test(line)) {\n                    let rc = this._rowcol;\n                    let pos = this.point() - rc.col;\n                    let ci = /[^\\S\\r\\n]*/.exec(line)[0].length;\n                    if (ci > indent) {\n                        this._deleteText(pos, pos + ci - indent);\n                    } else if (indent > ci) {\n                        this._insertText(\" \".repeat(indent - ci), pos);\n                    }\n                    if (rc.col <= ci) {\n                        this.cmd(\"goto_char\", pos + indent);\n                    }\n                }\n            }\n        }\n    }),\n\n    indent_region: Ymacs_Interactive(\"r\", function(begin, end) {\n        this.cmd(\"save_excursion\", function() {\n            var m = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            while (this.point() < m.getPosition()) {\n                this.cmd(\"indent_line\", true);\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\"))\n                    break;\n            };\n            m.destroy();\n        });\n    }),\n\n    make_marker: function(pos) {\n        return this.createMarker(pos);\n    },\n\n    looking_at: function() {\n        return this.looking_at.apply(this, arguments);\n    },\n\n    looking_back: function() {\n        return this.looking_back.apply(this, arguments);\n    },\n\n    search_forward: Ymacs_Interactive(\"sSearch: \", function(str, bound) {\n        var code = this.getCode(), point = this.point();\n        if (this.getq(\"case_fold_search\")) {\n            code = code.toLowerCase();\n            str = str.toLowerCase();\n        }\n        var pos = code.indexOf(str, point);\n        if (pos >= 0 && (bound == null || pos <= bound)) {\n            return this.cmd(\"goto_char\", pos + str.length);\n        }\n    }),\n\n    search_backward: Ymacs_Interactive(\"sSearch backward: \", function(str, bound) {\n        var code = this.getCode(), point = this.point();\n        if (this.getq(\"case_fold_search\")) {\n            code = code.toLowerCase();\n            str = str.toLowerCase();\n        }\n        var pos = code.lastIndexOf(str, point);\n        if (pos == point)\n            pos = code.lastIndexOf(str, point - 1);\n        if (pos >= 0 && pos != point && (bound == null || pos >= bound)) {\n            return this.cmd(\"goto_char\", pos);\n        }\n    }),\n\n    make_regexp: function(rx) {\n        if (!(rx instanceof RegExp)) {\n            var matchCase = !this.getq(\"case_fold_search\");\n            try {\n                rx = new RegExp(rx, matchCase ? \"g\" : \"ig\");\n            } catch(ex) {\n                throw new Ymacs_Exception(\"Invalid regexp\");\n            }\n        }\n        return rx;\n    },\n\n    search_forward_regexp: Ymacs_Interactive(\"sRegExp search: \", function(rx) {\n        rx = this.cmd(\"make_regexp\", rx);\n        let pos = rx.lastIndex = this.point();\n        let m = rx.exec(this.getCode());\n        if (m && rx.lastIndex != pos) {\n            m.after = rx.lastIndex;\n            this.matchData = m;\n            this.cmd(\"goto_char\", rx.lastIndex);\n            return true;\n        }\n    }),\n\n    search_backward_regexp: Ymacs_Interactive(\"sBackward RegExp search: \", function(rx) {\n        rx = this.cmd(\"make_regexp\", rx);\n        var m = this.lastIndexOfRegexp(this.getCode(), rx, this.point());\n        if (m && m.index != this.point()) {\n            this.cmd(\"goto_char\", m.index);\n            return true;\n        }\n    }),\n\n    forward_word: Ymacs_Interactive_X(function(){\n        var syntax_word = this.getq(\"syntax_word\"), end = false;\n        while (!end && !syntax_word.test(this.charAt()))\n            if (!this.cmd(\"forward_char\"))\n                end = true;\n        while (!end && syntax_word.test(this.charAt()))\n            if (!this.cmd(\"forward_char\"))\n                end = true;\n    }),\n\n    backward_word: Ymacs_Interactive_X(function(){\n        var syntax_word = this.getq(\"syntax_word\"), end = false;\n        while (!end && !syntax_word.test(this.charAt(-1)))\n            if (!this.cmd(\"backward_char\"))\n                end = true;\n        while (!end && syntax_word.test(this.charAt(-1)))\n            if (!this.cmd(\"backward_char\"))\n                end = true;\n    }),\n\n    forward_paragraph: Ymacs_Interactive_X(function(){\n        let rx = this.getq(\"syntax_paragraph_sep\");\n        this.cmd(\"beginning_of_line\");\n        this.cmd(\"backward_char\");\n        if (this.cmd(\"looking_at\", rx)) {\n            this.cmd(\"goto_char\", this.cmd(\"match_end\"));\n        }\n        if (this.cmd(\"search_forward_regexp\", rx)) {\n            this.cmd(\"goto_char\", this.cmd(\"match_beginning\") + 1);\n        } else {\n            this.cmd(\"end_of_buffer\");\n        }\n    }),\n\n    backward_paragraph: Ymacs_Interactive_X(function(){\n        let rx = this.getq(\"syntax_paragraph_sep\");\n        this.cmd(\"beginning_of_line\");\n        if (this.cmd(\"looking_back\", rx)) {\n            this.cmd(\"goto_char\", this.cmd(\"match_beginning\"));\n        }\n        if (this.cmd(\"search_backward_regexp\", rx)) {\n            this.cmd(\"goto_char\", this.cmd(\"match_end\"));\n        } else {\n            this.cmd(\"beginning_of_buffer\");\n        }\n    }),\n\n    mark_paragraph: Ymacs_Interactive(\"^r\", function(begin, end){\n        if (!this.transientMarker) {\n            this.cmd(\"forward_paragraph\");\n            this.setMark(this.point());\n            this.ensureTransientMark();\n            this.cmd(\"backward_paragraph\");\n        }\n        else this.cmd(\"save_excursion\", function(){\n            if (this.transientMarker)\n                this.cmd(\"goto_char\", end);\n            this.ensureTransientMark();\n            this.cmd(\"forward_paragraph\");\n            this.setMark(this.point());\n            this.transientMarker.swap(this.caretMarker);\n        });\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n\n    transpose_words: Ymacs_Interactive_X(function() {\n        // if we're in the middle of a word, some\n        // weird things happen; better skip it, just\n        // like Emacs does.\n        this.cmd(\"backward_char\");\n        if (this.getq(\"syntax_word\").test(this.charAt()))\n            this.cmd(\"forward_word\");\n\n        var a = [];\n        this.cmd(\"forward_word\"); a.push(this.point());\n        this.cmd(\"backward_word\"); a.push(this.point());\n        this.cmd(\"backward_word\"); a.push(this.point());\n        this.cmd(\"forward_word\"); a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a));\n    }),\n\n    transpose_lines: Ymacs_Interactive_X(function() {\n        var a = [];\n        this.cmd(\"backward_line\");\n        this.cmd(\"beginning_of_line\"); a.push(this.point());\n        this.cmd(\"end_of_line\"); a.push(this.point());\n        this.cmd(\"forward_char\"); a.push(this.point());\n        this.cmd(\"end_of_line\"); a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a) + 1);\n    }),\n\n    transpose_chars: Ymacs_Interactive_X(function() {\n        var pos = this.point();\n        if (this.cmd(\"backward_char\"))\n            this.cmd(\"goto_char\", this._swapAreas([ pos - 1, pos, pos, pos + 1 ]));\n    }),\n\n    kill_word: Ymacs_Interactive(\"^p\", function(prefix) {\n        if (this.transientMarker) {\n            var r = this.getRegion();\n            this.cmd(\"kill_region\", r.begin, r.end);\n            this.clearTransientMark();\n        } else {\n            var pos = this.point();\n            this.cmd(\"forward_word\", prefix == null ? 1 : prefix);\n            var pos2 = this.point();\n            this._killingAction(pos, pos2, false);\n        }\n    }),\n\n    backward_kill_word: Ymacs_Interactive_X(function() {\n        var pos = this.point();\n        this.cmd(\"backward_word\");\n        var pos2 = this.point();\n        this._killingAction(pos, pos2, true);\n    }),\n\n    _apply_operation_on_word: function (op, cc) {\n        var pos = this.point();\n        if (this.getq(\"syntax_word\").test(this.charAt())) {\n            var pos2 = this.cmd(\"save_excursion\", function(){\n                this.cmd(\"forward_word\");\n                return this.point();\n            });\n            var word = op.call(this._bufferSubstring(pos, pos2));\n            this._deleteText(pos, pos2);\n            this._insertText(word);\n        } else {\n            this.cmd(\"forward_word\");\n            this.cmd(\"backward_word\");\n            if (pos != this.point())\n                this.cmd(cc);\n        }\n    },\n\n    capitalize_word: Ymacs_Interactive_X(function() {\n        this.cmd(\"_apply_operation_on_word\", function() {\n            return this.charAt(0).toUpperCase() + this.substr(1).toLowerCase();\n        }, \"capitalize_word\");\n    }),\n\n    downcase_word: Ymacs_Interactive_X(function() {\n        this.cmd(\"_apply_operation_on_word\", String.prototype.toLowerCase, \"downcase_word\");\n    }),\n\n    upcase_word: Ymacs_Interactive_X(function() {\n        this.cmd(\"_apply_operation_on_word\", String.prototype.toUpperCase, \"upcase_word\");\n    }),\n\n    goto_char: Ymacs_Interactive(\"NGoto char: \", function(pos){\n        return this._repositionCaret(pos);\n    }),\n\n    goto_line: Ymacs_Interactive(\"NGoto line: \", function(row){\n        var pos = this._rowColToPosition(row - 1, 0);\n        return this.cmd(\"goto_char\", pos);\n    }),\n\n    move_to_column: Ymacs_Interactive(\"NMove to column: \", function(col, force){\n        var rc = this._positionToRowCol(this.point());\n        var text = this.code[rc.row];\n        if (text.length < col) {\n            if (force) {\n                this.cmd(\"end_of_line\");\n                this.cmd(\"insert\", \" \".repeat(col - text.length));\n            } else {\n                this.cmd(\"end_of_line\");\n            }\n        } else {\n            this.cmd(\"goto_char\", this._rowColToPosition(rc.row, col));\n        }\n    }),\n\n    delete_region: Ymacs_Interactive(\"r\", function(begin, end){\n        this._deleteText(begin, end);\n    }),\n\n    insert: Ymacs_Interactive(\"sInsert text: \", function(...args){\n        return this._insertText(args.join(\"\"));\n    }),\n\n    keyboard_quit: Ymacs_Interactive(function(){\n        this.clearTransientMark();\n        this.setPrefixArg(undefined);\n        this.setMinibuffer(\"\");\n    }),\n\n    buffer_substring: function(begin, end) {\n        if (arguments.length == 0) {\n            var r = this.getRegion();\n            begin = r.begin;\n            end = r.end;\n        }\n        return this._bufferSubstring(begin, end);\n    },\n\n    kill_line: Ymacs_Interactive(\"^p\", function(prefix) {\n        if (this.transientMarker) {\n            var r = this.getRegion();\n            this.cmd(\"kill_region\", r.begin, r.end);\n            this.clearTransientMark();\n        } else if (prefix != null) {\n            this._killingAction(\n                this.point(),\n                this.cmd(\"save_excursion\", () => {\n                    this.cmd(\"forward_line\", prefix);\n                    this.cmd(\"beginning_of_line\");\n                    return this.point();\n                })\n            );\n        } else {\n            var pos = this.point(),\n                rc = this._rowcol,\n                line = this.code[rc.row],\n                end = pos + line.length - rc.col;\n            if (rc.row < this.code.length - 1 && this.cmd(\"looking_at\", /\\s*$/my))\n                end++;\n            this._killingAction(pos, end);\n        }\n    }),\n\n    save_excursion: function() {\n        return this._saveExcursion.apply(this, arguments);\n    },\n\n    prevent_undo: function() {\n        return this._disableUndo.apply(this, arguments);\n    },\n\n    point: function() {\n        return this.caretMarker.getPosition();\n    },\n\n    kill_region: Ymacs_Interactive(\"r\", function(begin, end){\n        this._killingAction(begin, end);\n    }),\n\n    copy_region_as_kill: Ymacs_Interactive(\"r\", function(begin, end){\n        this._killingAction(begin, end, false, true);\n    }),\n\n    yank: Ymacs_Interactive(\"^P\", function(atStart){\n        this.deleteTransientRegion();\n        var point = this.point();\n        this._insertText(this.ymacs.killRingText());\n        this.setMark(point);\n        if (atStart)\n            this.caretMarker.swap(this.markMarker);\n    }),\n\n    yank_from_operating_system: Ymacs_Interactive(async function() {\n        try {\n            let code = await navigator.clipboard.readText();\n            this._saveKilledText(code);\n            this.callInteractively(\"yank\");\n        } catch(ex) {\n            console.error(ex);\n            this.signalError(\"Cannot read the system clipboard. Error in devtools console.\");\n        }\n    }),\n\n    copy_for_operating_system: Ymacs_Interactive(\"r\", async function(begin, end) {\n        try {\n            let code = this.cmd(\"buffer_substring\", begin, end);\n            await navigator.clipboard.writeText(code);\n        } catch(ex) {\n            console.error(ex);\n            this.signalError(\"Cannot write to system clipboard. Error in devtools console.\");\n        }\n    }),\n\n    yank_pop: Ymacs_Interactive(function() {\n        if (/^yank/.test(this.previousCommand)) {\n            this.ymacs.rotateKillRing(false);\n            this._deleteText(this.caretMarker, this.markMarker);\n            this.cmd(\"yank\");\n        } else {\n            this.signalError(\"Previous command was not a yank\");\n        }\n    }),\n\n    yank_shift: Ymacs_Interactive(function() {\n        if (/^yank/.test(this.previousCommand)) {\n            this.ymacs.rotateKillRing(true);\n            this._deleteText(this.caretMarker, this.markMarker);\n            this.cmd(\"yank\");\n        } else {\n            this.signalError(\"Previous command was not a yank\");\n        }\n    }),\n\n    mark: function() {\n        return this.markMarker.getPosition();\n    },\n\n    set_mark_command: Ymacs_Interactive(\"d\", function(x){\n        this.clearTransientMark();\n        this.setMark(x);\n        if (this.currentCommand == \"set_mark_command\") {\n            this.signalInfo(\"Mark set\", null, 1000);\n            this.setq(\"sticky_mark\", true);\n        }\n    }),\n\n    exchange_point_and_mark: Ymacs_Interactive(\"^\", function(){\n        this.transientMarker = this.createMarker();\n        this.caretMarker.swap(this.markMarker);\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n\n    mark_whole_buffer: Ymacs_Interactive(function(){\n        this.clearTransientMark();\n        this.cmd(\"end_of_buffer\");\n        this.ensureTransientMark();\n        this.cmd(\"beginning_of_buffer\");\n        this.ensureTransientMark();\n    }),\n\n    recenter_top_bottom: Ymacs_Interactive(function() {\n        this.whenActiveFrame(function(frame){\n            frame.recenterTopBottom();\n        });\n    }),\n\n    recenter: Ymacs_Interactive(function() {\n        this.whenActiveFrame(function(frame){\n            frame.centerOnCaret();\n        });\n    }),\n\n    ensure_caret_visible: Ymacs_Interactive(function() {\n        this.whenActiveFrame(function(frame){\n            if (frame.ensureCaretVisible())\n                frame.centerOnCaret();\n        });\n    }),\n\n    /* -----[ paragraphs ]----- */\n\n    get_fill_paragraph_region: function() {\n        let r1 = this.cmd(\"save_excursion\", () => {\n            if (!this.cmd(\"looking_at\", this.getq(\"syntax_paragraph_sep\")))\n                this.cmd(\"forward_paragraph\");\n            let end = this.point() - 1;\n            this.cmd(\"backward_paragraph\");\n            let begin = this.point();\n            return { begin, end };\n        });\n        let r2 = this.cmd(\"xml_get_fill_paragraph_region\");\n        if (r2) {\n            return { begin: Math.max(r1.begin, r2.begin),\n                     end: Math.min(r1.end, r2.end) };\n        }\n        return r1;\n    },\n\n    fill_paragraph: Ymacs_Interactive(\"^rP\", function(begin, end, noPrefix) {\n        this.cmd(\"save_excursion\", function(){\n            if (!this.transientMarker) {\n                let r = this.cmd(\"get_fill_paragraph_region\");\n                begin = r.begin;\n                end = r.end;\n            } else {\n                this.clearTransientMark();\n            }\n\n            this.cmd(\"goto_char\", begin);\n            var eop = this.createMarker(end);\n\n            // identify the prefix to use for each line\n            var prefix = \"\", del = /\\s+/y;\n            if (this.cmd(\"looking_at\", /\\s*\\/\\/+\\s*/y)) {\n                prefix = this.matchData[0];\n                del = /\\s*\\/\\/+\\s*/y;\n            }\n            else if (this.cmd(\"looking_at\", /\\s*\\/\\*\\s*/y)) {\n                prefix = \" \".repeat(this.matchData[0].length);\n                del = /\\s*\\**\\s*/y;\n            }\n            else if (this.cmd(\"looking_at\", /\\s*[#>;\\s]+\\s*/y)) {\n                prefix = this.matchData[0];\n                del = /\\s*[#>;\\s]*\\s*/y;\n            }\n            else if (this.cmd(\"looking_at\", /\\s*([-*]|[0-9]+\\.|\\(?[a-z][\\).])?\\s+/iy)) {\n                prefix = \" \".repeat(this.matchData[0].length);\n                del = /\\s*[#>;\\s]*\\s*/y;\n            }\n\n            if (noPrefix) {\n                this._deleteText(this.point(), this.point() + this.matchData[0].length);\n                prefix = \"\";\n            }\n\n            // remove newlines first\n            while (true) {\n                this.cmd(\"end_of_line\");\n                this.cmd(\"backward_delete_whitespace\");\n                if (this.point() >= eop.getPosition())\n                    break;\n                this._replaceText(this.point(), this.point() + 1, \" \");\n                if (del && this.cmd(\"looking_at\", del)) {\n                    this._deleteText(this.point(), this.point() + this.matchData[0].length);\n                }\n            }\n\n            this.cmd(\"beginning_of_line\");\n\n            // main operation\n            var bol = this.point(), done = false;\n            while (!done) {\n                var p = this.point();\n                if (!this.cmd(\"search_forward_regexp\", /\\s/g)) {\n                    done = true;\n                }\n                if (this.point() >= eop.getPosition()) {\n                    this.cmd(\"goto_char\", eop);\n                    done = true;\n                }\n                if (this._rowcol.col > this.getq(\"fill_column\") + 1) {\n                    if (p > bol) {\n                        this.cmd(\"goto_char\", p);\n                    }\n                    this.cmd(\"backward_delete_whitespace\");\n                    this.cmd(\"newline\");\n                    this.cmd(\"insert\", prefix);\n                    bol = this.point();\n                }\n            }\n\n            eop.destroy();\n        });\n    }),\n\n    // this looks at the style of the current paragraph and starts\n    // a similar one, i.e. using same indentation level and prefix\n    // (list-like prefixes are incremented)\n    start_next_paragraph: Ymacs_Interactive(function() {\n        this.cmd(\"backward_paragraph\");\n\n        // identify the prefix to use for each line\n        var prefix = \"\";\n        if (this.cmd(\"looking_at\", /(\\s*)([0-9]+)(\\.\\s+)/y)) {\n            prefix = this.matchData[1] +\n                (parseInt(this.matchData[2], 10) + 1) +\n                this.matchData[3];\n        }\n        else if (this.cmd(\"looking_at\", /(\\s*\\(?)([a-z])([\\.\\)]\\s+)/iy)) {\n            prefix = this.matchData[1] +\n                String.fromCharCode(this.matchData[2].charCodeAt(0) + 1) +\n                this.matchData[3];\n        }\n        else if (this.cmd(\"looking_at\", /\\s*[#>;*\\s-]+\\s*/y)) {\n            prefix = this.matchData[0];\n        }\n\n        this.cmd(\"forward_paragraph\");\n        if (this.cmd(\"eob_p\"))\n            this.cmd(\"newline\");\n\n        this.cmd(\"insert\", \"\\n\", prefix);\n\n        if (!this.cmd(\"looking_at\", /\\n\\n/y)) {\n            this.cmd(\"newline\");\n            this.cmd(\"backward_char\");\n        };\n    }),\n\n    scroll_down_half: Ymacs_Interactive_X(function() {\n        this.whenActiveFrame(function(frame){\n            var hl = frame.heightInLines();\n            this.cmd(\"forward_line\", Math.round(hl / 1.33));\n            this.cmd(\"recenter\");\n        });\n    }),\n\n    scroll_up_half: Ymacs_Interactive_X(function() {\n        this.whenActiveFrame(function(frame){\n            var hl = frame.heightInLines();\n            this.cmd(\"backward_line\", Math.round(hl / 1.33));\n            this.cmd(\"recenter\");\n        });\n    }),\n\n    scroll_up: Ymacs_Interactive(\"p\", function(arg){\n        if (arg == null) arg = 3;\n        this.whenActiveFrame(function(frame){\n            frame.scrollUp(arg);\n        });\n    }),\n\n    scroll_down: Ymacs_Interactive(\"p\", function(arg){\n        if (arg == null) arg = 3;\n        this.whenActiveFrame(function(frame){\n            frame.scrollDown(arg);\n        });\n    }),\n\n    nuke_trailing_whitespace: Ymacs_Interactive(function() {\n        this.cmd(\"save_excursion\", function(){\n            this.cmd(\"goto_char\", 0);\n            while (this._rowcol.row < this.code.length) {\n                var line = this.code[this._rowcol.row],\n                m = /\\s+$/.exec(line);\n                if (m) {\n                    this.cmd(\"beginning_of_line\");\n                    this._deleteText(this.point() + m.index, this.point() + line.length);\n                }\n                if (!this.cmd(\"forward_line\"))\n                    break;\n            }\n        });\n    }),\n\n    match_string: function(n) {\n        return this.matchData[n];\n    },\n\n    match_beginning: function() {\n        return this.matchData.index;\n    },\n\n    match_end: function() {\n        return this.matchData.index + this.matchData[0].length;\n    },\n\n    undo: Ymacs_Interactive_X(function() {\n        this._placeUndoBoundary();\n        if (!this._playbackUndo()) {\n            this.signalError(\"No further undo information\");\n        }\n    }),\n\n    center_line: Ymacs_Interactive(\"p\", function(n){\n        if (n == null) n = 1;\n        for (let i = 0; i < n; ++i) {\n            if (i > 0) this.cmd(\"forward_line\");\n            this.cmd(\"save_excursion\", function(){\n                this.cmd(\"end_of_line\");\n                this.cmd(\"backward_delete_whitespace\", true);\n                this.cmd(\"beginning_of_line\");\n                this.cmd(\"delete_whitespace\", true);\n                var line = this.code[this._rowcol.row];\n                var indent = Math.floor((this.getq(\"fill_column\") - line.length) / 2);\n                this.cmd(\"insert\", \" \".repeat(indent));\n            });\n        }\n    }),\n\n    /* -----[ dabbrev ]----- */\n\n    dabbrev_expand: Ymacs_Interactive_X(function() {\n        if (this.previousCommand != \"dabbrev_expand\")\n            this.setq(\"dabbrev_context\", null);\n\n        var ctx = this.getq(\"dabbrev_context\");\n        if (!ctx) {\n            ctx = this.setq(\"dabbrev_context\", {});\n            var p1 = this.cmd(\"save_excursion\", function(){\n                this.cmd(\"bind_variables\", {\n                    syntax_word: this.getq(\"syntax_word_dabbrev\")\n                }, \"backward_word\");\n                return this.point();\n            });\n            if (p1 == this.point())\n                return this.signalError(\"Nothing to expand\");\n            ctx.search = this.cmd(\"buffer_substring\", p1, this.point());\n            ctx.point = p1;\n            ctx.length = this.point() - p1;\n            ctx.lastSearch = p1;\n            ctx.encountered = Object.create(null);\n            ctx.forward = false;\n            ctx.buffer = this;\n            ctx.seenBuffers = [ this ];\n            ctx.startBuffer = this;\n        }\n        var expansion;\n\n        // in the following excursion, *this* is ctx.buffer,\n        // not necessarily the currently active buffer.  It's\n        // purpose is to determine the next expansion and\n        // setup the context so that the next invocation would\n        // continue.\n        ctx.buffer.cmd(\"save_excursion\", function repeat(){\n            var word = this.getq(\"syntax_word_dabbrev\");\n            var p1;\n            var found = false;\n            this.cmd(\"goto_char\", ctx.lastSearch);\n            // console.log(\"last at: %d\", ctx.lastSearch);\n            if (!ctx.forward) {\n                while (this.cmd(\"search_backward\", ctx.search)) {\n                    if (!word.test(this.charAt(-1))) {\n                        found = true;\n                        break;\n                    }\n                }\n                if (found) {\n                    p1 = this.point();\n                    ctx.lastSearch = p1;\n                    this.cmd(\"goto_char\", p1 + ctx.search.length);\n                } else {\n                    ctx.forward = true;\n                    ctx.lastSearch = ctx.point + ctx.length;\n                    repeat.call(this);\n                    return;\n                }\n            } else {\n                while (this.cmd(\"search_forward\", ctx.search))\n                    if (!word.test(this.charAt(-ctx.search.length - 1))) {\n                        found = true;\n                        break;\n                    }\n                if (found) {\n                    ctx.lastSearch = this.point();\n                    p1 = this.point() - ctx.search.length;\n                } else {\n                    ctx.buffer = this.whenYmacs(\"getNextBuffer\", this);\n                    if (ctx.seenBuffers.includes(ctx.buffer)) {\n                        expansion = ctx.search;\n                        ctx.startBuffer.signalError(\"No more completions\");\n                        ctx.lastSearch = ctx.point + ctx.length;\n                        ctx.startBuffer.setq(\"dabbrev_context\", null);\n                        return;\n                    } else {\n                        ctx.seenBuffers.push(ctx.buffer);\n                        ctx.lastSearch = 0;\n                        ctx.buffer.cmd(\"save_excursion\", repeat);\n                        return;\n                    }\n                }\n            }\n            if (p1 != null) {\n                // console.log(\"%s at %d, next from %d\", ctx.search, p1, ctx.lastSearch);\n                this.cmd(\"bind_variables\", {\n                    syntax_word: this.getq(\"syntax_word_dabbrev\")\n                }, \"forward_word\");\n                expansion = this.cmd(\"buffer_substring\", p1, this.point());\n                if (ctx.encountered[expansion])\n                    repeat.call(this);\n            }\n        });\n        if (expansion != null) {\n            this._replaceText(ctx.point, ctx.point + ctx.length, expansion);\n            ctx.length = expansion.length;\n            ctx.encountered[expansion] = true;\n        }\n    }),\n\n    /* -----[ frames and buffers ]----- */\n\n    split_frame_vertically: Ymacs_Interactive(\"p\", function(percent) {\n        if (percent == null) percent = \"50%\";\n        else percent += \"%\";\n        this.whenActiveFrame(\"vsplit\", percent);\n    }),\n\n    split_frame_horizontally: Ymacs_Interactive(\"p\", function(percent) {\n        if (percent == null) percent = \"50%\";\n        else percent += \"%\";\n        this.whenActiveFrame(\"hsplit\", percent);\n    }),\n\n    delete_other_frames: Ymacs_Interactive(function() {\n        this.whenActiveFrame(\"deleteOtherFrames\");\n    }),\n\n    delete_frame: Ymacs_Interactive(function() {\n        this.whenActiveFrame(\"deleteFrame\");\n    }),\n\n    other_frame: Ymacs_Interactive(function() {\n        this.whenYmacs(\"focusOtherFrame\");\n    }),\n\n    windmove: function(dir) {\n        this.whenYmacs(function(ymacs){\n            var f = ymacs.getFrameInDirection(dir);\n            if (f) f.focus();\n        });\n    },\n\n    next_buffer: Ymacs_Interactive(function() {\n        this.whenYmacs(\"switchToNextBuffer\", this.sameCommandCount() + 1);\n    }),\n\n    previous_buffer: Ymacs_Interactive(function() {\n        this.whenYmacs(\"switchToPreviousBuffer\", this.sameCommandCount() + 1);\n    }),\n\n    switch_to_buffer: Ymacs_Interactive(\"BSwitch to buffer: \", function(buffer) {\n        this.whenYmacs(function(ymacs){\n            if (!/\\S/.test(buffer)) {\n                if (ymacs.buffers.length < 2) return;\n                buffer = ymacs.buffers[1];\n            }\n            ymacs.switchToBuffer(buffer);\n        });\n    }),\n\n    kill_buffer: Ymacs_Interactive(function() {\n        var self = this;\n        function kill() {\n            self.whenYmacs(function(ymacs){\n                ymacs.killBuffer(self);\n            });\n        }\n        if (self.dirty()) {\n            var msg = \"Buffer \" + self.name + \" modified; kill anyway?\";\n            self.cmd(\"minibuffer_yn\", msg, function(yes){\n                if (yes) kill();\n            });\n        } else {\n            kill();\n        }\n    }),\n\n    rename_buffer: Ymacs_Interactive(\"sRename current buffer to: \", function(name){\n        this.whenYmacs(function(ymacs){\n            ymacs.renameBuffer(this, name);\n        });\n    }),\n\n    /* -----[ other ]----- */\n\n    delete_region_or_line: Ymacs_Interactive(\"^\", function() {\n        if (!this.deleteTransientRegion()) {\n            this.cmd(\"beginning_of_line\");\n            var pos = this.point();\n            this.cmd(\"end_of_line\");\n            this.cmd(\"forward_char\");\n            if (this.point() != pos) {\n                this._deleteText(pos, this.point());\n                return true;\n            }\n        }\n    }),\n\n    // http://mihai.bazon.net/blog/close-last-xml-tag-emacs\n    close_last_xml_tag: Ymacs_Interactive_X(function() {\n        var tag, quote;\n        this.cmd(\"save_excursion\", function() {\n            var skip = 1;\n            while (skip != 0 && this.cmd(\"search_backward_regexp\", /<\\x2f?([a-zA-Z0-9:_-]+)/g)) {\n                tag = this.cmd(\"match_string\", 1);\n                if (this.cmd(\"looking_at\", /<\\x2f/y)) {\n                    ++skip;\n                }\n                else if (!this.cmd(\"looking_at\", /<[^\\x2f][^>]*?\\x2f>/y)) {\n                    --skip;\n                }\n            }\n            if (skip != 0)\n                tag = null;\n        });\n        if (tag) {\n            this.cmd(\"insert\", \"</\", tag, \">\");\n        } else {\n            throw new Ymacs_Exception(\"Couldn't find a tag to close\");\n        }\n    }),\n\n    bind_variables: function() {\n        return this.withVariables.apply(this, arguments);\n    },\n\n    for_region: Ymacs_Interactive(\"^r\\nCExecute command within region: \", function(begin, end, func) {\n        if (end < begin) { var tmp = begin; begin = end; end = tmp; } // MACROS!  I WANT MACROS!  EVAL SUCKS. x-(\n        if (!(func instanceof Function))\n            func = this.COMMANDS[func];\n        this.clearTransientMark();\n        this.cmd(\"goto_char\", begin);\n        begin = this.createMarker(begin, true);\n        end = this.createMarker(end);\n        this.withCommands(\n            {\n                goto_char: function(pos){\n                    if (pos >= begin.getPosition() && pos <= end.getPosition())\n                        return this._repositionCaret(pos);\n                    throw \"YMACS_RESTRICT\";\n                }\n            },\n            function() {\n                try {\n                    while (true) {\n                        var tmp = this.point();\n                        func.call(this);\n                        if (this.point() == tmp && !this.cmd(\"forward_line\"))\n                            break;\n                    }\n                } catch(ex) {\n                    if (ex !== \"YMACS_RESTRICT\")\n                        throw ex;\n                } finally {\n                    begin.destroy();\n                    end.destroy();\n                }\n            }\n        );\n    }),\n\n    comment_region: Ymacs_Interactive(\"^r\", function(begin, end){\n        var cmmt = this.getq(\"syntax_comment_line\") || this.getq(\"syntax_comment_multi\");\n        if (!cmmt) return;\n        this.clearTransientMark();\n        this.cmd(\"save_excursion\", function(){\n            end = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            var min = 100000;\n            out: while (this.point() < end.getPosition()) {\n                while (this.cmd(\"looking_at\", /\\s*$/my)) {\n                    if (!this.cmd(\"forward_line\")) break out;\n                }\n                var col = this._rowcol.col;\n                while (this.cmd(\"looking_at\", /\\s/y) && col < min) {\n                    if (!this.cmd(\"forward_char\")) break out;\n                    ++col;\n                }\n                if (col < min) min = col;\n                if (Array.isArray(cmmt.ch)) {\n                    this.cmd(\"insert\", cmmt.ch[0], \" \");\n                    this.cmd(\"end_of_line\");\n                    this.cmd(\"insert\", \" \", cmmt.ch[1]);\n                } else {\n                    this.cmd(\"insert\", cmmt.ch, \" \");\n                }\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\")) break out;\n            }\n            this.cmd(\"goto_char\", end);\n            if (this._rowcol.col > 0 && !this.cmd(\"looking_at\", /\\s*$/my))\n                this.cmd(\"newline_and_indent\");\n        });\n    }),\n\n    uncomment_region: Ymacs_Interactive(\"r\", function(begin, end){\n        var cmmt1 = this.getq(\"syntax_comment_line\");\n        var cmmt2 = this.getq(\"syntax_comment_multi\");\n        if (!cmmt1 && !cmmt2) return;\n        this.clearTransientMark();\n        this.cmd(\"save_excursion\", function(){\n            end = this.createMarker(end);\n            this.cmd(\"goto_char\", begin);\n            while (this.point() < end.getPosition()) {\n                this.cmd(\"forward_whitespace\");\n                if (cmmt1 && this.cmd(\"looking_at\", cmmt1.rx)) {\n                    this.cmd(\"delete_char\", this.matchData[0].length);\n                } else if (cmmt2 && this.cmd(\"looking_at\", cmmt2.rx)) {\n                    this._replaceText(this.point(), this.point() + this.matchData[0].length, this.matchData[1]);\n                }\n                this.cmd(\"beginning_of_line\");\n                if (!this.cmd(\"forward_line\")) break;\n            }\n        });\n    }),\n\n    comment_dwim: Ymacs_Interactive(\"^r\", function(begin, end){\n        var cmmt1 = this.getq(\"syntax_comment_line\");\n        var cmmt2 = this.getq(\"syntax_comment_multi\");\n        if (!cmmt1 && !cmmt2) return;\n        if (this.transientMarker) {\n            this.cmd(\"save_excursion\", function(){\n                this.cmd(\"goto_char\", begin);\n                var already_comment =\n                    (cmmt1 && this.cmd(\"looking_at\", cmmt1.rx))\n                    ||\n                    (cmmt2 && this.cmd(\"looking_at\", cmmt2.rx));\n                if (already_comment) {\n                    this.cmd(\"uncomment_region\", begin, end);\n                } else {\n                    this.cmd(\"comment_region\", begin, end);\n                }\n            });\n        } else {\n            this.cmd(\"end_of_line\");\n            if (cmmt1) {\n                this.cmd(\"insert\", \" \", cmmt1.ch, \" \");\n            } else {\n                this.cmd(\"insert\", \" \", cmmt2.ch[0], cmmt2.ch[1]);\n                this.cmd(\"backward_char\", cmmt2.ch[1].length);\n            }\n            this.cmd(\"indent_line\");\n        }\n    }),\n\n    what_cursor_position: Ymacs_Interactive(\"^\", function(){\n        var ch = this.charAt(), chname = ch;\n        if (ch == null)\n            chname = \"EOF\";\n        else if (ch == \" \")\n            chname = \"Space\";\n        else if (ch == \"\\n\")\n            chname = \"Newline\";\n        this.popupMessage({\n            isHtml: true,\n            atCaret: true,\n            text: TMPL_CHAR_INFO({\n                ch      : DOM.htmlEscape(chname),\n                code    : ch ? ch.charCodeAt(0) : null,\n                codeHex : ch ? ch.charCodeAt().toString(16).toUpperCase() : null,\n                point   : this.point(),\n                size    : this.getCodeSize(),\n                sizeKB  : formatBytes(this.getCodeSize(), 2)\n            }),\n        });\n    }),\n\n    set_fill_column: Ymacs_Interactive(\"p\", function(value){\n        let next = value => {\n            let prev = this.getq(\"fill_column\");\n            this.setq(\"fill_column\", +value);\n            this.signalInfo(`Fill column set to ${value} (was ${prev})`, false, 5000);\n        };\n        if (value == null) {\n            this.whenMinibuffer(mb => {\n                this.cmd(\"minibuffer_prompt\", \"Set fill column to: \");\n                mb.setMark();\n                mb.transientMarker = mb.createMarker(mb.point(), true);\n                mb.cmd(\"insert\", String(this._rowcol.col));\n                mb.ensureTransientMark();\n                this.cmd(\"minibuffer_read_number\", next);\n            });\n        } else {\n            next(value);\n        }\n    }),\n\n});\n\n/* -----[ rectangle functions (vertical editing) ]----- */\n\n(function(){\n\n    function apply_on_rectangle(buffer, begin, end, func) {\n        buffer.cmd(\"save_excursion\", function(){\n            var p1 = this._positionToRowCol(begin),\n            p2 = this._positionToRowCol(end),\n            width = Math.abs(p2.col - p1.col);\n            for (var line = p1.row; line <= p2.row; ++line) {\n                this.cmd(\"goto_char\", this._rowColToPosition(line, 0));\n                var text = this.code[line],\n                c1 = p1.col,\n                c2 = p2.col,\n                p = this.point(), ws = 0;\n                if (c1 > c2) {\n                    var tmp = c1;\n                    c1 = c2;\n                    c2 = tmp;\n                }\n                if (c1 > text.length) {\n                    ws = c1 - text.length;\n                    c1 = text.length;\n                }\n                if (c2 > text.length) {\n                    c2 = text.length;\n                }\n                func.call(this, p + c1, p + c2, ws, width);\n            }\n        }, begin == buffer.point());\n    };\n\n    Ymacs_Buffer.newCommands({\n\n        string_rectangle: Ymacs_Interactive(\"r\\nsString rectangle: \", function(begin, end, string) {\n            apply_on_rectangle(this, begin, end, function(c1, c2, ws){\n                if (ws > 0) {\n                    this._insertText(\" \".repeat(ws), c1);\n                } else {\n                    this._deleteText(c1, c2);\n                }\n                this._insertText(string, c1 + ws);\n            });\n        }),\n\n        kill_rectangle: Ymacs_Interactive(\"r\", function(begin, end){\n            var text = [];\n            apply_on_rectangle(this, begin, end, function(c1, c2, ws, width){\n                var str = this._bufferSubstring(c1, c2);\n                if (c2 - c1 < width)\n                    str += \" \".repeat(width - c2 + c1);\n                text.push(str);\n                this._deleteText(c1, c2);\n            });\n            this.setq(\"killed_rectangle\", text);\n        }),\n\n        clear_rectangle: Ymacs_Interactive(\"r\", function(begin, end){\n            this.cmd(\"string_rectangle\", begin, end,\n                     \" \".repeat(Math.abs(this._positionToRowCol(end).col -\n                                         this._positionToRowCol(begin).col)));\n        }),\n\n        insert_rectangle: function(point, rect) {\n            var col = this._positionToRowCol(point).col;\n            this.setMark(point);\n            rect.forEach((text, i) => {\n                if (i > 0) {\n                    if (!this.cmd(\"forward_line\")) {\n                        this.cmd(\"end_of_line\");\n                        this.cmd(\"newline\");\n                    }\n                    this.cmd(\"move_to_column\", col, true);\n                }\n                this.cmd(\"insert\", text);\n            });\n        },\n\n        yank_rectangle: Ymacs_Interactive(\"d\", function(point){\n            var kr = this.getq(\"killed_rectangle\");\n            if (kr == null)\n                throw new Ymacs_Exception(\"No killed rectangle\");\n            this.cmd(\"insert_rectangle\", point, kr);\n        }),\n\n        _next_is_meta: function() {\n            if (!this.__nextIsMeta) {\n                this.__nextIsMeta = true;\n                this.currentKeys.pop();\n            }\n        },\n\n    });\n\n})();\n\n(function(){\n    Ymacs_Buffer.newCommands({\n        kmacro_start_macro: Ymacs_Interactive(\"p\", function(arg) {\n            if (this.ymacs.isRunningMacro()) {\n                return;\n            }\n            if (this.ymacs.isRecordingMacro()) {\n                this.signalError(\"Already defining keyboard macro.\");\n                return;\n            }\n            this.signalInfo(\"Defining keyboard macro\");\n            this.ymacs.startMacro(arg !== null);\n        }),\n        kmacro_end_macro: Ymacs_Interactive(function() {\n            if (this.ymacs.isRunningMacro()) {\n                return;\n            }\n            if (!this.ymacs.isRecordingMacro()) {\n                this.signalInfo(\"Not defining kbd macro\");\n                return;\n            }\n            this.signalInfo(\"Keyboard macro defined\");\n            this.ymacs.stopMacro();\n        }),\n        kmacro_end_and_call_macro: Ymacs_Interactive(\"p\", function(arg) {\n            this.ymacs.stopMacro();\n            if (arg === null)\n                arg = 1;\n            var macro = this.ymacs.getLastMacro();\n            this.interactiveEvent(null);\n            this.ymacs.runMacro(arg, macro);\n        })\n    });\n})();\n\n/* -----[ transient mark extension commands ]----- */\n\n[\n    \"forward_char\",\n    \"forward_word\",\n    \"forward_line\",\n    \"forward_paragraph\",\n    \"forward_sexp\",\n    \"beginning_of_line\",\n    \"beginning_of_indentation_or_line\",\n    \"beginning_of_buffer\",\n    \"backward_char\",\n    \"backward_word\",\n    \"backward_line\",\n    \"backward_paragraph\",\n    \"backward_sexp\",\n    \"end_of_line\",\n    \"end_of_buffer\"\n\n].forEach(function(cmd) {\n    Ymacs_Buffer.COMMANDS[cmd + \"_mark\"] = Ymacs_Interactive(\"^\", function(){\n        this.ensureTransientMark();\n        this.cmdApply(cmd, arguments);\n        this.ensureTransientMark();\n    });\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { zeroPad, getYmacsThemes } from \"./ymacs-utils.js\";\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\nimport { read_with_continuation } from \"./ymacs-minibuffer.js\";\n\nYmacs_Buffer.newCommands({\n\n    get_region: function() {\n        return this.getRegion();\n    },\n\n    figure_out_mode: function(code) {\n        if (!code)\n            code = this.getCode();\n        var lines = code.split(/\\n/);\n        if (lines.length > 4)\n            lines.splice(2, lines.length - 4);\n        for (let line of lines) {\n            let m = /-\\*-\\s*(.*?)\\s*-\\*-/i.exec(line);\n            if (m) return m[1];\n        }\n    },\n\n    // TODO: the mapping from extension to mode should be defined\n    // with each mode.\n    mode_from_name: function(name) {\n        if (!name) name = this.name;\n        var ext = (/\\.[^.]+$/.exec(name) || [\"\"])[0];\n        switch (ext) {\n          case \".css\":\n            return \"css\";\n\n          case \".js\":\n            return \"javascript\";\n\n          case \".lisp\":\n          case \".scm\":\n          case \".el\":\n            return \"lisp\";\n\n          case \".md\":\n            return \"markdown\";\n\n          case \".xml\":\n            return \"xml\";\n\n          case \".html\":\n            return \"html\";\n        }\n        return null;\n    },\n\n    set_buffer_mode: function(mode) {\n        if (!mode)\n            mode = this.cmd(\"figure_out_mode\") || this.cmd(\"mode_from_name\");\n        if (mode) {\n            if (this.COMMANDS[mode]) {\n                this.cmd(mode, true);\n            } else if (this.COMMANDS[mode + \"_mode\"]) {\n                this.cmd(mode + \"_mode\", true);\n            }\n        }\n    },\n\n    cperl_lineup: Ymacs_Interactive(\"r\", function(begin, end){\n        this.cmd(\"save_excursion\", function(){\n            var rcend = this._positionToRowCol(end), max = 0, lines = [];\n            this.cmd(\"goto_char\", begin);\n            this.cmd(\"forward_whitespace\", true);\n            var ch = this.charAt();\n            if (ch.toLowerCase() != ch.toUpperCase()) {\n                this.signalError(\"Cannot lineup here\");\n                return;\n            }\n            while (this._rowcol.row <= rcend.row) {\n                var pos = this.getLine().indexOf(ch);\n                if (pos >= 0) {\n                    if (pos > max)\n                        max = pos;\n                    lines.push([ this._rowcol.row, pos ]);\n                }\n                if (!this.cmd(\"forward_line\"))\n                    break;\n            }\n            ++max;\n            lines.forEach(l => {\n                this.cmd(\"goto_char\", this._rowColToPosition(l[0], l[1]));\n                this.cmd(\"insert\", \" \".repeat(max - l[1]));\n            });\n        });\n    }),\n\n    htmlize_region: Ymacs_Interactive(\"r\\nP\", function(begin, end, lineNum) {\n        this.tokenizer.finishParsing();\n        var row = this._positionToRowCol(begin).row;\n        var html = \"\";\n        var line = row;\n        var pad;\n        if (lineNum && !lineNum.empty)\n            line = parseInt(lineNum, 10);\n        end = this._positionToRowCol(end).row;\n        pad = String(end).length;\n        while (row <= end) {\n            html += \"<div class='line'>\";\n            if (lineNum)\n                html += \"<span class='line-number'>\" + zeroPad(line, pad, \" \") + \"</span>\";\n            ++line;\n            html += this._textProperties.getLineHTML(row, this.code[row], null) + \"</div>\\n\";\n            ++row;\n        }\n        var tmp = this.ymacs.switchToBuffer(\"*Htmlize*\");\n        tmp.setCode(html);\n        tmp.cmd(\"xml_mode\", true);\n    }),\n\n    execute_extended_command: Ymacs_Interactive(\"^CM-x \", function(cmd) {\n        this.callInteractively(cmd);\n    }),\n\n    set_variable: Ymacs_Interactive(\"vSet variable: \\nsTo value: \", function(variable, value) {\n        var tmp = parseFloat(value);\n        if (!isNaN(tmp))\n            value = tmp;\n        this.setq(variable, value);\n    }),\n\n    eval_string: Ymacs_Interactive(\"^MEval string: \", function(code){\n        try {\n            var variables = [\n                this,      // buffer\n                this.ymacs // ymacs\n            ];\n            code = new Function(\"buffer\", \"ymacs\", code);\n            code.apply(this, variables);\n            this.clearTransientMark();\n        } catch(ex) {\n            this.signalError(ex.type + \": \" + ex.message);\n            if (window.console)\n                console.log(ex);\n        }\n    }),\n\n    eval_region: Ymacs_Interactive(\"^r\", function(begin, end) {\n        this.cmd(\"eval_string\", this.cmd(\"buffer_substring\", begin, end));\n    }),\n\n    eval_buffer: Ymacs_Interactive(function(){\n        this.cmd(\"eval_string\", this.getCode());\n    }),\n\n    toggle_line_numbers: Ymacs_Interactive(\"^\", function(){\n        this.ymacs.toggleClass(\"Ymacs-line-numbers\");\n    }),\n\n    save_file: Ymacs_Interactive(\"FWrite file: \", function(name){\n        this.ymacs.ls_setFileContents(name, this.getCode());\n        this.signalInfo(\"Saved in local storage\");\n    }),\n\n    load_file: Ymacs_Interactive(\"fFind file: \", function(name){\n        var code = this.ymacs.ls_getFileContents(name);\n        var buffer = this.ymacs.createBuffer({ name: name });\n        buffer.setCode(code);\n        buffer.cmd(\"set_buffer_mode\");\n        buffer.cmd(\"switch_to_buffer\", name);\n    }),\n\n    find_file: Ymacs_Interactive(\"FFind file: \", function(name) {\n        var self = this;\n        name = self.ymacs.fs_normalizePath(name);\n        self.ymacs.fs_fileType(name, function (type) {\n            if (type === \"directory\") {\n                self.signalInfo(\"Can't open directory\");\n            } else {\n                self.ymacs.fs_getFileContents(name, true, function (code, stamp) {\n                    var buffer = self.ymacs.getBuffer(name);\n\n                    function find_file() {\n                        buffer.setCode(code || \"\");\n                        buffer.stamp = stamp;\n                        buffer.dirty(false);\n                        buffer.cmd(\"set_buffer_mode\");\n                        buffer.cmd(\"switch_to_buffer\", name);\n                    }\n\n                    if (buffer) {\n                        if (stamp == null) {\n                            find_file();\n                        } else if (buffer.stamp == stamp) {\n                            buffer.cmd(\"switch_to_buffer\", name);\n                        } else {\n                            var msg = \"File \" + name + \" changed on disk.  \"\n                                + (buffer.dirty() ? \"Discard your edits?\" : \"Reread from disk?\");\n                            buffer.cmd(\"minibuffer_yn\", msg, function (yes) {\n                                if (yes)\n                                    find_file();\n                            });\n                        }\n                    } else {\n                        buffer = self.ymacs.createBuffer({ name: name, stamp: stamp });\n                        if (code == null)\n                            self.signalInfo(\"New file\");\n                        find_file();\n                    }\n                });\n            }\n        });\n    }),\n\n    write_file: Ymacs_Interactive(\"FWrite file: \", function(name){\n        var self = this;\n\n        function write_file() {\n            self.ymacs.fs_setFileContents(name, self.getCode(), null, function (stamp) {\n                self.cmd(\"rename_buffer\", name);\n                self.dirty(false);\n                self.stamp = stamp; // refresh stamp\n                self.signalInfo(\"Wrote \"+name);\n            });\n        }\n\n        var buffer = self.ymacs.getBuffer(name);\n        if (!buffer)\n            write_file();\n        else {\n            var msg = \"A buffer is visiting \"+name+\"; proceed?\";\n            buffer.cmd(\"minibuffer_yn\", msg, function (yes) {\n                if (yes) {\n                    self.ymacs.killBuffer(buffer);\n                    write_file();\n                }\n            });\n        }\n    }),\n\n    save_some_buffers: function () {\n        this.cmd(\"save_some_buffers_with_continuation\", true, function () { });\n    },\n\n    save_some_buffers_with_continuation: function (ask, cont) {\n\n        var bufs = this.ymacs.buffers.slice(); // get copy of buffers\n\n        function loop(saved) {\n            if (bufs.length > 0)\n                bufs.shift().cmd(\"save_buffer_with_continuation\", ask, loop);\n            else\n                cont();\n        }\n\n        loop(false);\n    },\n\n    save_buffer_with_continuation: function (ask, cont) {\n\n        var self = this;\n\n        function did_save(stamp) {\n            self.dirty(false);\n            self.stamp = stamp; // refresh stamp\n            cont(true);\n        }\n\n        function do_save() {\n            self.ymacs.fs_setFileContents(self.name, self.getCode(), self.stamp, function (stamp) {\n                if (stamp != null) {\n                    did_save(stamp);\n                } else {\n                    self.cmd(\"minibuffer_yn\", self.name + \" has changed since visited or saved.  Save anyway?\", function (yes) {\n                        if (!yes) {\n                            cont(false);\n                        } else {\n                            self.ymacs.fs_setFileContents(self.name, self.getCode(), null, function (stamp) {\n                                did_save(stamp);\n                            });\n                        }\n                    });\n                }\n            });\n        }\n\n        if (!self.dirty() || (ask && self.name.match(/^\\*.*\\*$/))) {\n            cont(false);\n        } else if (!ask) {\n            do_save();\n        } else {\n            self.cmd(\"minibuffer_yn\", \"Save file \" + self.name + \"?\", function (yes) {\n                if (!yes) {\n                    cont(false);\n                } else {\n                    do_save();\n                }\n            });\n        }\n    },\n\n    save_buffer: Ymacs_Interactive(\"\", function () {\n        var self = this;\n        if (self.dirty())\n            self.cmd(\"save_buffer_with_continuation\", false, function (saved) {\n                if (saved)\n                    self.signalInfo(\"Wrote \"+self.name);\n            });\n        else\n            self.signalInfo(\"No changes need to be saved\");\n    }),\n\n    delete_file: Ymacs_Interactive(\"fDelete file: \", function(name){\n        var self = this;\n        self.ymacs.fs_deleteFile(name, function () {\n            self.signalInfo(\"Deleted \"+name);\n        });\n    }),\n\n    eval_file: Ymacs_Interactive(\"fEval file: \", function(name){\n        var self = this;\n        self.ymacs.fs_getFileContents(name, false, function (code, stamp) {\n            self.cmd(\"eval_string\", code);\n        });\n    }),\n\n    request_full_screen: Ymacs_Interactive(async function(){\n        try {\n            this.ymacs.requestFullScreen();\n        } catch(ex) {\n            console.error(ex);\n            this.signalError(\"Full-screen denied\", false, 3000);\n        }\n    }),\n\n    set_color_theme: Ymacs_Interactive(function(theme){\n        if (theme) {\n            this.ymacs.setColorTheme(theme);\n        } else {\n            let names = getYmacsThemes().sort();\n            this.cmd(\"minibuffer_prompt\", \"Color theme: \");\n            read_with_continuation.call(this, names, theme => {\n                this.ymacs.setColorTheme(theme);\n            }, (mb, theme, cont) => {\n                theme = theme.trim();\n                if (!theme) {\n                    mb.cmd(\"minibuffer_complete\");\n                } else if (names.indexOf(theme) < 0) {\n                    mb.signalError(\"No such theme\");\n                    return cont(false);\n                } else {\n                    return cont(true);\n                }\n            });\n        }\n    }),\n\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { DOM, common_prefix } from \"./ymacs-utils.js\";\nimport { Ymacs_Popup } from \"./ymacs-popup.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\nvar $menu = null, $selectedIndex = null, $selectedItem = null;\nfunction popupCompletionMenu(frame, list) {\n    let activeElement = document.activeElement;\n    let ymacs = this.ymacs; // `this` is the minibuffer\n    $menu = new Ymacs_Popup();\n    $menu.addClass(\"with-arrow\");\n    list.forEach((label, index) => {\n        let value = label;\n        if (typeof label != \"string\") {\n            value = label.value;\n            label = label.label;\n        }\n        let el = DOM.fromHTML(`<div class=\"Ymacs_Menu_Item\" data-value=\"${DOM.htmlEscape(value)}\"\n                                          data-index=\"${index}\">${DOM.htmlEscape(label)}</div>`);\n        $menu.add(el);\n    });\n    DOM.on($menu.getContentElement(), {\n        click: ev => {\n            activeElement.focus();\n            let item = ev.target;\n            if (!DOM.hasClass(item, \"Ymacs_Menu_Item\")) return;\n            select(+item.dataset.index);\n            handle_enter.call(this);\n            handle_enter.call(this);\n        },\n    });\n    ymacs._popupAtCaret($menu.getElement());\n    select(0);\n\n    this.pushKeymap(KEYMAP_POPUP_ACTIVE);\n    $menu.addEventListener(\"onDestroy\", () => this.popKeymap(KEYMAP_POPUP_ACTIVE));\n}\n\nfunction killMenu() {\n    if ($menu) $menu.destroy();\n    $menu = null;\n    $selectedItem = null;\n    $selectedIndex = null;\n}\n\nfunction select(idx) {\n    let cont = $menu.getContentElement();\n    let items = [...cont.querySelectorAll(\".Ymacs_Menu_Item\")];\n    let n = items.length;\n    $selectedIndex = ((idx % n) + n) % n;\n    items.forEach(el => {\n        let current = el.dataset.index == $selectedIndex;\n        if (current) $selectedItem = el;\n        DOM.condClass(el, current, \"selected\");\n    });\n    $selectedItem.scrollIntoView({ block: \"nearest\" });\n}\n\nexport function read_with_continuation(completions, cont, validate) {\n    this.whenMinibuffer(function(mb){\n        var changed_vars = mb.setq({\n            completion_list: completions,\n            minibuffer_validation: (what, cont2) => {\n                if (what == null)\n                    what = mb.cmd(\"minibuffer_contents\");\n                if (validate)\n                    validate.call(this, mb, what, cont2);\n                else\n                    cont2(true); // accept anything by default\n            },\n            minibuffer_continuation: what => {\n                mb.setq(changed_vars);\n                if (cont)\n                    cont.call(this, what);\n            },\n        });\n    });\n}\n\nfunction filename_completion(mb, str, re, cont) {\n    var self = this;\n    var lastslash = str.lastIndexOf(\"/\");\n    var dir = str.slice(0, lastslash+1);\n    var partial = str.slice(lastslash+1);\n    self.ymacs.fs_getDirectory(dir, function (files) {\n        function add_trailing_slash_to_dir(name) {\n            if (files[name].type == \"directory\") {\n                return name + \"/\";\n            } else {\n                return name;\n            }\n        }\n        if (!files) {\n            mb.signalError(\"Not found\");\n            cont(null);\n        } else {\n            var completions = [];\n            for (var f in files) {\n                if (f.indexOf(partial) == 0) {\n                    completions.push(add_trailing_slash_to_dir(f));\n                }\n            }\n            if (completions.length == 0) {\n                cont([]);\n            } else {\n                var prefix = common_prefix(completions);\n                if (prefix != partial) {\n                    mb.cmd(\"minibuffer_replace_input\", dir + prefix);\n                    cont(null);\n                } else if (completions.length == 1) {\n                    cont([str]);\n                } else {\n                    completions = completions.map(function(name){\n                        return { label: name, value: dir + name };\n                    });\n                    console.log(completions);\n                    popupCompletionMenu.call(mb, self.getMinibufferFrame(), completions);\n                    cont(null);\n                }\n            }\n        }\n    });\n}\n\nYmacs_Buffer.newCommands({\n\n    minibuffer_prompt: function(prompt, nofocus) {\n        this.whenMinibuffer(function(mb){\n            var f = this.getMinibufferFrame();\n            this.ymacs.setInputFrame(f);\n            mb.prompt(prompt);\n            if (!nofocus)\n                f.focus();\n        });\n    },\n\n    minibuffer_yn: function(prompt, cont) {\n        this.cmd(\"minibuffer_prompt\", prompt + \" (yes or no) \");\n        this.cmd(\"minibuffer_read_yn\", function (text) {\n            cont(text == \"yes\");\n        });\n    },\n\n    minibuffer_read_yn: function(cont) {\n        read_with_continuation.call(this, [ \"yes\", \"no\" ], cont, function(mb, text, cont2){\n            if (text == \"yes\" || text == \"no\")\n                cont2(true);\n            else\n                mb.signalError(\"Please enter yes or no\");\n        });\n    },\n\n    minibuffer_read_number: function(cont) {\n        read_with_continuation.call(this, null, cont, function(mb, text, cont2){\n            var n = parseInt(text, 10);\n            if (isNaN(n))\n                mb.signalError(\"Please enter a number\");\n            cont2(!isNaN(n));\n        });\n    },\n\n    minibuffer_read_command: function(cont) {\n        var completions = Object.keys(this.COMMANDS).filter(cmd => this.COMMANDS[cmd].ymacsInteractive).sort();\n        read_with_continuation.call(this, completions, cont, function(mb, name, cont2){\n            var cmd = this.COMMANDS[name],\n                ret = cmd && cmd.ymacsInteractive;\n            if (!ret) {\n                mb.signalError(\"No such command: \" + name);\n            }\n            cont2(ret);\n        });\n    },\n\n    minibuffer_read_function: function(cont) {\n        var commandNames = Array.hashKeys(Ymacs_Buffer.COMMANDS).sort();\n        read_with_continuation.call(this, commandNames, cont, function(mb, name, cont2){\n            var cmd = this.COMMANDS[name],\n                ret = !!cmd;\n            if (!ret)\n                mb.signalError(\"No such function: \" + name);\n            cont2(ret);\n        });\n    },\n\n    minibuffer_read_buffer: function(cont) {\n        this.whenYmacs(function(ymacs){\n            var bufferNames = ymacs.buffers.map(b => b.name);\n            bufferNames.push(bufferNames.shift());\n            read_with_continuation.call(this, bufferNames, cont);\n            //handle_tab.call(this);\n        });\n    },\n\n    minibuffer_read_string: function(completions, cont, validate) {\n        read_with_continuation.call(this, completions, cont, validate);\n    },\n\n    minibuffer_read_variable: function(cont) {\n        var tmp = Object.assign({}, this.globalVariables, this.variables);\n        var completions = Object.keys(tmp).filter(name => !/^\\*/.test(name)).sort();\n        read_with_continuation.call(this, completions, function(name) {\n            let val = this.getq(name);\n            this.signalInfo(`Current value of <b>${DOM.htmlEscape(name)}</b> = <b>${DOM.htmlEscape(val)}</b>`, true, 3000);\n            return cont.apply(this, arguments);\n        });\n    },\n\n    minibuffer_read_existing_file: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function () {\n            read_with_continuation.call(self, filename_completion, cont, function(mb, name, cont2){\n                self.ymacs.fs_fileType(name, function (type) {\n                    if (type == null) {\n                        mb.signalError(\"No such file: \" + name);\n                        cont2(false);\n                    } else {\n                        cont2(true);\n                    }\n                });\n            });\n        });\n    },\n\n    minibuffer_read_file: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function () {\n            read_with_continuation.call(self, filename_completion, cont);\n        });\n    },\n\n    minibuffer_read_file_or_directory: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function () {\n            read_with_continuation.call(self, filename_completion, cont);\n        });\n    },\n\n    minibuffer_read_directory: function(cont) {\n        var self = this;\n        self.cmd(\"minibuffer_replace_input_by_current_dir\", function () {\n            read_with_continuation.call(self, filename_completion, cont);\n        });\n    },\n\n    minibuffer_prompt_end: function() {\n        return this.whenMinibuffer(function(mb){\n            return mb.promptMarker.getPosition();\n        });\n    },\n\n    minibuffer_contents: function() {\n        return this.whenMinibuffer(function(mb){\n            return mb._bufferSubstring(mb.promptMarker);\n        });\n    },\n\n    minibuffer_replace_input: function(value) {\n        this.whenMinibuffer(function(mb){\n            mb._replaceText(mb.promptMarker, mb.getCodeSize(), value);\n            this.getMinibufferFrame().redrawCaret(true);\n        });\n    },\n\n    minibuffer_replace_input_by_current_dir: function (cont) {\n        this.whenYmacs(function(ymacs){\n            var self = this;\n            var name = ymacs.getActiveBuffer().name;\n            var dir = name.slice(0, name.lastIndexOf(\"/\")+1);\n            ymacs.fs_remapDir(dir, function (dir) {\n                self.cmd(\"minibuffer_replace_input\", dir);\n                cont();\n            });\n        });\n    },\n\n    minibuffer_complete: function() {\n        var self = this;\n        self.whenMinibuffer(function(mb){\n\n            function complete(a) {\n                if (!a || a.length == 0) {\n                    mb.signalError(\"No completions\");\n                }\n                else {\n                    var prefix = common_prefix(a);\n                    if (prefix != str) {\n                        mb.cmd(\"minibuffer_replace_input\", prefix);\n                    }\n                    else if (a.length == 1) {\n                        mb.signalError(\"Sole completion\");\n                    }\n                    else {\n                        popupCompletionMenu.call(mb, self.getMinibufferFrame(), a);\n                    }\n                }\n            }\n\n            var a = mb.getq(\"completion_list\"),\n                str = mb.cmd(\"minibuffer_contents\"),\n                re = str.replace(/([\\[\\]\\(\\)\\{\\}\\.\\*\\+\\?\\|\\\\])/g, \"\\\\$1\").replace(/([_-])/g, \"[^_-]*[_-]\");\n            re = new RegExp(\"^\" + re, \"i\");\n            if (a instanceof Function) {\n                a.call(self, mb, str, re, function (a) {\n                    if (a)\n                        complete(a);\n                });\n            }\n            else if (a && a.length > 0) {\n                a = a.filter(cmd => re.test(cmd));\n                complete(a);\n            }\n            else\n                complete(a);\n        });\n    },\n\n    minibuffer_complete_and_exit: function() {\n        this.whenMinibuffer(mb => {\n            mb.getq(\"minibuffer_validation\").call(mb, null, valid => {\n                if (valid)\n                    mb.cmd(\"minibuffer_keyboard_quit\", this.getq(\"minibuffer_continuation\"));\n            });\n        });\n    },\n\n    minibuffer_keyboard_quit: function(cont) {\n        this.whenMinibuffer(function(mb){\n            var text = this.cmd(\"minibuffer_contents\");\n            mb.setCode(\"\");\n            this.ymacs.setInputFrame(this.ymacs.getActiveFrame());\n            this.ymacs.getActiveFrame().focus();\n            if (!cont) {\n                mb.callHooks(\"abort\");\n            }\n            setTimeout(() => {\n                if (cont)\n                    cont.call(this, text);\n                this.getPrefixArg();\n            }, 1);\n        });\n        killMenu();\n    }\n\n});\n\nfunction handle_arrow_down() {\n    if ($menu) {\n        select($selectedIndex + 1);\n    }\n}\n\nfunction handle_arrow_up() {\n    if ($menu) {\n        select($selectedIndex - 1);\n    }\n}\n\nfunction handle_popup_home() {\n    if ($menu) {\n        select(0);\n    }\n}\n\nfunction handle_popup_end() {\n    if ($menu) {\n        select(-1);\n    }\n}\n\nfunction handle_enter() {\n    if ($menu) {\n        if ($selectedItem) {\n            this.cmd(\"minibuffer_replace_input\", $selectedItem.dataset.value);\n            killMenu();\n        } else {\n            this.signalError(\"Select something...\");\n        }\n    } else {\n        this.cmd(\"minibuffer_complete_and_exit\");\n    }\n}\n\nfunction handle_tab() {\n    if (!$menu)\n        this.cmd(\"minibuffer_complete\");\n    else\n        handle_arrow_down.call(this);\n}\n\nfunction handle_s_tab() {\n    handle_arrow_up.call(this);\n}\n\nfunction handle_home() {\n    this.cmd(\"goto_char\", this.promptMarker);\n}\n\nfunction handle_home_mark() {\n    this.ensureTransientMark();\n    this.cmd(\"goto_char\", this.promptMarker);\n    this.ensureTransientMark();\n}\n\nvar DEFAULT_KEYS = {\n    \"Tab\"                                : handle_tab,\n    \"Enter\"                              : handle_enter,\n    \"Home && C-a\"                        : handle_home,\n    \"S-Home && S-C-a\"                    : Ymacs_Interactive(\"^\", handle_home_mark)\n};\n\nvar KEYMAP_MB_ACTIVE = Ymacs_Keymap.define(null, Object.assign({\n    \"C-g && Escape\" : \"minibuffer_keyboard_quit\"\n}, DEFAULT_KEYS));\n\nvar KEYMAP_POPUP_ACTIVE = Ymacs_Keymap.define(null, Object.assign({\n    \"S-Tab\"                                 : handle_s_tab,\n    \"ArrowDown && ArrowRight && C-n && C-f\" : handle_arrow_down,\n    \"ArrowUp && ArrowLeft && C-p && C-b\"    : handle_arrow_up,\n    \"PageDown\"                              : handle_arrow_down,\n    \"PageUp\"                                : handle_arrow_up,\n    \"C-End && M->\"                          : handle_popup_end,\n    \"C-Home && M-<\"                         : handle_popup_home,\n    \"Escape\"                                : function() {\n        killMenu();\n    }\n}, DEFAULT_KEYS));\nKEYMAP_POPUP_ACTIVE.defaultHandler = [ function() {\n    killMenu();\n    return false; // say it's not handled though\n} ];\n\nYmacs_Buffer.newMode(\"minibuffer_mode\", function(){\n    this.pushKeymap(KEYMAP_MB_ACTIVE);\n    return function() {\n        this.popKeymap(KEYMAP_MB_ACTIVE);\n    };\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Keymap } from  \"./ymacs-keymap.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\nlet Ymacs_Keymap_ISearch = Ymacs_Keymap.define(\"isearch\", {\n    \"Escape\"                : [ \"isearch_abort\", true ],\n    \"C-g\"                   : \"isearch_reset_or_abort\",\n    \"C-w && C-S-s\"          : \"isearch_yank_word_or_char\",\n    \"C-s\"                   : \"isearch_forward\",\n    \"C-r\"                   : \"isearch_backward\",\n    \"M-%\"                   : \"query_replace\",\n    \"C-M-%\"                 : \"query_replace_regexp\",\n    \"M-s w && M-w\"          : \"isearch_toggle_word\",\n    \"M-s c && M-c\"          : \"isearch_toggle_case_fold\",\n    \"M-s Space && M-Space\"  : \"isearch_toggle_lax_whitespace\",\n    \"Enter\"                 : \"isearch_abort\",\n    \"C-l\"                   : \"recenter_top_bottom\",\n    \"Backspace\"             : function() {\n        if (this.getMinibuffer().point() > this._isearchContext.mbMark.getPosition()) {\n            this.getMinibuffer().cmd(\"backward_delete_char\");\n            this.cmd(\"goto_char\", this._isearchContext.livepoint);\n            isearchText.call(this);\n            updateIsearch.call(this);\n        }\n    },\n});\nYmacs_Keymap_ISearch.defaultHandler = [ \"isearch_printing_char\" ];\n\nfunction initIsearch({\n    forward = true,\n    regexp = false,\n    lax = true,\n    word = false,\n    case_fold = this.getq(\"case_fold_search\"),\n    case_replace = this.getq(\"case_replace\"),\n    qreplace = false,\n    region = null,\n} = {}) {\n    if (!this._isearchContext) {\n        this._isearchContext = {\n            forward      : forward,\n            regexp       : regexp,\n            lax          : lax,\n            word         : word,\n            case_fold    : case_fold,\n            case_replace : case_replace,\n            livepoint    : this.point(),\n            origpoint    : this.point(),\n            current      : { begin: this.point(), end: this.point() },\n            mbMark       : this.getMinibuffer().promptMarker,\n            query        : \"\",\n            qreplace     : qreplace,\n            region       : region,\n        };\n        if (!qreplace) {\n            this.pushKeymap(Ymacs_Keymap_ISearch);\n            resetPrompt.call(this);\n        }\n        return true;\n    }\n}\n\nfunction isearchText() {\n    return this._isearchContext.query = this.getMinibuffer()._bufferSubstring(this._isearchContext.mbMark);\n}\n\nfunction updateIsearch({ forward } = {}) {\n    var query = this._isearchContext.query;\n    if (!/\\S/.test(query) && this.getq(\"isearch_last_context\")) {\n        this._isearchContext = this.getq(\"isearch_last_context\");\n        query = this._isearchContext.query;\n        this.getMinibuffer()._placeUndoBoundary();\n        this.getMinibuffer().cmd(\"insert\", query);\n        this._isearchContext.origpoint = this.point();\n        this._isearchContext.current = { begin: this.point(), end: this.point() };\n    }\n    this._isearchContext.livepoint = this.point();\n    if (forward != null) {\n        this._isearchContext.forward = forward;\n    }\n    return doSearch.call(this);\n}\n\nfunction caseFold() {\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    return ctx.case_fold ?? (\n        (ctx.regexp ? (query = query.replace(/\\\\./g, \"\")) : query) == query.toLowerCase()\n    );\n}\n\nfunction lazyHighlight(qrx, prompt) {\n    let cursor = this._rowcol;\n    let minpos = this._rowColToPosition(cursor.row - 50, 0);\n    let maxpos = this._rowColToPosition(cursor.row + 50, Infinity);\n    let code = this.getCode();\n    let hl = [];\n    let ctx = this._isearchContext;\n    let point = this.point();\n    let count = 0;\n    let crnt = 0;\n    qrx.lastIndex = ctx.region?.begin || 0;\n    while (true) {\n        let m = qrx.exec(code);\n        if (m && m[0].length) {\n            if (ctx.region && qrx.lastIndex > ctx.region.end) {\n                break;\n            }\n            count++;\n            if (m.index >= minpos && m.index <= maxpos) {\n                let p1 = this._positionToRowCol(m.index);\n                let p2 = this._positionToRowCol(qrx.lastIndex);\n                hl.push({\n                    line1: p1.row, col1: p1.col,\n                    line2: p2.row, col2: p2.col\n                });\n            }\n            if (point >= m.index && point < qrx.lastIndex || (point == qrx.lastIndex && ctx.forward)) {\n                crnt = count;\n            }\n        } else {\n            break;\n        }\n    }\n    resetPrompt.call(this, count, crnt, prompt);\n    this.setOverlay(\"isearch-lazy\", hl);\n}\n\nfunction resetPrompt(count, crnt, prompt) {\n    let ctx = this._isearchContext;\n    this.whenMinibuffer(mb => {\n        if (prompt) {\n            mb.prompt(prompt.call(this, count, crnt, ctx));\n        } else {\n            let pos = ctx.qreplace && count ? `[${count}] `\n                : (count && crnt) ? `[${crnt}/${count}] `\n                : \"\";\n            mb.prompt(`${pos}${\n  ctx.qreplace ? \"Query replace\" : \"I-search\"}${\n  ctx.regexp ? \" regexp\" : ctx.word ? \" word\" : \"\"}${\n  ctx.forward ? \"\" : \" backward\"}:`);\n        }\n        let start = ctx.mbMark;\n        let mid = start + ctx.lastFoundQuery?.length;\n        if (mid != null) {\n            mb.forEachLine((line, c1, c2) => {\n                mb._textProperties.removeLineProps(line, c1, c2, \"css\");\n            }, start, mid);\n            mb.forEachLine((line, c1, c2) => {\n                mb._textProperties.addLineProps(line, c1, c2, \"css\", \"isearch-fail\");\n            }, mid);\n        }\n    });\n}\n\nfunction doSearch({ forward } = this._isearchContext) {\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    let found = false;\n    try {\n        let rx = searchRegExp.call(this);\n        found = this.cmd(forward ? \"search_forward_regexp\" : \"search_backward_regexp\", rx);\n        if (found) {\n            ctx.lastFoundQuery = query;\n            this.cmd(\"ensure_caret_visible\");\n            let p1 = this.point();\n            let p2 = p1 + (forward ? -1 : 1) * this.matchData[0].length;\n            if (forward) [ p1, p2 ] = [ p2, p1 ];\n            ctx.current = { begin: p1, end: p2 };\n            let p1rc = this._positionToRowCol(p1);\n            let p2rc = this._positionToRowCol(p2);\n            this.setOverlay(\"isearch\", {\n                line1: p1rc.row, col1: p1rc.col,\n                line2: p2rc.row, col2: p2rc.col,\n            });\n        }\n        lazyHighlight.call(this, rx);\n    } catch {};\n    return found;\n}\n\nfunction searchRegExp({\n    query = null,\n    regexp = false,\n    lax = true,\n    case_fold = true,\n    word = false,\n} = (this._isearchContext || {})) {\n    let searchRX = query;\n    if (!regexp) {\n        searchRX = query.replace(/[\\]\\[\\}\\{\\)\\(\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n        if (word) {\n            // XXX: I guess it would be nice to use syntax_word / syntax_word_dabbrev\n            searchRX = \"\\\\b\" + searchRX + \"\\\\b\";\n        }\n    }\n    if (lax) {\n        searchRX = searchRX.replace(/\\s+/g, \"\\\\s+\");\n    }\n    return new RegExp(searchRX, caseFold.call(this) ? \"ugi\" : \"ug\");\n}\n\nYmacs_Buffer.newCommands({\n\n    isearch_forward: Ymacs_Interactive(function() {\n        let arg = { forward: true };\n        if (!initIsearch.call(this, arg)) {\n            if (!updateIsearch.call(this, arg))\n                this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n\n    isearch_backward: Ymacs_Interactive(function() {\n        let arg = { forward: false };\n        if (!initIsearch.call(this, arg)) {\n            if (!updateIsearch.call(this, arg)) {\n                this.signalError(\"No more backward occurrences of the search text\");\n            }\n        }\n    }),\n\n    isearch_forward_regexp: Ymacs_Interactive(function() {\n        let arg = { forward: true, regexp: true };\n        if (!initIsearch.call(this, arg)) {\n            if (!updateIsearch.call(this, arg))\n                this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n\n    isearch_backward_regexp: Ymacs_Interactive(function() {\n        let arg = { forward: false, regexp: true };\n        if (!initIsearch.call(this, arg)) {\n            if (!updateIsearch.call(this, arg))\n                this.signalError(\"No more forward occurrences of the search text\");\n        }\n    }),\n\n    isearch_yank_word_or_char: Ymacs_Interactive(function() {\n        if (!this._isearchContext) {\n            initIsearch.call(this, { forward: true });\n        }\n        let ctx = this._isearchContext;\n        var pos = ctx.current.end;\n        var pos2 = this.cmd(\"save_excursion\", function(){\n            this.cmd(\"goto_char\", pos);\n            this.cmd(\"forward_word\");\n            return this.point();\n        });\n        if (pos2 != pos) {\n            var word = this._bufferSubstring(pos, pos2);\n            this.getMinibuffer()._placeUndoBoundary();\n            this.getMinibuffer().cmd(\"insert\", word.toLowerCase());\n            word = isearchText.call(this);\n            this.cmd(\"goto_char\", ctx.current.begin);\n            doSearch.call(this, { forward: true });\n        }\n    }),\n\n    isearch_toggle_word: Ymacs_Interactive(function(){\n        let ctx = this._isearchContext;\n        ctx.word = !ctx.word;\n        if (ctx.word) ctx.regexp = false;\n        this.signalInfo(`Search word: ${ctx.word ? \"ON\" : \"OFF\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        doSearch.call(this);\n    }),\n\n    isearch_toggle_case_fold: Ymacs_Interactive(function(){\n        let ctx = this._isearchContext;\n        if (ctx.case_fold == null) ctx.case_fold = false;\n        else if (ctx.case_fold === false) ctx.case_fold = true;\n        else if (ctx.case_fold === true) ctx.case_fold = null;\n        this.signalInfo(`Case sensitive: ${ctx.case_fold == null ? \"AUTO\" : ctx.case_fold ? \"OFF\" : \"ON\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        doSearch.call(this);\n    }),\n\n    isearch_toggle_lax_whitespace: Ymacs_Interactive(function(){\n        let ctx = this._isearchContext;\n        ctx.lax = !ctx.lax;\n        this.signalInfo(`Loose whitespace: ${ctx.lax ? \"ON\" : \"OFF\"}`, false, 2000);\n        this.cmd(\"goto_char\", this._isearchContext.current.begin);\n        doSearch.call(this);\n    }),\n\n    isearch_printing_char: Ymacs_Interactive(function() {\n        let ctx = this._isearchContext;\n        var ev = this.interactiveEvent();\n        if (ev?.key?.length == 1 && !ev.ctrlKey && !ev.altKey) {\n            this.whenMinibuffer(mb => {\n                mb.cmd(\"self_insert_command\");\n                this.cmd(\"goto_char\", ctx.livepoint);\n                isearchText.call(this);\n                doSearch.call(this);\n            });\n            return true;\n        } else {\n            this.cmd(\"isearch_abort\");\n            return false;\n        }\n    }),\n\n    isearch_abort: Ymacs_Interactive(function(cancelled) {\n        if (!cancelled)\n            this.setGlobal(\"isearch_last_context\", this._isearchContext);\n        this.setMinibuffer(\"\");\n        this.popKeymap(Ymacs_Keymap_ISearch);\n        if (cancelled) {\n            this.cmd(\"goto_char\", this._isearchContext.origpoint);\n        } else {\n            this.markMarker.setPosition(this._isearchContext.origpoint);\n        }\n        this._isearchContext = null;\n        this.deleteOverlay(\"isearch\");\n        this.deleteOverlay(\"isearch-lazy\");\n        return true;\n    }),\n\n    isearch_reset_or_abort: Ymacs_Interactive(function(){\n        let ctx = this._isearchContext;\n        if (!ctx.lastFoundQuery || ctx.query == ctx.lastFoundQuery) {\n            this.cmd(\"isearch_abort\", true);\n        } else {\n            this.whenMinibuffer(mb => {\n                mb._replaceText(ctx.mbMark, mb.getCode().length, ctx.lastFoundQuery);\n                ctx.query = ctx.lastFoundQuery;\n                doSearch.call(this);\n            });\n        }\n    }),\n});\n\n/* -----[ query-replace ]----- */\n\nlet Ymacs_Keymap_Query_Replace = Ymacs_Keymap.define(\"query_replace\", {\n    \"y && Space\"               : \"query_replace_yes_this_occurrence\",\n    \".\"                        : \"query_replace_yes_this_occurrence_and_stop\",\n    \"n && Delete && Backspace\" : \"query_replace_no_this_occurrence\",\n    \"u\"                        : \"query_replace_undo_previous\",\n    \"!\"                        : \"query_replace_yes_all_occurrences\",\n    \"q && Enter\"               : [ \"query_replace_abort\", true ],\n    \"C-l\"                      : \"recenter_top_bottom\",\n});\nYmacs_Keymap_Query_Replace.defaultHandler = [ \"query_replace_abort\" ];\n\nfunction query_replace_1(args = {}) {\n    this.whenMinibuffer(mb => {\n        initIsearch.call(this, { ...args, qreplace: true });\n        let ctx = this._isearchContext;\n        this.cmd(\"minibuffer_prompt\", `Query replace${ctx.regexp ? \" regexp\" : ctx.word ? \" word\" : \"\"}: `);\n        let hlOrig = () => {\n            isearchText.call(this);\n            try {\n                lazyHighlight.call(this, searchRegExp.call(this));\n            } catch {};\n        };\n        mb.addEventListener(\"afterInteractiveCommand\", hlOrig);\n        let onQuit = (continued) => {\n            mb.removeEventListener(\"afterInteractiveCommand\", hlOrig);\n            mb.removeEventListener(\"abort\", onQuit);\n            if (!continued) {\n                this.deleteOverlay(\"isearch\");\n                this.deleteOverlay(\"isearch-lazy\");\n                this._isearchContext = null;\n            }\n        };\n        mb.addEventListener(\"abort\", onQuit);\n        this.cmd(\"minibuffer_read_string\", null, orig => {\n            this._isearchContext.query = orig;\n            query_replace_2.call(this);\n            onQuit(true);\n        }, (buf, query, cont) => {\n            ctx.query = query;\n            try {\n                lazyHighlight.call(this, searchRegExp.call(this));\n                cont(query);\n            } catch {\n                buf.popupMessage({ type: \"error\", text: \"Incomplete regexp\", atCaret: true });\n            }\n        });\n    });\n}\n\nfunction query_replace_2() {\n    let mb = this.getMinibuffer();\n    let ctx = this._isearchContext;\n    let query = ctx.query;\n    let rxorig = searchRegExp.call(this);\n    lazyHighlight.call(this, rxorig);\n    if (rxorig) {\n        this.cmd(\"minibuffer_prompt\", `Replace ${ctx.regexp ? \"regexp \" : \"\"}${query} with: `);\n        let onQuit = () => {\n            this.deleteOverlay(\"isearch\");\n            this.deleteOverlay(\"isearch-lazy\");\n            this._isearchContext = null;\n            mb.removeEventListener(\"abort\", onQuit);\n        };\n        mb.addEventListener(\"abort\", onQuit);\n        this.cmd(\"minibuffer_read_string\", null, replacement => {\n            this.clearTransientMark();\n            query_replace_3.call(this, mb, rxorig, replacement);\n        });\n    }\n}\n\nfunction similarCase(rplc) {\n    let ctx = this._isearchContext;\n    if (ctx.case_replace && rplc == rplc.toLowerCase()) {\n        let orig = this.matchData[0];\n        if (orig == orig.toUpperCase()) return rplc.toUpperCase();\n        if (orig == this.capitalize(orig)) return this.capitalize(rplc);\n    }\n    return rplc;\n}\n\nfunction query_replace_3(mb, rxorig, replacement) {\n    let ctx = this._isearchContext;\n    this.pushKeymap(Ymacs_Keymap_Query_Replace);\n    let cmds, stop, curr, count = 0;\n    let queue = [];\n    let end = ctx.region && this.createMarker(ctx.region.end);\n    this.cmd(\"goto_char\", ctx.region ? ctx.region.begin : ctx.current.begin);\n\n    let domatch = replacement => {\n        if (ctx.regexp) {\n            // look ma, I can write code like this.\n            replacement = replacement.replace(\n                /(?:\\\\([\\\\\\&\\#]|\\d+|<.+?>))/g,\n                (s, p) => p == \"\\\\\" ? \"\\\\\"\n                    :     p == \"#\" ? count\n                    :     p == \"&\" ? this.matchData[0]\n                    :     p[0] == \"<\" ? this.matchData.groups[p.substr(1, p.length - 2)]\n                    : this.matchData[+p]\n            );\n        }\n        return similarCase.call(this, replacement);\n    };\n\n    let gotoNext = (all) => {\n        let point = this.point();\n        let found = this.cmd(\"search_forward_regexp\", rxorig);\n        if (found) {\n            let m = this.matchData;\n            if (ctx.region && (m.index < ctx.region.begin || m.after > end)) {\n                if (!all) {\n                    this.cmd(\"goto_char\", point);\n                }\n                return null;\n            }\n            let begin = this.matchData.index;\n            found = { begin: begin, end: this.point() };\n            if (!all) {\n                this.cmd(\"ensure_caret_visible\");\n                let rc_begin = this._positionToRowCol(begin);\n                this.setOverlay(\"isearch\", {\n                    line1: rc_begin.row, col1: rc_begin.col,\n                    line2: this._rowcol.row, col2: this._rowcol.col\n                });\n            }\n        }\n        if (!all) {\n            lazyHighlight.call(this, rxorig, (count, crnt) =>\n                `[${count}] Replace with ${domatch(replacement)}? (y/n/u/!)`);\n        }\n        return found;\n    };\n\n    cmds = this.replaceCommands({\n        query_replace_yes_this_occurrence: Ymacs_Interactive(() => {\n            queue.push(curr);\n            this._replaceText(curr.begin, curr.end, domatch(replacement));\n            count++;\n            curr = gotoNext();\n            if (!curr) stop();\n        }),\n        query_replace_yes_this_occurrence_and_stop: Ymacs_Interactive(() => {\n            queue.push(curr);\n            this._replaceText(curr.begin, curr.end, domatch(replacement));\n            count++;\n            stop();\n        }),\n        query_replace_no_this_occurrence: Ymacs_Interactive(() => {\n            curr = gotoNext();\n            if (!curr) stop();\n        }),\n        query_replace_yes_all_occurrences: Ymacs_Interactive(() => {\n            let last;\n            while (curr) {\n                last = curr;\n                this._replaceText(curr.begin, curr.end, domatch(replacement));\n                count++;\n                curr = gotoNext(true);\n            }\n            if (last) {\n                this.cmd(\"goto_char\", last.begin);\n                this.cmd(\"ensure_caret_visible\");\n            }\n            stop();\n        }),\n        query_replace_undo_previous: Ymacs_Interactive(() => {\n            let prev = queue.pop();\n            if (prev) {\n                count--;\n                this.cmd(\"undo\");\n\n                // XXX: this is ugly, but oh well.. We'd like to\n                // pretend this edit/undo operation never exist.\n                let uptr = this.__undoPointer;\n                let uq = this.__undoQueue.slice(0, uptr);\n                setTimeout(() => {\n                    this.__undoPointer = uptr;\n                    this.__undoQueue = uq;\n                });\n\n                this.cmd(\"goto_char\", prev.begin);\n                curr = gotoNext();\n            } else {\n                this.signalError(\"No more undo\");\n            }\n        }),\n        query_replace_abort: Ymacs_Interactive(enter => {\n            stop();\n            return enter;\n        }),\n    });\n    stop = () => {\n        if (end) end.destroy();\n        mb.removeEventListener(\"abort\", stop);\n        this.newCommands(cmds);\n        this.deleteOverlay(\"isearch\");\n        this.deleteOverlay(\"isearch-lazy\");\n        this._isearchContext = null;\n        this.popKeymap(Ymacs_Keymap_Query_Replace);\n        mb.cmd(\"minibuffer_keyboard_quit\");\n        this.signalInfo(`Replaced ${count} occurrences`);\n    };\n    curr = gotoNext();\n    if (!curr) {\n        stop();\n    } else {\n        mb.addEventListener(\"abort\", stop);\n    }\n}\n\nfunction query_replace(regexp) {\n    return Ymacs_Interactive(\"^P\", function(word){\n        let ctx = this._isearchContext;\n        let args = {\n            qreplace: true,\n            regexp: regexp == null && ctx ? ctx.regexp : !!regexp,\n            word: !!word,\n            region: this.transientMarker && this.getRegion(),\n        };\n        if (ctx) {\n            this.cmd(\"isearch_abort\");\n            this._isearchContext = Object.assign({}, ctx, args);\n            query_replace_2.call(this);\n        } else {\n            query_replace_1.call(this, args);\n        }\n    });\n}\n\nYmacs_Buffer.newCommands({\n    query_replace: query_replace(null),\n    query_replace_regexp: query_replace(true),\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Tokenizer } from \"./ymacs-tokenizer.js\";\n\nYmacs_Tokenizer.define(\"css\", function(stream, tok){\n\n    var PARSER = {\n        next        : next,\n        copy        : copy,\n        indentation : indentation\n    };\n\n    var $parens = [];\n    var $passedParens = [];\n    var $cont = [];\n    var $inString = null;\n    var $inComment = null;\n\n    function copy() {\n        var c = resume.context = {\n            parens       : $parens.slice(0),\n            passedParens : $passedParens.slice(0),\n            cont         : $cont.slice(0),\n            inString     : $inString,\n            inComment    : $inComment\n        };\n        function resume() {\n            $parens       = c.parens.slice(0);\n            $passedParens = c.passedParens.slice(0);\n            $cont         = c.cont.slice(0);\n            $inString     = c.inString;\n            $inComment    = c.inComment;\n            return PARSER;\n        };\n        return resume;\n    };\n\n    function INDENT_LEVEL() {\n        return tok.buffer.getq(\"indent_level\");\n    };\n\n    var OPEN_PAREN = {\n        \"(\" : \")\",\n        \"{\" : \"}\",\n        \"[\" : \"]\"\n    };\n\n    var CLOSE_PAREN = {\n        \")\" : \"(\",\n        \"}\" : \"{\",\n        \"]\" : \"[\"\n    };\n\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    };\n\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    };\n\n    function foundToken(c1, c2, type) {\n        tok.onToken(stream.line, c1, c2, type);\n    };\n\n    function readComment() {\n        var line = stream.lineText(), pos = line.indexOf(\"*/\", stream.col);\n        var m = /^\\s*\\*+/.exec(line.substr(stream.col));\n        if (m) {\n            foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n        }\n        if (pos >= 0) {\n            $cont.pop();\n            $inComment = null;\n            foundToken(stream.col, pos, \"mcomment\");\n            foundToken(pos, pos += 2, \"mcomment-stopper\");\n            stream.col = pos;\n        } else {\n            foundToken(stream.col, line.length, \"mcomment\");\n            stream.col = line.length;\n        }\n    };\n\n    function readString(end, type) {\n        var ch, esc = false, start = stream.col;\n        while (!stream.eol()) {\n            ch = stream.peek();\n            if (!esc && ch === end) {\n                $cont.pop();\n                $inString = null;\n                foundToken(start, stream.col, type);\n                var p = $parens.at(-1);\n                if (p && p.type == ch) {\n                    $parens.pop();\n                    p.closed = { line: stream.line, col: stream.col, opened: p };\n                    $passedParens.push(p);\n                }\n                foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                return;\n            }\n            esc = !esc && ch === \"\\\\\";\n            stream.nextCol();\n        }\n        foundToken(start, stream.col, type);\n    };\n\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0)\n            return $cont.at(-1)();\n        var ch = stream.peek(), tmp;\n        if (stream.lookingAt(\"/*\")) {\n            $inComment = { line: stream.line, c1: stream.col };\n            foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n            $cont.push(readComment);\n        }\n        else if (stream.lookingAt(\"//\")) {\n            foundToken(stream.col, stream.col += 2, \"comment-starter\");\n            foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n        }\n        else if (ch === '\"' || ch === \"'\") {\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            $inString = { line: stream.line, c1: stream.col };\n            foundToken(stream.col, ++stream.col, \"string-starter\");\n            $cont.push(readString.bind(null, ch, \"string\"));\n        }\n        else if ((tmp = isOpenParen(ch))) {\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            foundToken(stream.col, ++stream.col, \"open-paren\");\n        }\n        else if ((tmp = isCloseParen(ch))) {\n            var p = $parens.pop();\n            if (!p || p.type != tmp) {\n                foundToken(stream.col, ++stream.col, \"error\");\n            } else {\n                p.closed = { line: stream.line, col: stream.col, opened: p };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\");\n            }\n        }\n        else if ((tmp = stream.lookingAt(/^(--+|\\$)?([\\p{L}\\p{N}-]+):/u))) {\n            foundToken(stream.col, stream.col += tmp[0].length - 1, tmp[1] ? \"variable-name\" : \"keyword\");\n            foundToken(stream.col, ++stream.col, \"operator\");\n        }\n        else if ((tmp = stream.lookingAt(/^((?:\\d*\\.)?\\d+)(px|pt|em|ex|in|cm|mm|rem|vw|vh|fr|s|%)?/))) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"number\");\n            if (tmp[2]) {\n                foundToken(stream.col, stream.col += tmp[2].length, \"type\");\n            }\n        }\n        else if ((tmp = stream.lookingAt(/^(\\.[\\p{L}\\p{N}_:-]+)/u))) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"function-name\");\n        }\n        else if ((tmp = stream.lookingAt(/^(#[\\p{L}\\p{N}_:-]+)/u))) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"constant\");\n        }\n        else if ((tmp = stream.lookingAt(/^(@[\\p{L}\\p{N}_:-]+)/u))) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"builtin\");\n        }\n        else if ((tmp = stream.lookingAt(/^(url|none|auto|bold|italic|normal|inherit|print|screen|all|important|calc|var)/))) {\n            foundToken(stream.col, stream.col += tmp[1].length, \"builtin\");\n        }\n        else {\n            foundToken(stream.col, ++stream.col, null);\n        }\n    };\n\n    function indentation() {\n        // no indentation for continued strings\n        if ($inString)\n            return 0;\n\n        var row = stream.line;\n        var currentLine = stream.lineText();\n        var indent = 0;\n\n        if ($inComment) {\n            var commentStartLine = stream.lineText($inComment.line);\n            indent = $inComment.c1 + 1;\n            if (!/^\\s*\\*/.test(currentLine)) {\n                // align with the first non-whitespace and non-asterisk character in the comment\n                var re = /[^\\s*]/g;\n                re.lastIndex = $inComment.c1 + 1;\n                var m = re.exec(commentStartLine);\n                if (m)\n                    indent = m.index;\n            }\n            return indent;\n        }\n\n        var p = $parens.at(-1);\n        if (p) {\n            // check if the current line closes the paren\n            var re = new RegExp(\"^\\\\s*\\\\\" + OPEN_PAREN[p.type]);\n            var thisLineCloses = re.test(currentLine);\n\n            // Check if there is text after the opening paren.  If so, indent to that column.\n            var line = stream.lineText(p.line);\n            re = /\\S/g;\n            re.lastIndex = p.col + 1;\n            var m = re.exec(line);\n            if (m) {\n                // but if this line closes the paren, better use the column of the open paren\n                indent = thisLineCloses ? p.col : m.index;\n            }\n            else {\n                // Otherwise we should indent to one level more than the indentation of the line\n                // containing the opening paren.\n                indent = stream.lineIndentation(p.line) + INDENT_LEVEL();\n\n                // but if this line closes the paren, then back one level\n                if (thisLineCloses)\n                    indent -= INDENT_LEVEL();\n            }\n        }\n        else {\n            let i = row, m;\n            while (i-- > 0) if ((m = /\\S/.exec(stream.lineText(i)))) break;\n            if (m) indent = m.index;\n        }\n\n        return indent;\n    };\n\n    return PARSER;\n\n});\n\nYmacs_Buffer.newMode(\"css_mode\", function(){\n    var tok = this.tokenizer;\n    this.setTokenizer(new Ymacs_Tokenizer({ buffer: this, type: \"css\" }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    var changed_vars = this.setq({\n        syntax_paragraph_sep: /\\n(?:[ \\t\\/\\*]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*\\/\\/+ ?/ygu,\n            ch: \"//\"\n        },\n        syntax_comment_multi: {\n            rx: /[^\\S\\r\\n]*\\/\\*+(.*?)\\*+\\//ygu,\n            ch: [ \"/*\", \"*/\" ]\n        },\n    });\n\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match)\n            this.cmd(\"paren_match_mode\", false);\n        this.setq(changed_vars);\n    };\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Tokenizer } from \"./ymacs-tokenizer.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\n\n/* -----[ This defines the tokenizer ]----- */\n\n(function(){\n\n    function qw(str) {\n        return str.trim().split(/\\s+/);\n    }\n\n    function toHash(a) {\n        return a.reduce((a, key, i) => (a[key] = i + 1, a), Object.create(null));\n    }\n\n    var KEYWORDS = qw(\"abstract break case catch class const \\\ncontinue debugger default delete do else \\\nenum export extends final finally for \\\nfunction goto if implements import in \\\ninstanceof interface native new package \\\nprivate protected public return static \\\nswitch synchronized throw \\\nthrows transient try typeof var void let \\\nyield volatile while with\");\n\n    var KEYWORDS_TYPE = qw(\"boolean byte char double float int long short void \\\nArray Date Function Math Number Object RegExp String\");\n\n    var KEYWORDS_CONST = qw(\"false null undefined Infinity NaN true arguments\");\n\n    var KEYWORDS_BUILTIN = qw(\"Infinity NaN \\\nPackages decodeURI decodeURIComponent \\\nencodeURI encodeURIComponent eval isFinite isNaN parseFloat \\\nparseInt undefined window document alert prototype constructor super this\");\n\n    var ALLOW_REGEXP_AFTER = /[\\[({,;+\\-*=?&|!:][\\x20\\t\\n\\xa0]*$|return\\s+$|typeof\\s+$/;\n\n    function isLetter(ch) {\n        return ch.toLowerCase() != ch.toUpperCase();\n    };\n\n    function isNameStart(ch) {\n        return ch && (isLetter(ch) || /^[_$]$/.test(ch));\n    };\n\n    function isNameChar(ch) {\n        return ch && (isLetter(ch) || /^[0-9_$]$/.test(ch));\n    };\n\n    var OPEN_PAREN = {\n        \"(\"  : \")\",\n        \"{\"  : \"}\",\n        \"[\"  : \"]\",\n    };\n\n    var CLOSE_PAREN = {\n        \")\" : \"(\",\n        \"}\" : \"{\",\n        \"]\" : \"[\",\n    };\n\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    };\n\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    };\n\n    function JS_PARSER(KEYWORDS, KEYWORDS_TYPE, KEYWORDS_CONST, KEYWORDS_BUILTIN, stream, tok) {\n\n        var $cont = [];\n        var $parens = [];\n        var $passedParens = [];\n        var $inComment = null;\n        var $inString = false;\n        var PARSER = {\n            next        : next,\n            copy        : copy,\n            indentation : indentation\n        };\n\n        function INDENT_LEVEL() {\n            return stream.buffer.getq(\"indent_level\");\n        };\n\n        function copy() {\n            var context = restore.context = {\n                cont         : $cont.slice(0),\n                inComment    : $inComment,\n                inString     : $inString,\n                parens       : $parens.slice(0),\n                passedParens : $passedParens.slice(0),\n            };\n            function restore() {\n                $cont          = context.cont.slice(0);\n                $inComment     = context.inComment;\n                $inString      = context.inString;\n                $parens        = context.parens.slice(0);\n                $passedParens  = context.passedParens.slice(0);\n                return PARSER;\n            };\n            return restore;\n        };\n\n        function foundToken(c1, c2, type) {\n            tok.onToken(stream.line, c1, c2, type);\n        };\n\n        function readName() {\n            var col = stream.col, ch = stream.next(),\n            name = ch;\n            while (!stream.eol()) {\n                ch = stream.peek();\n                if (!isNameChar(ch))\n                    break;\n                name += ch;\n                stream.nextCol();\n            }\n            return ch && { line: stream.line, c1: col, c2: stream.col, id: name };\n        };\n\n        function readComment() {\n            var line = stream.lineText(), pos = line.indexOf(\"*/\", stream.col);\n            var m = /^\\s*\\*+/.exec(line.substr(stream.col));\n            if (m) {\n                foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n            }\n            if (pos >= 0) {\n                $cont.pop();\n                $inComment = null;\n                foundToken(stream.col, pos, \"mcomment\");\n                foundToken(pos, pos += 2, \"mcomment-stopper\");\n                stream.col = pos;\n            } else {\n                foundToken(stream.col, line.length, \"mcomment\");\n                stream.col = line.length;\n            }\n        };\n\n        function readString(end, type) {\n            $inString = true;\n            var ch, esc = false, start = stream.col;\n            while (!stream.eol()) {\n                ch = stream.peek();\n                if (!esc && ch === end) {\n                    $cont.pop();\n                    $inString = false;\n                    foundToken(start, stream.col, type);\n                    var p = $parens.at(-1);\n                    if (p && p.type == ch) {\n                        $parens.pop();\n                        p.closed = { line: stream.line, col: stream.col, opened: p };\n                        $passedParens.push(p);\n                    }\n                    foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                    return;\n                }\n                if (!esc && end == \"`\" && stream.lookingAt(\"${\")) { // start nested expression\n                    $inString = false;\n                    $parens.push({ line: stream.line, col: stream.col, type: \"${\" });\n                    foundToken(start, stream.col, type);\n                    foundToken(stream.col, stream.col += 2, \"open-paren\");\n                    $cont.push(readToken);\n                    return;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, type);\n        };\n\n        function readLiteralRegexp() {\n            var ch, esc = false, inset = 0, start = stream.col;\n            while (!stream.eol()) {\n                ch = stream.peek();\n                if (isOpenParen(ch) && !esc && !inset)\n                    inset++;\n                if (isCloseParen(ch) && !esc) {\n                    inset--;\n                    if (inset < 0)\n                        inset = 0;\n                }\n                if (ch === \"/\" && !esc && !inset) {\n                    $cont.pop();\n                    foundToken(start, stream.col, \"regexp\");\n                    foundToken(stream.col, ++stream.col, \"regexp-stopper\");\n                    var m = stream.lookingAt(/^[gmsiyu]+/);\n                    if (m)\n                        foundToken(stream.col, stream.col += m[0].length, \"regexp-modifier\");\n                    return true;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, \"regexp\");\n        };\n\n        function readToken() {\n            var ch = stream.peek(), m, tmp;\n            if (stream.lookingAt(\"/*\")) {\n                $inComment = { line: stream.line, c1: stream.col };\n                foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n                $cont.push(readComment);\n            }\n            else if (stream.lookingAt(\"//\")) {\n                foundToken(stream.col, stream.col += 2, \"comment-starter\");\n                foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n            }\n            else if (ch === '\"' || ch === \"'\" || ch === \"`\") {\n                $parens.push({ line: stream.line, col: stream.col, type: ch });\n                foundToken(stream.col, ++stream.col, \"string-starter\");\n                $cont.push(readString.bind(null, ch, \"string\"));\n            }\n            else if ((m = stream.lookingAt(/^0x[0-9a-f]+|^[0-9]*\\.?[0-9]+/))) {\n                foundToken(stream.col, stream.col += m[0].length, \"number\");\n            }\n            else if (isNameStart(ch) && (tmp = readName())) {\n                var type = tmp.id in KEYWORDS ? \"keyword\"\n                    : tmp.id in KEYWORDS_TYPE ? \"type\"\n                    : tmp.id in KEYWORDS_CONST ? \"constant\"\n                    : tmp.id in KEYWORDS_BUILTIN ? \"builtin\"\n                    : null;\n                foundToken(tmp.c1, tmp.c2, type);\n            }\n            else if ((tmp = isOpenParen(ch))) {\n                $parens.push({ line: stream.line, col: stream.col, type: ch });\n                foundToken(stream.col, ++stream.col, \"open-paren\");\n            }\n            else if ((tmp = isCloseParen(ch))) {\n                var p = $parens.pop();\n                if (ch == \"}\" && p && p.type == \"${\") {\n                    p.closed = { line: stream.line, col: stream.col, opened: p };\n                    $passedParens.push(p);\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                    $cont.pop();\n                }\n                else if (!p || p.type != tmp) {\n                    foundToken(stream.col, ++stream.col, \"error\");\n                } else {\n                    p.closed = { line: stream.line, col: stream.col, opened: p };\n                    $passedParens.push(p);\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                }\n            }\n            else if (ch === \"/\" && ALLOW_REGEXP_AFTER.test(stream.textBefore())) {\n                foundToken(stream.col, ++stream.col, \"regexp-starter\");\n                $cont.push(readLiteralRegexp);\n            }\n            else if ((m = stream.lookingAt(/^\\s+$/))) {\n                foundToken(stream.col, stream.col += m[0].length, \"trailing-whitespace\");\n            }\n            else {\n                foundToken(stream.col, ++stream.col, null);\n            }\n        }\n\n        function next() {\n            stream.checkStop();\n            if ($cont.length > 0)\n                return $cont.at(-1)();\n            readToken();\n        };\n\n        function indentation() {\n            var row = stream.line;\n            var currentLine = stream.lineText();\n            var indent = 0;\n\n            if ($inString) {\n                // inside string literal\n                if (row > 0 && !/\\S/.test(currentLine)) {\n                    // on an empty line, set indentation from previous line\n                    return stream.lineIndentation(row - 1);\n                }\n                // otherwise keep existing indentation\n                return null;\n            }\n\n            if ($inComment) {\n                var commentStartLine = stream.lineText($inComment.line);\n                indent = $inComment.c1 + 1;\n                if (!/^\\s*\\*/.test(currentLine)) {\n                    // align with the first non-whitespace and non-asterisk character in the comment\n                    var re = /[^\\s*]/g;\n                    re.lastIndex = $inComment.c1 + 1;\n                    var m = re.exec(commentStartLine);\n                    if (m)\n                        indent = m.index;\n                }\n                return indent;\n            }\n\n            var p = $parens.at(-1);\n            if (p) {\n                // check if the current line closes the paren\n                var re = new RegExp(\"^\\\\s*\\\\\" + OPEN_PAREN[p.type]);\n                var thisLineCloses = re.test(currentLine);\n\n                // Check if there is text after the opening paren.  If so, indent to that column.\n                var line = stream.lineText(p.line);\n                re = /\\S/g;\n                re.lastIndex = p.col + 1;\n                var m = re.exec(line);\n                if (m) {\n                    // but if this line closes the paren, better use the column of the open paren\n                    indent = thisLineCloses ? p.col : m.index;\n                }\n                else {\n                    // Otherwise we should indent to one level more than the indentation of the line\n                    // containing the opening paren.\n                    indent = stream.lineIndentation(p.line) + INDENT_LEVEL();\n\n                    // but if this line closes the paren, then back one level\n                    if (thisLineCloses)\n                        indent -= INDENT_LEVEL();\n                }\n            }\n            else {\n                let i = row, m;\n                while (i-- > 0) if ((m = /\\S/.exec(stream.lineText(i)))) break;\n                if (m) indent = m.index;\n            }\n\n            // Some more adjustments for continued statements.  Since we don't really have a\n            // rigorous parser, we have to rely on other regexps here, which sucks but will do for\n            // now.\n\n            if (row > 0) {\n                var before = stream.textBefore();\n                if (/\\)\\s*$/.test(before) && $passedParens.length > 0) {\n                    // Ends in a paren, could be an if, while or for which demands smart\n                    // indentation on the current line, let's check it out.\n\n                    // Note that the passedParen saved for that close paren is actually\n                    // the opening one, which suits us greatly.\n                    p = $passedParens.at(-1);\n                    var stmtLine = stream.lineText(p.line);\n                    if (/^\\s*(if|for|while)\\W/.test(stmtLine))\n                        indent += INDENT_LEVEL();\n                }\n                else if (/\\Welse\\s*$/.test(before)) {\n                    indent += INDENT_LEVEL();\n                }\n            }\n\n            // switch labels use half the indent level, which is my favorite\n            if (/^\\s*(case|default)\\W/.test(currentLine))\n                indent -= INDENT_LEVEL() / 2;\n\n            return indent;\n        };\n\n        return PARSER;\n\n    };\n\n    Ymacs_Tokenizer.define(\"js\", JS_PARSER.bind(\n        null,\n        toHash(KEYWORDS),\n        toHash(KEYWORDS_TYPE),\n        toHash(KEYWORDS_CONST),\n        toHash(KEYWORDS_BUILTIN)\n    ));\n\n})();\n\n/* -----[ Keymap for C-like language mode ]----- */\n\nlet Ymacs_Keymap_JS = Ymacs_Keymap.define(\"js\", {\n    \"`\"   : [ \"paredit_open_pair\", \"`\", \"`\", /[\\`\\\\]/g ],\n    \"'\"   : [ \"paredit_open_pair\", \"'\", \"'\", /[\\'\\\\]/g ],\n    \"M-`\" : [ \"paredit_wrap_round\", \"`\", \"`\", /[\\`\\\\]/g ],\n    \"M-'\" : [ \"paredit_wrap_round\", \"'\", \"'\", /[\\'\\\\]/g ],\n});\n\n/* -----[ Mode entry point ]----- */\n\nYmacs_Buffer.newMode(\"javascript_mode\", function() {\n    var tok = this.tokenizer;\n    this.setTokenizer(new Ymacs_Tokenizer({ buffer: this, type: \"js\" }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    this.pushKeymap(Ymacs_Keymap_JS);\n    var changed_vars = this.setq({\n        syntax_paragraph_sep: /\\n(?:[ \\t\\/\\*]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*\\/\\/+ ?/ygu,\n            ch: \"//\"\n        },\n        syntax_comment_multi: {\n            rx: /[^\\S\\r\\n]*\\/\\*+(.*?)\\*+\\//ygu,\n            ch: [ \"/*\", \"*/\" ]\n        },\n    });\n\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match)\n            this.cmd(\"paren_match_mode\", false);\n        this.popKeymap(Ymacs_Keymap_JS);\n        this.setq(changed_vars);\n    };\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Tokenizer, Ymacs_Simple_Stream } from \"./ymacs-tokenizer.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\n(function(){\n\n    function Partial(value) {\n        this.value = value;\n    };\n\n    function QuickParser(buffer, pos) {\n        var input = new Ymacs_Simple_Stream({ buffer: buffer, pos: pos });\n        function peek() { return input.peek() };\n        function next() { return input.next() };\n        function skip_ws() {\n            return input.read_while(function(ch){\n                if (!caret_token && caret != null && input.pos == caret) return false;\n                return input.is_whitespace(ch);\n            });\n        };\n        function skip(ch) { next() };\n        function read_while(pred) { return input.read_while(pred) };\n        function read_escaped(start, end, inces) {\n            skip(start);\n            var escaped = false;\n            var str = \"\";\n            while (true) {\n                var ch = next();\n                if (!ch) throw new Partial(str);\n                if (escaped) {\n                    str += ch;\n                    escaped = false;\n                } else if (ch == \"\\\\\") {\n                    if (inces) str += ch;\n                    escaped = true;\n                } else if (ch == end) {\n                    break;\n                } else {\n                    str += ch;\n                }\n            }\n            return str;\n        };\n        function read_comment() {\n            return read_while(function(ch){ return ch && ch != \"\\n\" });\n        };\n        function read_multiline_comment() {\n            var comment = read_while(function(){\n                return !input.looking_at(\"|#\");\n            });\n            skip(); skip();\n            return comment;\n        };\n        function read_string() {\n            return read_escaped(\"\\\"\", \"\\\"\");\n        };\n        function read_list(beg, end) {\n            var save_list_index = list_index;\n            list_index = 0;\n            try {\n                var ret = [], p;\n                skip(beg);\n                out: while (true) {\n                    skip_ws();\n                    switch (peek()) {\n                      case end: break out;\n                      case null: throw new Partial(ret);\n                      default:\n                        ret.push(read_token());\n                        ++list_index;\n                    }\n                }\n                skip(end);\n                return ret;\n            } finally {\n                list_index = save_list_index;\n            }\n        };\n        function read_regexp() {\n            var str = read_escaped(\"/\", \"/\", true);\n            var mods = read_while(function(ch){\n                if (ch) switch (ch.toLowerCase()) {\n                  case \"y\":\n                  case \"m\":\n                  case \"g\":\n                  case \"i\":\n                    return true;\n                }\n            }).toLowerCase();\n            return { pattern: str, modifiers: mods };\n        };\n        function read_symbol() {\n            return read_while(function(ch){\n                switch (ch) {\n                  case null:\n                  case \"(\":\n                  case \")\":\n                  case \"{\":\n                  case \"}\":\n                  case \"[\":\n                  case \"]\":\n                  case \"#\":\n                  case \";\":\n                  case \"`\":\n                  case \"'\":\n                  case \"\\\"\":\n                  case \"|\":\n                  case \" \":\n                  case \"\\n\":\n                  case \"\\t\":\n                  case \"\\x0C\":\n                  case \"\\u2028\":\n                  case \"\\u2029\":\n                  case \"\\xA0\":\n                    return false;\n                };\n                return true;\n            });\n        };\n        function read_char() {\n            return next() + read_while(function(ch){\n                return (ch >= \"a\" && ch <= \"z\") ||\n                    (ch >= \"A\" && ch <= \"z\") ||\n                    (ch >= \"0\" && ch <= \"9\") ||\n                    ch == \"-\" || ch == \"_\";\n            });\n        };\n        function read_sharp() {\n            skip(\"#\");\n            switch (peek()) {\n              case \"\\\\\": next(); return token(\"char\", read_char);\n              case \"/\": return token(\"regexp\", read_regexp);\n              case \"(\": return token(\"vector\", read_list.bind(null, \"(\", \")\"));\n              case \"'\": next(); return token(\"function\", read_symbol);\n              case \"|\": next(); return token(\"comment\", read_multiline_comment);\n              default:\n                return token(\"unknown\", read_token);\n            }\n        };\n        function read_token() {\n            skip_ws();\n            if (!caret_token && caret != null && input.pos == caret && (!parent || parent.type == \"list\")) {\n                return caret_token = token(\"caret\");\n            }\n            switch (peek()) {\n              case \";\"  : return token(\"comment\", read_comment);\n              case \"\\\"\" : return token(\"string\", read_string);\n              case \"(\"  : return token(\"list\", read_list.bind(null, \"(\", \")\"));\n              case \"{\"  : return token(\"list\", read_list.bind(null, \"{\", \"}\"));\n              case \"[\"  : return token(\"list\", read_list.bind(null, \"[\", \"]\"));\n              case \"#\"  : return token(\"sharp\", read_sharp);\n              case \"`\"  : next(); return token(\"qq\", read_token, -1);\n              case \",\"  :\n                next();\n                if (peek() == \"@\") {\n                    next();\n                    return token(\"splice\", read_token, -2);\n                }\n                return token(\"unquote\", read_token, -1);\n              case \"'\"  : next(); return token(\"quote\", read_token, -1);\n              case \")\"  : return null;\n              case null : return null; // EOF\n            }\n            return token(\"symbol\", read_symbol);\n        };\n        function read_all() {\n            var ret = [];\n            while (peek() != null) {\n                var tok = read_token();\n                if (tok == null) break;\n                ret.push(tok);\n                ++list_index;\n            }\n            return ret;\n        };\n        var caret_token = null;\n        var list_index = 0;\n        var caret = null;\n        var parent = null;\n        var cont_exp = null;\n        function token(type, reader, adjust_start) {\n            if (adjust_start == null) adjust_start = 0;\n            var save_parent = parent;\n            try {\n                var tok = {\n                    value   : null,\n                    index   : list_index,\n                    type    : type,\n                    start   : input.pos + adjust_start,\n                    parent  : parent,\n                    depth   : parent ? parent.depth + 1 : 0,\n                    partial : false\n                };\n                if (type == \"list\") parent = tok;\n                try {\n                    if (reader) {\n                        tok.value = reader();\n                        if (tok.value === \"\") {\n                            // couldn't figure this out, but let's not crash the browser.\n                            next();\n                        }\n                    }\n                } catch(ex) {\n                    if (ex instanceof Partial) {\n                        tok.value = ex.value;\n                        tok.partial = true;\n                    } else {\n                        throw ex;\n                    }\n                }\n                tok.end = input.pos;\n                if (caret != null) {\n                    if (tok.start <= caret && tok.end >= caret) {\n                        if (!cont_exp) cont_exp = tok;\n                    }\n                }\n                return tok;\n            } finally {\n                parent = save_parent;\n            }\n        };\n        return {\n            parse: function(pos) {\n                caret = pos;\n                return token(\"list\", read_all);\n            },\n            read: function() {\n                return read_token();\n            },\n            prev_exp: function() {\n                if (caret_token) {\n                    return caret_token.parent.value[caret_token.index - 1];\n                } else if (cont_exp) {\n                    if (cont_exp.type == \"list\" && cont_exp.end == caret + 1)\n                        return cont_exp.value.at(-1);\n                    return cont_exp.parent.value[cont_exp.index];\n                }\n            },\n            caret_token: function() {\n                return caret_token;\n            },\n            cont_exp: function() {\n                return cont_exp;\n            },\n            sexp: function() {\n                var tok = cont_exp;\n                while (tok && (!/^(?:list|string)$/.test(tok.type) || tok.end == caret))\n                    tok = tok.parent;\n                return tok;\n            }\n        };\n    };\n\n    Ymacs_Buffer.newCommands({\n\n        test_lisp_parse: Ymacs_Interactive(function(){\n            try {\n                var p = QuickParser(this);\n                var ast = p.parse(this.point());\n                console.log(ast);\n                console.log(p.caret_token());\n                console.log(p.cont_exp());\n                console.log(p.prev_exp());\n            } catch(ex) {\n                console.log(ex);\n            }\n        }),\n\n        lisp_make_quick_parser: function() {\n            return QuickParser.apply(this, [this, ...arguments]);\n        },\n\n        lisp_forward_sexp: Ymacs_Interactive(function(){\n            var p = QuickParser(this, this.point());\n            var tok = p.read();\n            if (tok) this.cmd(\"goto_char\", tok.end);\n        }),\n\n        lisp_backward_sexp: Ymacs_Interactive(function(){\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var tok = p.prev_exp();\n            if (tok) this.cmd(\"goto_char\", tok.start);\n        }),\n\n        lisp_backward_up_list: Ymacs_Interactive(function(){\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var list = p.sexp();\n            if (list && list.parent) this.cmd(\"goto_char\", list.start);\n        }),\n\n        lisp_handle_string_quote: Ymacs_Interactive(function(){\n            var p = QuickParser(this);\n            p.parse(this.point());\n            var tok = p.prev_exp();\n            if (tok && tok.type == \"string\" && this.point() < tok.end) {\n                if (this.cmd(\"looking_at\", /\\\"/y))\n                    this.cmd(\"forward_char\");\n                else if (!this.cmd(\"looking_back\", /\\\\/g))\n                    this.cmd(\"insert\", \"\\\\\\\"\");\n                else\n                    this.cmd(\"insert\", \"\\\"\");\n            } else {\n                this.cmd(\"insert\", '\"\"');\n                this.cmd(\"backward_char\");\n            }\n        })\n\n    });\n\n    // XXX: much of the parser is actually copied from ymacs-mode-js.js.  I should somehow unify\n    // the duplicate code.\n\n    function qw(str) {\n        return str.trim().split(/\\s+/);\n    }\n\n    function toHash(str) {\n        return qw(str).reduce((a, key, i) => (a[key] = i + 1, a), Object.create(null));\n    }\n\n    function regexp_opt(x, mods) {\n        if (typeof x == \"string\") x = qw(x);\n        return new RegExp(\"^(\" + x.join(\"|\") + \")$\", mods);\n    }\n\n    var SPECIAL_FORMS = regexp_opt(\"\\\ndefine defvar defparameter defconstant deftype defstruct defclass defsetf destructuring-bind \\\ndefmacro defun defmethod defgeneric defpackage in-package defreadtable in-readtable \\\nwhen cond unless etypecase typecase ctypecase \\\nlambda  let load-time-value quote macrolet \\\nprogn begin prog1 prog2 progv go flet the \\\nif throw eval-when multiple-value-prog1 multiple-value-bind unwind-protect let\\\\* \\\nignore-errors handler-case handler-bind invoke-restart restart-case restart-bind case \\\nlabels function symbol-macrolet block tagbody catch locally \\\ninc! dec! cons c[ad]{1,4}r list and or not null null\\\\? \\\nloop do while dotimes \\\nreturn return-from setq set! set-car! set-cdr! setf multiple-value-call values\", \"i\");\n\n    var ERROR_FORMS = toHash(\"error warn\");\n\n    var CONSTANTS = toHash(\"t nil\");\n\n    var OPEN_PAREN = {\n        \"(\" : \")\",\n        \"{\" : \"}\",\n        \"[\" : \"]\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    var CLOSE_PAREN = {\n        \")\" : \"(\",\n        \"}\" : \"{\",\n        \"]\" : \"[\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    var DEFINES_FUNCTION = toHash(\"defun defmacro defgeneric defmethod\");\n\n    var DEFINES_TYPE = toHash(\"deftype defclass defstruct\");\n\n    var FORM_ARGS = {\n        \"if\"                  : \"3+\",\n        \"aif\"                 : \"3+\",\n        \"when\"                : \"1*\",\n        \"awhen\"               : \"1*\",\n        \"once-only\"           : \"1*\",\n        \"lambda\"              : \"1*\",\n        \"unless\"              : \"1*\",\n        \"defun\"               : \"2*\",\n        \"defpackage\"          : \"1*\",\n        \"defgeneric\"          : \"2*\",\n        \"defmethod\"           : \"2*\",\n        \"defclass\"            : \"2*\",\n        \"defstruct\"           : \"1*\",\n        \"defmacro\"            : \"2*\",\n        \"progn\"               : \"0+\",\n        \"begin\"               : \"0+\",\n        \"prog1\"               : \"1*\",\n        \"prog2\"               : \"2*\",\n        \"let\"                 : \"1*\",\n        \"labels\"              : \"1*\",\n        \"flet\"                : \"1*\",\n        \"macrolet\"            : \"1*\",\n        \"symbol-macrolet\"     : \"1*\",\n        \"destructuring-bind\"  : \"2*\",\n        \"unwind-protect\"      : \"1*\",\n        \"catch\"               : \"1*\",\n        \"case\"                : \"1*\",\n        \"ecase\"               : \"1*\",\n        \"cond\"                : \"0+\",\n        \"handler-bind\"        : \"1*\",\n        \"handler-case\"        : \"1*\",\n        \"restart-bind\"        : \"1*\",\n        \"restart-case\"        : \"1*\",\n        \"return-from\"         : \"1*\",\n        \"block\"               : \"1*\",\n        \"dotimes\"             : \"1*\",\n        \"dolist\"              : \"1*\",\n        \"multiple-value-bind\" : \"2*\",\n        \":method\"             : \"1*\",\n        \"eval-when\"           : \"1*\",\n    };\n\n    var LOCAL_BODYDEF = toHash(\"labels flet macrolet\");\n\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    };\n\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    };\n\n    // the tokenizer function\n    Ymacs_Tokenizer.define(\"lisp\", function(stream, tok, options){\n\n        if (!options) options = {};\n\n        function isConstituent(ch) {\n            if (options.rx_special && options.rx_special.test(ch))\n                return false;\n            return ch.toLowerCase() != ch.toUpperCase() ||\n                /^[-|0-9!#$%&*+./:<=>?@\\^_~]$/i.test(ch);\n        };\n\n        function isConstituentStart(ch) {\n            //return ch != \"#\" && isConstituent(ch);\n            return isConstituent(ch);\n        };\n\n        var $cont          = [],\n        $inString      = false,\n        $inComment     = false,\n        $quote         = null,\n        $parens        = [],\n        $passedParens  = [],\n        $backList      = [],\n        $list          = [],\n        PARSER         = { next: next, copy: copy, indentation: indentation };\n\n        function copy() {\n            var context = restore.context = {\n                cont         : $cont.slice(0),\n                quote        : $quote,\n                inString     : $inString,\n                inComment    : $inComment,\n                parens       : $parens.slice(0),\n                passedParens : $passedParens.slice(0),\n                backList     : $backList.slice(0),\n                list         : $list.slice(0)\n            };\n            function restore() {\n                $cont          = context.cont.slice(0);\n                $inString      = context.inString;\n                $quote         = context.quote;\n                $inComment     = context.inComment;\n                $parens        = context.parens.slice(0);\n                $passedParens  = context.passedParens.slice(0);\n                $backList      = context.backList.slice(0),\n                $list          = context.list.slice(0);\n                return PARSER;\n            };\n            return restore;\n        };\n\n        function foundToken(c1, c2, type) {\n            tok.onToken(stream.line, c1, c2, type);\n        };\n\n        function newArg(what) {\n            if (what == null)\n                what = { c1: stream.col };\n            $list.push(what);\n        };\n\n        function INDENT_LEVEL() { return stream.buffer.getq(\"indent_level\"); };\n\n        function readName() {\n            var col = stream.col, ch = stream.next(),\n            name = ch;\n            while (!stream.eol()) {\n                ch = stream.peek();\n                if (!isConstituent(ch))\n                    break;\n                name += ch;\n                stream.nextCol();\n            }\n            var tok = ch && { line: stream.line, c1: col, c2: stream.col, id: name.toLowerCase() };\n            if (tok.c2 > tok.c1) return tok;\n        };\n\n        function readString(end, type) {\n            var ch, esc = false, start = stream.col;\n            while (!stream.eol()) {\n                ch = stream.peek();\n                if (!esc && ch === end) {\n                    $cont.pop();\n                    $inString = null;\n                    foundToken(start, stream.col, type);\n                    var p = $parens.at(-1);\n                    if (p && p.type == ch) {\n                        $parens.pop();\n                        p.closed = { line: stream.line, col: stream.col, opened: p };\n                        $passedParens.push(p);\n                    }\n                    foundToken(stream.col, ++stream.col, type + \"-stopper\");\n                    return true;\n                }\n                esc = !esc && ch === \"\\\\\";\n                stream.nextCol();\n            }\n            foundToken(start, stream.col, type);\n        };\n\n        function readComment() {\n            var line = stream.lineText(), pos = line.indexOf(\"|#\", stream.col);\n            var m = /^\\s*\\|+/.exec(line.substr(stream.col));\n            if (m) {\n                foundToken(stream.col, stream.col += m[0].length, \"mcomment-starter\");\n            }\n            if (pos >= 0) {\n                $cont.pop();\n                $inComment = null;\n                foundToken(stream.col, pos, \"mcomment\");\n                foundToken(pos, pos += 2, \"mcomment-stopper\");\n                stream.col = pos;\n            } else {\n                foundToken(stream.col, line.length, \"mcomment\");\n                stream.col = line.length;\n            }\n        };\n\n        function isForm(form, list = $list) {\n            var f = list && list.length > 0 && list[0].id;\n            if (f) {\n                f = f.toLowerCase();\n                if (form == null)\n                    return f;\n                return typeof form == \"string\" ? f == form : f in form;\n            }\n        };\n\n        function next() {\n            stream.checkStop();\n            if ($cont.length > 0)\n                return $cont.at(-1)();\n            var ch = stream.peek(), tmp;\n            if ((tmp = stream.lookingAt(/^#\\\\.[a-z0-9_-]*/i))) {\n                newArg();\n                foundToken(stream.col, stream.col += tmp[0].length, \"constant\");\n            }\n            else if ((tmp = stream.lookingAt(/^#\\x2f((\\\\.|[^\\x2f])*)\\x2f([igsm]*)/))) {\n                newArg();\n                foundToken(stream.col, stream.col += 2, \"regexp-starter\");\n                foundToken(stream.col, stream.col += tmp[1].length, \"regexp\");\n                foundToken(stream.col, stream.col += 1, \"regexp-stopper\");\n                if (tmp[3])\n                    foundToken(stream.col, stream.col += tmp[3].length, \"regexp-modifier\");\n            }\n            else if (stream.lookingAt(/^#\\x27[^(]/)) {\n                newArg();\n                stream.col += 2;\n                tmp = readName();\n                foundToken(tmp.c1, tmp.c2, \"function-name\");\n            }\n            else if (stream.lookingAt(\"#|\")) {\n                $inComment = { line: stream.line, c1: stream.col };\n                foundToken(stream.col, stream.col += 2, \"mcomment-starter\");\n                $cont.push(readComment);\n            }\n            else if ((tmp = stream.lookingAt(/^;+/))) {\n                foundToken(stream.col, stream.col += tmp[0].length, \"comment-starter\");\n                foundToken(stream.col, stream.col = stream.lineLength(), \"comment\");\n            }\n            else if (ch === '\"') {\n                newArg();\n                $inString = { line: stream.line, c1: stream.col };\n                $parens.push({ line: stream.line, col: stream.col, type: ch });\n                foundToken(stream.col, ++stream.col, \"string-starter\");\n                $cont.push(readString.bind(null, ch, \"string\"));\n            }\n            else if ((tmp = stream.lookingAt(/^[+-]?(#x[0-9a-fA-F]+|#o[0-7]+|#b[01]+|[0-9]*\\.?[0-9]+e?[0-9]*)(\\x2f(#x[0-9a-fA-F]+|#o[0-7]+|#b[01]+|[0-9]*\\.?[0-9]+e?[0-9]*))?/))) { // Dude, WTF...\n                newArg();\n                foundToken(stream.col, stream.col += tmp[0].length, \"number\");\n            }\n            else if ((tmp = isOpenParen(ch))) {\n                newArg();\n                $backList.push($list);\n                $list = [];\n                $parens.push({ line: stream.line, col: stream.col, type: ch });\n                foundToken(stream.col, ++stream.col, \"open-paren\");\n            }\n            else if ((tmp = isCloseParen(ch))) {\n                var p = $parens.pop();\n                if (!p || p.type != tmp) {\n                    foundToken(stream.col, ++stream.col, \"error\");\n                } else {\n                    p.closed = { line: stream.line, col: stream.col, opened: p };\n                    $passedParens.push(p);\n                    $list = $backList.pop();\n                    foundToken(stream.col, ++stream.col, \"close-paren\");\n                }\n            }\n            else if (isConstituentStart(ch) && (tmp = readName())) {\n                var type = ch == \":\" ? \"lisp-keyword\"\n                    : ch == \"&\" ? \"type\"\n                    : /^#:/.test(tmp.id) ? \"lisp-keyword\"\n                    : SPECIAL_FORMS.test(tmp.id) ? \"keyword\"\n                    : tmp.id in ERROR_FORMS ? \"error\"\n                    : tmp.id in CONSTANTS ? \"constant\"\n                    : null;\n                if (!type) {\n                    // perhaps function name?\n                    if (isForm(DEFINES_FUNCTION) && $list.length == 1) {\n                        type = \"function-name\";\n                    }\n                    else if (isForm(DEFINES_TYPE) && $list.length == 1) {\n                        type = \"type\";\n                    }\n                    // there are a lot of macros starting with \"with-\", so let's highlight this\n                    else if (/^with(out)?[-\\x2f]|:with(out)?[-\\x2f]/i.test(tmp.id)) {\n                        type = \"builtin\";\n                    }\n                }\n                newArg(tmp);\n                foundToken(tmp.c1, tmp.c2, type);\n            }\n            else {\n                foundToken(stream.col, ++stream.col, null);\n            }\n        };\n\n        function indentation() {\n            var currentLine = stream.lineText();\n            if ($inString) {\n                return Math.max(0, currentLine.search(/[^\\s\\t\\n]/));\n            }\n            var indent = 0;\n\n            // XXX: rewrite this mess.\n\n            var p = $parens.at(-1);\n            if (p) {\n                var line = stream.lineText(p.line);\n                indent = p.col + 1;\n                if (/[\\#\\']/.test(line.charAt(p.col - 1))) {\n                    return indent;\n                }\n                var nextNonSpace;\n                if (isConstituentStart(line.charAt(indent))) {\n                    var re = /\\s\\S/g;\n                    re.lastIndex = p.col;\n                    nextNonSpace = re.exec(line);\n                    if (nextNonSpace) {\n                        indent = nextNonSpace = nextNonSpace.index + 1;\n                    }\n                }\n                if ($list && $list.length) {\n                    var currentForm = isForm();\n                    if (currentForm) {\n                        currentForm = currentForm.replace(/\\*$/, \"\");\n                        var formArgs = FORM_ARGS[currentForm];\n                        if (!formArgs && /^with|:with/.test(currentForm)) {\n                            // \"with\" macros usually take one argument, then &body\n                            formArgs = \"0*\";\n                        }\n                        if (!formArgs && /^def/.test(currentForm)) {\n                            // definitions usually take two arguments, then &body\n                            if (nextNonSpace && /[\\(\\[\\{]/.test(line.charAt(nextNonSpace)))\n                                formArgs = \"1*\";\n                            else\n                                formArgs = \"2*\";\n                        }\n                        if (!formArgs) try {\n                            if (Object.hasOwn(LOCAL_BODYDEF, $backList[$backList.length - 2][0].id)) {\n                                formArgs = \"1*\";\n                            }\n                        } catch(ex){}\n                        if (formArgs) {\n                            var n = parseInt(formArgs, 10);\n                            var hasRest = /\\+/.test(formArgs);\n                            var hasBody =/\\*/.test(formArgs);\n                            indent = p.col + INDENT_LEVEL();\n                            if (hasRest && nextNonSpace) {\n                                indent = nextNonSpace;\n                            }\n                            else if ((n > 0 && $list.length - 1 < n)) {\n                                // still in the arguments\n                                if (nextNonSpace)\n                                    indent = nextNonSpace;\n                                else\n                                    indent += INDENT_LEVEL();\n                            }\n                        }\n                    }\n                }\n            }\n\n            return indent;\n        };\n\n        return PARSER;\n    });\n\n})();\n\nlet Ymacs_Keymap_LispMode = Ymacs_Keymap.define(\"lisp\", {\n    '\"' : [ \"lisp_handle_string_quote\" ], // XXX: keep this?\n});\n\nYmacs_Buffer.newMode(\"lisp_mode\", function() {\n\n    var tok = this.tokenizer;\n    this.setTokenizer(new Ymacs_Tokenizer({ buffer: this, type: \"lisp\" }));\n    var changed_vars = this.setq({\n        indent_level: 2,\n        syntax_paragraph_sep: /\\n(?:[ \\t;]*\\n)+/g,\n        syntax_comment_line: {\n            rx: /[^\\S\\r\\n]*;+ ?/gu,\n            ch: \";;\"\n        },\n        syntax_word_dabbrev: /^[-0-9_*%+/@&$.=~\\p{L}]$/u,\n    });\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    this.pushKeymap(Ymacs_Keymap_LispMode);\n\n    var changed_commands = this.replaceCommands({\n        \"forward_sexp\"            : \"lisp_forward_sexp\",\n        \"backward_sexp\"           : \"lisp_backward_sexp\",\n        \"backward_up_list\"        : \"lisp_backward_up_list\"\n    });\n\n    return function() {\n        this.setTokenizer(tok);\n        this.setq(changed_vars);\n        this.newCommands(changed_commands);\n        if (!was_paren_match)\n            this.cmd(\"paren_match_mode\", false);\n        this.popKeymap(Ymacs_Keymap_LispMode);\n    };\n\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Tokenizer } from \"./ymacs-tokenizer.js\";\n\nYmacs_Tokenizer.define(\"markdown\", function(stream, tok) {\n\n    let PARSER = { next: next, copy: copy };\n    let $inline = [];\n    let $parens = [];\n    let $cont = [];\n    let $passedParens = [];\n\n    function copy() {\n        let context = restore.context = {\n            cont         : [...$cont],\n            inline       : [...$inline],\n            parens       : [...$parens],\n            passedParens : [...$passedParens],\n        };\n        function restore() {\n            $cont         = [...context.cont];\n            $inline       = [...context.inline];\n            $parens       = [...context.parens];\n            $passedParens = [...context.passedParens];\n            return PARSER;\n        };\n        return restore;\n    };\n\n    let OPEN_PAREN = {\n        \"(\" : \")\",\n        \"{\" : \"}\",\n        \"[\" : \"]\",\n        \"\" : \"\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    let CLOSE_PAREN = {\n        \")\" : \"(\",\n        \"}\" : \"{\",\n        \"]\" : \"[\",\n        \"\" : \"\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    function foundToken(c1, c2, type) {\n        tok.onToken(stream.line, c1, c2, type);\n    };\n\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    };\n\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    };\n\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0)\n            return $cont.at(-1)();\n        readToken();\n    };\n\n    function readToken() {\n        let ch = stream.peek(), tmp;\n        if (stream.col == 0 && (tmp = stream.lookingAt(/^(#+)/))) {\n            foundToken(0, stream.col = stream.lineLength(), \"markdown-heading\" + tmp[0].length);\n        }\n        else if (stream.line > 0 && stream.col == 0 && (tmp = stream.lookingAt(/^[=-]+$/)) && /\\S/.test(stream.lineText(stream.line - 1))) {\n            tmp = tmp[0].charAt(0) == \"=\" ? 1 : 2;\n            tmp = \"markdown-heading\" + tmp;\n            tok.onToken(stream.line - 1, 0, stream.lineLength(stream.line - 1), tmp);\n            foundToken(0, stream.col = stream.lineLength(), tmp);\n        }\n        else if (stream.col == 0 && (tmp = stream.lookingAt(/^>\\s*[>\\s]*/))) {\n            tmp = tmp[0].replace(/\\s+/g, \"\").length;\n            if (tmp > 3)\n                tmp = \"\";\n            tmp = \"markdown-blockquote\" + tmp;\n            foundToken(0, stream.col = stream.lineLength(), tmp);\n        }\n        else if ((tmp = isOpenParen(ch))) {\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            foundToken(stream.col, ++stream.col, \"open-paren\");\n        }\n        else if ((tmp = isCloseParen(ch))) {\n            let p = $parens.pop();\n            if (!p || p.type != tmp) {\n                foundToken(stream.col, ++stream.col, \"error\");\n            } else {\n                p.closed = { line: stream.line, col: stream.col, opened: p };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\");\n            }\n        }\n        else {\n            foundToken(stream.col, ++stream.col, null);\n        }\n    };\n\n    return PARSER;\n\n});\n\nYmacs_Buffer.newMode(\"markdown_mode\", function() {\n\n    var tok = this.tokenizer;\n    this.setTokenizer(new Ymacs_Tokenizer({ buffer: this, type: \"markdown\" }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match)\n            this.cmd(\"paren_match_mode\", false);\n    };\n\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { delayed } from \"./ymacs-utils.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\nimport { getPP, compareRowCol, caretInside } from \"./ymacs-tokenizer.js\";\n\nlet Ymacs_Keymap_ParenMatch = Ymacs_Keymap.define(\"parenmatch\", {\n    \"C-M-x\"                        : \"goto_matching_paren\",\n    \"C-M-q\"                        : \"indent_sexp\",\n    \"C-M-f && C-M-n\"               : \"forward_sexp\",\n    \"C-M-b && C-M-p\"               : \"backward_sexp\",\n    \"C-M-u && M-a && C-M-ArrowUp\"  : \"backward_up_list\",\n    \"C-M-a\"                        : \"beginning_of_defun\",\n    \"C-M-e\"                        : \"end_of_defun\",\n    \"M-e\"                          : \"up_list\",\n    \"C-M-ArrowDown\"                : \"down_list\",\n    \"M-C-k\"                        : \"kill_sexp\",\n    \"M-C-Space\"                    : \"mark_sexp\",\n    \"M-C-t\"                        : \"transpose_sexps\",\n\n    \"(\"                            : [ \"paredit_open_pair\", \"(\", \")\" ],\n    \"[\"                            : [ \"paredit_open_pair\", \"[\", \"]\" ],\n    \"{\"                            : [ \"paredit_open_pair\", \"{\", \"}\" ],\n    \"\"                            : [ \"paredit_open_pair\", \"\", \"\" ],\n    \"\"                            : [ \"paredit_open_pair\", \"\", \"\" ],\n    \"\"                            : [ \"paredit_open_pair\", \"\", \"\" ],\n    '\"'                            : [ \"paredit_open_pair\", '\"', '\"', /[\\\"\\\\]/g ],\n\n    \")\"                            : [ \"paredit_close_pair\", \"(\", \")\" ],\n    \"]\"                            : [ \"paredit_close_pair\", \"[\", \"]\" ],\n    \"}\"                            : [ \"paredit_close_pair\", \"{\", \"}\" ],\n    \"\"                            : [ \"paredit_close_pair\", \"\", \"\" ],\n    \"\"                            : [ \"paredit_close_pair\", \"\", \"\" ],\n    \"\"                            : [ \"paredit_close_pair\", \"\", \"\" ],\n\n    \"M-(\"                          : [ \"paredit_wrap_round\", \"(\", \")\" ],\n    \"M-[\"                          : [ \"paredit_wrap_round\", \"[\", \"]\" ],\n    \"M-{\"                          : [ \"paredit_wrap_round\", \"{\", \"}\" ],\n    \"M-\"                          : [ \"paredit_wrap_round\", \"\", \"\" ],\n    \"M-\"                          : [ \"paredit_wrap_round\", \"\", \"\" ],\n    \"M-\"                          : [ \"paredit_wrap_round\", \"\", \"\" ],\n    'M-\"'                          : [ \"paredit_wrap_round\", '\"', '\"', /[\\\"\\\\]/g ],\n\n    \"M-r\"                          : \"paredit_raise_sexp\",\n    \"M-s\"                          : \"paredit_splice_sexp\",\n    \"Backspace\"                    : \"paredit_backward_delete_char\",\n    //\"Delete && C-d\"                : \"paredit_delete_char\",\n    \"Enter\"                        : \"paredit_newline_and_indent\",\n    \"; && : && , && .\"             : \"paredit_electric_char\",\n});\n\nvar PARENS = {\n    \"(\" : \")\",\n    \"[\" : \"]\",\n    \"{\" : \"}\",\n    \"\" : \"\",\n    \"\" : \"\",\n    \"\" : \"\",\n    '\"' : '\"',\n    \"'\" : \"'\",\n    '`' : '`',\n};\n\nvar R_PARENS = {\n    \")\" : \"(\",\n    \"]\" : \"[\",\n    \"}\" : \"{\",\n    \"\" : \"\",\n    \"\" : \"\",\n    \"\" : \"\",\n    '\"' : '\"',\n    \"'\" : \"'\",\n    '`' : '`',\n};\n\nfunction ERROR(o) {\n    throw new Ymacs_Exception(\"Balanced expression not found\");\n};\n\nfunction caretInOP(caret, paren) {\n    if (caret.row == paren.line) {\n        if (paren.col != null) {\n            return caret.col == paren.col;\n        } else {\n            return paren.c1 <= caret.col\n                && caret.col <= paren.c2;\n        }\n    }\n}\n\nfunction caretInCP(caret, paren) {\n    if (caret.row == paren.line) {\n        if (paren.col != null) {\n            return caret.col == paren.col + 1;\n        } else {\n            return paren.c1 <= caret.col\n                && caret.col <= paren.c2;\n        }\n    }\n}\n\nfunction startOf(paren) {\n    return paren.c1 ?? paren.col;\n}\n\nfunction endOf(paren) {\n    return paren.c2 ?? (paren.col + 1);\n}\n\nYmacs_Buffer.newCommands({\n\n    matching_paren: function() {\n        let parser = this.tokenizer.getLastParser();\n        if (parser) {\n            let rc = this._rowcol;\n            let parens = getPP(parser);\n            for (let op of parens) {\n                let cp = op.closed;\n                if (caretInOP(rc, op)) {\n                    return this._rowColToPosition(cp.line, endOf(cp));\n                } else if (caretInCP(rc, cp)) {\n                    return this._rowColToPosition(op.line, startOf(op));\n                }\n            }\n        }\n    },\n\n    indent_sexp: Ymacs_Interactive(function() {\n        var pos = this.cmd(\"matching_paren\");\n        if (pos != null) {\n            this.cmd(\"indent_region\", this.point(), pos);\n        } else {\n            ERROR(this);\n        }\n    }),\n\n    goto_matching_paren: Ymacs_Interactive(function() {\n        var pos = this.cmd(\"matching_paren\");\n        if (pos != null) {\n            this.cmd(\"goto_char\", pos);\n            return true;\n        }\n    }),\n\n    forward_sexp: Ymacs_Interactive(function() {\n        let parser = this.tokenizer.finishParsing(), next;\n        if (parser) {\n            // find next paren\n            let rc = this._rowcol;\n            let parens = getPP(parser);\n            for (let i = 0; i < parens.length; ++i) {\n                let p = parens[i];\n                if (p.line > rc.row || (p.line == rc.row && startOf(p) >= rc.col)) {\n                    next = p;\n                    break;\n                }\n            }\n        }\n        this.withVariables({\n            syntax_word: this.getq(\"syntax_word_sexp\"),\n        }, \"forward_word\");\n        if (next && next.closed && compareRowCol(this._rowcol, next) > 0) {\n            this.cmd(\"goto_char\", this._rowColToPosition(next.closed.line, endOf(next.closed)));\n        }\n    }),\n\n    backward_sexp: Ymacs_Interactive(function() {\n        let parser = this.tokenizer.finishParsing(), prev;\n        if (parser) {\n            // find next paren\n            let rc = this._rowcol;\n            let parens = getPP(parser).filter(p => p.closed).map(p => p.closed).sort(compareRowCol);\n            for (let i = parens.length; --i >= 0;) {\n                let p = parens[i];\n                if (p.line < rc.row || (p.line == rc.row && startOf(p) < rc.col)) {\n                    prev = p;\n                    break;\n                }\n            }\n        }\n        this.withVariables({\n            syntax_word: this.getq(\"syntax_word_sexp\"),\n        }, \"backward_word\");\n        if (prev && prev.opened && compareRowCol(this._rowcol, { line: prev.line, col: endOf(prev) }) < 0) {\n            this.cmd(\"goto_char\", this._rowColToPosition(prev.opened.line, startOf(prev.opened)));\n        }\n    }),\n\n    mark_sexp: Ymacs_Interactive(\"^r\", function(begin, end){\n        this.cmd(\"save_excursion\", function(){\n            if (this.transientMarker)\n                this.cmd(\"goto_char\", end);\n            this.ensureTransientMark();\n            this.cmd(\"forward_sexp\");\n            this.setMark(this.point());\n            this.transientMarker.swap(this.caretMarker);\n        });\n        this.ensureTransientMark();\n        this.setq(\"sticky_mark\", true);\n    }),\n\n    kill_sexp: Ymacs_Interactive(function() {\n        this._killingAction(\n            this.point(),\n            this.cmd(\"save_excursion\", function() {\n                this.cmd(\"forward_sexp\");\n                return this.point();\n            })\n        );\n    }),\n\n    transpose_sexps: Ymacs_Interactive(function() {\n        var a = [];\n        this.cmd(\"forward_sexp\"); a.push(this.point());\n        this.cmd(\"backward_sexp\"); a.push(this.point());\n        this.cmd(\"backward_sexp\"); a.push(this.point());\n        this.cmd(\"forward_sexp\"); a.push(this.point());\n        this.cmd(\"goto_char\", this._swapAreas(a));\n    }),\n\n    down_list: Ymacs_Interactive(function(){\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let lc = { line: rc.row, col: rc.col };\n            let p = getPP(tok).filter(p => p.closed).find(p => compareRowCol(p, lc) >= 0);\n            if (p != null) {\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, endOf(p)));\n            } else {\n                ERROR(this);\n            }\n        }\n    }),\n\n    backward_up_list: Ymacs_Interactive(function(){\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = getPP(tok).filter(caretInside(rc)).at(-1);\n            if (p != null) {\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, startOf(p)));\n            } else {\n                ERROR(this);\n            }\n        }\n    }),\n\n    up_list: Ymacs_Interactive(function(){\n        this.cmd(\"backward_up_list\");\n        this.cmd(\"forward_sexp\");\n    }),\n\n    beginning_of_defun: Ymacs_Interactive(function(){\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = getPP(tok).filter(caretInside(rc))[0];\n            if (p != null) {\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, startOf(p)));\n                this.cmd(\"back_to_indentation\");\n            } else {\n                this.cmd(\"backward_sexp\");\n            }\n        }\n    }),\n\n    end_of_defun: Ymacs_Interactive(function(){\n        let tok = this.tokenizer.finishParsing();\n        if (tok) {\n            let rc = this._rowcol;\n            let p = getPP(tok).filter(caretInside(rc))[0];\n            if (p != null) {\n                p = p.closed;\n                this.cmd(\"goto_char\", this._rowColToPosition(p.line, endOf(p)));\n            } else {\n                this.cmd(\"forward_sexp\");\n            }\n        }\n    }),\n\n    paredit_raise_sexp: Ymacs_Interactive(function(){\n        this.cmd(\"forward_sexp\");\n        this.cmd(\"backward_sexp\");\n        var start = this.point();\n        this.cmd(\"forward_sexp\");\n        var end = this.point();\n        this.cmd(\"backward_up_list\");\n        var kstart = this.point();\n        this.cmd(\"forward_sexp\");\n        var kend = this.point();\n        var sexp = this.cmd(\"buffer_substring\", start, end);\n        this._replaceText(kstart, kend, sexp);\n        this.cmd(\"goto_char\", kstart);\n        this.cmd(\"indent_region\", kstart, kstart + sexp.length);\n    }),\n\n    paredit_splice_sexp: Ymacs_Interactive(function(){\n        let p = getPP(this.tokenizer.finishParsing())\n            .filter(caretInside(this._rowcol, \"inner\")).at(-1);\n        if (p.inner && p.outer) {\n            this.cmd(\"save_excursion\", function(){\n                let outer_begin = this._rowColToPosition(p.outer.l1, p.outer.c1);\n                let outer_end = this._rowColToPosition(p.outer.l2, p.outer.c2);\n                let inner_begin = this._rowColToPosition(p.inner.l1, p.inner.c1);\n                let inner_end = this._rowColToPosition(p.inner.l2, p.inner.c2);\n                this.withMarkers((m1, m2) => {\n                    this._deleteText(inner_end, outer_end);\n                    this._deleteText(outer_begin, inner_begin);\n                    this.cmd(\"indent_region\", m1, m2);\n                }, inner_begin, inner_end);\n            });\n        } else {\n            this.cmd(\"save_excursion\", function(){\n                this.cmd(\"backward_up_list\");\n                var start = this.point();\n                this.cmd(\"forward_sexp\");\n                this.cmd(\"backward_delete_char\");\n                var end = this.point();\n                this.cmd(\"goto_char\", start);\n                this.cmd(\"delete_char\");\n                this.cmd(\"indent_region\", start, end - 1);\n            });\n        }\n    }),\n\n    paredit_backward_delete_char: Ymacs_Interactive(\"^p\", function(n){\n        if (n != null) return this.cmd(\"backward_delete_char\", n);\n        if (!this.deleteTransientRegion()) {\n            if (this.cmd(\"looking_back\", /[\\(\\[\\{\\\"\\\\\\`\\']/g)) {\n                var close = PARENS[this.matchData[0]];\n                if (close) {\n                    var rx = new RegExp(\"\\\\s*\\\\\" + close, \"my\");\n                    if (this.cmd(\"looking_at\", rx)) this.cmd(\"save_excursion\", function(){\n                        this.cmd(\"delete_whitespace\");\n                        this.cmd(\"delete_char\");\n                    });\n                }\n            }\n            this.cmd(\"backward_delete_char\");\n        }\n    }),\n\n    paredit_delete_char: Ymacs_Interactive(\"^p\", function(n){\n        if (n != null) return this.cmd(\"delete_char\", n);\n        if (!this.deleteTransientRegion()) {\n            if (this.cmd(\"looking_at\", /[\\]\\}\\)\\\"\\\\\\`\\']/y)) {\n                var open = R_PARENS[this.matchData[0]];\n                if (open) {\n                    var rx = new RegExp(\"\\\\\" + open + \"\\\\s*\", \"mg\");\n                    if (this.cmd(\"looking_back\", rx)) this.cmd(\"save_excursion\", function(){\n                        this.cmd(\"backward_delete_whitespace\");\n                        this.cmd(\"backward_delete_char\");\n                    });\n                }\n            }\n            this.cmd(\"delete_char\");\n        }\n    }),\n\n    paredit_open_pair: Ymacs_Interactive(\"^\", function(pair_a, pair_b, backslash) {\n        if (this.transientMarker) {\n            this.cmd(\"paredit_wrap_round\", pair_a, pair_b, backslash);\n            return;\n        }\n        if (pair_a == pair_b && this.looking_at(pair_a)) {\n            // presumably close; it's already there, just skip it\n            this.cmd(\"forward_char\");\n        } else {\n            this.cmd(\"insert\", pair_a);\n            this.cmd(\"insert\", pair_b);\n            this.cmd(\"backward_char\", pair_b.length);\n        }\n        this.cmd(\"paredit_maybe_indent\");\n    }),\n\n    paredit_close_pair: Ymacs_Interactive(\"^\", function(pair_a, pair_b) {\n        if (this.transientMarker) {\n            this.cmd(\"paredit_wrap_round\", pair_a, pair_b);\n            return;\n        }\n        var re = new RegExp(\"\\\\s*\\\\\" + pair_b, \"iy\");\n        if (this.cmd(\"looking_at\", re))\n            this._deleteText(this.point(), this.matchData.after);\n        this.cmd(\"insert\", pair_b);\n        this.cmd(\"paredit_maybe_indent\");\n    }),\n\n    paredit_wrap_round: Ymacs_Interactive(\"^\", function(paren, closing, backslash) {\n        var r = this.transientMarker\n            ? this.getRegion()\n            : this.cmd(\"save_excursion\", function(){\n                var begin = this.point();\n                this.cmd(\"forward_sexp\");\n                return { begin: begin, end: this.point() };\n            }),\n            txt = this._bufferSubstring(r.begin, r.end),\n            before = this.point() < r.end;\n        if (backslash) {\n            txt = txt.replace(backslash, s => \"\\\\\" + s);\n        }\n        var m = this.createMarker(r.end);\n        this.cmd(\"save_excursion\", function(){\n            this._replaceText(r.begin, r.end, paren + txt + closing);\n        }, before);\n        if (before) {\n            this.cmd(\"forward_char\");\n        }\n        this.clearTransientMark();\n        this.cmd(\"indent_region\", r.begin, m.getPosition());\n        m.destroy();\n    }),\n\n    paredit_newline_and_indent: Ymacs_Interactive(function(){\n        var inparens = this.looking_at(/[ \\t]*([\\]\\}])/y)\n            && this.looking_back(new RegExp(\"\\\\\" + R_PARENS[this.matchData[1]] + \"[ \\\\t]*\", \"g\"));\n        this.cmd(\"newline_and_indent\");\n        if (inparens) {\n            this.cmd(\"newline_and_indent\");\n            this.cmd(\"backward_line\");\n            this.cmd(\"indent_line\");\n        }\n    }),\n\n    paredit_maybe_indent: function() {\n        if (this.getq(\"electric_indent\")) {\n            this.cmd(\"indent_line\");\n        }\n    },\n\n    paredit_electric_char: Ymacs_Interactive(function(){\n        this.cmd(\"self_insert_command\");\n        this.cmd(\"paredit_maybe_indent\");\n    }),\n\n});\n\nYmacs_Buffer.newMode(\"paren_match_mode\", function(){\n\n    this.pushKeymap(Ymacs_Keymap_ParenMatch);\n\n    var clearOvl = function() {\n        this.deleteOverlay(\"match-paren\");\n    }.bind(this);\n\n    function inside(a, b, c) {\n        return b >= a && b < c;\n    }\n\n    let events = {\n        beforeInteractiveCommand: function() {\n            clearOvl();\n        },\n        afterInteractiveCommand: delayed(() => {\n            let p = this.tokenizer.getLastParser(), rc = this._rowcol;\n            let hl = [];\n            if (p) for (let par_a of getPP(p)) {\n                let par_b = par_a.closed;\n                let ac1 = par_a.c1 ?? par_a.col, ac2 = par_a.c2 ?? (par_a.col + par_a.type.length);\n                let bc1 = par_b.c1 ?? par_b.col, bc2 = par_b.c2 ?? (par_b.col + 1);\n                if (caretInOP(rc, par_a) || caretInCP(rc, par_b)) {\n                    hl.push({\n                        line1: par_a.line, col1: ac1,\n                        line2: par_a.line, col2: ac2\n                    }, {\n                        line1: par_b.line, col1: bc1,\n                        line2: par_b.line, col2: bc2\n                    });\n                    break;\n                }\n            }\n            this.setOverlay(\"match-paren\", hl);\n        }, 100)\n    };\n    this.addEventListener(events);\n\n    if (this.getq(\"electric_indent\") == null) {\n        this.setq(\"electric_indent\", true);\n    }\n\n    return function() {\n        clearOvl();\n        this.popKeymap(Ymacs_Keymap_ParenMatch);\n        this.removeEventListener(events);\n    };\n\n});\n","/// This file is part of Ymacs - www.ymacs.org\n/// Copyright (c) 2009-2024 Mihai Bazon <mihai.bazon@gmail.com>\n/// License: MIT\n\nimport { Ymacs_Buffer } from \"./ymacs-buffer.js\";\nimport { Ymacs_Tokenizer, getPP, compareRowCol, caretInside } from \"./ymacs-tokenizer.js\";\nimport { Ymacs_Exception } from \"./ymacs-exception.js\";\nimport { Ymacs_Keymap } from \"./ymacs-keymap.js\";\nimport { Ymacs_Interactive } from \"./ymacs-interactive.js\";\n\nconst RX_EMPTY_TAG = /^(?:area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/i;\nconst RX_BLOCK_TAG = /^(?:article|aside|blockquote|body|button|caption|col|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h[1-6]|header|hgroup|li|ol|p|pre|section|table|tbody|textarea|tfoot|th|thead|td|tr|ul)$/i;\n\nYmacs_Tokenizer.define(\"xml\", xml_tokenizer);\nYmacs_Tokenizer.define(\"html\", html_tokenizer);\n\nlet Ymacs_Keymap_XML = Ymacs_Keymap.define(\"xml\", {\n    \"C-c /\"   : \"xml_close_tag\",\n    \"/\"       : \"xml_slash_complete_tag\",\n    \">\"       : \"xml_gt_complete_tag\",\n    \"C-Enter\" : \"xml_zen_expand\",\n    \"Enter\"   : \"xml_newline_and_indent\"\n});\n\nlet markup_mode = tok_type => function(){\n    var tok = this.tokenizer;\n    this.setTokenizer(new Ymacs_Tokenizer({ buffer: this, type: tok_type }));\n    var was_paren_match = this.cmd(\"paren_match_mode\", true);\n    this.pushKeymap(Ymacs_Keymap_XML);\n    var changed_vars = this.setq({\n        indent_level: 2,\n        syntax_comment_multi: {\n            rx: /[^\\S\\r\\n]*<!--+[^\\S\\r\\n]*(.*?)[^\\S\\r\\n]*-->/ygu,\n            ch: [ \"<!--\", \"-->\" ]\n        },\n        syntax_word_dabbrev: /^[\\p{N}_$\\p{L}:#-]$/u,\n        syntax_word_sexp: /^[\\p{N}_$\\p{L}:#-]$/u,\n    });\n    return function() {\n        this.setTokenizer(tok);\n        if (!was_paren_match)\n            this.cmd(\"paren_match_mode\", false);\n        this.popKeymap(Ymacs_Keymap_XML);\n        this.setq(changed_vars);\n    };\n};\n\nYmacs_Buffer.newMode(\"xml_mode\", markup_mode(\"xml\"));\nYmacs_Buffer.newMode(\"html_mode\", markup_mode(\"html\"));\n\nYmacs_Buffer.newCommands({\n    xml_get_fill_paragraph_region: function() {\n        let blk = getPP(this.tokenizer.finishParsing())\n            .filter(caretInside(this._rowcol, \"outer\"))\n            .findLast(p => RX_BLOCK_TAG.test(p.type));\n        if (blk) {\n            let r = {\n                begin: this._rowColToPosition(blk.inner.l1, blk.inner.c1),\n                end: this._rowColToPosition(blk.inner.l2, blk.inner.c2)\n            };\n            this.cmd(\"save_excursion\", () => {\n                this.cmd(\"goto_char\", r.begin);\n                if (this.cmd(\"looking_at\", /[^\\S\\r\\n]*\\n/gy)) {\n                    this.cmd(\"goto_char\", this.matchData.after);\n                    r.begin = this.point();\n                }\n                this.cmd(\"goto_char\", r.end);\n                if (this.cmd(\"looking_back\", /\\n[^\\S\\r\\n]*/g)) {\n                    this.cmd(\"backward_whitespace\");\n                    r.end = this.point();\n                }\n            });\n            return r;\n        }\n    }\n});\n\nfunction xml_tokenizer(stream, tok, { emptyTags, inline } = {}) {\n    var $tags = [];\n    var $cont = [];\n    var $parens = [];\n    var $passedParens = [];\n    var $inTag = null;\n    var $inComment = null;\n    var $inString = false;\n    var $inline = 0;\n    var PARSER = { next: next, copy: copy, indentation: indentation,\n                   get tags() { return $tags } };\n\n    function copy() {\n        let context = resume.context = {\n            tags: $tags.slice(0),\n            cont: $cont.slice(0),\n            parens: $parens.slice(0),\n            passedParens: $passedParens.slice(0),\n            inTag: $inTag,\n            inComment: $inComment,\n            inString: $inString,\n            inline: $inline,\n        };\n        function resume() {\n            $cont = context.cont.slice(0);\n            $tags = context.tags.slice(0);\n            $parens = context.parens.slice(0);\n            $passedParens = context.passedParens.slice(0);\n            $inTag = context.inTag;\n            $inComment = context.inComment;\n            $inString = context.inString;\n            $inline = context.inline;\n            return PARSER;\n        };\n        return resume;\n    }\n\n    function INDENT_LEVEL() {\n        return stream.buffer.getq(\"indent_level\");\n    }\n\n    function foundToken(c1, c2, type, addInline) {\n        if (addInline && inline) {\n            let cls = inline && inline.cls($inline) || \"\";\n            if (type) cls += \" \" + type;\n            tok.onToken(stream.line, c1, c2, cls || null);\n        } else {\n            tok.onToken(stream.line, c1, c2, type);\n        }\n    }\n\n    function isLetter(ch) {\n        return ch.toLowerCase() != ch.toUpperCase();\n    }\n\n    function isNameStart(ch) {\n        return ch && (isLetter(ch) || /^[:_-]$/.test(ch));\n    }\n\n    function isNameChar(ch) {\n        return ch && (isLetter(ch) || /^[0-9:_-]$/.test(ch));\n    }\n\n    function readName() {\n        var col = stream.col, ch = stream.next(),\n        name = ch;\n        while (!stream.eol()) {\n            ch = stream.peek();\n            if (!isNameChar(ch))\n                break;\n            name += ch;\n            stream.nextCol();\n        }\n        return ch && { line: stream.line, c1: col, c2: stream.col, id: name };\n    }\n\n    function readString(end) {\n        $inString = true;\n        var ch, esc = false, start = stream.col;\n        while (!stream.eol()) {\n            ch = stream.peek();\n            if (!esc && ch === end) {\n                $cont.pop();\n                $inString = false;\n                foundToken(start, stream.col, \"string\");\n                var p = $parens.at(-1);\n                if (p && p.type == ch) {\n                    $parens.pop();\n                    p.closed = { line: stream.line, col: stream.col, opened: p };\n                    $passedParens.push(p);\n                }\n                foundToken(stream.col, ++stream.col, \"string-stopper\");\n                return;\n            }\n            esc = !esc && ch === \"\\\\\";\n            stream.nextCol();\n        }\n        foundToken(start, stream.col, \"string\");\n    }\n\n    function readTag() {\n        var ch = stream.peek(), name;\n        if (stream.lookingAt(\"/>\")) {\n            let p = $parens.at(-1);\n            if (p && p.type == \"<\") {\n                $parens.pop();\n                p.closed = { line: stream.line, col: stream.col + 1, opened: p };\n                $passedParens.push(p);\n            }\n            $cont.pop();\n            $inTag = null;\n            foundToken(stream.col, ++stream.col, \"xml-closetag-slash\");\n            foundToken(stream.col, ++stream.col, \"xml-close-bracket\");\n        }\n        else if (ch === \">\") {\n            let p = $parens.at(-1);\n            if (p && p.type == \"<\") {\n                $parens.pop();\n                p.closed = { line: stream.line, col: stream.col, opened: p };\n                $passedParens.push(p);\n            }\n            $cont.pop();\n            foundToken(stream.col, ++stream.col, \"xml-close-bracket\");\n            if (!emptyTags?.test($inTag.id)) {\n                $inTag.inner = { l1: stream.line, c1: stream.col };\n                $tags.push($inTag);\n                if (inline) {\n                    $inline ^= inline.code($inTag.id);\n                }\n            }\n            $inTag = null;\n        }\n        else if (isNameStart(ch) && (name = readName())) {\n            foundToken(name.c1, name.c2, \"xml-attribute\");\n        }\n        else if (ch === '\"' || ch === \"'\") {\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            foundToken(stream.col, ++stream.col, \"string-starter\");\n            $cont.push(readString.bind(null, ch));\n        }\n        else foundToken(stream.col, ++stream.col, null);\n    }\n\n    function readComment(type, end, op) {\n        var line = stream.lineText(), pos = line.indexOf(end, stream.col);\n        if (pos >= 0) {\n            $cont.pop();\n            foundToken(stream.col, pos, type);\n            $inComment = null;\n            op.closed = { line: stream.line, c1: pos, c2: pos + end.length, opened: op };\n            $passedParens.push(op);\n            foundToken(pos, pos += end.length, type + \"-stopper\");\n            stream.col = pos;\n        } else {\n            foundToken(stream.col, line.length, type);\n            stream.col = line.length;\n        }\n    }\n\n    function readCloseBracket(tag) {\n        var m = stream.lookingAt(/^([\\s\\xA0]*)(>?)/);\n        if (m && m[0]) {\n            if (m[1])\n                foundToken(stream.col, stream.col += m[1].length, null);\n            if (m[2]) {\n                let p = $parens.pop();\n                p.closed = { line: stream.line, col: stream.col, opened: p };\n                $passedParens.push(p);\n                foundToken(stream.col, stream.col += m[2].length, \"xml-close-bracket\");\n                $cont.pop();\n                if (tag) {\n                    tag.outer.l2 = stream.line;\n                    tag.outer.c2 = stream.col;\n                }\n            }\n        } else {\n            foundToken(stream.col, ++stream.col, \"error\");\n        }\n    }\n\n    let OPEN_PAREN = {\n        \"(\" : \")\",\n        \"{\" : \"}\",\n        \"[\" : \"]\",\n        \"\" : \"\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    let CLOSE_PAREN = {\n        \")\" : \"(\",\n        \"}\" : \"{\",\n        \"]\" : \"[\",\n        \"\" : \"\",\n        \"\" : \"\",\n        \"\" : \"\",\n    };\n\n    function isOpenParen(ch) {\n        return OPEN_PAREN[ch];\n    }\n\n    function isCloseParen(ch) {\n        return CLOSE_PAREN[ch];\n    }\n\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0)\n            return $cont.at(-1)();\n        let ch = stream.peek(), m;\n        if (stream.lookingAt(\"<![CDATA[\")) {\n            let op = { line: stream.line, c1: stream.col, c2: stream.col + 9, type: \"<![CDATA[\" };\n            $parens.push(op);\n            foundToken(stream.col, stream.col += 9, \"xml-cdata-starter\");\n            $inComment = { line: stream.line, c1: stream.col };\n            $cont.push(readComment.bind(null, \"xml-cdata\", \"]]>\", op));\n        }\n        else if (stream.lookingAt(\"<!--\")) {\n            let op = { line: stream.line, c1: stream.col, c2: stream.col + 4, type: \"<!--\" };\n            $parens.push(op);\n            foundToken(stream.col, stream.col += 4, \"mcomment-starter\");\n            $inComment = { line: stream.line, c1: stream.col };\n            $cont.push(readComment.bind(null, \"mcomment\", \"-->\", op));\n        }\n        else if ((m = stream.lookingAt(/^<!.*?>/))) {\n            foundToken(stream.col, stream.col += m[0].length, \"directive\");\n        }\n        else if (stream.lookingAt(\"</\") && isNameStart(stream.peek(+2))) {\n            let otag = $tags.pop();\n            if (otag) {\n                otag.inner.l2 = stream.line;\n                otag.inner.c2 = stream.col;\n                if (inline) {\n                    $inline ^= inline.code(otag.id);\n                }\n            }\n            $parens.push({ line: stream.line, c1: stream.col, c2: stream.col + 2, type: \"</\" });\n            foundToken(stream.col, ++stream.col, \"xml-open-bracket\");\n            foundToken(stream.col, ++stream.col, \"xml-closetag-slash\");\n            let ctag = readName();\n            foundToken(ctag.c1, ctag.c2, ( otag && otag.id == ctag.id\n                                         ? \"xml-close-tag\"\n                                         : \"error\" ));\n            if (otag) {\n                let popen = { line: otag.line, c1: otag.c1, c2: otag.c2, type: otag.id,\n                              inner: otag.inner, outer: otag.outer };\n                let pclose = { line: ctag.line, c1: ctag.c1, c2: ctag.c2, opened: popen };\n                popen.closed = pclose;\n                $passedParens.push(popen);\n            }\n            $cont.push(readCloseBracket.bind(null, otag));\n        }\n        else if (ch === \"<\" && isNameStart(stream.peek(+1))) {\n            let outer = { l1: stream.line, c1: stream.col };\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            foundToken(stream.col, ++stream.col, \"xml-open-bracket\");\n            let tag = readName();\n            tag.outer = outer;\n            foundToken(tag.c1, tag.c2, \"xml-open-tag\");\n            $inTag = tag;\n            $cont.push(readTag);\n        }\n        else if ((m = stream.lookingAt(/^&.*?;/))) {\n            foundToken(stream.col, ++stream.col, \"xml-entity-starter\");\n            foundToken(stream.col, stream.col += m[0].length - 2, \"xml-entity\");\n            foundToken(stream.col, ++stream.col, \"xml-entity-stopper\");\n        }\n        else if (ch === \"&\") {\n            foundToken(stream.col, ++stream.col, \"error\");\n        }\n        else if ((m = isOpenParen(ch))) {\n            $parens.push({ line: stream.line, col: stream.col, type: ch });\n            foundToken(stream.col, ++stream.col, \"open-paren\", true);\n        }\n        else if ((m = isCloseParen(ch))) {\n            let p = $parens.pop();\n            if (!p || p.type != m) {\n                foundToken(stream.col, ++stream.col, \"error\");\n            } else {\n                p.closed = { line: stream.line, col: stream.col, opened: p };\n                $passedParens.push(p);\n                foundToken(stream.col, ++stream.col, \"close-paren\", true);\n            }\n        }\n        else {\n            foundToken(stream.col, ++stream.col, null, ch != \" \");\n        }\n    }\n\n    function indentation() {\n        var indent, lastTag;\n        if ($inComment) {\n            indent = stream.lineIndentation($inComment.line) + INDENT_LEVEL();\n        }\n        else if ($inTag) {\n            var txt = stream.lineText($inTag.line);\n            if (/^\\s*$/.test(txt.substr(0, $inTag.c1 - 1))) {\n                indent = $inTag.c1 + $inTag.id.length + 1;\n            } else {\n                indent = stream.lineIndentation($inTag.line);\n            }\n        }\n        else if ((lastTag = $tags.at(-1))) {\n            indent = stream.lineIndentation(lastTag.line) + INDENT_LEVEL();\n            // if current line begins with a closing tag, back one level\n            if (/^\\s*<\\x2f/.test(stream.lineText()))\n                indent -= INDENT_LEVEL();\n        }\n\n        if (indent == null) {\n            let line = stream.line;\n            while (line > 0 && !/\\S/.test(stream.lineText(line))) line--;\n            indent = stream.lineIndentation(line);\n        }\n\n        return indent;\n    }\n\n    return PARSER;\n}\n\nfunction inlineCode(tag) {\n    return (tag == \"i\" || tag == \"em\" ? 1 :\n            tag == \"b\" || tag == \"strong\" ? 2 :\n            tag == \"a\" ? 4 :\n            tag == \"h1\" ? 8 :\n            tag == \"h2\" ? 16 :\n            tag == \"h3\" ? 32 :\n            tag == \"h4\" ? 64 :\n            0);\n}\n\nfunction inlineCls(inline) {\n    let out = \"\";\n    if (inline & 1) out += \" italic\";\n    if (inline & 2) out += \" bold\";\n    if (inline & 4) out += \" link\";\n    if (inline & 8) out += \" heading1\";\n    if (inline & 16) out += \" heading2\";\n    if (inline & 32) out += \" heading3\";\n    if (inline & 64) out += \" heading4\";\n    return out.trim() || null;\n}\n\nfunction html_tokenizer(stream, tok){\n    let $cont = [];\n    let $xml = tok.getLanguage(\"xml\", {\n        emptyTags: RX_EMPTY_TAG,\n        inline: { code: inlineCode, cls: inlineCls },\n    });\n    let $js = tok.getLanguage(\"js\");\n    let $css = tok.getLanguage(\"css\");\n    let $mode = $xml;\n\n    let PARSER = {\n        next: next,\n        copy: copy,\n        get mode() {\n            return $mode === $xml ? \"markup\"\n                :  $mode === $css ? \"css\"\n                :  $mode === $js ? \"js\"\n                :  null;\n        },\n        get tags() {\n            return $xml.tags;\n        },\n        indentation: indentation\n    };\n\n    function next() {\n        stream.checkStop();\n        if ($cont.length > 0)\n            return $cont.at(-1)();\n\n        if ($mode === $xml) {\n            let tag = $xml.tags.at(-1);\n            if (tag?.id == \"script\") {\n                $mode = $js;\n            } else if (tag?.id == \"style\") {\n                $mode = $css;\n            }\n        }\n        if ($mode === $js) {\n            if (stream.lookingAt(\"</script\")) {\n                $mode = $xml;\n            }\n        }\n        if ($mode === $css) {\n            if (stream.lookingAt(\"</style\")) {\n                $mode = $xml;\n            }\n        }\n\n        $mode.next();\n    }\n\n    function copy() {\n        let _cont = [...$cont];\n        let _main = $xml.copy();\n        let _js = $js.copy();\n        let _css = $css.copy();\n        let _mode = $mode;\n        function resume() {\n            $cont = [..._cont];\n            $xml = _main();\n            $js = _js();\n            $css = _css();\n            $mode = _mode;\n            return PARSER;\n        }\n        resume.context = {\n            get passedParens() {\n                return [\n                    ..._main.context.passedParens,\n                    ..._js.context.passedParens,\n                    ..._css.context.passedParens,\n                ];\n            },\n            get tags() {\n                return _main.context.tags;\n            }\n        };\n        return resume;\n    }\n\n    function indentation() {\n        if (/^\\s*<\\//.test(stream.lineText()))\n            return $xml.indentation();\n        return $mode.indentation();\n    }\n\n    return PARSER;\n}\n\n(function(){\n\n    let Ymacs_Keymap_XML_Zen = Ymacs_Keymap.define(\"xml_zen\", {\n        \"Tab\"   : \"xml_zen_next_poi\",\n        \"S-Tab\" : \"xml_zen_prev_poi\",\n        \"C-g\"   : \"xml_zen_stop\"\n    });\n\n    var MODE_TYPE = 1, MODE_CLASS = 2, MODE_ID = 3, MODE_REPEAT = 4, MODE_ATTR = 5;\n\n    function zen_render(el, html) {\n        var n = el.repeat || 1;\n        for (var i = 1; i <= n; ++i) {\n            if (i > 1)\n                html(\"\\n\");\n            html(\"<\", el.type);\n            if (el.id) {\n                html(' id=\"', el.id.replace(/\\$/g, i), '\"');\n            }\n            if (el.klass) {\n                html(' class=\"', el.klass.replace(/\\$/g, i), '\"');\n            }\n            if (el.attributes) {\n                el.attributes.forEach(attr => html(\" \", attr, '=\"|\"'));\n            }\n            html(\">\");\n            if (el.child) {\n                html(\"\\n\");\n                zen_render(el.child, html);\n                html(\"\\n\");\n            } else {\n                html(\"|\");\n            }\n            html(\"</\", el.type, \">\");\n            if (el.next) {\n                html(\"\\n\");\n                zen_render(el.next, html);\n            }\n        }\n    };\n\n    function zen_parse(str, i) {\n        var el = { type: \"\" }, mode = MODE_TYPE;\n        OUTER: while (i < str.length) {\n            var ch = str.charAt(i++);\n            switch (ch) {\n\n              case \"#\":\n                mode = MODE_ID;\n                el.id = \"\";\n                break;\n\n              case \".\":\n                mode = MODE_CLASS;\n                if (el.klass != null) {\n                    el.klass += \" \";\n                } else {\n                    el.klass = \"\";\n                }\n                break;\n\n              case \":\":\n                mode = MODE_ATTR;\n                if (el.attributes == null)\n                    el.attributes = [];\n                el.attributes.push(\"\");\n                break;\n\n              case \"*\":\n                mode = MODE_REPEAT;\n                el.repeat = \"\";\n                break;\n\n              case \">\":\n                el.child = zen_parse(str, i);\n                i = el.child.i;\n                break OUTER;\n\n              case \"(\":\n                el.child = zen_parse(str, i);\n                i = el.child.i;\n                break;\n\n              case \")\":\n                break OUTER;\n\n              case \"+\":\n                el.next = zen_parse(str, i);\n                i = el.next.i;\n                break OUTER;\n\n              default:\n                switch (mode) {\n                  case MODE_TYPE:\n                    el.type += ch;\n                    break;\n                  case MODE_CLASS:\n                    el.klass += ch;\n                    break;\n                  case MODE_ID:\n                    el.id += ch;\n                    break;\n                  case MODE_REPEAT:\n                    el.repeat = parseInt(String(el.repeat) + ch, 10);\n                    break;\n                  case MODE_ATTR:\n                    el.attributes.push(el.attributes.pop() + ch);\n                    break;\n                }\n            }\n        }\n\n        el.i = i;\n        return el;\n    };\n\n    function maybe_stop_zen() {\n        var point = this.point(),\n        a = this.getq(\"xml_zen_markers\"),\n        start = a[0],\n        end = a.at(-1);\n        if (point < start.getPosition() || point > end.getPosition() ||\n            end.getPosition() == a.at(-2).getPosition()) {\n            this.cmd(\"xml_zen_stop\");\n        }\n    };\n\n    Ymacs_Buffer.newCommands({\n\n        xml_close_tag: Ymacs_Interactive(function() {\n            this.cmd(\"close_last_xml_tag\");\n            this.cmd(\"indent_line\");\n        }),\n\n        xml_slash_complete_tag: Ymacs_Interactive(function() {\n            this.cmd(\"self_insert_command\");\n            if (this.looking_back(\"</\")) {\n                let rc = this._rowcol;\n                let parser = this.tokenizer.getParserForLine(rc.row, rc.col);\n                let ctx = parser.copy().context;\n                let tag = ctx.tags.at(-1);\n                if (tag) {\n                    this._placeUndoBoundary();\n                    this.cmd(\"insert\", tag.id, \">\");\n                    this.cmd(\"indent_line\");\n                }\n            }\n        }),\n\n        xml_gt_complete_tag: Ymacs_Interactive(function() {\n            this.cmd(\"self_insert_command\");\n            let rc = this._rowcol;\n            let parser = this.tokenizer.getParserForLine(rc.row, rc.col);\n            let ctx = parser.copy().context;\n            let tag = ctx.tags.at(-1);\n            if (tag?.inner?.l1 == rc.row && tag.inner.c1 == rc.col) {\n                this._placeUndoBoundary();\n                let pos = this.point();\n                this.cmd(\"insert\", \"</\", tag.id, \">\");\n                this.cmd(\"goto_char\", pos);\n            }\n        }),\n\n        xml_zen_expand: Ymacs_Interactive(function() {\n            this.cmd(\"xml_zen_stop\");\n            var html = \"\";\n            var start = this.cmd(\"save_excursion\", function() {\n                this.cmd(\"backward_whitespace\");\n                while (!this.cmd(\"looking_back\", /[\\x20\\xa0\\s\\t\\n;&]/g))\n                    if (!this.cmd(\"backward_char\"))\n                        break;\n                return this.point();\n            });\n            var point = this.point();\n\n            try {\n                zen_render(\n                    zen_parse(\n                        this.cmd(\"buffer_substring\", start, point).trim(), 0\n                    ),\n                    (...args) => html += args.join(\"\")\n                );\n            } catch(ex) {\n                throw new Ymacs_Exception(\"The Zen is not strong today :-/\");\n            }\n\n            this.cmd(\"delete_region\", start, point);\n            this.cmd(\"insert\", html);\n            start = this.createMarker(start, false, \"xml_zen\");\n\n            // locate points of interest\n            var end = this.createMarker(this.point(), true, \"xml_zen\"), markers = [];\n            this.cmd(\"goto_char\", start.getPosition());\n            while (this.cmd(\"search_forward\", \"|\", end.getPosition())) {\n                this.cmd(\"backward_delete_char\");\n                markers.push(this.createMarker(this.point(), true, \"xml_zen_start\"));\n                markers.push(this.createMarker(this.point(), false, \"xml_zen_end\"));\n            }\n\n            this.cmd(\"indent_region\", start.getPosition(), end.getPosition());\n\n            var count = markers.length;\n            if (count > 0) {\n                // move to first POI\n                this.cmd(\"goto_char\", markers[0]);\n                markers.unshift(start);\n                markers.push(end);\n                this.setq(\"xml_zen_markers\", markers);\n                this.pushKeymap(Ymacs_Keymap_XML_Zen);\n                this.addEventListener(\"afterInteractiveCommand\", maybe_stop_zen);\n            } else {\n                start.destroy();\n                end.destroy();\n            }\n        }),\n\n        xml_zen_stop: Ymacs_Interactive(function(){\n            var tmp = this.getq(\"xml_zen_markers\");\n            if (tmp) {\n                tmp.map(m => m.destroy());\n                this.setq(\"xml_zen_markers\", null);\n            }\n            this.popKeymap(Ymacs_Keymap_XML_Zen);\n            this.removeEventListener(\"afterInteractiveCommand\", maybe_stop_zen);\n        }),\n\n        xml_zen_next_poi: Ymacs_Interactive(function(){\n            let markers = this.getq(\"xml_zen_markers\"), pos = this.point();\n            for (let i = 0; i < markers.length; ++i) {\n                let m = markers[i];\n                if (m.getPosition() > pos) {\n                    this.cmd(\"goto_char\", m.getPosition());\n                    break;\n                }\n            }\n        }),\n\n        xml_zen_prev_poi: Ymacs_Interactive(function(){\n            let markers = this.getq(\"xml_zen_markers\"), pos = this.point();\n            for (let i = markers.length; --i >= 0;) {\n                let m = markers[i];\n                if (m.getPosition() < pos) {\n                    this.cmd(\"goto_char\", m.getPosition());\n                    break;\n                }\n            }\n        }),\n\n        xml_newline_and_indent: Ymacs_Interactive(function(){\n            let inparens = this.looking_at(\"</\") && this.looking_back(\">\");\n            this.cmd(\"newline_and_indent\");\n            if (inparens) {\n                this.cmd(\"newline_and_indent\");\n                this.cmd(\"backward_line\");\n                this.cmd(\"indent_line\");\n            }\n        }),\n\n    });\n\n})();\n"],"names":["$08a06a2e99accb03$var$OVERLAY","$08a06a2e99accb03$var$TEMPLATE","document","createElement","$08a06a2e99accb03$export$cb0933279c36a66b","fromHTML","html","innerHTML","trim","cont","content","children","length","addClass","el","cls","classList","add","delClass","RegExp","className","replace","remove","hasClass","contains","condClass","cond","clsTrue","clsFalse","toggle","toggleClass","args","trash","on","element","event","handler","options","addEventListener","Object","keys","forEach","ev","off","removeEventListener","overlayOn","body","appendChild","overlayOff","mousePos","box","getBoundingClientRect","x","clientX","left","y","clientY","top","htmlEscape","str","$08a06a2e99accb03$export$76712d54f90f7348","constructor","_ev_handlers","create","o","assign","a","_getHandlers","$08a06a2e99accb03$export$cd7f480d6b8286c3","push","listenOnce","fn","apply","callHooks","f","destroy","$08a06a2e99accb03$export$a829527ff4e4114a","initClassName","_ymacs_object","name","getContentElement","getElement","thing","setContent","setStyle","prop","val","style","getBox","arguments","array","pos","indexOf","splice","$08a06a2e99accb03$export$ad41d882ec94ba04","timeout","obj","bind","timer","clearTimeout","setTimeout","$08a06a2e99accb03$export$e1a3971de07c83b5","number","fixed","spec","r","sz","$08a06a2e99accb03$var$$1K","$08a06a2e99accb03$var$$1M","$08a06a2e99accb03$var$$1G","Math","round","toFixed","$08a06a2e99accb03$export$b43564a9f178c38c","strings","b","n","min","i","charAt","substring","slice","$c35b14db10f870d1$export$57a830c2aa4f8317","editor","before","position","markers","rowcol","onChange","editorChange","diff","p","arg","call","getPosition","valueOf","setPosition","noHooks","force","getRowCol","_positionToRowCol","swap","other","tmp","$d9a61832b63ddf79$var$KEYMAPS","$d9a61832b63ddf79$export$6b6e17e3540cb3d2","definitions","defineKeys","define","get","parseKey","key","split","reverse","c","toLowerCase","ctrlKey","metaKey","shiftKey","pop","sort","join","unparseKey","wheelDelta","altKey","ymacsMeta","toUpperCase","defineKey","func","Array","dfn","map","getHandler","def","isArray","attached","detached","$541ef653595620bf$export$c411e7bd03572a3a","why","message","$92bab0a532b3076f$export$1c2a1b3d78098030","documentation","Function","ymacsDoc","ymacsInteractive","m","exec","substr","ymacsMarkExtend","ymacsWarnReadonly","ymacsSelectFrame","collect","execute","rest","concat","callInteractively","next","$92bab0a532b3076f$var$createArgumentFunction","reader","$92bab0a532b3076f$var$ARG_READERS","ymacsCallInteractively","$92bab0a532b3076f$export$8c34793404b3efcb","prototype","$92bab0a532b3076f$var$$TRUE","$92bab0a532b3076f$var$prompt","pr","getPrefixArg","cmd","$92bab0a532b3076f$var$read_arbitrary_text","$92bab0a532b3076f$var$read_number","toString","empty","console","log","B","C","d","point","e","k","K","markMarker","M","N","parseInt","isNaN","P","getRegion","begin","end","s","U","v","F","G","D","$2a60837ab2b03436$var$minibuffer_keys","$2a60837ab2b03436$var$emacs_keys","$2a60837ab2b03436$export$649e07e86b62d08f","defaultHandler","$2a60837ab2b03436$export$e144e07a20daa9d","$2a60837ab2b03436$export$7f1c7eed09402475","interactiveEvent","ch","prefix","test","popKeymap","setPrefixArg","isMinibuffer","whenMinibuffer","mb","buffer","$9e9d7d2dbe50ab17$export$bdebb5ddaa01123f","reset","props","insertLine","row","deleteLine","replaceLine","text","addLineProps","j","changed","removeLineProps","spliceLineProps","getLineHTML","caret","last","ret","css","$5e779a545e33325b$var$GLOBAL_VARS","case_fold_search","case_replace","line_movement_requested_col","fill_column","tab_width","indent_level","sticky_mark","syntax_word","syntax_capitalize_word","syntax_word_dabbrev","syntax_word_sexp","syntax_paragraph_sep","$5e779a545e33325b$var$setq","undefined","ymacsCommand","$5e779a545e33325b$var$MRK","$5e779a545e33325b$export$df331bdfc76955b4","code","ymacs","tokenizer","COMMANDS","newCommands","replaceCommands","cmds","replacements","oldcmd","newcmd","newMode","activate","modevar","hookvar","setGlobal","status","getq","hook","setq","modes","getVariable","setVariable","$5e779a545e33325b$export$36a0d48d1b18d0fa","__savingExcursion","__preventUpdates","__preventUndo","__undoInProgress","__dirtyLines","__undoQueue","__undoPointer","caretMarker","createMarker","matchData","previousCommand","currentCommand","currentKeys","progress","variables","globalVariables","_rowcol","_tokenizerEvents","_on_tokenizerFoundToken","_textProperties","_on_textPropertiesChange","keymap","pushKeymap","makeDefaultKeymap","setCode","_lastCommandWasKill","addModeHook","pushUnique","removeModeHook","withVariables","vars","saved","cmdApply","withCommands","lastIndexOfRegexp","rx","bound","match","global","source","flags","lastIndex","after","skipOne","signalError","isHtml","indicateError","type","signalInfo","popupMessage","dirty","__isDirty","updateModeline","__code","__size","forAllFrames","frame","ensureCaretVisible","redrawModelineWithTimer","setTokenizer","tok","getCode","getCodeSize","size","getLine","charAtRowCol","col","line","rc","finalArgs","sameCommandCount","_placeUndoBoundary","preventUpdates","clearTransientMark","ex","ensureTransientMark","resumeUpdates","start","resetOverwriteMode","om","overwriteMode","getMinibuffer","whenYmacs","minibuffer","getMinibufferFrame","minibuffer_frame","setMinibuffer","forEachLine","c1","c2","getActiveFrame","when","what","whenActiveFrame","fr","activeFrame","getBufferFrames","withMarkers","max","redrawDirtyLines","draw","setOverlay","deleteOverlay","setMark","tm","transientMarker","line1","col1","line2","col2","deleteTransientRegion","_deleteText","lastKeyEvent","noDiscard","updateProgress","renderModelineContent","percent","ml","custom","_recordChange","len","q","shift","at","_playbackUndo","action","didit","_insertText","_replaceLine","_deleteLine","quickDeleteLine","_insertLine","quickInsertLine","drawIt","lines","ln","_updateMarkers","_boundPosition","_bufferSubstring","brc","erc","_replaceText","_swapAreas","b1","e1","b2","e2","t1","t2","_killingAction","p1","p2","prepend","noDelete","_saveKilledText","killRingToMaster","pushToKillRing","navigator","clipboard","writeText","killRingText","_rowColToPosition","_repositionCaret","offset","delta","truncate","_saveExcursion","markerBefore","_disableUndo","_handleKeyEvent","handled","lcwk","__nextIsMeta","cc","foundPrefix","km","h","bold","formatLineHTML","looking_at","needle","haystack","index","looking_back","capitalize","_","promptMarker","whatever","prompt","$ec4394da1a74075f$export$731251e1d39d8621","_cont","$9526afefc19b5eea$var$CLICK_COUNT","$9526afefc19b5eea$var$CLICK_COUNT_TIMER","$9526afefc19b5eea$var$CLEAR_CLICK_COUNT","$9526afefc19b5eea$var$LINE_DIV","$9526afefc19b5eea$var$COUNT","$9526afefc19b5eea$export$3230e5a51f22d844","highlightCurrentLine","id","__caretId","redrawModeline","tabIndex","onDestroy","_on_destroy","_dragSelectHandlers","mousemove","_dragSelect_onMouseMove","mouseup","_dragSelect_onMouseUp","_bufferEvents","onLineChange","_on_bufferLineChange","onInsertLine","_on_bufferInsertLine","onDeleteLine","_on_bufferDeleteLine","onPointChange","_on_bufferPointChange","onResetCode","_on_bufferResetCode","onOverwriteMode","_on_bufferOverwriteMode","onProgressChange","_on_bufferProgressChange","beforeInteractiveCommand","_on_bufferBeforeInteractiveCommand","afterInteractiveCommand","_on_bufferAfterInteractiveCommand","onOverlayChange","_on_bufferOverlayChange","onOverlayDelete","_on_bufferOverlayDelete","_moreBufferEvents","onMessage","_on_bufferMessage","__ensureCaretVisible","setBuffer","getOverlaysContainer","_on_scroll","mousedown","_dragSelect_onMouseDown","focus","_on_focus","blur","_on_blur","keydown","_on_keyDown","keyup","_on_keyUp","wheel","_on_mouseWheel","exitAllowed","firstChild","getModelineElement","childNodes","getCaretElement","getElementById","getLineDivElement","div","st","scrollTop","redrawCaret","scrollIntoView","block","inline","offsetLeft","clientWidth","scrollLeft","focusInside","activeElement","_redrawBuffer","centerOnCaret","recenterTopBottom","center","offsetTop","clientHeight","offsetHeight","bottom","centerOnLine","setModelineContent","deleteOtherFrames","keepOnlyFrame","deleteFrame","_split","horiz","ovdiv","scroll","createFrame","sc","$9526afefc19b5eea$export$7b0e4d18ade0c4c9","replaceWith","setSplit","vsplit","hsplit","__showCaret","_unhoverLine","__hoverLine","isActive","querySelectorAll","__prevCaretLine","_getLineHTML","coordinatesToRowCol","self","findLine","r1","r2","floor","y1","y2","findCol","coordinates","$9526afefc19b5eea$var$textColX","range","createRange","selectNodeContents","treeWalker","createTreeWalker","NodeFilter","SHOW_TEXT","nextNode","node","currentNode","clen","nodeValue","setStart","setEnd","right","heightInLines","maxline","firstline","firstLineVisible","lastline","lastLineVisible","cloneNode","insertBefore","clearPopupMessage","getOverlayId","getOverlayHTML","p0","getOverlaysCount","old","_setOverlayClasses","names","dataset","ymacsOverlay","ymacsOverlays","setActiveFrame","stopPropagation","buf","window","processKeyEvent","preventDefault","scrollUp","scrollDown","_dragHandlers","_onMouseMove","_onMouseUp","_rb","_onMouseDown","target","first","_start","_orig_sz","offsetWidth","frac","gridTemplateRows","gridTemplateColumns","$2f9db344d0795d0e$var$minElement","minEl","minValue","minIndex","$2f9db344d0795d0e$var$selectClosestFrameX","byx","abs","height","$2f9db344d0795d0e$var$selectClosestFrameY","byy","width","$2f9db344d0795d0e$var$ensureLocalStorage","localStorage","getItem","$2f9db344d0795d0e$export$e2cc12c8ba83ca65","buffers","frames","cf_frameStyle","_addBufferListeners","killRing","killMasterOfRings","__macro_recording","__macro_finished","__error_thrown","__running_macro","__macro_times","__macro_step","__macro_timer","__input_frame","hidden","createBuffer","getActiveBuffer","nextHiddenBuffer","unshift","rotateKillRing","getBuffer","find","killBuffer","renameBuffer","_do_switchToBuffer","switchToBuffer","maybeName","cur","filter","switchToNextBuffer","switchToPreviousBuffer","getNextBuffer","getPrevBuffer","setFrameStyle","parentNode","parent","querySelector","focusOtherFrame","setInputFrame","nofocus","setColorTheme","themeId","getFrameInDirection","dir","_get_frameInDir_left","_get_frameInDir_right","_get_frameInDir_up","_get_frameInDir_down","ls_get","JSON","parse","ls_set","src","setItem","stringify","ls_getFileContents","nothrow","info","ls_getFileDirectory","ls_setFileContents","files","store","back","path","part","hasOwnProperty","full","ls_deleteFile","fs_normalizePath","fs_fileType","fs_getFileContents","fs_setFileContents","stamp","fs_getDirectory","dirname","hasOwn","fs_deleteFile","fs_remapDir","isRunningMacro","isRecordingMacro","startMacro","do_append","stopMacro","getLastMacro","stepMacro","runMacro","times","macro","timer_popupMessage","atCaret","popup","__popup","removeProperty","_popupAtCaret","requestFullScreen","requestFullscreen","visibility","mybox","cbox","cbox_center","mybox_center","transform","$c749180882ef16eb$export$2f1022027d35d1bb","nextCol","prevCol","nextLine","prevLine","peek","stop","__stop","EOF","lineText","lineIndentation","lookingAt","textBefore","textAfter","eol","eof","l","stopAt","lineLength","save","restore","state","checkStop","EOL","skip_ws","$c749180882ef16eb$export$825fc0b420d392c1","is_whitespace","read_while","pred","$c749180882ef16eb$var$LANGUAGES","$c749180882ef16eb$export$3964ae1c660db960","stream","theParser","parsers","copy","timerUpdate","getLanguage","showProgress","doit","onToken","getParserForLine","reparseAll","finishParsing","getLastParser","getIndentation","indentation","$c749180882ef16eb$export$2b0c642afb0ae4ca","$c749180882ef16eb$export$af0894485b469f4e","pp","context","passedParens","$c749180882ef16eb$export$f6a9bcac20db9551","zone","closed","outer","l1","l2","inner","forward_char","backward_char","forward_line","backward_line","forward_whitespace","noLine","backward_whitespace","beginning_of_line","back_to_indentation","beginning_of_indentation_or_line","end_of_line","beginning_of_buffer","end_of_buffer","eob_p","bob_p","eol_p","bol_p","backward_delete_char","delete_char","delete_whitespace","backward_delete_whitespace","delete_indentation","universal_argument","overwrite_mode","self_insert_command","repeat","newline","newline_and_indent","indent_line","noEmpty","indent","ci","indent_region","make_marker","search_forward","search_backward","lastIndexOf","make_regexp","matchCase","search_forward_regexp","search_backward_regexp","forward_word","backward_word","forward_paragraph","backward_paragraph","mark_paragraph","transpose_words","transpose_lines","transpose_chars","kill_word","pos2","backward_kill_word","_apply_operation_on_word","op","word","capitalize_word","downcase_word","String","upcase_word","goto_char","goto_line","move_to_column","delete_region","insert","keyboard_quit","buffer_substring","kill_line","save_excursion","prevent_undo","kill_region","copy_region_as_kill","yank","atStart","yank_from_operating_system","readText","error","copy_for_operating_system","yank_pop","yank_shift","mark","set_mark_command","exchange_point_and_mark","mark_whole_buffer","recenter_top_bottom","recenter","ensure_caret_visible","get_fill_paragraph_region","fill_paragraph","noPrefix","eop","del","bol","done","start_next_paragraph","fromCharCode","charCodeAt","scroll_down_half","hl","scroll_up_half","scroll_up","scroll_down","nuke_trailing_whitespace","match_string","match_beginning","match_end","undo","center_line","dabbrev_expand","expansion","ctx","search","lastSearch","encountered","forward","seenBuffers","startBuffer","found","includes","split_frame_vertically","split_frame_horizontally","delete_other_frames","delete_frame","other_frame","windmove","next_buffer","previous_buffer","switch_to_buffer","kill_buffer","kill","msg","yes","rename_buffer","delete_region_or_line","close_last_xml_tag","tag","skip","bind_variables","for_region","comment_region","cmmt","out","uncomment_region","cmmt1","cmmt2","comment_dwim","what_cursor_position","chname","$c7731ae7d5abaea3$var$TMPL_CHAR_INFO","codeHex","sizeKB","set_fill_column","value","prev","apply_on_rectangle","ws","string_rectangle","string","kill_rectangle","clear_rectangle","insert_rectangle","rect","yank_rectangle","kr","_next_is_meta","kmacro_start_macro","kmacro_end_macro","kmacro_end_and_call_macro","$64ad30bda24c420e$var$$menu","$64ad30bda24c420e$var$$selectedIndex","$64ad30bda24c420e$var$$selectedItem","$64ad30bda24c420e$var$popupCompletionMenu","list","label","click","item","$64ad30bda24c420e$var$select","$64ad30bda24c420e$var$handle_enter","$64ad30bda24c420e$var$KEYMAP_POPUP_ACTIVE","$64ad30bda24c420e$var$killMenu","idx","items","current","$64ad30bda24c420e$export$9cb120f8f6032a76","completions","validate","changed_vars","completion_list","minibuffer_validation","cont2","minibuffer_continuation","$64ad30bda24c420e$var$filename_completion","re","lastslash","partial","$64ad30bda24c420e$var$handle_arrow_down","$64ad30bda24c420e$var$handle_arrow_up","minibuffer_prompt","minibuffer_yn","minibuffer_read_yn","minibuffer_read_number","minibuffer_read_command","minibuffer_read_function","commandNames","hashKeys","minibuffer_read_buffer","bufferNames","minibuffer_read_string","minibuffer_read_variable","minibuffer_read_existing_file","minibuffer_read_file","minibuffer_read_file_or_directory","minibuffer_read_directory","minibuffer_prompt_end","minibuffer_contents","minibuffer_replace_input","minibuffer_replace_input_by_current_dir","minibuffer_complete","complete","minibuffer_complete_and_exit","valid","minibuffer_keyboard_quit","$64ad30bda24c420e$var$DEFAULT_KEYS","$64ad30bda24c420e$var$KEYMAP_MB_ACTIVE","get_region","figure_out_mode","mode_from_name","set_buffer_mode","mode","cperl_lineup","rcend","htmlize_region","lineNum","pad","zero","execute_extended_command","set_variable","variable","parseFloat","eval_string","eval_region","eval_buffer","toggle_line_numbers","save_file","load_file","find_file","write_file","save_some_buffers","save_some_buffers_with_continuation","ask","bufs","loop","save_buffer_with_continuation","did_save","do_save","save_buffer","delete_file","eval_file","request_full_screen","set_color_theme","theme","themes","styleSheets","digStyle","rule","cssRules","digRule","CSSImportRule","styleSheet","selectorText","$f129722536e13624$var$Ymacs_Keymap_ISearch","_isearchContext","mbMark","livepoint","$f129722536e13624$var$isearchText","$f129722536e13624$var$updateIsearch","$f129722536e13624$var$initIsearch","regexp","lax","case_fold","qreplace","region","origpoint","query","$f129722536e13624$var$resetPrompt","$f129722536e13624$var$doSearch","$f129722536e13624$var$caseFold","$f129722536e13624$var$lazyHighlight","qrx","cursor","minpos","maxpos","Infinity","count","crnt","mid","lastFoundQuery","$f129722536e13624$var$searchRegExp","p1rc","p2rc","searchRX","isearch_forward","isearch_backward","isearch_forward_regexp","isearch_backward_regexp","isearch_yank_word_or_char","isearch_toggle_word","isearch_toggle_case_fold","isearch_toggle_lax_whitespace","isearch_printing_char","isearch_abort","cancelled","isearch_reset_or_abort","$f129722536e13624$var$Ymacs_Keymap_Query_Replace","$f129722536e13624$var$query_replace_1","hlOrig","onQuit","continued","orig","$f129722536e13624$var$query_replace_2","rxorig","replacement","$f129722536e13624$var$query_replace_3","$f129722536e13624$var$similarCase","rplc","curr","queue","domatch","groups","gotoNext","all","rc_begin","query_replace_yes_this_occurrence","query_replace_yes_this_occurrence_and_stop","query_replace_no_this_occurrence","query_replace_yes_all_occurrences","query_replace_undo_previous","uptr","uq","query_replace_abort","enter","$f129722536e13624$var$query_replace","query_replace","query_replace_regexp","PARSER","$cont","$inComment","foundToken","readComment","$parens","$inString","readString","OPEN_PAREN","CLOSE_PAREN","opened","$passedParens","resume","parens","inString","inComment","currentLine","commentStartLine","thisLineCloses","INDENT_LEVEL","esc","was_paren_match","syntax_comment_line","syntax_comment_multi","qw","toHash","reduce","KEYWORDS","KEYWORDS_TYPE","KEYWORDS_CONST","KEYWORDS_BUILTIN","ALLOW_REGEXP_AFTER","isLetter","JS_PARSER","readToken","stmtLine","readLiteralRegexp","inset","isNameStart","readName","$8e1bdec65509308b$var$Ymacs_Keymap_JS","Partial","QuickParser","input","caret_token","read_escaped","inces","escaped","read_comment","read_multiline_comment","comment","read_string","read_list","beg","save_list_index","list_index","read_token","read_regexp","pattern","modifiers","read_symbol","read_char","read_sharp","token","read_all","cont_exp","adjust_start","save_parent","depth","read","prev_exp","sexp","test_lisp_parse","ast","lisp_make_quick_parser","lisp_forward_sexp","lisp_backward_sexp","lisp_backward_up_list","lisp_handle_string_quote","SPECIAL_FORMS","ERROR_FORMS","CONSTANTS","DEFINES_FUNCTION","DEFINES_TYPE","FORM_ARGS","LOCAL_BODYDEF","isConstituent","rx_special","$quote","$backList","$list","newArg","isConstituentStart","isForm","quote","backList","nextNonSpace","currentForm","formArgs","hasRest","form","$cd9400013ca46db2$var$Ymacs_Keymap_LispMode","changed_commands","$inline","$0d1e4b05bb7aaeb3$var$Ymacs_Keymap_ParenMatch","$0d1e4b05bb7aaeb3$var$PARENS","$0d1e4b05bb7aaeb3$var$R_PARENS","$0d1e4b05bb7aaeb3$var$ERROR","$0d1e4b05bb7aaeb3$var$caretInOP","paren","$0d1e4b05bb7aaeb3$var$caretInCP","$0d1e4b05bb7aaeb3$var$startOf","$0d1e4b05bb7aaeb3$var$endOf","matching_paren","parser","cp","indent_sexp","goto_matching_paren","forward_sexp","backward_sexp","mark_sexp","kill_sexp","transpose_sexps","down_list","lc","backward_up_list","up_list","beginning_of_defun","end_of_defun","paredit_raise_sexp","kstart","kend","paredit_splice_sexp","outer_begin","outer_end","inner_begin","inner_end","m1","m2","paredit_backward_delete_char","close","paredit_delete_char","open","paredit_open_pair","pair_a","pair_b","backslash","paredit_close_pair","paredit_wrap_round","closing","txt","paredit_newline_and_indent","inparens","paredit_maybe_indent","paredit_electric_char","clearOvl","events","par_a","par_b","ac1","ac2","bc1","bc2","$3aa295d5c8d5089e$var$RX_EMPTY_TAG","$3aa295d5c8d5089e$var$RX_BLOCK_TAG","emptyTags","$tags","$inTag","otag","ctag","popen","pclose","readCloseBracket","readTag","tags","inTag","lastTag","addInline","$xml","$3aa295d5c8d5089e$var$inlineCode","$3aa295d5c8d5089e$var$inlineCls","$js","$css","$mode","_main","_js","_css","_mode","$3aa295d5c8d5089e$var$Ymacs_Keymap_XML","$3aa295d5c8d5089e$var$markup_mode","tok_type","xml_get_fill_paragraph_region","blk","findLast","Ymacs_Keymap_XML_Zen","maybe_stop_zen","xml_close_tag","xml_slash_complete_tag","xml_gt_complete_tag","xml_zen_expand","zen_render","klass","attributes","attr","child","zen_parse","OUTER","xml_zen_stop","xml_zen_next_poi","xml_zen_prev_poi","xml_newline_and_indent","Ymacs","Ymacs_Buffer","Ymacs_Keymap","Ymacs_Keymap_Emacs","Ymacs_Tokenizer","Ymacs_Interactive","Ymacs_Exception"],"version":3,"file":"ymacs.mjs.map"}